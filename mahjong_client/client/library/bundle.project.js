require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"Alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c12553sxCxG/on0Bz7rkX0f', 'Alert');
// scripts/components/Alert.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _alert: null,
        _btnOK: null,
        _btnCancel: null,
        _title: null,
        _content: null,
        _onok: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._alert = cc.find("Canvas/alert");
        this._title = cc.find("Canvas/alert/title").getComponent(cc.Label);
        this._content = cc.find("Canvas/alert/content").getComponent(cc.Label);

        this._btnOK = cc.find("Canvas/alert/btn_ok");
        this._btnCancel = cc.find("Canvas/alert/btn_cancel");

        cc.vv.utils.addClickEvent(this._btnOK, this.node, "Alert", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._btnCancel, this.node, "Alert", "onBtnClicked");

        this._alert.active = false;
        cc.vv.alert = this;
    },

    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_ok") {
            if (this._onok) {
                this._onok();
            }
        }
        this._alert.active = false;
        this._onok = null;
    },

    show: function show(title, content, onok, needcancel) {
        this._alert.active = true;
        this._onok = onok;
        this._title.string = title;
        this._content.string = content;
        if (needcancel) {
            this._btnCancel.active = true;
            this._btnOK.x = -150;
            this._btnCancel.x = 150;
        } else {
            this._btnCancel.active = false;
            this._btnOK.x = 0;
        }
    },

    onDestory: function onDestory() {
        if (cc.vv) {
            cc.vv.alert = null;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"AnysdkMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f58cea6lrpDZJSNs2BGBqxN', 'AnysdkMgr');
// scripts/AnysdkMgr.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _isCapturing: false
    },

    // use this for initialization
    onLoad: function onLoad() {},

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },

    init: function init() {
        this.ANDROID_API = "com/vivigames/scmj/WXAPI";
        this.IOS_API = "AppController";
    },

    login: function login() {
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod(this.ANDROID_API, "Login", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod(this.IOS_API, "login");
        } else {
            console.log("platform:" + cc.sys.os + " dosn't implement share.");
        }
    },

    share: function share(title, desc) {
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod(this.ANDROID_API, "Share", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", cc.vv.SI.appweb, title, desc);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod(this.IOS_API, "share:shareTitle:shareDesc:", cc.vv.SI.appweb, title, desc);
        } else {
            console.log("platform:" + cc.sys.os + " dosn't implement share.");
        }
    },

    shareResult: function shareResult() {
        if (this._isCapturing) {
            return;
        }
        this._isCapturing = true;
        var size = cc.director.getWinSize();
        var currentDate = new Date();
        var fileName = "result_share.jpg";
        var fullPath = jsb.fileUtils.getWritablePath() + fileName;
        if (jsb.fileUtils.isFileExist(fullPath)) {
            jsb.fileUtils.removeFile(fullPath);
        }
        var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height));
        texture.setPosition(cc.p(size.width / 2, size.height / 2));
        texture.begin();
        cc.director.getRunningScene().visit();
        texture.end();
        texture.saveToFile(fileName, cc.IMAGE_FORMAT_JPG);

        var self = this;
        var tryTimes = 0;
        var fn = function fn() {
            if (jsb.fileUtils.isFileExist(fullPath)) {
                var height = 100;
                var scale = height / size.height;
                var width = Math.floor(size.width * scale);

                if (cc.sys.os == cc.sys.OS_ANDROID) {
                    jsb.reflection.callStaticMethod(self.ANDROID_API, "ShareIMG", "(Ljava/lang/String;II)V", fullPath, width, height);
                } else if (cc.sys.os == cc.sys.OS_IOS) {
                    jsb.reflection.callStaticMethod(self.IOS_API, "shareIMG:width:height:", fullPath, width, height);
                } else {
                    console.log("platform:" + cc.sys.os + " dosn't implement share.");
                }
                self._isCapturing = false;
            } else {
                tryTimes++;
                if (tryTimes > 10) {
                    console.log("time out...");
                    return;
                }
                setTimeout(fn, 50);
            }
        };
        setTimeout(fn, 50);
    },

    onLoginResp: function onLoginResp(code) {
        var fn = function fn(ret) {
            if (ret.errcode == 0) {
                cc.sys.localStorage.setItem("wx_account", ret.account);
                cc.sys.localStorage.setItem("wx_sign", ret.sign);
            }
            cc.vv.userMgr.onAuth(ret);
        };
        cc.vv.http.sendRequest("/wechat_auth", { code: code, os: cc.sys.os }, fn);
    }
});

cc._RFpop();
},{}],"AudioMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '55caepcpvFK5r0Ax5f8jss4', 'AudioMgr');
// scripts/AudioMgr.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        bgmVolume: 1.0,
        sfxVolume: 1.0,

        bgmAudioID: -1
    },

    // use this for initialization
    init: function init() {
        var t = cc.sys.localStorage.getItem("bgmVolume");
        if (t != null) {
            this.bgmVolume = parseFloat(t);
        }

        var t = cc.sys.localStorage.getItem("sfxVolume");
        if (t != null) {
            this.sfxVolume = parseFloat(t);
        }

        cc.game.on(cc.game.EVENT_HIDE, function () {
            console.log("cc.audioEngine.pauseAll");
            cc.audioEngine.pauseAll();
        });
        cc.game.on(cc.game.EVENT_SHOW, function () {
            console.log("cc.audioEngine.resumeAll");
            cc.audioEngine.resumeAll();
        });
    },

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },

    getUrl: function getUrl(url) {
        return cc.url.raw("resources/sounds/" + url);
    },

    playBGM: function playBGM(url) {
        var audioUrl = this.getUrl(url);
        console.log(audioUrl);
        if (this.bgmAudioID >= 0) {
            cc.audioEngine.stop(this.bgmAudioID);
        }
        this.bgmAudioID = cc.audioEngine.play(audioUrl, true, this.bgmVolume);
    },

    playSFX: function playSFX(url) {
        var audioUrl = this.getUrl(url);
        if (this.sfxVolume > 0) {
            var audioId = cc.audioEngine.play(audioUrl, false, this.sfxVolume);
        }
    },

    setSFXVolume: function setSFXVolume(v) {
        if (this.sfxVolume != v) {
            cc.sys.localStorage.setItem("sfxVolume", v);
            this.sfxVolume = v;
        }
    },

    setBGMVolume: function setBGMVolume(v, force) {
        if (this.bgmAudioID >= 0) {
            if (v > 0) {
                cc.audioEngine.resume(this.bgmAudioID);
            } else {
                cc.audioEngine.pause(this.bgmAudioID);
            }
            //cc.audioEngine.setVolume(this.bgmAudioID,this.bgmVolume);
        }
        if (this.bgmVolume != v || force) {
            cc.sys.localStorage.setItem("bgmVolume", v);
            this.bgmVolume = v;
            cc.audioEngine.setVolume(this.bgmAudioID, v);
        }
    },

    pauseAll: function pauseAll() {
        cc.audioEngine.pauseAll();
    },

    resumeAll: function resumeAll() {
        cc.audioEngine.resumeAll();
    }
});

cc._RFpop();
},{}],"Chat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '58f27rxustNsYlRX3fryN8X', 'Chat');
// scripts/components/Chat.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _chatRoot: null,
        _tabQuick: null,
        _tabEmoji: null,
        _iptChat: null,

        _quickChatInfo: null,
        _btnChat: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        cc.vv.chat = this;

        this._btnChat = this.node.getChildByName("btn_chat");
        this._btnChat.active = cc.vv.replayMgr.isReplay() == false;

        this._chatRoot = this.node.getChildByName("chat");
        this._chatRoot.active = false;

        this._tabQuick = this._chatRoot.getChildByName("quickchatlist");
        this._tabEmoji = this._chatRoot.getChildByName("emojis");

        this._iptChat = this._chatRoot.getChildByName("iptChat").getComponent(cc.EditBox);

        this._quickChatInfo = {};
        this._quickChatInfo["item0"] = { index: 0, content: "快点啊，都等到我花儿都谢谢了！", sound: "fix_msg_1.mp3" };
        this._quickChatInfo["item1"] = { index: 1, content: "怎么又断线了，网络怎么这么差啊！", sound: "fix_msg_2.mp3" };
        this._quickChatInfo["item2"] = { index: 2, content: "不要走，决战到天亮！", sound: "fix_msg_3.mp3" };
        this._quickChatInfo["item3"] = { index: 3, content: "你的牌打得也太好了！", sound: "fix_msg_4.mp3" };
        this._quickChatInfo["item4"] = { index: 4, content: "你是妹妹还是哥哥啊？", sound: "fix_msg_5.mp3" };
        this._quickChatInfo["item5"] = { index: 5, content: "和你合作真是太愉快了！", sound: "fix_msg_6.mp3" };
        this._quickChatInfo["item6"] = { index: 6, content: "大家好，很高兴见到各位！", sound: "fix_msg_7.mp3" };
        this._quickChatInfo["item7"] = { index: 7, content: "各位，真是不好意思，我得离开一会儿。", sound: "fix_msg_8.mp3" };
        this._quickChatInfo["item8"] = { index: 8, content: "不要吵了，专心玩游戏吧！", sound: "fix_msg_9.mp3" };
    },

    getQuickChatInfo: function getQuickChatInfo(index) {
        var key = "item" + index;
        return this._quickChatInfo[key];
    },

    onBtnChatClicked: function onBtnChatClicked() {
        this._chatRoot.active = true;
    },

    onBgClicked: function onBgClicked() {
        this._chatRoot.active = false;
    },

    onTabClicked: function onTabClicked(event) {
        if (event.target.name == "tabQuick") {
            this._tabQuick.active = true;
            this._tabEmoji.active = false;
        } else if (event.target.name == "tabEmoji") {
            this._tabQuick.active = false;
            this._tabEmoji.active = true;
        }
    },

    onQuickChatItemClicked: function onQuickChatItemClicked(event) {
        this._chatRoot.active = false;
        var info = this._quickChatInfo[event.target.name];
        cc.vv.net.send("quick_chat", info.index);
    },

    onEmojiItemClicked: function onEmojiItemClicked(event) {
        console.log(event.target.name);
        this._chatRoot.active = false;
        cc.vv.net.send("emoji", event.target.name);
    },

    onBtnSendChatClicked: function onBtnSendChatClicked() {
        this._chatRoot.active = false;
        if (this._iptChat.string == "") {
            return;
        }
        cc.vv.net.send("chat", this._iptChat.string);
        this._iptChat.string = "";
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"CheckBox":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc9e5hcegFBFpbh0CwUFw8V', 'CheckBox');
// scripts/components/CheckBox.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        target: cc.Node,
        sprite: cc.SpriteFrame,
        checkedSprite: cc.SpriteFrame,
        checked: false
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.refresh();
    },

    onClicked: function onClicked() {
        this.checked = !this.checked;
        this.refresh();
    },

    switchToUnchecked: function switchToUnchecked() {
        this.checked = false;
        this.refresh();
    },

    refresh: function refresh() {
        var targetSprite = this.target.getComponent(cc.Sprite);
        if (this.checked) {
            targetSprite.spriteFrame = this.checkedSprite;
        } else {
            targetSprite.spriteFrame = this.sprite;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"CreateRole":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5d56bFYy/REb77pQCq9YHh6', 'CreateRole');
// scripts/components/CreateRole.js

cc.Class({
    "extends": cc.Component,

    properties: {
        inputName: cc.EditBox
    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    onRandomBtnClicked: function onRandomBtnClicked() {
        var names = ["上官", "欧阳", "东方", "端木", "独孤", "司马", "南宫", "夏侯", "诸葛", "皇甫", "长孙", "宇文", "轩辕", "东郭", "子车", "东阳", "子言"];

        var names2 = ["雀圣", "赌侠", "赌圣", "稳赢", "不输", "好运", "自摸", "有钱", "土豪"];
        var idx = Math.floor(Math.random() * (names.length - 1));
        var idx2 = Math.floor(Math.random() * (names2.length - 1));
        this.inputName.string = names[idx] + names2[idx2];
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        this.onRandomBtnClicked();
    },

    onBtnConfirmClicked: function onBtnConfirmClicked() {
        var name = this.inputName.string;
        if (name == "") {
            console.log("invalid name.");
            return;
        }
        console.log(name);
        cc.vv.userMgr.create(name);
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"CreateRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'eec07HsL4pBn5/PiT3SYBew', 'CreateRoom');
// scripts/components/CreateRoom.js

cc.Class({
    "extends": cc.Component,

    properties: {
        _leixingxuanze: null,
        _koufei: null,
        _quanshu: null,
        _jiesuan: null,
        _wanfaxuanze: null,
        _types: [] },

    //定义多种游戏类型
    // use this for initialization
    onLoad: function onLoad() {
        //有多种玩法，沈家门麻将 定海麻将 推到胡麻将
        this._types = ["sjmmj", "dhmj", "tdh"];

        //隐藏除第一种外的其他玩法 界面
        for (var i = 1; i < this._types.length; i++) {
            this.node.getChildByName(this._types[i]).active = false;
        }
    },

    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },

    onBtnOK: function onBtnOK(event) {
        this.node.active = false;
        //确定游戏类型
        var type = event.target.parent.name;
        //分别进入不同的创建逻辑
        //TODO：让添加一个游戏和规则更加方便
        if (type == "sjmmj") {
            this.createRoomSJMMJ();
        } else if (type == "dhmj") {
            this.createRoomDHMJ();
        } else if (type == "tdh") {
            this.createRoomTDH();
        }
    },

    onTypeClicked: function onTypeClicked(event) {
        this.switchType(event.target.parent.children[1].name);
    },

    //tab界面切换
    switchType: function switchType(type) {
        for (var i = 0; i < this._types.length; i++) {
            this.node.getChildByName(this._types[i]).active = false;
        }
        this.node.getChildByName(type).active = true;
    },

    createRoomSJMMJ: function createRoomSJMMJ() {

        //获取需要的所有选项

        //这里一定要小写，后端会直接拼接这个字符串
        var type = "sjmmj";

        this._koufei = [];
        var t = this.node.getChildByName(type).getChildByName("koufei");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._koufei.push(n);
            }
        }

        this._quanshu = [];
        var t = this.node.getChildByName(type).getChildByName("quanshu");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._quanshu.push(n);
            }
        }

        this._jiesuan = [];
        var t = this.node.getChildByName(type).getChildByName("jiesuan");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._jiesuan.push(n);
            }
        }

        this._wanfaxuanze = [];
        var t = this.node.getChildByName(type).getChildByName("wanfaxuanze");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("CheckBox");
            if (n != null) {
                this._wanfaxuanze.push(n);
            }
        }

        var self = this;
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                //console.log(ret.errmsg);
                if (ret.errcode == 2222) {
                    cc.vv.alert.show("提示", "房卡不足，创建房间失败!");
                } else {
                    cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                }
            } else {
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };

        var hongzhongdanghua = self._wanfaxuanze[0].checked;

        var koufei = 0;
        for (var i = 0; i < self._koufei.length; ++i) {
            if (self._koufei[i].checked) {
                koufei = i;
                break;
            }
        }

        var quanshu = 0;
        for (var i = 0; i < self._quanshu.length; ++i) {
            if (self._quanshu[i].checked) {
                quanshu = i;
                break;
            }
        }

        var jiesuan = 0;
        for (var i = 0; i < self._jiesuan.length; ++i) {
            if (self._jiesuan[i].checked) {
                jiesuan = i;
                break;
            }
        }

        var conf = {
            type: type,
            hongzhongdanghua: hongzhongdanghua,
            koufei: koufei,
            quanshu: quanshu,
            jiesuan: jiesuan
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        cc.vv.wc.show("正在创建房间");
        cc.vv.http.sendRequest("/create_private_room", data, onCreate);
    },

    createRoomDHMJ: function createRoomDHMJ() {

        //获取需要的所有选项
        //这里一定要小写，后端会直接拼接这个字符串
        var type = "dhmj";

        this._koufei = [];
        var t = this.node.getChildByName(type).getChildByName("koufei");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._koufei.push(n);
            }
        }

        this._quanshu = [];
        var t = this.node.getChildByName(type).getChildByName("quanshu");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._quanshu.push(n);
            }
        }

        this._jiesuan = [];
        var t = this.node.getChildByName(type).getChildByName("jiesuan");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._jiesuan.push(n);
            }
        }

        var self = this;
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                if (ret.errcode == 2222) {
                    cc.vv.alert.show("提示", "房卡不足，创建房间失败!");
                } else {
                    cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                }
            } else {
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };

        //判断用户做了哪些选择
        //扣费 0 房主出资 1 玩家平分
        //圈数 0 8盘 1 一圈
        //结算 0 50  1 120

        var koufei = 0;
        for (var i = 0; i < self._koufei.length; ++i) {
            if (self._koufei[i].checked) {
                koufei = i;
                break;
            }
        }

        var quanshu = 0;
        for (var i = 0; i < self._quanshu.length; ++i) {
            if (self._quanshu[i].checked) {
                quanshu = i;
                break;
            }
        }

        var jiesuan = 0;
        for (var i = 0; i < self._jiesuan.length; ++i) {
            if (self._jiesuan[i].checked) {
                jiesuan = i;
                break;
            }
        }

        var conf = {
            type: type,
            koufei: koufei,
            quanshu: quanshu,
            jiesuan: jiesuan
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        console.log(data);
        cc.vv.wc.show("正在创建房间");
        cc.vv.http.sendRequest("/create_private_room", data, onCreate);
    },

    createRoomTDH: function createRoomTDH() {

        //获取需要的所有选项
        //这里一定要小写，后端会直接拼接这个字符串
        var type = "tdh";

        this._koufei = [];
        var t = this.node.getChildByName(type).getChildByName("koufei");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._koufei.push(n);
            }
        }

        this._quanshu = [];
        var t = this.node.getChildByName(type).getChildByName("quanshu");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._quanshu.push(n);
            }
        }

        this._jiesuan = [];
        var t = this.node.getChildByName(type).getChildByName("jiesuan");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._jiesuan.push(n);
            }
        }

        var self = this;
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                if (ret.errcode == 2222) {
                    cc.vv.alert.show("提示", "房卡不足，创建房间失败!");
                } else {
                    cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                }
            } else {
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };

        //判断用户做了哪些选择
        //扣费 0 房主出资 1 玩家平分
        //圈数 0 8盘 1 一圈
        //结算 0 50  1 120

        var koufei = 0;
        for (var i = 0; i < self._koufei.length; ++i) {
            if (self._koufei[i].checked) {
                koufei = i;
                break;
            }
        }

        var quanshu = 0;
        for (var i = 0; i < self._quanshu.length; ++i) {
            if (self._quanshu[i].checked) {
                quanshu = i;
                break;
            }
        }

        var jiesuan = 0;
        for (var i = 0; i < self._jiesuan.length; ++i) {
            if (self._jiesuan[i].checked) {
                jiesuan = i;
                break;
            }
        }

        var conf = {
            type: type,
            koufei: koufei,
            quanshu: quanshu,
            jiesuan: jiesuan
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        console.log(data);
        cc.vv.wc.show("正在创建房间");
        cc.vv.http.sendRequest("/create_private_room", data, onCreate);
    }

});

cc._RFpop();
},{}],"DingQue":[function(require,module,exports){
"use strict";
cc._RFpush(module, '907582awNJFnobC/mZGFLBq', 'DingQue');
// scripts/components/DingQue.js

cc.Class({
    "extends": cc.Component,

    properties: {
        queYiMen: null,
        tips: [],
        selected: [],
        dingques: []
    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initView();
        this.initDingQue();
        this.initEventHandlers();
    },

    initView: function initView() {
        var gameChild = this.node.getChildByName("game");
        this.queYiMen = gameChild.getChildByName("dingque");
        this.queYiMen.active = cc.vv.gameNetMgr.isDingQueing;

        var arr = ["myself", "right", "up", "left"];
        for (var i = 0; i < arr.length; ++i) {
            var side = gameChild.getChildByName(arr[i]);
            var seat = side.getChildByName("seat");
            var dingque = seat.getChildByName("que");
            this.dingques.push(dingque);
        }
        this.reset();

        var tips = this.queYiMen.getChildByName("tips");
        for (var i = 0; i < tips.childrenCount; ++i) {
            var n = tips.children[i];
            this.tips.push(n.getComponent(cc.Label));
        }

        if (cc.vv.gameNetMgr.gamestate == "dingque") {
            this.showDingQueChoice();
        }
    },

    initEventHandlers: function initEventHandlers() {
        var self = this;

        this.node.on('game_dingque_notify', function (data) {
            var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(data.detail);
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
            console.log("game_dingque_notify:" + localIndex);
            self.tips[localIndex].node.active = true;
        });

        this.node.on('game_dingque_finish', function () {
            //通知每一个玩家定缺的花色
            self.queYiMen.active = false;
            cc.vv.gameNetMgr.isDingQueing = false;
            self.initDingQue();
        });
    },

    showDingQueChoice: function showDingQueChoice() {
        this.queYiMen.active = true;
        var sd = cc.vv.gameNetMgr.getSelfData();
        var typeCounts = [0, 0, 0];
        for (var i = 0; i < sd.holds.length; ++i) {
            var pai = sd.holds[i];
            var type = cc.vv.mahjongmgr.getMahjongType(pai);
            typeCounts[type]++;
        }

        var min = 65535;
        var minIndex = 0;
        for (var i = 0; i < typeCounts.length; ++i) {
            if (typeCounts[i] < min) {
                min = typeCounts[i];
                minIndex = i;
            }
        }

        var arr = ["tong", "tiao", "wan"];
        for (var i = 0; i < arr.length; ++i) {
            var node = this.queYiMen.getChildByName(arr[i]);
            if (minIndex == i) {
                node.getComponent(cc.Animation).play("dingque_tuijian");
            } else {
                node.getComponent(cc.Animation).stop();
            }
            //this.queYiMen.getChildByName(arr[i]).getChildByName('jian').active = minIndex == i;  
        }

        this.reset();
        for (var i = 0; i < this.tips.length; ++i) {
            var n = this.tips[i];
            if (i > 0) {
                n.node.active = false;
            } else {
                n.node.active = true;
            }
        }
    },

    initDingQue: function initDingQue() {
        var arr = ["tong", "tiao", "wan"];
        var data = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < data.length; ++i) {
            var que = data[i].dingque;
            if (que == null || que < 0 || que >= arr.length) {
                que = null;
            } else {
                que = arr[que];
            }

            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            if (que) {
                this.dingques[localIndex].getChildByName(que).active = true;
            }
        }
    },

    reset: function reset() {
        this.setInteractable(true);

        this.selected.push(this.queYiMen.getChildByName("tong_selected"));
        this.selected.push(this.queYiMen.getChildByName("tiao_selected"));
        this.selected.push(this.queYiMen.getChildByName("wan_selected"));
        for (var i = 0; i < this.selected.length; ++i) {
            this.selected[i].active = false;
        }

        for (var i = 0; i < this.dingques.length; ++i) {
            for (var j = 0; j < this.dingques[i].children.length; ++j) {
                this.dingques[i].children[j].active = false;
            }
        }
    },

    onQueYiMenClicked: function onQueYiMenClicked(event) {
        var type = 0;
        if (event.target.name == "tong") {
            type = 0;
        } else if (event.target.name == "tiao") {
            type = 1;
        } else if (event.target.name == "wan") {
            type = 2;
        }

        for (var i = 0; i < this.selected.length; ++i) {
            this.selected[i].active = false;
        }
        this.selected[type].active = true;
        cc.vv.gameNetMgr.dingque = type;
        cc.vv.net.send("dingque", type);

        //this.setInteractable(false);
    },

    setInteractable: function setInteractable(value) {
        this.queYiMen.getChildByName("tong").getComponent(cc.Button).interactable = value;
        this.queYiMen.getChildByName("tiao").getComponent(cc.Button).interactable = value;
        this.queYiMen.getChildByName("wan").getComponent(cc.Button).interactable = value;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"Folds":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0bf63eiZEFMWbW03o8heqa5', 'Folds');
// scripts/components/Folds.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _folds: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this.initView();
        this.initEventHandler();

        this.initAllFolds();
    },

    initView: function initView() {
        this._folds = {};
        var game = this.node.getChildByName("game");
        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var sideName = sides[i];
            var sideRoot = game.getChildByName(sideName);
            var folds = [];
            var foldRoot = sideRoot.getChildByName("folds");
            for (var j = 0; j < foldRoot.children.length; ++j) {
                var n = foldRoot.children[j];
                n.active = false;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = null;
                folds.push(sprite);
            }
            this._folds[sideName] = folds;
        }

        this.hideAllFolds();
    },

    hideAllFolds: function hideAllFolds() {
        for (var k in this._folds) {
            var f = this._folds[i];
            for (var i in f) {
                f[i].node.active = false;
            }
        }
    },

    initEventHandler: function initEventHandler() {
        var self = this;
        this.node.on('game_begin', function (data) {
            self.initAllFolds();
        });

        this.node.on('game_sync', function (data) {
            self.initAllFolds();
        });

        this.node.on('game_chupai_notify', function (data) {
            self.initFolds(data.detail);
        });

        this.node.on('guo_notify', function (data) {
            self.initFolds(data.detail);
        });
    },

    initAllFolds: function initAllFolds() {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            this.initFolds(seats[i]);
        }
    },

    initFolds: function initFolds(seatData) {
        var folds = seatData.folds;
        if (folds == null) {
            return;
        }
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatData.seatindex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);

        var foldsSprites = this._folds[side];
        for (var i = 0; i < foldsSprites.length; ++i) {
            var index = i;
            if (side == "right" || side == "up") {
                index = foldsSprites.length - i - 1;
            }
            var sprite = foldsSprites[index];
            sprite.node.active = true;
            this.setSpriteFrameByMJID(pre, sprite, folds[i]);
        }
        for (var i = folds.length; i < foldsSprites.length; ++i) {
            var index = i;
            if (side == "right" || side == "up") {
                index = foldsSprites.length - i - 1;
            }
            var sprite = foldsSprites[index];

            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
    },

    setSpriteFrameByMJID: function setSpriteFrameByMJID(pre, sprite, mjid) {
        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
        sprite.node.active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"GameNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9545659TARKZLMoHGqXoY2N', 'GameNetMgr');
// scripts/GameNetMgr.js

cc.Class({
    "extends": cc.Component,

    properties: {
        dataEventHandler: null,
        roomId: null,
        maxNumOfGames: -1,
        numOfGames: -1,
        numOfMJ: 0,
        seatIndex: -1,
        seats: null,
        turn: -1,
        button: -1,
        dingque: -1,
        chupai: -1,
        isDingQueing: false,
        isHuanSanZhang: false,
        gamestate: "",
        isOver: false,
        dissoveData: null,

        //舟山麻将额外属性
        fengxiang: null

    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    reset: function reset() {
        this.turn = -1;
        this.chupai = -1, this.dingque = -1;
        this.button = -1;
        this.gamestate = "";
        this.dingque = -1;
        this.isDingQueing = false;
        this.isHuanSanZhang = false;
        this.curaction = null;
        for (var i = 0; i < this.seats.length; ++i) {
            this.seats[i].holds = [];
            this.seats[i].folds = [];
            this.seats[i].pengs = [];
            this.seats[i].chis = [];
            this.seats[i].huas = [];
            this.seats[i].angangs = [];
            this.seats[i].diangangs = [];
            this.seats[i].wangangs = [];
            this.seats[i].dingque = -1;
            this.seats[i].ready = false;
            this.seats[i].hued = false;
            this.seats[i].huanpais = null;
            this.huanpaimethod = -1;
        }
    },

    clear: function clear() {
        this.dataEventHandler = null;
        if (this.isOver == null) {
            this.seats = null;
            this.roomId = null;
            this.maxNumOfGames = 0;
            this.numOfGames = 0;
        }
    },

    dispatchEvent: function dispatchEvent(event, data) {
        if (this.dataEventHandler) {
            this.dataEventHandler.emit(event, data);
        }
    },

    getSeatIndexByID: function getSeatIndexByID(userId) {
        for (var i = 0; i < this.seats.length; ++i) {
            var s = this.seats[i];
            if (s.userid == userId) {
                return i;
            }
        }
        return -1;
    },

    isOwner: function isOwner() {
        return this.seatIndex == 0;
    },

    getSeatByID: function getSeatByID(userId) {
        var seatIndex = this.getSeatIndexByID(userId);
        var seat = this.seats[seatIndex];
        return seat;
    },

    getSelfData: function getSelfData() {
        return this.seats[this.seatIndex];
    },

    getLocalIndex: function getLocalIndex(index) {
        var ret = (index - this.seatIndex + 4) % 4;
        return ret;
    },

    prepareReplay: function prepareReplay(roomInfo, detailOfGame) {
        this.roomId = roomInfo.id;
        this.seats = roomInfo.seats;
        this.turn = detailOfGame.base_info.button;
        var baseInfo = detailOfGame.base_info;
        for (var i = 0; i < this.seats.length; ++i) {
            var s = this.seats[i];
            s.seatindex = i;
            s.score = null;
            s.holds = baseInfo.game_seats[i];
            s.pengs = [];
            s.chis = [];
            s.huas = [];
            s.angangs = [];
            s.diangangs = [];
            s.wangangs = [];
            s.folds = [];
            console.log(s);
            if (cc.vv.userMgr.userId == s.userid) {
                this.seatIndex = i;
            }
        }
        this.conf = {
            type: baseInfo.type
        };
        if (this.conf.type == null) {
            this.conf.type == "sjmmmj";
        }
    },

    getWanfa: function getWanfa() {
        var conf = this.conf;
        if (conf && conf.maxGames != null && conf.maxFan != null) {
            var strArr = [];
            // strArr.push(conf.maxGames + "局");
            // strArr.push(conf.maxFan + "番封顶");
            if (conf.type == "sjmmj") {
                conf.koufei == 0 ? strArr.push("房主出资") : strArr.push("玩家平分");
                conf.hongzhongdanghua ? strArr.push("红中当花") : {};
                conf.quanshu == 0 ? strArr.push("8局") : strArr.push("一圈");
                if (conf.jiesuan == 0) strArr.push("幺半");else if (conf.jiesuan == 1) strArr.push("一二");else if (conf.jiesuan == 2) strArr.push("二四");
            } else if (conf.type == "dhmj") {
                conf.koufei == 0 ? strArr.push("房主出资") : strArr.push("玩家平分");
                conf.quanshu == 0 ? strArr.push("8局") : strArr.push("一圈");
                if (conf.jiesuan == 0) strArr.push("10");else if (conf.jiesuan == 1) strArr.push("25");else if (conf.jiesuan == 2) strArr.push("50");else if (conf.jiesuan == 3) strArr.push("120");
            } else if (conf.type == "tdh") {
                conf.koufei == 0 ? strArr.push("房主出资") : strArr.push("玩家平分");
                conf.quanshu == 0 ? strArr.push("8局") : strArr.push("一圈");
                if (conf.jiesuan == 0) strArr.push("有花");
            }
            // if(conf.zimo == 1){
            //     strArr.push("自摸加番");
            // }
            // else{
            //     strArr.push("自摸加底");
            // }
            // if(conf.jiangdui){
            //     strArr.push("将对");  
            // }
            // if(conf.dianganghua == 1){
            //     strArr.push("点杠花(自摸)");  
            // }
            // else{
            //     strArr.push("点杠花(放炮)");
            // }
            // if(conf.menqing){
            //     strArr.push("门清、中张");  
            // }
            // if(conf.tiandihu){
            //     strArr.push("天地胡");  
            // }
            return strArr.join(" ");
        }
        return "";
    },

    initHandlers: function initHandlers() {
        var self = this;
        cc.vv.net.addHandler("login_result", function (data) {
            console.log("login_result");
            console.log(data);
            if (data.errcode === 0) {
                var data = data.data;
                self.roomId = data.roomid;
                self.conf = data.conf;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.fengxiang = data.fengxiang;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
            } else {
                console.log(data.errmsg);
            }
        });

        cc.vv.net.addHandler("login_finished", function (data) {
            console.log("login_finished");

            var loadgame = function loadgame() {
                cc.director.loadScene("mjgame");
            };
            var fadeout = cc.fadeOut(0.1);
            var finish = cc.callFunc(loadgame, this);
            var seq = cc.sequence(fadeout, finish);
            cc.director.getScene().getChildByName('Canvas').runAction(seq);

            //cc.director.loadScene("mjgame");
        });

        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.dingque = -1;
            self.isDingQueing = false;
            self.seats = null;
        });

        cc.vv.net.addHandler("exit_notify_push", function (data) {
            var userId = data;
            var s = self.getSeatByID(userId);
            if (s != null) {
                s.userid = 0;
                s.name = "";
                self.dispatchEvent("user_state_changed", s);
            }
        });

        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.dingque = -1;
            self.isDingQueing = false;
            self.seats = null;
        });

        cc.vv.net.addHandler("disconnect", function (data) {
            if (self.roomId == null) {
                cc.director.loadScene("hall");
            } else {
                if (self.isOver == false) {
                    cc.vv.userMgr.oldRoomId = self.roomId;
                    self.dispatchEvent("disconnect");
                } else {
                    self.roomId = null;
                }
            }
        });

        cc.vv.net.addHandler("new_user_comes_push", function (data) {
            //console.log(data);
            var seatIndex = data.seatindex;
            if (self.seats[seatIndex].userid > 0) {
                self.seats[seatIndex].online = true;
            } else {
                data.online = true;
                self.seats[seatIndex] = data;
            }
            self.dispatchEvent('new_user', self.seats[seatIndex]);
        });

        cc.vv.net.addHandler("user_state_push", function (data) {
            //console.log(data);
            var userId = data.userid;
            var seat = self.getSeatByID(userId);
            seat.online = data.online;
            self.dispatchEvent('user_state_changed', seat);
        });

        cc.vv.net.addHandler("user_ready_push", function (data) {
            //console.log(data);
            var userId = data.userid;
            var seat = self.getSeatByID(userId);
            seat.ready = data.ready;
            self.dispatchEvent('user_state_changed', seat);
        });

        cc.vv.net.addHandler("game_holds_push", function (data) {
            var seat = self.seats[self.seatIndex];
            console.log(data);
            seat.holds = data;

            for (var i = 0; i < self.seats.length; ++i) {
                var s = self.seats[i];
                if (s.folds == null) {
                    s.folds = [];
                }
                if (s.pengs == null) {
                    s.pengs = [];
                }
                if (s.angangs == null) {
                    s.angangs = [];
                }
                if (s.diangangs == null) {
                    s.diangangs = [];
                }
                if (s.chis == null) {
                    s.chis = [];
                }
                if (s.huas == null) {
                    s.huas = [];
                }
                if (s.wangangs == null) {
                    s.wangangs = [];
                }
                s.ready = false;
            }
            self.dispatchEvent('game_holds');
        });

        cc.vv.net.addHandler("game_feng_push", function (data) {
            self.fengxiang = data;
            self.dispatchEvent('game_feng');
        });

        cc.vv.net.addHandler("game_begin_push", function (data) {
            console.log('game_action_push');
            console.log(data);
            self.button = data;
            self.turn = self.button;
            self.gamestate = "begin";
            self.dispatchEvent('game_begin');
        });

        cc.vv.net.addHandler("game_playing_push", function (data) {
            console.log('game_playing_push');
            self.gamestate = "playing";
            self.dispatchEvent('game_playing');
        });

        cc.vv.net.addHandler("game_sync_push", function (data) {
            console.log("game_sync_push");
            console.log(data);
            self.numOfMJ = data.numofmj;
            self.gamestate = data.state;
            self.fengxiang = data.fengxiang;
            if (self.gamestate == "dingque") {
                self.isDingQueing = true;
            } else if (self.gamestate == "huanpai") {
                self.isHuanSanZhang = true;
            }
            self.turn = data.turn;
            self.button = data.button;
            self.chupai = data.chuPai;
            self.huanpaimethod = data.huanpaimethod;
            for (var i = 0; i < 4; ++i) {
                var seat = self.seats[i];
                var sd = data.seats[i];
                seat.holds = sd.holds;
                seat.folds = sd.folds;
                seat.angangs = sd.angangs;
                seat.diangangs = sd.diangangs;
                seat.wangangs = sd.wangangs;
                seat.pengs = sd.pengs;
                seat.chis = sd.chis;
                seat.huas = sd.huas;
                seat.dingque = sd.que;
                seat.hued = sd.hued;
                seat.iszimo = sd.iszimo;
                seat.huinfo = sd.huinfo;
                seat.huanpais = sd.huanpais;
                if (i == self.seatIndex) {
                    self.dingque = sd.que;
                }
            }
        });

        cc.vv.net.addHandler("game_huanpai_push", function (data) {
            self.isHuanSanZhang = true;
            self.dispatchEvent('game_huanpai');
        });

        cc.vv.net.addHandler("hangang_notify_push", function (data) {
            self.dispatchEvent('hangang_notify', data);
        });

        cc.vv.net.addHandler("game_action_push", function (data) {
            self.curaction = data;
            console.log(data);
            self.dispatchEvent('game_action', data);
        });

        cc.vv.net.addHandler("game_chupai_push", function (data) {
            console.log('game_chupai_push');
            //console.log(data);
            var turnUserID = data;
            var si = self.getSeatIndexByID(turnUserID);
            self.doTurnChange(si);
        });

        cc.vv.net.addHandler("game_num_push", function (data) {
            self.numOfGames = data;
            self.dispatchEvent('game_num', data);
        });

        cc.vv.net.addHandler("game_over_push", function (data) {
            console.log('game_over_push');
            console.log(data);
            var results = data.results;
            for (var i = 0; i < self.seats.length; ++i) {
                self.seats[i].score = results.length == 0 ? 0 : results[i].totalscore;
            }
            self.dispatchEvent('game_over', results);
            if (data.endinfo) {
                self.isOver = true;
                self.dispatchEvent('game_end', data.endinfo);
            }
            self.reset();
            for (var i = 0; i < self.seats.length; ++i) {
                self.dispatchEvent('user_state_changed', self.seats[i]);
            }
        });

        cc.vv.net.addHandler("mj_count_push", function (data) {
            console.log('mj_count_push');
            self.numOfMJ = data;
            //console.log(data);
            self.dispatchEvent('mj_count', data);
        });

        cc.vv.net.addHandler("hu_push", function (data) {
            console.log('hu_push');
            console.log(data);
            self.doHu(data);
        });

        cc.vv.net.addHandler("game_chupai_notify_push", function (data) {
            var userId = data.userId;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doChupai(si, pai);
        });

        cc.vv.net.addHandler("game_mopai_push", function (data) {
            console.log('game_mopai_push');
            self.doMopai(self.seatIndex, data);
        });

        cc.vv.net.addHandler("guo_notify_push", function (data) {
            console.log('guo_notify_push');
            var userId = data.userId;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doGuo(si, pai);
        });

        cc.vv.net.addHandler("guo_result", function (data) {
            console.log('guo_result');
            self.dispatchEvent('guo_result');
        });

        cc.vv.net.addHandler("guohu_push", function (data) {
            console.log('guohu_push');
            self.dispatchEvent("push_notice", { info: "过胡", time: 1.5 });
        });

        cc.vv.net.addHandler("huanpai_notify", function (data) {
            var seat = self.getSeatByID(data.si);
            seat.huanpais = data.huanpais;
            self.dispatchEvent('huanpai_notify', seat);
        });

        cc.vv.net.addHandler("game_huanpai_over_push", function (data) {
            console.log('game_huanpai_over_push');
            var info = "";
            var method = data.method;
            if (method == 0) {
                info = "换对家牌";
            } else if (method == 1) {
                info = "换下家牌";
            } else {
                info = "换上家牌";
            }
            self.huanpaimethod = method;
            cc.vv.gameNetMgr.isHuanSanZhang = false;
            self.dispatchEvent("game_huanpai_over");
            self.dispatchEvent("push_notice", { info: info, time: 2 });
        });

        cc.vv.net.addHandler("peng_notify_push", function (data) {
            console.log('peng_notify_push');
            console.log(data);
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doPeng(si, data.pai);
        });

        cc.vv.net.addHandler("gang_notify_push", function (data) {
            console.log('gang_notify_push');
            console.log(data);
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doGang(si, pai, data.gangtype);
        });

        cc.vv.net.addHandler("chi_notify_push", function (data) {
            console.log('chi_notify_push');
            console.log(data);
            var userId = data.userid;
            var pai = data.pai;
            var chigroup = data.chigroup;
            var si = self.getSeatIndexByID(userId);
            self.doChi(si, data.pai, chigroup);
        });

        cc.vv.net.addHandler("gethua_notify_push", function (data) {
            console.log('gethua_notify_push');
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doHua(si, data.pai);
        });

        //开局补花侦听 全局
        cc.vv.net.addHandler("buhua_notify_push", function (data) {
            console.log('buhua_notify_push');
            var userId = data.userid;
            var buhuas = data.buhuas;
            var si = self.getSeatIndexByID(userId);
            self.doBuhua(si, buhuas);
        });

        //开局补花侦听 自己
        cc.vv.net.addHandler("game_buhua_push", function (data) {
            console.log('game_buhua_push');
            var userId = data.userid;
            var holds = data.holds;
            var buhuas = data.buhuas;
            var si = self.getSeatIndexByID(userId);
            self.doBuhuaforme(si, holds, buhuas);
        });

        cc.vv.net.addHandler("game_dingque_notify_push", function (data) {
            self.dispatchEvent('game_dingque_notify', data);
        });

        cc.vv.net.addHandler("game_dingque_finish_push", function (data) {
            for (var i = 0; i < data.length; ++i) {
                self.seats[i].dingque = data[i];
            }
            self.dispatchEvent('game_dingque_finish', data);
        });

        cc.vv.net.addHandler("chat_push", function (data) {
            self.dispatchEvent("chat_push", data);
        });

        cc.vv.net.addHandler("quick_chat_push", function (data) {
            self.dispatchEvent("quick_chat_push", data);
        });

        cc.vv.net.addHandler("emoji_push", function (data) {
            self.dispatchEvent("emoji_push", data);
        });

        cc.vv.net.addHandler("dissolve_notice_push", function (data) {
            console.log("dissolve_notice_push");
            console.log(data);
            self.dissoveData = data;
            self.dispatchEvent("dissolve_notice", data);
        });

        cc.vv.net.addHandler("dissolve_cancel_push", function (data) {
            self.dissoveData = null;
            self.dispatchEvent("dissolve_cancel", data);
        });

        cc.vv.net.addHandler("voice_msg_push", function (data) {
            self.dispatchEvent("voice_msg", data);
        });
    },

    doGuo: function doGuo(seatIndex, pai) {
        var seatData = this.seats[seatIndex];
        var folds = seatData.folds;
        folds.push(pai);
        this.dispatchEvent('guo_notify', seatData);
    },

    doMopai: function doMopai(seatIndex, pai) {
        var seatData = this.seats[seatIndex];
        if (seatData.holds) {
            seatData.holds.push(pai);
            this.dispatchEvent('game_mopai', { seatIndex: seatIndex, pai: pai });
        }
    },

    doChupai: function doChupai(seatIndex, pai) {
        this.chupai = pai;
        var seatData = this.seats[seatIndex];
        if (seatData.holds) {
            var idx = seatData.holds.indexOf(pai);
            seatData.holds.splice(idx, 1);
        }
        this.dispatchEvent('game_chupai_notify', { seatData: seatData, pai: pai });
    },

    doPeng: function doPeng(seatIndex, pai) {
        console.log(seatIndex);
        var seatData = this.seats[seatIndex];
        console.log(this.seats[seatIndex]);
        console.log(this.seats[0]);
        console.log(this.seats["0"]);
        console.log(seatData);
        console.log(seatData.huas);
        console.log(seatData.userid);
        //移除手牌
        if (seatData.holds) {
            for (var i = 0; i < 2; ++i) {
                var idx = seatData.holds.indexOf(pai);
                seatData.holds.splice(idx, 1);
            }
        }

        //更新碰牌数据
        var pengs = seatData.pengs;
        pengs.push(pai);

        this.dispatchEvent('peng_notify', seatData);
    },

    doChi: function doChi(seatIndex, pai, chigroup) {
        console.log("dochi");
        var seatData = this.seats[seatIndex];
        console.log(seatData);
        //移除手牌
        if (seatData.holds) {
            for (var i = 0; i < 3; ++i) {
                if (pai == chigroup[i]) continue;
                var idx = seatData.holds.indexOf(chigroup[i]);
                seatData.holds.splice(idx, 1);
            }
        }

        //更新吃牌数据
        var chis = seatData.chis;
        chis.push(chigroup);

        this.dispatchEvent('chi_notify', seatData);
    },

    doHua: function doHua(seatIndex, pai) {
        var seatData = this.seats[seatIndex];
        //更新花牌数据
        if (seatData.huas == undefined || seatData.huas == null) {
            seatData.huas = [];
        }
        var huas = seatData.huas;
        huas.push(pai);
        this.dispatchEvent('gethua_notify', seatData);
    },

    doBuhua: function doBuhua(seatIndex, buhuas) {
        console.log("da buhua");
        var seatData = this.seats[seatIndex];
        //更新花牌数据
        if (seatData.huas == undefined || seatData.huas == null) {
            seatData.huas = [];
        }
        var huas = seatData.huas;
        for (var i = 0; i < buhuas.length; i++) {
            huas.push(buhuas[i]);
        }
        this.dispatchEvent('gethua_notify', seatData);
    },

    doBuhuaforme: function doBuhuaforme(seatIndex, holds, buhuas) {
        console.log("da buhua");
        var seatData = this.seats[seatIndex];
        // for(var i=0 ; i < holds.length ; i++) {
        //     seatData.holds.push(holds[i]);
        // }
        // for(var i=0 ; i < buhuas.length ; i++) {
        //     var idx = seatData.holds.indexOf(buhuas[i]);
        //     seatData.holds.splice(idx,1);
        // }
        seatData.holds = holds;
        this.dispatchEvent('buhua_notify', seatData);
    },

    getGangType: function getGangType(seatData, pai) {
        if (seatData.pengs.indexOf(pai) != -1) {
            return "wangang";
        } else {
            var cnt = 0;
            for (var i = 0; i < seatData.holds.length; ++i) {
                if (seatData.holds[i] == pai) {
                    cnt++;
                }
            }
            if (cnt == 3) {
                return "diangang";
            } else {
                return "angang";
            }
        }
    },

    doGang: function doGang(seatIndex, pai, gangtype) {
        var seatData = this.seats[seatIndex];

        if (!gangtype) {
            gangtype = this.getGangType(seatData, pai);
        }

        if (gangtype == "wangang") {
            if (seatData.pengs.indexOf(pai) != -1) {
                var idx = seatData.pengs.indexOf(pai);
                if (idx != -1) {
                    seatData.pengs.splice(idx, 1);
                }
            }
            seatData.wangangs.push(pai);
        }
        if (seatData.holds) {
            for (var i = 0; i <= 4; ++i) {
                var idx = seatData.holds.indexOf(pai);
                if (idx == -1) {
                    //如果没有找到，表示移完了，直接跳出循环
                    break;
                }
                seatData.holds.splice(idx, 1);
            }
        }
        if (gangtype == "angang") {
            seatData.angangs.push(pai);
        } else if (gangtype == "diangang") {
            seatData.diangangs.push(pai);
        }
        this.dispatchEvent('gang_notify', { seatData: seatData, gangtype: gangtype });
    },

    doHu: function doHu(data) {
        this.dispatchEvent('hupai', data);
    },

    doTurnChange: function doTurnChange(si) {
        var data = {
            last: this.turn,
            turn: si
        };
        this.turn = si;
        this.dispatchEvent('game_chupai', data);
    },

    connectGameServer: function connectGameServer(data) {
        this.dissoveData = null;
        cc.vv.net.ip = data.ip + ":" + data.port;
        console.log(cc.vv.net.ip);
        var self = this;

        var onConnectOK = function onConnectOK() {
            console.log("onConnectOK");
            var sd = {
                token: data.token,
                roomid: data.roomid,
                time: data.time,
                sign: data.sign
            };
            cc.vv.net.send("login", sd);
        };

        var onConnectFailed = function onConnectFailed() {
            console.log("failed.");
            cc.vv.wc.hide();
        };
        cc.vv.wc.show("正在进入房间");
        cc.vv.net.connect(onConnectOK, onConnectFailed);
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"GameOver":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'facfdljnx5F+rFDAq5Qbmqa', 'GameOver');
// scripts/components/GameOver.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _gameover: null,
        _gameresult: null,
        _seats: [],
        _isGameEnd: false,
        _pingju: null,
        _win: null,
        _lose: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        if (cc.vv.gameNetMgr.conf == null) {
            return;
        }
        //TODO:可能出现不同的计分板
        this._gameover = this.node.getChildByName("game_over_" + cc.vv.gameNetMgr.conf.type);

        for (var n = 0; n < 4; n++) {
            var hua_node = this._gameover.getChildByName("result_list").getChildByName("s" + (n + 1)).getChildByName("huas");
            for (var m = 0; m < hua_node.childrenCount; m++) {
                hua_node.children[m].active = false;
            }
        }

        this._gameover.active = false;

        this._pingju = this._gameover.getChildByName("pingju");
        this._win = this._gameover.getChildByName("win");
        this._lose = this._gameover.getChildByName("lose");

        this._gameresult = this.node.getChildByName("game_result");

        var wanfa = this._gameover.getChildByName("wanfa").getComponent(cc.Label);
        wanfa.string = cc.vv.gameNetMgr.getWanfa();

        var listRoot = this._gameover.getChildByName("result_list");
        for (var i = 1; i <= 4; ++i) {
            var s = "s" + i;
            var sn = listRoot.getChildByName(s);
            //整理所有需要显示在计分板上的信息的节点
            var viewdata = {};
            viewdata.username = sn.getChildByName('username').getComponent(cc.Label);
            viewdata.reason = sn.getChildByName('reason').getComponent(cc.Label);
            viewdata.taisi = sn.getChildByName('taisi').getComponent(cc.Label);

            var f = sn.getChildByName('fan');
            if (f != null) {
                viewdata.fan = f.getComponent(cc.Label);
            }

            viewdata.score = sn.getChildByName('score').getComponent(cc.Label);
            viewdata.hu = sn.getChildByName('hu');
            viewdata.mahjongs = sn.getChildByName('pai');
            viewdata.zhuang = sn.getChildByName('zhuang');
            viewdata.hupai = sn.getChildByName('hupai');
            viewdata._pengandgang = [];

            this._seats.push(viewdata);
        }

        //初始化网络事件监听器
        var self = this;
        this.node.on('game_over', function (data) {
            self.onGameOver(data.detail);
        });

        this.node.on('game_end', function (data) {
            self._isGameEnd = true;
        });
    },

    onGameOver: function onGameOver(data) {
        //TODO:多种判定
        if (cc.vv.gameNetMgr.conf.type == "sjmmj") {
            this.onGameOver_SJMMJ(data);
        } else if (cc.vv.gameNetMgr.conf.type == "dhmj") {
            this.onGameOver_DHMJ(data);
        } else if (cc.vv.gameNetMgr.conf.type == "tdh") {
            this.onGameOver_TDH(data);
        }
    },

    onGameOver_SJMMJ: function onGameOver_SJMMJ(data) {
        console.log(data);
        if (data.length == 0) {
            this._gameresult.active = true;
            return;
        }
        this._gameover.active = true;
        this._pingju.active = false;
        this._win.active = false;
        this._lose.active = false;

        var myscore = data[cc.vv.gameNetMgr.seatIndex].score;
        if (myscore > 0) {
            this._win.active = true;
        } else if (myscore < 0) {
            this._lose.active = true;
        } else {
            this._pingju.active = true;
        }

        //显示玩家信息
        for (var i = 0; i < 4; ++i) {
            var seatView = this._seats[i];
            var userData = data[i];
            var hued = false;
            //胡牌的玩家才显示 是否清一色 根xn的字样
            var numOfGangs = userData.angangs.length + userData.wangangs.length + userData.diangangs.length;
            var numOfGen = userData.numofgen;
            var actionArr = [];
            var is7pairs = false;
            var ischadajiao = false;
            for (var j = 0; j < userData.actions.length; ++j) {
                var ac = userData.actions[j];
                if (ac.type == "zimo" || ac.type == "ganghua" || ac.type == "dianganghua" || ac.type == "hu" || ac.type == "gangpaohu" || ac.type == "qiangganghu" || ac.type == "chadajiao") {
                    if (userData.pattern == "7pairs") {
                        actionArr.push("七对");
                    } else if (userData.pattern == "l7pairs") {
                        actionArr.push("龙七对");
                    } else if (userData.pattern == "j7pairs") {
                        actionArr.push("将七对");
                    } else if (userData.pattern == "duidui") {
                        actionArr.push("碰碰胡");
                    } else if (userData.pattern == "jiangdui") {
                        actionArr.push("将对");
                    }

                    if (ac.type == "zimo") {
                        actionArr.push("自摸");
                    } else if (ac.type == "ganghua") {
                        actionArr.push("杠上花");
                    } else if (ac.type == "dianganghua") {
                        actionArr.push("点杠花");
                    } else if (ac.type == "gangpaohu") {
                        actionArr.push("杠炮胡");
                    } else if (ac.type == "qiangganghu") {
                        actionArr.push("抢杠胡");
                    } else if (ac.type == "chadajiao") {
                        ischadajiao = true;
                    }
                    hued = true;
                } else if (ac.type == "fangpao") {
                    actionArr.push("放炮");
                } else if (ac.type == "angang") {
                    actionArr.push("暗杠");
                } else if (ac.type == "diangang") {
                    actionArr.push("明杠");
                } else if (ac.type == "wangang") {
                    actionArr.push("弯杠");
                } else if (ac.type == "fanggang") {
                    actionArr.push("放杠");
                } else if (ac.type == "zhuanshougang") {
                    actionArr.push("转手杠");
                } else if (ac.type == "beiqianggang") {
                    actionArr.push("被抢杠");
                } else if (ac.type == "beichadajiao") {
                    actionArr.push("被查叫");
                }
            }

            if (hued) {
                if (userData.qingyise) {
                    actionArr.push("清一色");
                }

                if (userData.menqing) {
                    actionArr.push("门清");
                }

                if (userData.zhongzhang) {
                    actionArr.push("中张");
                }

                if (userData.jingouhu) {
                    actionArr.push("金钩胡");
                }

                if (userData.haidihu) {
                    actionArr.push("海底胡");
                }

                if (userData.tianhu) {
                    actionArr.push("天胡");
                }

                if (userData.dihu) {
                    actionArr.push("地胡");
                }

                if (numOfGen > 0) {
                    actionArr.push("根x" + numOfGen);
                }

                if (ischadajiao) {
                    actionArr.push("查大叫");
                }

                if (userData.hunyise) {
                    actionArr.push("混一色");
                }

                if (userData.duiduihu) {
                    actionArr.push("对对胡");
                }

                if (userData.paihu) {
                    actionArr.push("排胡");
                }

                if (userData.gangshanghua) {
                    actionArr.push("杠上花");
                }

                if (userData.kan) {
                    actionArr.push("坎档");
                }

                if (userData.bian) {
                    actionArr.push("边档");
                }

                if (userData.dan) {
                    actionArr.push("单吊");
                }

                if (userData.duidao) {
                    actionArr.push("对倒");
                }
            }

            for (var o = 0; o < 3; ++o) {
                seatView.hu.children[o].active = false;
            }
            if (userData.huorder >= 0) {
                seatView.hu.children[userData.huorder].active = true;
            }

            seatView.username.string = cc.vv.gameNetMgr.seats[i].name;
            seatView.zhuang.active = cc.vv.gameNetMgr.button == i;
            seatView.reason.string = actionArr.join("、");

            //显示丝数台数
            console.log("显示台和丝");
            console.log(userData.tai);
            console.log(userData.si);
            console.log(seatView.taisi.string);
            seatView.taisi.string = userData.tai + "台" + userData.si + "丝";

            //显示胡数
            var fan = 0;
            fan = userData.fan;
            seatView.fan.string = fan + "胡";

            //
            if (userData.score > 0) {
                seatView.score.string = "+" + userData.score;
            } else {
                seatView.score.string = userData.score;
            }

            var hupai = -1;
            if (hued) {
                hupai = userData.holds.pop();
            }

            cc.vv.mahjongmgr.sortMJ(userData.holds, userData.dingque);

            //胡牌不参与排序
            if (hued) {
                userData.holds.push(hupai);
            }

            //隐藏所有牌
            for (var k = 0; k < seatView.mahjongs.childrenCount; ++k) {
                var n = seatView.mahjongs.children[k];
                n.active = false;
            }

            var lackingNum = (userData.pengs.length + numOfGangs + userData.chis.length) * 3;
            //显示相关的牌
            for (var k = 0; k < userData.holds.length; ++k) {
                var pai = userData.holds[k];
                var n = seatView.mahjongs.children[k + lackingNum];
                n.active = true;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            }

            for (var k = 0; k < seatView._pengandgang.length; ++k) {
                seatView._pengandgang[k].active = false;
            }

            //初始化杠牌
            var index = 0;
            var gangs = userData.angangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "angang");
                index++;
            }

            var gangs = userData.diangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "diangang");
                index++;
            }

            var gangs = userData.wangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "wangang");
                index++;
            }

            //初始化碰牌
            var pengs = userData.pengs;
            if (pengs) {
                for (var k = 0; k < pengs.length; ++k) {
                    var mjid = pengs[k];
                    this.initPengAndGangs(seatView, index, mjid, "peng");
                    index++;
                }
            }

            //初始化吃牌
            var chis = userData.chis;
            if (chis) {
                for (var k = 0; k < chis.length; ++k) {
                    var mjid = chis[k];
                    this.initPengAndGangs(seatView, index, mjid, "chi");
                    index++;
                }
            }

            //初始化花牌 TODO:和下面一样写初始化函数 并且要首先隐藏所有的花

            var huas = userData.huas;
            var hua_node = this._gameover.getChildByName("result_list").getChildByName("s" + (i + 1)).getChildByName("huas");
            for (var k = 0; k < hua_node.childrenCount; ++k) {
                hua_node.children[k].active = false;
            }
            if (huas) {
                for (var k = 0; k < huas.length; ++k) {
                    var mjid = huas[k];
                    hua_node.children[k].active = true;
                    var sp = hua_node.children[k].getComponent(cc.Sprite);
                    sp.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", mjid);
                }
            }

            //东南西北小旗子转换
            var switchFengFlag = function switchFengFlag(direction, dir_str) {
                for (var k = 0; k < 4; k++) {
                    direction.children[k].active = false;
                }
                direction.getChildByName(dir_str).active = true;
            };

            //显示当前风圈和局数
            var numofgames = this._gameover.getChildByName("numofgames");
            var fengquan = "东风圈";
            switch (cc.vv.gameNetMgr.fengxiang) {
                case 0:
                    fengquan = "东风圈";break;
                case 1:
                    fengquan = "南风圈";break;
                case 2:
                    fengquan = "西风圈";break;
                case 3:
                    fengquan = "北风圈";break;
            }
            numofgames.getComponent(cc.Label).string = fengquan;

            //判断东南西北
            if (userData.button) {
                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + (i % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "dong");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 1) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "nan");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 2) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "xi");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 3) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "bei");
            }
        }
    },
    onGameOver_DHMJ: function onGameOver_DHMJ(data) {
        console.log(data);
        if (data.length == 0) {
            this._gameresult.active = true;
            return;
        }
        this._gameover.active = true;
        this._pingju.active = false;
        this._win.active = false;
        this._lose.active = false;

        var myscore = data[cc.vv.gameNetMgr.seatIndex].score;
        if (myscore > 0) {
            this._win.active = true;
        } else if (myscore < 0) {
            this._lose.active = true;
        } else {
            this._pingju.active = true;
        }

        //显示玩家信息
        for (var i = 0; i < 4; ++i) {
            var seatView = this._seats[i];
            var userData = data[i];
            var hued = false;
            //胡牌的玩家才显示 是否清一色 根xn的字样
            var numOfGangs = userData.angangs.length + userData.wangangs.length + userData.diangangs.length;
            var numOfGen = userData.numofgen;
            var actionArr = [];
            var is7pairs = false;
            var ischadajiao = false;
            for (var j = 0; j < userData.actions.length; ++j) {
                var ac = userData.actions[j];
                if (ac.type == "zimo" || ac.type == "ganghua" || ac.type == "dianganghua" || ac.type == "hu" || ac.type == "gangpaohu" || ac.type == "qiangganghu" || ac.type == "chadajiao") {
                    if (userData.pattern == "7pairs") {
                        actionArr.push("七对");
                    } else if (userData.pattern == "l7pairs") {
                        actionArr.push("龙七对");
                    } else if (userData.pattern == "j7pairs") {
                        actionArr.push("将七对");
                    } else if (userData.pattern == "duidui") {
                        actionArr.push("碰碰胡");
                    } else if (userData.pattern == "jiangdui") {
                        actionArr.push("将对");
                    }

                    if (ac.type == "zimo") {
                        actionArr.push("自摸");
                    } else if (ac.type == "ganghua") {
                        actionArr.push("杠上花");
                    } else if (ac.type == "dianganghua") {
                        actionArr.push("点杠花");
                    } else if (ac.type == "gangpaohu") {
                        actionArr.push("杠炮胡");
                    } else if (ac.type == "qiangganghu") {
                        actionArr.push("抢杠胡");
                    } else if (ac.type == "chadajiao") {
                        ischadajiao = true;
                    }
                    hued = true;
                } else if (ac.type == "fangpao") {
                    actionArr.push("放炮");
                } else if (ac.type == "angang") {
                    actionArr.push("暗杠");
                } else if (ac.type == "diangang") {
                    actionArr.push("明杠");
                } else if (ac.type == "wangang") {
                    actionArr.push("弯杠");
                } else if (ac.type == "fanggang") {
                    actionArr.push("放杠");
                } else if (ac.type == "zhuanshougang") {
                    actionArr.push("转手杠");
                } else if (ac.type == "beiqianggang") {
                    actionArr.push("被抢杠");
                } else if (ac.type == "beichadajiao") {
                    actionArr.push("被查叫");
                } else if (ac.type == "sanchisanpeng0") {
                    actionArr.push("三吃三碰东");
                } else if (ac.type == "sanchisanpeng1") {
                    actionArr.push("三吃三碰南");
                } else if (ac.type == "sanchisanpeng2") {
                    actionArr.push("三吃三碰西");
                } else if (ac.type == "sanchisanpeng3") {
                    actionArr.push("三吃三碰北");
                }
            }

            if (hued) {
                if (userData.qingyise) {
                    actionArr.push("清一色");
                }

                if (userData.menqing) {
                    actionArr.push("门清");
                }

                if (userData.zhongzhang) {
                    actionArr.push("中张");
                }

                if (userData.jingouhu) {
                    actionArr.push("金钩胡");
                }

                if (userData.haidihu) {
                    actionArr.push("海底胡");
                }

                if (userData.tianhu) {
                    actionArr.push("天胡");
                }

                if (userData.dihu) {
                    actionArr.push("地胡");
                }

                if (numOfGen > 0) {
                    actionArr.push("根x" + numOfGen);
                }

                if (ischadajiao) {
                    actionArr.push("查大叫");
                }

                if (userData.hunyise) {
                    actionArr.push("混一色");
                }

                if (userData.duiduihu) {
                    actionArr.push("对对胡");
                }

                if (userData.paihu) {
                    actionArr.push("排胡");
                }

                if (userData.gangshanghua) {
                    actionArr.push("杠上花");
                }

                if (userData.kan) {
                    actionArr.push("坎档");
                }

                if (userData.bian) {
                    actionArr.push("边档");
                }

                if (userData.dan) {
                    actionArr.push("单吊");
                }

                if (userData.duidao) {
                    actionArr.push("对倒");
                }
            }

            for (var o = 0; o < 3; ++o) {
                seatView.hu.children[o].active = false;
            }
            if (userData.huorder >= 0) {
                seatView.hu.children[userData.huorder].active = true;
            }

            seatView.username.string = cc.vv.gameNetMgr.seats[i].name;
            seatView.zhuang.active = cc.vv.gameNetMgr.button == i;
            seatView.reason.string = actionArr.join("、");

            //显示丝数台数
            if (userData.tai == -1) seatView.taisi.string = "";else seatView.taisi.string = userData.tai + "台";

            //
            if (userData.score > 0) {
                seatView.score.string = "+" + userData.score;
            } else {
                seatView.score.string = userData.score;
            }

            var hupai = -1;
            if (hued) {
                hupai = userData.holds.pop();
            }

            cc.vv.mahjongmgr.sortMJ(userData.holds, userData.dingque);

            //胡牌不参与排序
            if (hued) {
                userData.holds.push(hupai);
            }

            //隐藏所有牌
            for (var k = 0; k < seatView.mahjongs.childrenCount; ++k) {
                var n = seatView.mahjongs.children[k];
                n.active = false;
            }

            var lackingNum = (userData.pengs.length + numOfGangs + userData.chis.length) * 3;
            //显示相关的牌
            for (var k = 0; k < userData.holds.length; ++k) {
                var pai = userData.holds[k];
                var n = seatView.mahjongs.children[k + lackingNum];
                n.active = true;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            }

            for (var k = 0; k < seatView._pengandgang.length; ++k) {
                seatView._pengandgang[k].active = false;
            }

            //初始化杠牌
            var index = 0;
            var gangs = userData.angangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "angang");
                index++;
            }

            var gangs = userData.diangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "diangang");
                index++;
            }

            var gangs = userData.wangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "wangang");
                index++;
            }

            //初始化碰牌
            var pengs = userData.pengs;
            if (pengs) {
                for (var k = 0; k < pengs.length; ++k) {
                    var mjid = pengs[k];
                    this.initPengAndGangs(seatView, index, mjid, "peng");
                    index++;
                }
            }

            //初始化吃牌
            var chis = userData.chis;
            if (chis) {
                for (var k = 0; k < chis.length; ++k) {
                    var mjid = chis[k];
                    this.initPengAndGangs(seatView, index, mjid, "chi");
                    index++;
                }
            }

            //初始化花牌 TODO:和下面一样写初始化函数 并且要首先隐藏所有的花

            var huas = userData.huas;
            var hua_node = this._gameover.getChildByName("result_list").getChildByName("s" + (i + 1)).getChildByName("huas");
            for (var k = 0; k < hua_node.childrenCount; ++k) {
                hua_node.children[k].active = false;
            }
            if (huas) {
                for (var k = 0; k < huas.length; ++k) {
                    var mjid = huas[k];
                    hua_node.children[k].active = true;
                    var sp = hua_node.children[k].getComponent(cc.Sprite);
                    sp.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", mjid);
                }
            }

            //东南西北小旗子转换
            var switchFengFlag = function switchFengFlag(direction, dir_str) {
                for (var k = 0; k < 4; k++) {
                    direction.children[k].active = false;
                }
                direction.getChildByName(dir_str).active = true;
            };

            //显示当前风圈和局数
            var numofgames = this._gameover.getChildByName("numofgames");
            var fengquan = "东风圈";
            switch (cc.vv.gameNetMgr.fengxiang) {
                case 0:
                    fengquan = "东风圈";break;
                case 1:
                    fengquan = "南风圈";break;
                case 2:
                    fengquan = "西风圈";break;
                case 3:
                    fengquan = "北风圈";break;
            }
            numofgames.getComponent(cc.Label).string = fengquan;

            //判断东南西北
            if (userData.button) {
                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + (i % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "dong");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 1) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "nan");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 2) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "xi");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 3) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "bei");
            }
        }
    },
    onGameOver_TDH: function onGameOver_TDH(data) {
        console.log(data);
        if (data.length == 0) {
            this._gameresult.active = true;
            return;
        }
        this._gameover.active = true;
        this._pingju.active = false;
        this._win.active = false;
        this._lose.active = false;

        var myscore = data[cc.vv.gameNetMgr.seatIndex].score;
        if (myscore > 0) {
            this._win.active = true;
        } else if (myscore < 0) {
            this._lose.active = true;
        } else {
            this._pingju.active = true;
        }

        //显示玩家信息
        for (var i = 0; i < 4; ++i) {
            var seatView = this._seats[i];
            var userData = data[i];
            var hued = false;
            //胡牌的玩家才显示 是否清一色 根xn的字样
            var numOfGangs = userData.angangs.length + userData.wangangs.length + userData.diangangs.length;
            var numOfGen = userData.numofgen;
            var actionArr = [];
            var is7pairs = false;
            var ischadajiao = false;
            for (var j = 0; j < userData.actions.length; ++j) {
                var ac = userData.actions[j];
                if (ac.type == "zimo" || ac.type == "ganghua" || ac.type == "dianganghua" || ac.type == "hu" || ac.type == "gangpaohu" || ac.type == "qiangganghu" || ac.type == "chadajiao") {
                    if (userData.pattern == "7pairs") {
                        actionArr.push("七对");
                    } else if (userData.pattern == "l7pairs") {
                        actionArr.push("龙七对");
                    } else if (userData.pattern == "j7pairs") {
                        actionArr.push("将七对");
                    } else if (userData.pattern == "duidui") {
                        actionArr.push("碰碰胡");
                    } else if (userData.pattern == "jiangdui") {
                        actionArr.push("将对");
                    }

                    if (ac.type == "zimo") {
                        actionArr.push("自摸");
                    } else if (ac.type == "ganghua") {
                        actionArr.push("杠上花");
                    } else if (ac.type == "dianganghua") {
                        actionArr.push("点杠花");
                    } else if (ac.type == "gangpaohu") {
                        actionArr.push("杠炮胡");
                    } else if (ac.type == "qiangganghu") {
                        actionArr.push("抢杠胡");
                    } else if (ac.type == "chadajiao") {
                        ischadajiao = true;
                    }
                    hued = true;
                } else if (ac.type == "fangpao") {
                    actionArr.push("放炮");
                } else if (ac.type == "angang") {
                    actionArr.push("暗杠");
                } else if (ac.type == "diangang") {
                    actionArr.push("明杠");
                } else if (ac.type == "wangang") {
                    actionArr.push("弯杠");
                } else if (ac.type == "fanggang") {
                    actionArr.push("放杠");
                } else if (ac.type == "zhuanshougang") {
                    actionArr.push("转手杠");
                } else if (ac.type == "beiqianggang") {
                    actionArr.push("被抢杠");
                } else if (ac.type == "beichadajiao") {
                    actionArr.push("被查叫");
                }
            }

            if (hued) {
                if (userData.qingyise) {
                    actionArr.push("清一色");
                }

                if (userData.menqing) {
                    actionArr.push("门清");
                }

                if (userData.zhongzhang) {
                    actionArr.push("中张");
                }

                if (userData.jingouhu) {
                    actionArr.push("金钩胡");
                }

                if (userData.haidihu) {
                    actionArr.push("海底胡");
                }

                if (userData.tianhu) {
                    actionArr.push("天胡");
                }

                if (userData.dihu) {
                    actionArr.push("地胡");
                }

                if (numOfGen > 0) {
                    actionArr.push("根x" + numOfGen);
                }

                if (ischadajiao) {
                    actionArr.push("查大叫");
                }

                if (userData.hunyise) {
                    actionArr.push("混一色");
                }

                if (userData.duiduihu) {
                    actionArr.push("对对胡");
                }

                if (userData.paihu) {
                    actionArr.push("排胡");
                }

                if (userData.gangshanghua) {
                    actionArr.push("杠上花");
                }

                if (userData.kan) {
                    actionArr.push("坎档");
                }

                if (userData.bian) {
                    actionArr.push("边档");
                }

                if (userData.dan) {
                    actionArr.push("单吊");
                }

                if (userData.duidao) {
                    actionArr.push("对倒");
                }
            }

            for (var o = 0; o < 3; ++o) {
                seatView.hu.children[o].active = false;
            }
            if (userData.huorder >= 0) {
                seatView.hu.children[userData.huorder].active = true;
            }

            seatView.username.string = cc.vv.gameNetMgr.seats[i].name;
            seatView.zhuang.active = cc.vv.gameNetMgr.button == i;
            seatView.reason.string = actionArr.join("、");

            //显示丝数台数
            seatView.taisi.string = "";

            //
            if (userData.score > 0) {
                seatView.score.string = "+" + userData.score;
            } else {
                seatView.score.string = userData.score;
            }

            var hupai = -1;
            if (hued) {
                hupai = userData.holds.pop();
            }

            cc.vv.mahjongmgr.sortMJ(userData.holds, userData.dingque);

            //胡牌不参与排序
            if (hued) {
                userData.holds.push(hupai);
            }

            //隐藏所有牌
            for (var k = 0; k < seatView.mahjongs.childrenCount; ++k) {
                var n = seatView.mahjongs.children[k];
                n.active = false;
            }

            var lackingNum = (userData.pengs.length + numOfGangs + userData.chis.length) * 3;
            //显示相关的牌
            for (var k = 0; k < userData.holds.length; ++k) {
                var pai = userData.holds[k];
                var n = seatView.mahjongs.children[k + lackingNum];
                n.active = true;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            }

            for (var k = 0; k < seatView._pengandgang.length; ++k) {
                seatView._pengandgang[k].active = false;
            }

            //初始化杠牌
            var index = 0;
            var gangs = userData.angangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "angang");
                index++;
            }

            var gangs = userData.diangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "diangang");
                index++;
            }

            var gangs = userData.wangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "wangang");
                index++;
            }

            //初始化碰牌
            var pengs = userData.pengs;
            if (pengs) {
                for (var k = 0; k < pengs.length; ++k) {
                    var mjid = pengs[k];
                    this.initPengAndGangs(seatView, index, mjid, "peng");
                    index++;
                }
            }

            //初始化吃牌
            var chis = userData.chis;
            if (chis) {
                for (var k = 0; k < chis.length; ++k) {
                    var mjid = chis[k];
                    this.initPengAndGangs(seatView, index, mjid, "chi");
                    index++;
                }
            }

            //初始化花牌 TODO:和下面一样写初始化函数 并且要首先隐藏所有的花

            var huas = userData.huas;
            var hua_node = this._gameover.getChildByName("result_list").getChildByName("s" + (i + 1)).getChildByName("huas");
            for (var k = 0; k < hua_node.childrenCount; ++k) {
                hua_node.children[k].active = false;
            }
            if (huas) {
                for (var k = 0; k < huas.length; ++k) {
                    var mjid = huas[k];
                    hua_node.children[k].active = true;
                    var sp = hua_node.children[k].getComponent(cc.Sprite);
                    sp.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", mjid);
                }
            }

            //东南西北小旗子转换
            var switchFengFlag = function switchFengFlag(direction, dir_str) {
                for (var k = 0; k < 4; k++) {
                    direction.children[k].active = false;
                }
                direction.getChildByName(dir_str).active = true;
            };

            //显示当前风圈和局数
            var numofgames = this._gameover.getChildByName("numofgames");
            var fengquan = "东风圈";
            switch (cc.vv.gameNetMgr.fengxiang) {
                case 0:
                    fengquan = "东风圈";break;
                case 1:
                    fengquan = "南风圈";break;
                case 2:
                    fengquan = "西风圈";break;
                case 3:
                    fengquan = "北风圈";break;
            }
            numofgames.getComponent(cc.Label).string = fengquan;

            //判断东南西北
            if (userData.button) {
                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + (i % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "dong");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 1) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "nan");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 2) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "xi");

                var direction = this._gameover.getChildByName("result_list").getChildByName("s" + ((i + 3) % 4 + 1)).getChildByName("direction");
                switchFengFlag(direction, "bei");
            }
        }
    },

    initPengAndGangs: function initPengAndGangs(seatView, index, mjid, flag) {
        var pgroot = null;
        if (seatView._pengandgang.length <= index) {
            pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabSelf);
            seatView._pengandgang.push(pgroot);
            seatView.mahjongs.addChild(pgroot);
        } else {
            pgroot = seatView._pengandgang[index];
            pgroot.active = true;
        }

        var sprites = pgroot.getComponentsInChildren(cc.Sprite);
        for (var s = 0; s < sprites.length; ++s) {
            var sprite = sprites[s];
            if (sprite.node.name == "gang") {
                var isGang = flag != "peng";
                sprite.node.active = isGang;
                sprite.node.scaleX = 1.0;
                sprite.node.scaleY = 1.0;
                if (flag == "angang") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame("myself");
                    sprite.node.scaleX = 1.4;
                    sprite.node.scaleY = 1.4;
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid);
                }
            } else {
                if (flag == "peng") sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid);else if (flag == "chi") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid[s]);
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid);
                }
            }
        }
        pgroot.x = index * 55 * 3 + index * 10;
    },

    onBtnReadyClicked: function onBtnReadyClicked() {
        console.log("onBtnReadyClicked");
        if (this._isGameEnd) {
            this._gameresult.active = true;
        } else {
            cc.vv.net.send('ready');
        }
        this._gameover.active = false;
    },

    onBtnShareClicked: function onBtnShareClicked() {
        console.log("onBtnShareClicked");
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2b08d8pm0VBDLYlZIdfLuPS', 'GameResult');
// scripts/components/GameResult.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _gameresult: null,
        _seats: []
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this._gameresult = this.node.getChildByName("game_result");
        //this._gameresult.active = false;

        var seats = this._gameresult.getChildByName("seats");
        for (var i = 0; i < seats.children.length; ++i) {
            this._seats.push(seats.children[i].getComponent("Seat"));
        }

        var btnClose = cc.find("Canvas/game_result/btnClose");
        if (btnClose) {
            cc.vv.utils.addClickEvent(btnClose, this.node, "GameResult", "onBtnCloseClicked");
        }

        var btnShare = cc.find("Canvas/game_result/btnShare");
        if (btnShare) {
            cc.vv.utils.addClickEvent(btnShare, this.node, "GameResult", "onBtnShareClicked");
        }

        //初始化网络事件监听器
        var self = this;
        this.node.on('game_end', function (data) {
            self.onGameEnd(data.detail);
        });
    },

    showResult: function showResult(seat, info, isZuiJiaPaoShou) {
        seat.node.getChildByName("zuijiapaoshou").active = isZuiJiaPaoShou;

        seat.node.getChildByName("zimocishu").getComponent(cc.Label).string = info.numzimo;
        seat.node.getChildByName("jiepaocishu").getComponent(cc.Label).string = info.numjiepao;
        seat.node.getChildByName("dianpaocishu").getComponent(cc.Label).string = info.numdianpao;
        seat.node.getChildByName("angangcishu").getComponent(cc.Label).string = info.numangang;
        seat.node.getChildByName("minggangcishu").getComponent(cc.Label).string = info.numminggang;
        //seat.node.getChildByName("chajiaocishu").getComponent(cc.Label).string = info.numchadajiao;
    },

    onGameEnd: function onGameEnd(endinfo) {
        var seats = cc.vv.gameNetMgr.seats;
        var maxscore = -1;
        var maxdianpao = 0;
        var dianpaogaoshou = -1;
        for (var i = 0; i < seats.length; ++i) {
            var seat = seats[i];
            if (seat.score > maxscore) {
                maxscore = seat.score;
            }
            if (endinfo[i].numdianpao > maxdianpao) {
                maxdianpao = endinfo[i].numdianpao;
                dianpaogaoshou = i;
            }
        }

        for (var i = 0; i < seats.length; ++i) {
            var seat = seats[i];
            var isBigwin = false;
            if (seat.score > 0) {
                isBigwin = seat.score == maxscore;
            }
            this._seats[i].setInfo(seat.name, seat.score, isBigwin);
            this._seats[i].setID(seat.userid);
            var isZuiJiaPaoShou = dianpaogaoshou == i;
            this.showResult(this._seats[i], endinfo[i], isZuiJiaPaoShou);
        }
    },

    onBtnCloseClicked: function onBtnCloseClicked() {
        cc.director.loadScene("hall");
    },

    onBtnShareClicked: function onBtnShareClicked() {
        cc.vv.anysdkMgr.shareResult();
    }
});

cc._RFpop();
},{}],"Global":[function(require,module,exports){
"use strict";
cc._RFpush(module, '24e30ZJLgdH3rs1R1CvqN8U', 'Global');
// scripts/Global.js

var Global = cc.Class({
    "extends": cc.Component,
    statics: {
        isstarted: false,
        netinited: false,
        userguid: 0,
        nickname: "",
        money: 0,
        lv: 0,
        roomId: 0
    }
});

cc._RFpop();
},{}],"HTTP":[function(require,module,exports){
"use strict";
cc._RFpush(module, '90ae61J525JQIt5taF3Nce2', 'HTTP');
// scripts/HTTP.js

//local

//var URL = "http://192.168.1.121:9000";
//DEV SERVER
//var URL = "http://139.219.224.143:9000";
//FORMAL SERVER
var URL = "http://119.23.250.115:9000";

cc.VERSION = 20161227;
var HTTP = cc.Class({
    "extends": cc.Component,

    statics: {
        sessionId: 0,
        userId: 0,
        master_url: URL,
        url: URL,
        sendRequest: function sendRequest(path, data, handler, extraUrl) {
            var xhr = cc.loader.getXMLHttpRequest();
            xhr.timeout = 5000;
            var str = "?";
            for (var k in data) {
                if (str != "?") {
                    str += "&";
                }
                str += k + "=" + data[k];
            }
            if (extraUrl == null) {
                extraUrl = HTTP.url;
            }
            var requestURL = extraUrl + path + encodeURI(str);
            console.log("RequestURL:" + requestURL);
            xhr.open("GET", requestURL, true);
            if (cc.sys.isNative) {
                xhr.setRequestHeader("Accept-Encoding", "gzip,deflate", "text/html;charset=UTF-8");
            }

            xhr.onreadystatechange = function () {
                console.log(xhr);
                if (xhr.readyState === 4 && xhr.status >= 200 && xhr.status < 300) {
                    console.log("http res(" + xhr.responseText.length + "):" + xhr.responseText);
                    try {
                        var ret = JSON.parse(xhr.responseText);
                        if (handler !== null) {
                            handler(ret);
                        } /* code */
                    } catch (e) {
                        console.log("err:" + e);
                        //handler(null);
                    } finally {
                        if (cc.vv && cc.vv.wc) {
                            //       cc.vv.wc.hide();   
                        }
                    }
                } else {
                        console.log("status=" + xhr.readyState);
                        //self.url = "http://139.219.224.143:9000";
                        //HTTP.url = "http://139.219.224.143:9000";
                    }
            };

            if (cc.vv && cc.vv.wc) {
                //cc.vv.wc.show();
            }
            xhr.send();
            return xhr;
        }
    }
});

cc._RFpop();
},{}],"Hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6edb3jjx+FBepS1mk1xKDF2', 'Hall');
// scripts/components/Hall.js

var Net = require("Net");
var Global = require("Global");
cc.Class({
    "extends": cc.Component,

    properties: {
        lblName: cc.Label,
        lblMoney: cc.Label,
        lblGems: cc.Label,
        lblID: cc.Label,
        lblNotice: cc.Label,
        joinGameWin: cc.Node,
        createRoomWin: cc.Node,
        settingsWin: cc.Node,
        helpWin: cc.Node,
        xiaoxiWin: cc.Node,
        btnJoinGame: cc.Node,
        btnReturnGame: cc.Node,
        sprHeadImg: cc.Sprite
    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    initNetHandlers: function initNetHandlers() {
        var self = this;
    },

    onShare: function onShare() {
        cc.vv.anysdkMgr.share("舟山麻将", "舟山麻将，包含了沈家门麻将、定海麻将、推到胡等多种舟山流行麻将玩法。");
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        if (!cc.vv) {
            cc.director.loadScene("loading");
            return;
        }
        this.initLabels();

        if (cc.vv.gameNetMgr.roomId == null) {
            this.btnJoinGame.active = true;
            this.btnReturnGame.active = false;
        } else {
            this.btnJoinGame.active = false;
            this.btnReturnGame.active = true;
        }

        //var params = cc.vv.args;
        var roomId = cc.vv.userMgr.oldRoomId;
        if (roomId != null) {
            cc.vv.userMgr.oldRoomId = null;
            cc.vv.userMgr.enterRoom(roomId);
        }

        var imgLoader = this.sprHeadImg.node.getComponent("ImageLoader");
        imgLoader.setUserID(cc.vv.userMgr.userId);
        cc.vv.utils.addClickEvent(this.sprHeadImg.node, this.node, "Hall", "onBtnClicked");

        this.addComponent("UserInfoShow");

        this.initButtonHandler("Canvas/right_bottom/btn_shezhi");
        this.initButtonHandler("Canvas/right_bottom/btn_help");
        this.initButtonHandler("Canvas/right_bottom/btn_xiaoxi");
        this.helpWin.addComponent("OnBack");
        this.xiaoxiWin.addComponent("OnBack");

        if (!cc.vv.userMgr.notice) {
            cc.vv.userMgr.notice = {
                version: null,
                msg: "数据请求中..."
            };
        }

        if (!cc.vv.userMgr.gemstip) {
            cc.vv.userMgr.gemstip = {
                version: null,
                msg: "数据请求中..."
            };
        }

        this.lblNotice.string = cc.vv.userMgr.notice.msg;

        this.refreshInfo();
        this.refreshNotice();
        this.refreshGemsTip();

        cc.vv.audioMgr.playBGM("bgMain.mp3");

        //预加载麻将游戏界面
        cc.director.preloadScene('mjgame', function () {
            cc.log('preload mjgame complete!!!');
        });

        var youkeorweixin = cc.sys.localStorage.getItem("youkeorweixin");
        if (cc.sys.os == cc.sys.OS_IOS && youkeorweixin == "0") {
            //隐藏显示下边按钮
            cc.find("Canvas/hallBg/fujianmajiang").active = false;
            cc.find("Canvas/hallBg/anhuimajiang").active = false;
            cc.find("Canvas/hallBg/qiqibuyu").active = false;
            cc.find("Canvas/hallBg/qiqipuke").active = false;
            cc.find("Canvas/hallBg/more").active = false;
            cc.find("Canvas/hallBg/xixia001").active = false;
            cc.find("Canvas/top_left/headinfo/bg").active = false;
            cc.find("Canvas/top_left/headinfo/gems").active = false;
            cc.find("Canvas/top_left/headinfo/btn_add_gems").active = false;
            cc.find("Canvas/top_left/headinfo/lblGems").active = false;
            cc.find("Canvas/right_bottom/btn_zhanji").active = false;
            cc.find("Canvas/right_bottom/btn_share").active = false;
        }
    },

    refreshInfo: function refreshInfo() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                if (ret.gems != null) {
                    this.lblGems.string = ret.gems;
                }
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_status", data, onGet.bind(this));
    },

    refreshGemsTip: function refreshGemsTip() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                cc.vv.userMgr.gemstip.version = ret.version;
                cc.vv.userMgr.gemstip.msg = ret.msg.replace("<newline>", "\n");
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "fkgm",
            version: cc.vv.userMgr.gemstip.version
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },

    refreshNotice: function refreshNotice() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                cc.vv.userMgr.notice.version = ret.version;
                cc.vv.userMgr.notice.msg = ret.msg;
                this.lblNotice.string = ret.msg;
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "notice",
            version: cc.vv.userMgr.notice.version
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },

    initButtonHandler: function initButtonHandler(btnPath) {
        var btn = cc.find(btnPath);
        cc.vv.utils.addClickEvent(btn, this.node, "Hall", "onBtnClicked");
    },

    initLabels: function initLabels() {
        this.lblName.string = cc.vv.userMgr.userName;
        this.lblMoney.string = cc.vv.userMgr.coins;
        this.lblGems.string = cc.vv.userMgr.gems;
        this.lblID.string = "ID:" + cc.vv.userMgr.userId;
    },

    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_shezhi") {
            this.settingsWin.active = true;
        } else if (event.target.name == "btn_help") {
            this.helpWin.active = true;
        } else if (event.target.name == "btn_xiaoxi") {
            this.xiaoxiWin.active = true;
        } else if (event.target.name == "head") {
            cc.vv.userinfoShow.show(cc.vv.userMgr.userName, cc.vv.userMgr.userId, this.sprHeadImg, cc.vv.userMgr.sex, cc.vv.userMgr.ip);
        }
    },

    onJoinGameClicked: function onJoinGameClicked() {
        this.joinGameWin.active = true;
    },

    onReturnGameClicked: function onReturnGameClicked() {
        var loadgame = function loadgame() {
            cc.director.loadScene("mjgame");
        };
        var fadeout = cc.fadeOut(0.1);
        var finish = cc.callFunc(loadgame, this);
        var seq = cc.sequence(fadeout, finish);
        this.node.runAction(seq);
    },

    onBtnAddGemsClicked: function onBtnAddGemsClicked() {
        cc.vv.alert.show("提示", cc.vv.userMgr.gemstip.msg);
        this.refreshInfo();
    },

    onCreateRoomClicked: function onCreateRoomClicked() {
        if (cc.vv.gameNetMgr.roomId != null) {
            cc.vv.alert.show("提示", "房间已经创建!\n必须解散当前房间才能创建新的房间");
            return;
        }
        console.log("onCreateRoomClicked");
        this.createRoomWin.active = true;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        var x = this.lblNotice.node.x;
        x -= dt * 100;
        if (x + this.lblNotice.node.width < -1000) {
            x = 500;
        }
        this.lblNotice.node.x = x;

        if (cc.vv && cc.vv.userMgr.roomData != null) {
            cc.vv.userMgr.enterRoom(cc.vv.userMgr.roomData);
            cc.vv.userMgr.roomData = null;
        }
    }
});

cc._RFpop();
},{"Global":"Global","Net":"Net"}],"History":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '4d7bci0LUxMT6MJKXJDj89w', 'History');
// scripts/components/History.js

cc.Class({
    "extends": cc.Component,

    properties: {
        HistoryItemPrefab: {
            "default": null,
            type: cc.Prefab
        },
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _history: null,
        _viewlist: null,
        _content: null,
        _viewitemTemp: null,
        _historyData: null,
        _curRoomInfo: null,
        _emptyTip: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._history = this.node.getChildByName("history");
        this._history.active = false;

        this._emptyTip = this._history.getChildByName("emptyTip");
        this._emptyTip.active = true;

        this._viewlist = this._history.getChildByName("viewlist");
        this._content = cc.find("view/content", this._viewlist);

        this._viewitemTemp = this._content.children[0];
        this._content.removeChild(this._viewitemTemp);

        var node = cc.find("Canvas/right_bottom/btn_zhanji");
        this.addClickEvent(node, this.node, "History", "onBtnHistoryClicked");

        var node = cc.find("Canvas/history/btn_back");
        this.addClickEvent(node, this.node, "History", "onBtnBackClicked");
    },

    addClickEvent: function addClickEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;

        var clickEvents = node.getComponent(cc.Button).clickEvents;
        clickEvents.push(eventHandler);
    },

    onBtnBackClicked: function onBtnBackClicked() {
        if (this._curRoomInfo == null) {
            this._historyData = null;
            this._history.active = false;
        } else {
            this.initRoomHistoryList(this._historyData);
        }
    },

    onBtnHistoryClicked: function onBtnHistoryClicked() {
        this._history.active = true;
        var self = this;
        cc.vv.userMgr.getHistoryList(function (data) {
            data.sort(function (a, b) {
                return a.time < b.time;
            });
            self._historyData = data;
            for (var i = 0; i < data.length; ++i) {
                for (var j = 0; j < 4; ++j) {
                    var s = data[i].seats[j];
                    s.name = new Buffer(s.name, 'base64').toString();
                }
            }
            self.initRoomHistoryList(data);
        });
    },

    dateFormat: function dateFormat(time) {
        var date = new Date(time);
        var datetime = "{0}-{1}-{2} {3}:{4}:{5}";
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        month = month >= 10 ? month : "0" + month;
        var day = date.getDate();
        day = day >= 10 ? day : "0" + day;
        var h = date.getHours();
        h = h >= 10 ? h : "0" + h;
        var m = date.getMinutes();
        m = m >= 10 ? m : "0" + m;
        var s = date.getSeconds();
        s = s >= 10 ? s : "0" + s;
        datetime = datetime.format(year, month, day, h, m, s);
        return datetime;
    },

    initRoomHistoryList: function initRoomHistoryList(data) {
        console.log("initRoomHistoryList");
        for (var i = 0; i < data.length; ++i) {
            var node = this.getViewItem(i);
            node.idx = i;
            var titleId = "" + (i + 1);
            node.getChildByName("title").getComponent(cc.Label).string = titleId;
            node.getChildByName("roomNo").getComponent(cc.Label).string = "房间ID:" + data[i].id;
            var datetime = this.dateFormat(data[i].time * 1000);
            node.getChildByName("time").getComponent(cc.Label).string = datetime;

            console.log(1);

            var btnOp = node.getChildByName("btnOp");
            btnOp.idx = i;
            //btnOp.getChildByName("Label").getComponent(cc.Label).string = "详情";

            console.log(2);

            for (var j = 0; j < 4; ++j) {
                var s = data[i].seats[j];
                var info = s.name + ":" + s.score;
                //console.log(info);
                node.getChildByName("info" + j).getComponent(cc.Label).string = info;
            }

            console.log(3);
        }
        this._emptyTip.active = data.length == 0;
        console.log(this._emptyTip.active);
        this.shrinkContent(data.length);
        this._curRoomInfo = null;
    },

    initGameHistoryList: function initGameHistoryList(roomInfo, data) {
        console.log("initGameHistoryList");
        data.sort(function (a, b) {
            return a.create_time < b.create_time;
        });
        for (var i = 0; i < data.length; ++i) {
            var node = this.getViewItem(i);
            var idx = data.length - i - 1;
            node.idx = idx;
            var titleId = "" + (idx + 1);
            node.getChildByName("title").getComponent(cc.Label).string = titleId;
            node.getChildByName("roomNo").getComponent(cc.Label).string = "房间ID:" + roomInfo.id;
            var datetime = this.dateFormat(data[i].create_time * 1000);
            node.getChildByName("time").getComponent(cc.Label).string = datetime;

            var btnOp = node.getChildByName("btnOp");
            btnOp.idx = idx;
            //btnOp.getChildByName("Label").getComponent(cc.Label).string = "回放";

            var result = JSON.parse(data[i].result);
            for (var j = 0; j < 4; ++j) {
                var s = roomInfo.seats[j];
                var info = s.name + ":" + result[j];
                //console.log(info);
                node.getChildByName("info" + j).getComponent(cc.Label).string = info;
            }
        }
        this.shrinkContent(data.length);
        this._curRoomInfo = roomInfo;
    },

    getViewItem: function getViewItem(index) {
        var content = this._content;
        if (content.childrenCount > index) {
            return content.children[index];
        }
        var node = cc.instantiate(this._viewitemTemp);
        content.addChild(node);
        return node;
    },
    shrinkContent: function shrinkContent(num) {
        while (this._content.childrenCount > num) {
            var lastOne = this._content.children[this._content.childrenCount - 1];
            this._content.removeChild(lastOne, true);
        }
    },

    getGameListOfRoom: function getGameListOfRoom(idx) {
        var self = this;
        var roomInfo = this._historyData[idx];
        cc.vv.userMgr.getGamesOfRoom(roomInfo.uuid, function (data) {
            if (data != null && data.length > 0) {
                self.initGameHistoryList(roomInfo, data);
            }
        });
    },

    getDetailOfGame: function getDetailOfGame(idx) {
        var self = this;
        var roomUUID = this._curRoomInfo.uuid;
        cc.vv.userMgr.getDetailOfGame(roomUUID, idx, function (data) {
            data.base_info = JSON.parse(data.base_info);
            data.action_records = JSON.parse(data.action_records);
            cc.vv.gameNetMgr.prepareReplay(self._curRoomInfo, data);
            cc.vv.replayMgr.init(data);
            cc.director.loadScene("mjgame");
        });
    },

    onViewItemClicked: function onViewItemClicked(event) {
        // var idx = event.target.idx;
        // console.log(idx);
        // if(this._curRoomInfo == null){
        //     this.getGameListOfRoom(idx);
        // }
        // else{
        //     this.getDetailOfGame(idx);     
        // }
    },

    onBtnOpClicked: function onBtnOpClicked(event) {
        // var idx = event.target.parent.idx;
        // console.log(idx);
        // if(this._curRoomInfo == null){
        //     this.getGameListOfRoom(idx);
        // }
        // else{
        //     this.getDetailOfGame(idx);     
        // }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"buffer":2}],"HotUpdate":[function(require,module,exports){
"use strict";
cc._RFpush(module, '17141EodNRM/4IpsE04IyCU', 'HotUpdate');
// scripts/HotUpdate.js

cc.Class({
    "extends": cc.Component,

    properties: {
        updatePanel: {
            "default": null,
            type: cc.Node
        },
        manifestUrl: {
            "default": null,
            url: cc.RawAsset
        },
        percent: {
            "default": null,
            type: cc.Label
        },
        lblErr: {
            "default": null,
            type: cc.Label
        }
    },

    checkCb: function checkCb(event) {
        cc.log('Code: ' + event.getEventCode());
        switch (event.getEventCode()) {
            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:
                cc.log("No local manifest file found, hot update skipped.");
                cc.eventManager.removeListener(this._checkListener);
                break;
            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:
            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:
                cc.log("Fail to download manifest file, hot update skipped.");
                cc.eventManager.removeListener(this._checkListener);
                break;
            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:
                cc.log("Already up to date with the latest remote version.");
                cc.eventManager.removeListener(this._checkListener);
                this.lblErr.string += "游戏不需要更新\n";
                cc.director.loadScene("loading");
                break;
            case jsb.EventAssetsManager.NEW_VERSION_FOUND:
                this._needUpdate = true;
                this.updatePanel.active = true;
                this.percent.string = '00.00%';
                cc.eventManager.removeListener(this._checkListener);
                break;
            default:
                break;
        }
        this.hotUpdate();
    },

    updateCb: function updateCb(event) {
        var needRestart = false;
        var failed = false;
        switch (event.getEventCode()) {
            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:
                cc.log('No local manifest file found, hot update skipped.');
                failed = true;
                break;
            case jsb.EventAssetsManager.UPDATE_PROGRESSION:
                var percent = event.getPercent();
                var percentByFile = event.getPercentByFile();

                var msg = event.getMessage();
                if (msg) {
                    cc.log(msg);
                }
                cc.log(percent.toFixed(2) + '%');
                this.percent.string = percent + '%';
                break;
            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:
            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:
                cc.log('Fail to download manifest file, hot update skipped.');
                failed = true;
                break;
            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:
                cc.log('Already up to date with the latest remote version.');
                failed = true;
                break;
            case jsb.EventAssetsManager.UPDATE_FINISHED:
                cc.log('Update finished. ' + event.getMessage());

                needRestart = true;
                break;
            case jsb.EventAssetsManager.UPDATE_FAILED:
                cc.log('Update failed. ' + event.getMessage());

                this._failCount++;
                if (this._failCount < 5) {
                    this._am.downloadFailedAssets();
                } else {
                    cc.log('Reach maximum fail count, exit update process');
                    this._failCount = 0;
                    failed = true;
                }
                break;
            case jsb.EventAssetsManager.ERROR_UPDATING:
                cc.log('Asset update error: ' + event.getAssetId() + ', ' + event.getMessage());
                break;
            case jsb.EventAssetsManager.ERROR_DECOMPRESS:
                cc.log(event.getMessage());
                break;
            default:
                break;
        }

        if (failed) {
            cc.eventManager.removeListener(this._updateListener);
            this.updatePanel.active = false;
        }

        if (needRestart) {
            cc.eventManager.removeListener(this._updateListener);
            // Prepend the manifest's search path
            var searchPaths = jsb.fileUtils.getSearchPaths();
            var newPaths = this._am.getLocalManifest().getSearchPaths();
            Array.prototype.unshift(searchPaths, newPaths);
            // This value will be retrieved and appended to the default search path during game startup,
            // please refer to samples/js-tests/main.js for detailed usage.
            // !!! Re-add the search paths in main.js is very important, otherwise, new scripts won't take effect.
            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));

            jsb.fileUtils.setSearchPaths(searchPaths);
            this.lblErr.string += "游戏资源更新完毕\n";
            cc.game.restart();
        }
    },

    hotUpdate: function hotUpdate() {
        if (this._am && this._needUpdate) {
            this.lblErr.string += "开始更新游戏资源...\n";
            this._updateListener = new jsb.EventListenerAssetsManager(this._am, this.updateCb.bind(this));
            cc.eventManager.addListener(this._updateListener, 1);

            this._failCount = 0;
            this._am.update();
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        // Hot update is only available in Native build
        if (!cc.sys.isNative) {
            return;
        }
        this.lblErr.string += "检查游戏资源...\n";
        var storagePath = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + 'tiantianqipai-asset';
        cc.log('Storage path for remote asset : ' + storagePath);
        this.lblErr.string += storagePath + "\n";
        cc.log('Local manifest URL : ' + this.manifestUrl);
        this._am = new jsb.AssetsManager(this.manifestUrl, storagePath);
        this._am.retain();

        this._needUpdate = false;
        if (this._am.getLocalManifest().isLoaded()) {
            this._checkListener = new jsb.EventListenerAssetsManager(this._am, this.checkCb.bind(this));
            cc.eventManager.addListener(this._checkListener, 1);

            this._am.checkUpdate();
        }
    },

    onDestroy: function onDestroy() {
        this._am && this._am.release();
    }
});

cc._RFpop();
},{}],"HuanSanZhang":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9a096oAgU5HwrxX05ZPNYtW', 'HuanSanZhang');
// scripts/components/HuanSanZhang.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _huanpaitip: null,
        _huanpaiArr: []
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._huanpaitip = cc.find("Canvas/huansanzhang");
        this._huanpaitip.active = cc.vv.gameNetMgr.isHuanSanZhang;

        if (this._huanpaitip.active) {
            this.showHuanpai(cc.vv.gameNetMgr.getSelfData().huanpais == null);
        }
        this.initHuaipaiInfo();

        var btnOk = cc.find("Canvas/huansanzhang/btn_ok");
        if (btnOk) {
            cc.vv.utils.addClickEvent(btnOk, this.node, "HuanSanZhang", "onHuanSanZhang");
        }

        var self = this;

        this.node.on('game_huanpai', function (data) {
            self._huanpaitip.active = true;
            self.showHuanpai(true);
        });

        this.node.on('huanpai_notify', function (data) {
            if (data.detail.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initHuaipaiInfo();
            }
        });

        this.node.on('game_huanpai_over', function (data) {
            self._huanpaitip.active = false;
            for (var i = 0; i < self._huanpaiArr.length; ++i) {
                self._huanpaiArr[i].y = 0;
            }
            self._huanpaiArr = [];
            self.initHuaipaiInfo();
        });

        this.node.on('game_huanpai_result', function (data) {
            cc.vv.gameNetMgr.isHuanSanZhang = false;
            self._huanpaitip.active = false;
            for (var i = 0; i < self._huanpaiArr.length; ++i) {
                self._huanpaiArr[i].y = 0;
            }
            self._huanpaiArr = [];
        });

        this.node.on('mj_clicked', function (data) {
            var target = data.detail;
            //如果已经点起来，则取消
            var idx = self._huanpaiArr.indexOf(target);
            if (idx != -1) {
                target.y = 0;
                self._huanpaiArr.splice(idx, 1);
            } else {
                //如果是新的，则加入
                if (self._huanpaiArr.length < 3) {
                    self._huanpaiArr.push(target);
                    target.y = 15;
                }
            }
        });
    },

    showHuanpai: function showHuanpai(interactable) {
        this._huanpaitip.getChildByName("info").getComponent(cc.Label).string = "请选择三张一样花色的牌";
        this._huanpaitip.getChildByName("btn_ok").getComponent(cc.Button).interactable = interactable;
        this._huanpaitip.getChildByName("mask").active = false;
    },

    initHuaipaiInfo: function initHuaipaiInfo() {
        var huaipaiinfo = cc.find("Canvas/game/huanpaiinfo");
        var seat = cc.vv.gameNetMgr.getSelfData();
        if (seat.huanpais == null) {
            huaipaiinfo.active = false;
            return;
        }
        huaipaiinfo.active = true;
        for (var i = 0; i < seat.huanpais.length; ++i) {
            huaipaiinfo.getChildByName("hp" + (i + 1)).getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", seat.huanpais[i]);
        }

        var hpm = huaipaiinfo.getChildByName("hpm");
        hpm.active = true;
        if (cc.vv.gameNetMgr.huanpaimethod == 0) {
            hpm.rotation = 90;
        } else if (cc.vv.gameNetMgr.huanpaimethod == 1) {
            hpm.rotation = 0;
        } else if (cc.vv.gameNetMgr.huanpaimethod == 2) {
            hpm.rotation = 180;
        } else {
            hpm.active = false;
        }
    },

    onHuanSanZhang: function onHuanSanZhang(event) {
        if (this._huanpaiArr.length != 3) {
            return;
        }

        var type = null;
        for (var i = 0; i < this._huanpaiArr.length; ++i) {
            var pai = this._huanpaiArr[i].mjId;
            var nt = cc.vv.mahjongmgr.getMahjongType(pai);
            if (type == null) {
                type = nt;
            } else {
                if (type != nt) {
                    return;
                }
            }
        }

        var data = {
            p1: this._huanpaiArr[0].mjId,
            p2: this._huanpaiArr[1].mjId,
            p3: this._huanpaiArr[2].mjId
        };

        this._huanpaitip.getChildByName("info").getComponent(cc.Label).string = "等待其他玩家选牌...";
        this._huanpaitip.getChildByName("btn_ok").getComponent(cc.Button).interactable = false;
        this._huanpaitip.getChildByName("mask").active = true;

        cc.vv.net.send("huanpai", data);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"ImageLoader":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed057Bgp8FHlJbGI+ljAN7d', 'ImageLoader');
// scripts/components/ImageLoader.js

function loadImage(url, code, callback) {
    /*
    if(cc.vv.images == null){
        cc.vv.images = {};
    }
    var imageInfo = cc.vv.images[url];
    if(imageInfo == null){
        imageInfo = {
            image:null,
            queue:[],
        };
        cc.vv.images[url] = imageInfo;
    }
    
    cc.loader.load(url,function (err,tex) {
        imageInfo.image = tex;
        var spriteFrame = new cc.SpriteFrame(tex, cc.Rect(0, 0, tex.width, tex.height));
        for(var i = 0; i < imageInfo.queue.length; ++i){
            var itm = imageInfo.queue[i];
            itm.callback(itm.code,spriteFrame);
        }
        itm.queue = [];
    });
    if(imageInfo.image != null){
        var tex = imageInfo.image;
        var spriteFrame = new cc.SpriteFrame(tex, cc.Rect(0, 0, tex.width, tex.height));
        callback(code,spriteFrame);
    }
    else{
        imageInfo.queue.push({code:code,callback:callback});
    }*/
    cc.loader.load(url, function (err, tex) {
        var spriteFrame = new cc.SpriteFrame(tex, cc.Rect(0, 0, tex.width, tex.height));
        callback(code, spriteFrame);
    });
};

function getBaseInfo(userid, callback) {
    if (cc.vv.baseInfoMap == null) {
        cc.vv.baseInfoMap = {};
    }

    if (cc.vv.baseInfoMap[userid] != null) {
        callback(userid, cc.vv.baseInfoMap[userid]);
    } else {
        cc.vv.http.sendRequest('/base_info', { userid: userid }, function (ret) {
            var url = null;
            if (ret.headimgurl) {
                url = ret.headimgurl + ".jpg";
            }
            var info = {
                name: ret.name,
                sex: ret.sex,
                url: url
            };
            cc.vv.baseInfoMap[userid] = info;
            callback(userid, info);
        }, cc.vv.http.master_url);
    }
};

cc.Class({
    "extends": cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.setupSpriteFrame();
    },

    setUserID: function setUserID(userid) {
        if (cc.sys.isNative == false) {
            return;
        }
        if (!userid) {
            return;
        }
        if (cc.vv.images == null) {
            cc.vv.images = {};
        }

        var self = this;
        getBaseInfo(userid, function (code, info) {
            if (info && info.url) {
                loadImage(info.url, userid, function (err, spriteFrame) {
                    self._spriteFrame = spriteFrame;
                    self.setupSpriteFrame();
                });
            }
        });
    },

    setupSpriteFrame: function setupSpriteFrame() {
        if (this._spriteFrame) {
            var spr = this.getComponent(cc.Sprite);
            if (spr) {
                spr.spriteFrame = this._spriteFrame;
            }
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"JoinGameInput":[function(require,module,exports){
"use strict";
cc._RFpush(module, '10a1c8jz95Ju4NnpkOWUfin', 'JoinGameInput');
// scripts/components/JoinGameInput.js

cc.Class({
    "extends": cc.Component,

    properties: {
        nums: {
            "default": [],
            type: [cc.Label]
        },
        _inputIndex: 0
    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    // use this for initialization
    onLoad: function onLoad() {},

    onEnable: function onEnable() {
        this.onResetClicked();
    },

    onInputFinished: function onInputFinished(roomId) {
        cc.vv.userMgr.enterRoom(roomId, (function (ret) {
            if (ret.errcode == 0) {
                this.node.active = false;
            } else {
                var content = "房间[" + roomId + "]不存在，请重新输入!";
                if (ret.errcode == 4) {
                    content = "房间[" + roomId + "]已满!";
                }
                cc.vv.alert.show("提示", content);
                this.onResetClicked();
            }
        }).bind(this));
    },

    onInput: function onInput(num) {
        if (this._inputIndex >= this.nums.length) {
            return;
        }
        this.nums[this._inputIndex].string = num;
        this._inputIndex += 1;

        if (this._inputIndex == this.nums.length) {
            var roomId = this.parseRoomID();
            console.log("ok:" + roomId);
            this.onInputFinished(roomId);
        }
    },

    onN0Clicked: function onN0Clicked() {
        this.onInput(0);
    },
    onN1Clicked: function onN1Clicked() {
        this.onInput(1);
    },
    onN2Clicked: function onN2Clicked() {
        this.onInput(2);
    },
    onN3Clicked: function onN3Clicked() {
        this.onInput(3);
    },
    onN4Clicked: function onN4Clicked() {
        this.onInput(4);
    },
    onN5Clicked: function onN5Clicked() {
        this.onInput(5);
    },
    onN6Clicked: function onN6Clicked() {
        this.onInput(6);
    },
    onN7Clicked: function onN7Clicked() {
        this.onInput(7);
    },
    onN8Clicked: function onN8Clicked() {
        this.onInput(8);
    },
    onN9Clicked: function onN9Clicked() {
        this.onInput(9);
    },
    onResetClicked: function onResetClicked() {
        for (var i = 0; i < this.nums.length; ++i) {
            this.nums[i].string = "";
        }
        this._inputIndex = 0;
    },
    onDelClicked: function onDelClicked() {
        if (this._inputIndex > 0) {
            this._inputIndex -= 1;
            this.nums[this._inputIndex].string = "";
        }
    },
    onCloseClicked: function onCloseClicked() {
        this.node.active = false;
    },

    parseRoomID: function parseRoomID() {
        var str = "";
        for (var i = 0; i < this.nums.length; ++i) {
            str += this.nums[i].string;
        }
        return str;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"LoadingLogic":[function(require,module,exports){
"use strict";
cc._RFpush(module, '350d3Ry9aVIqJR27fP2H/z1', 'LoadingLogic');
// scripts/components/LoadingLogic.js

cc.Class({
    "extends": cc.Component,

    properties: {
        tipLabel: cc.Label,
        _stateStr: '',
        _progress: 0.0,
        _splash: null,
        _isLoading: false
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        this.initMgr();
        this.tipLabel.string = this._stateStr;

        this._splash = cc.find("Canvas/splash");
        this._splash.active = true;

        cc.vv.http.sendRequest("/mj_login", 1, function (data) {
            cc.sys.localStorage.setItem("youkeorweixin", data.data.youkeorweixin);
        });
        if (cc.sys.localStorage.getItem("youkeorweixin") == "0" && cc.sys.os == cc.sys.OS_IOS) {
            cc.find("Canvas/New Label").active = false;
        }
    },

    start: function start() {
        var self = this;
        var SHOW_TIME = 3000;
        var FADE_TIME = 500;
        if (cc.sys.os != cc.sys.OS_IOS || !cc.sys.isNative) {
            self._splash.active = true;
            var t = Date.now();
            var fn = function fn() {
                var dt = Date.now() - t;
                if (dt < SHOW_TIME) {
                    setTimeout(fn, 33);
                } else {
                    var op = (1 - (dt - SHOW_TIME) / FADE_TIME) * 255;
                    if (op < 0) {
                        self._splash.opacity = 0;
                        self.checkVersion();
                    } else {
                        self._splash.opacity = op;
                        setTimeout(fn, 33);
                    }
                }
            };
            setTimeout(fn, 33);
        } else {
            this._splash.active = false;
            this.checkVersion();
        }
    },

    initMgr: function initMgr() {
        cc.vv = {};
        var UserMgr = require("UserMgr");
        cc.vv.userMgr = new UserMgr();

        var ReplayMgr = require("ReplayMgr");
        cc.vv.replayMgr = new ReplayMgr();

        cc.vv.http = require("HTTP");
        cc.vv.global = require("Global");
        cc.vv.net = require("Net");

        var GameNetMgr = require("GameNetMgr");
        cc.vv.gameNetMgr = new GameNetMgr();
        cc.vv.gameNetMgr.initHandlers();

        var AnysdkMgr = require("AnysdkMgr");
        cc.vv.anysdkMgr = new AnysdkMgr();
        cc.vv.anysdkMgr.init();

        var VoiceMgr = require("VoiceMgr");
        cc.vv.voiceMgr = new VoiceMgr();
        cc.vv.voiceMgr.init();

        var AudioMgr = require("AudioMgr");
        cc.vv.audioMgr = new AudioMgr();
        cc.vv.audioMgr.init();

        var Utils = require("Utils");
        cc.vv.utils = new Utils();

        cc.args = this.urlParse();
    },

    urlParse: function urlParse() {
        var params = {};
        if (window.location == null) {
            return params;
        }
        var name, value;
        var str = window.location.href; //取得整个地址栏
        var num = str.indexOf("?");
        str = str.substr(num + 1); //取得所有参数   stringvar.substr(start [, length ]

        var arr = str.split("&"); //各个参数放到数组里
        for (var i = 0; i < arr.length; i++) {
            num = arr[i].indexOf("=");
            if (num > 0) {
                name = arr[i].substring(0, num);
                value = arr[i].substr(num + 1);
                params[name] = value;
            }
        }
        return params;
    },

    checkVersion: function checkVersion() {
        var self = this;
        var onGetVersion = function onGetVersion(ret) {
            if (ret.version == null) {
                console.log("error.");
            } else {
                cc.vv.SI = ret;
                if (ret.version != cc.VERSION) {
                    cc.find("Canvas/alert").active = true;
                } else {
                    self.startPreloading();
                }
            }
        };

        var xhr = null;
        var complete = false;
        var fnRequest = function fnRequest() {
            self._stateStr = "正在连接服务器";
            xhr = cc.vv.http.sendRequest("/get_serverinfo", null, function (ret) {
                xhr = null;
                complete = true;
                onGetVersion(ret);
            });
            setTimeout(fn, 5000);
        };

        var fn = function fn() {
            if (!complete) {
                if (xhr) {
                    xhr.abort();
                    self._stateStr = "连接失败，即将重试";
                    setTimeout(function () {
                        fnRequest();
                    }, 5000);
                } else {
                    fnRequest();
                }
            }
        };
        fn();
    },

    onBtnDownloadClicked: function onBtnDownloadClicked() {
        cc.sys.openURL(cc.vv.SI.appweb);
    },

    startPreloading: function startPreloading() {
        this._stateStr = "正在加载资源，请稍候";
        this._isLoading = true;
        var self = this;

        cc.loader.onProgress = function (completedCount, totalCount, item) {
            //console.log("completedCount:" + completedCount + ",totalCount:" + totalCount );
            if (self._isLoading) {
                self._progress = completedCount / totalCount;
            }
        };

        cc.loader.loadResAll("textures", function (err, assets) {
            self.onLoadComplete();
        });
    },

    onLoadComplete: function onLoadComplete() {
        this._isLoading = false;
        this._stateStr = "准备登陆";
        cc.director.loadScene("login");
        cc.loader.onComplete = null;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._stateStr.length == 0) {
            return;
        }
        this.tipLabel.string = this._stateStr + ' ';
        if (this._isLoading) {
            this.tipLabel.string += Math.floor(this._progress * 100) + "%";
        } else {
            var t = Math.floor(Date.now() / 1000) % 4;
            for (var i = 0; i < t; ++i) {
                this.tipLabel.string += '.';
            }
        }
    }
});

cc._RFpop();
},{"AnysdkMgr":"AnysdkMgr","AudioMgr":"AudioMgr","GameNetMgr":"GameNetMgr","Global":"Global","HTTP":"HTTP","Net":"Net","ReplayMgr":"ReplayMgr","UserMgr":"UserMgr","Utils":"Utils","VoiceMgr":"VoiceMgr"}],"Login":[function(require,module,exports){
"use strict";
cc._RFpush(module, '572a7Qfh69N9ZLXkNthANfi', 'Login');
// scripts/components/Login.js

String.prototype.format = function (args) {
    if (arguments.length > 0) {
        var result = this;
        if (arguments.length == 1 && typeof args == "object") {
            for (var key in args) {
                var reg = new RegExp("({" + key + "})", "g");
                result = result.replace(reg, args[key]);
            }
        } else {
            for (var i = 0; i < arguments.length; i++) {
                if (arguments[i] == undefined) {
                    return "";
                } else {
                    var reg = new RegExp("({[" + i + "]})", "g");
                    result = result.replace(reg, arguments[i]);
                }
            }
        }
        return result;
    } else {
        return this;
    }
};

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _mima: null,
        _mimaIndex: 0,
        mjdl: 1 },

    //�齫��¼�û�Э�飬ֻ�й�ѡ��ť�ο͵�¼��΢�ŵ�¼�ſ��Խ�ȥ
    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }

        if (!cc.vv) {
            cc.director.loadScene("loading");
            return;
        }
        cc.vv.http.url = cc.vv.http.master_url;
        cc.vv.net.addHandler('push_need_create_role', function () {
            console.log("onLoad:push_need_create_role");
            cc.director.loadScene("createrole");
        });

        cc.vv.audioMgr.playBGM("bgMain.mp3");

        this._mima = ["A", "A", "B", "B", "A", "B", "A", "B", "A", "A", "A", "B", "B", "B"];

        if (!cc.sys.isNative || cc.sys.os == cc.sys.OS_WINDOWS) {
            cc.find("Canvas/btn_yk").active = true;
        }

        var youkeorweixin = cc.sys.localStorage.getItem("youkeorweixin");
        //安卓只显示微信登陆
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            console.log("platform:" + cc.sys.OS_ANDROID + " OS_ANDROID.");
            cc.find("Canvas/btn_yk").active = false;
            cc.find("Canvas/z_weixindenglu").active = true;
        }
        //IOS审核版本 只显示游客登录 过审版本 只显示微信登陆
        else if (cc.sys.os == cc.sys.OS_IOS) {
                console.log("platform:" + cc.sys.OS_IOS + " OS_IOS.");
                if (youkeorweixin == "0") {
                    cc.find("Canvas/btn_yk").active = true;
                    cc.find("Canvas/z_weixindenglu").active = false;
                    cc.find("Canvas/yhxy").active = true;
                }
                if (youkeorweixin == "1" || youkeorweixin == "null") {
                    cc.find("Canvas/z_weixindenglu").active = true;
                    cc.find("Canvas/btn_yk").active = false;
                }
            } else {
                cc.find("Canvas/btn_yk").active = true;
                cc.find("Canvas/z_weixindenglu").active = true;
                console.log("platform:" + cc.sys.os + " dosn't implement share.");
            }
    },

    start: function start() {
        var account = cc.sys.localStorage.getItem("wx_account");
        var sign = cc.sys.localStorage.getItem("wx_sign");
        if (account != null && sign != null) {
            var ret = {
                errcode: 0,
                account: account,
                sign: sign
            };
            cc.vv.userMgr.onAuth(ret);
        }
    },
    onBtnReturn: function onBtnReturn() {
        var yhxy = this.node.getChildByName("yhxy");
        yhxy.active = false;
    },
    check_mark: function check_mark() {
        var tyyhxy = this.node.getChildByName("tyyhxy");
        var btn_checkbox = tyyhxy.getChildByName("btn_checkbox");
        var check_mark = btn_checkbox.getChildByName("check_mark");
        if (this.mjdl == 1) {
            check_mark.active = false;
            this.mjdl = 0;
        } else {
            check_mark.active = true;
            this.mjdl = 1;
        }
        console.log("this.mjdl:" + this.mjdl);
    },
    yonghuxieyi: function yonghuxieyi() {

        var yhxy = this.node.getChildByName("yhxy");
        yhxy.active = true;
    },
    prompt: function prompt() {
        var prompt = this.node.getChildByName("prompt");
        prompt.active = false;
    },
    onBtnQuickStartClicked: function onBtnQuickStartClicked() {
        if (this.mjdl == 0) {
            var prompt = this.node.getChildByName("prompt");
            prompt.active = true;
            return;
        }
        console.log("ssy");

        cc.vv.userMgr.guestAuth();
    },

    onBtnWeichatClicked: function onBtnWeichatClicked() {

        var self = this;
        if (self.mjdl == 0) {
            var prompt = this.node.getChildByName("prompt");
            prompt.active = true;
            return;
        }
        console.log("ss");
        cc.vv.anysdkMgr.login();
    },

    onBtnMIMAClicked: function onBtnMIMAClicked(event) {
        if (this._mima[this._mimaIndex] == event.target.name) {
            this._mimaIndex++;
            if (this._mimaIndex == this._mima.length) {
                cc.find("Canvas/btn_yk").active = true;
            }
        } else {
            console.log("oh ho~~~");
            this._mimaIndex = 0;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"MJGame":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7fa8fcvrqFOj6lhh6xHzd3c', 'MJGame');
// scripts/components/MJGame.js

cc.Class({
    "extends": cc.Component,

    properties: {
        gameRoot: {
            "default": null,
            type: cc.Node
        },

        prepareRoot: {
            "default": null,
            type: cc.Node
        },

        _myMJArr: [],
        _options: null,
        _selectedMJ: null,
        _chupaiSprite: [],
        _mjcount: null,
        _gamecount: null,
        _hupaiTips: [],
        _hupaiLists: [],
        _playEfxs: [],
        _opts: [],
        _gametype: null
    },

    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        if (!cc.vv) {
            cc.director.loadScene("loading");
            return;
        }
        this.addComponent("NoticeTip");
        this.addComponent("GameOver");
        this.addComponent("DingQue");
        this.addComponent("PengGangs");
        this.addComponent("MJRoom");
        this.addComponent("TimePointer");
        this.addComponent("GameResult");
        this.addComponent("Chat");
        this.addComponent("Folds");
        this.addComponent("ReplayCtrl");
        this.addComponent("PopupMgr");
        this.addComponent("HuanSanZhang");
        this.addComponent("ReConnect");
        this.addComponent("Voice");
        this.addComponent("UserInfoShow");

        this.initView();
        this.initEventHandlers();

        this.gameRoot.active = false;
        this.prepareRoot.active = true;
        this.initWanfaLabel();
        this.onGameBeign();
        cc.vv.audioMgr.playBGM("bgMain.mp3");

        //淡入
        var fadein = cc.fadeIn(0.1);
        this.node.runAction(fadein);
    },

    initView: function initView() {

        //搜索需要的子节点
        var gameChild = this.node.getChildByName("game");

        this._mjcount = gameChild.getChildByName('mjcount').getComponent(cc.Label);
        this._mjcount.string = "剩余" + cc.vv.gameNetMgr.numOfMJ + "张";
        this._gamecount = gameChild.getChildByName('gamecount').getComponent(cc.Label);
        switch (cc.vv.gameNetMgr.fengxiang) {
            case 0:
                this._gamecount.string = "东风圈";break;
            case 1:
                this._gamecount.string = "南风圈";break;
            case 2:
                this._gamecount.string = "西风圈";break;
            case 3:
                this._gamecount.string = "北风圈";break;
        }

        this._gametype = gameChild.getChildByName('gametype');
        switch (cc.vv.gameNetMgr.conf.type) {
            case "sjmmj":
                this._gametype.getComponent(cc.Label).string = "沈家门麻将";break;
            case "dhmj":
                this._gametype.getComponent(cc.Label).string = "定海麻将";break;
            case "tdh":
                this._gametype.getComponent(cc.Label).string = "推到胡";break;
        }

        var myselfChild = gameChild.getChildByName("myself");
        var myholds = myselfChild.getChildByName("holds");

        for (var i = 0; i < myholds.children.length; ++i) {
            var sprite = myholds.children[i].getComponent(cc.Sprite);
            this._myMJArr.push(sprite);
            sprite.spriteFrame = null;
        }

        var realwidth = cc.director.getVisibleSize().width;
        myholds.scaleX *= realwidth / 1280;
        myholds.scaleY *= realwidth / 1280;

        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var side = sides[i];

            var sideChild = gameChild.getChildByName(side);
            this._hupaiTips.push(sideChild.getChildByName("HuPai"));
            this._hupaiLists.push(sideChild.getChildByName("hupailist"));
            this._playEfxs.push(sideChild.getChildByName("play_efx").getComponent(cc.Animation));
            this._chupaiSprite.push(sideChild.getChildByName("ChuPai").children[0].getComponent(cc.Sprite));

            var opt = sideChild.getChildByName("opt");
            opt.active = false;
            var sprite = opt.getChildByName("pai").getComponent(cc.Sprite);
            var data = {
                node: opt,
                sprite: sprite
            };
            this._opts.push(data);
        }

        var opts = gameChild.getChildByName("ops");
        this._options = opts;
        this.hideOptions();
        this.hideChupai();
    },

    hideChupai: function hideChupai() {
        for (var i = 0; i < this._chupaiSprite.length; ++i) {
            this._chupaiSprite[i].node.active = false;
        }
    },

    initEventHandlers: function initEventHandlers() {
        cc.vv.gameNetMgr.dataEventHandler = this.node;

        //初始化事件监听器
        var self = this;

        this.node.on('game_holds', function (data) {
            self.initMahjongs();
            self.checkQueYiMen();
        });

        this.node.on('game_begin', function (data) {
            self.playShazi();
            self.onGameBeign(data);
        });

        this.node.on('game_sync', function (data) {
            self.onGameBeign(data);
        });

        this.node.on('game_chupai', function (data) {
            data = data.detail;
            self.hideChupai();
            self.checkQueYiMen();
            if (data.last != cc.vv.gameNetMgr.seatIndex) {
                self.initMopai(data.last, null);
            }
            if (!cc.vv.replayMgr.isReplay() && data.turn != cc.vv.gameNetMgr.seatIndex) {
                self.initMopai(data.turn, -1);
            }
        });

        this.node.on('game_mopai', function (data) {
            self.hideChupai();
            data = data.detail;
            var pai = data.pai;
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(data.seatIndex);
            if (localIndex == 0) {
                var index = 13;
                var sprite = self._myMJArr[index];
                self.setSpriteFrameByMJID("M_", sprite, pai, index);
                sprite.node.mjId = pai;
            } else if (cc.vv.replayMgr.isReplay()) {
                self.initMopai(data.seatIndex, pai);
            }
        });

        this.node.on('game_action', function (data) {
            self.showAction(data.detail);
            console.log("game_action");
        });

        // this.node.on('game_feng',function(data){
        //     self._gamecount
        //     console.log("game_feng");
        // });

        this.node.on('hupai', function (data) {
            var data = data.detail;
            //如果不是玩家自己，则将玩家的牌都放倒
            var seatIndex = data.seatindex;
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
            var hupai = self._hupaiTips[localIndex];
            hupai.active = true;

            if (localIndex == 0) {
                self.hideOptions();
            }
            var seatData = cc.vv.gameNetMgr.seats[seatIndex];
            seatData.hued = true;
            if (cc.vv.gameNetMgr.conf.type == "xlch") {
                hupai.getChildByName("sprHu").active = true;
                hupai.getChildByName("sprZimo").active = false;
                self.initHupai(localIndex, data.hupai);
                if (data.iszimo) {
                    if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                        seatData.holds.pop();
                        self.initMahjongs();
                    } else {
                        self.initOtherMahjongs(seatData);
                    }
                }
            } else {
                hupai.getChildByName("sprHu").active = !data.iszimo;
                hupai.getChildByName("sprZimo").active = data.iszimo;

                if (!(data.iszimo && localIndex == 0)) {
                    //if(cc.vv.replayMgr.isReplay() == false && localIndex != 0){
                    //    self.initEmptySprites(seatIndex);               
                    //}
                    self.initMopai(seatIndex, data.hupai);
                }
            }

            if (cc.vv.replayMgr.isReplay() == true && cc.vv.gameNetMgr.conf.type != "xlch") {
                var opt = self._opts[localIndex];
                opt.node.active = true;
                opt.sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", data.hupai);
            }

            if (data.iszimo) {
                self.playEfx(localIndex, "play_zimo");
            } else {
                self.playEfx(localIndex, "play_hu");
            }

            cc.vv.audioMgr.playSFX("nv/hu.mp3");
        });

        this.node.on('mj_count', function (data) {
            self._mjcount.string = "剩余" + cc.vv.gameNetMgr.numOfMJ + "张";
        });

        this.node.on('game_num', function (data) {
            //console.log('game_num!!!!!!!!!!'+cc.vv.gameNetMgr.fengxiang);
            // switch(cc.vv.gameNetMgr.fengxiang) {
            //     case 0:
            //         self._gamecount.string = "东风圈";break;
            //     case 1:
            //         self._gamecount.string = "南风圈";break;
            //     case 2:
            //         self._gamecount.string = "西风圈";break;
            //     case 3:
            //         self._gamecount.string = "北风圈";break;

            // }
        });

        this.node.on('game_feng', function (data) {
            console.log('game_num!!!!!!!!!!' + cc.vv.gameNetMgr.fengxiang);
            switch (cc.vv.gameNetMgr.fengxiang) {
                case 0:
                    self._gamecount.string = "东风圈";break;
                case 1:
                    self._gamecount.string = "南风圈";break;
                case 2:
                    self._gamecount.string = "西风圈";break;
                case 3:
                    self._gamecount.string = "北风圈";break;

            }
        });

        this.node.on('game_over', function (data) {
            self.gameRoot.active = false;
            self.prepareRoot.active = true;
        });

        this.node.on('game_chupai_notify', function (data) {
            self.hideChupai();
            var seatData = data.detail.seatData;
            //如果是自己，则刷新手牌
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            self.showChupai();
            var audioUrl = cc.vv.mahjongmgr.getAudioURLByMJID(data.detail.pai);
            cc.vv.audioMgr.playSFX(audioUrl);
        });

        this.node.on('guo_notify', function (data) {
            self.hideChupai();
            self.hideOptions();
            var seatData = data.detail;
            //如果是自己，则刷新手牌
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            }
            cc.vv.audioMgr.playSFX("give.mp3");
        });

        this.node.on('guo_result', function (data) {
            self.hideOptions();
        });

        this.node.on('game_dingque_finish', function (data) {
            self.initMahjongs();
        });

        this.node.on('peng_notify', function (data) {
            self.hideChupai();

            var seatData = data.detail;
            console.log('peng_notify');
            console.log(data);
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            var localIndex = self.getLocalIndex(seatData.seatindex);
            self.playEfx(localIndex, "play_peng");
            cc.vv.audioMgr.playSFX("nv/peng.mp3");
            self.hideOptions();
        });

        this.node.on('chi_notify', function (data) {
            console.log('chi_notify');
            console.log(data);
            self.hideChupai();

            var seatData = data.detail;

            console.log(data);
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            var localIndex = self.getLocalIndex(seatData.seatindex);
            self.playEfx(localIndex, "play_chi");
            cc.vv.audioMgr.playSFX("nv/chi.mp3");
            self.hideOptions();
        });

        this.node.on('buhua_notify', function (data) {
            console.log('buhua_notify');
            console.log(data.detail.holds);
            var seatData = data.detail;
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
        });

        this.node.on('gang_notify', function (data) {
            self.hideChupai();
            var data = data.detail;
            var seatData = data.seatData;
            var gangtype = data.gangtype;
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }

            var localIndex = self.getLocalIndex(seatData.seatindex);
            if (gangtype == "wangang") {
                self.playEfx(localIndex, "play_gang");
                cc.vv.audioMgr.playSFX("guafeng.mp3");
            } else {
                self.playEfx(localIndex, "play_gang");
                cc.vv.audioMgr.playSFX("rain.mp3");
            }
        });

        this.node.on("hangang_notify", function (data) {
            var data = data.detail;
            var localIndex = self.getLocalIndex(data);
            self.playEfx(localIndex, "play_gang");
            cc.vv.audioMgr.playSFX("nv/gang.mp3");
            self.hideOptions();
        });
    },

    showChupai: function showChupai() {
        var pai = cc.vv.gameNetMgr.chupai;
        if (pai >= 0) {
            //
            var localIndex = this.getLocalIndex(cc.vv.gameNetMgr.turn);
            var sprite = this._chupaiSprite[localIndex];
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            sprite.node.active = true;
        }
    },

    addOption: function addOption(btnName, pai, chitype) {
        console.log("弹出操作框");
        console.log(btnName);
        console.log(pai);
        //添加吃牌的三种方式
        //var str = pai.split("_");
        //var painame = str[0];
        //var painum = str[1];
        if (chitype && chitype.left == true) {
            var op = this._options.getChildByName("chiop").getChildByName("left");
            op.active = true;
            var sprite = op.children[0].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            var sprite = op.children[1].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai + 1);
            var sprite = op.children[2].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai + 2);
        }

        if (chitype && chitype.mid == true) {
            var op = this._options.getChildByName("chiop").getChildByName("mid");
            op.active = true;
            var sprite = op.children[0].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai - 1);
            var sprite = op.children[1].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            var sprite = op.children[2].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai + 1);
        }
        if (chitype && chitype.right == true) {
            var op = this._options.getChildByName("chiop").getChildByName("right");
            op.active = true;
            var sprite = op.children[0].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai - 2);
            var sprite = op.children[1].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai - 1);
            var sprite = op.children[2].getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
        }
        //其他
        for (var i = 0; i < this._options.childrenCount; ++i) {
            var child = this._options.children[i];
            if (child.name == "op" && child.active == false) {
                child.active = true;
                var sprite = child.getChildByName("opTarget").getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
                var btn = child.getChildByName(btnName);
                btn.active = true;
                btn.pai = pai;
                return;
            }
        }
    },

    hideOptions: function hideOptions(data) {
        this._options.active = false;
        for (var i = 0; i < this._options.childrenCount; ++i) {
            var child = this._options.children[i];
            if (child.name == "op") {
                child.active = false;
                child.getChildByName("btnPeng").active = false;
                child.getChildByName("btnGang").active = false;
                child.getChildByName("btnHu").active = false;
                child.getChildByName("btnChi").active = false;
            }
            if (child.name == "chiop") {
                child.active = false;
                child.getChildByName("left").active = false;
                child.getChildByName("mid").active = false;
                child.getChildByName("right").active = false;
            }
        }
    },

    showAction: function showAction(data) {
        console.log("show action");
        console.log(this._options.active);
        if (this._options.active) {
            this.hideOptions();
        }

        if (data && (data.hu || data.gang || data.peng || data.chi)) {
            console.log(data.chi);
            this._options.active = true;
            if (data.hu) {
                this.addOption("btnHu", data.pai);
            }
            if (data.peng) {
                this.addOption("btnPeng", data.pai);
            }

            if (data.gang) {
                for (var i = 0; i < data.gangpai.length; ++i) {
                    var gp = data.gangpai[i];
                    this.addOption("btnGang", gp);
                }
            }

            if (data.chi) {
                this.addOption("btnChi", data.pai, data.chitype);
            }
        }
        console.log(data.chi);
    },

    initWanfaLabel: function initWanfaLabel() {
        var wanfa = cc.find("Canvas/infobar/wanfa").getComponent(cc.Label);
        wanfa.string = cc.vv.gameNetMgr.getWanfa();
    },

    initHupai: function initHupai(localIndex, pai) {
        if (cc.vv.gameNetMgr.conf.type == "xlch") {
            var hupailist = this._hupaiLists[localIndex];
            for (var i = 0; i < hupailist.children.length; ++i) {
                var hupainode = hupailist.children[i];
                if (hupainode.active == false) {
                    var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
                    hupainode.getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, pai);
                    hupainode.active = true;
                    break;
                }
            }
        }
    },

    playEfx: function playEfx(index, name) {
        this._playEfxs[index].node.active = true;
        this._playEfxs[index].play(name);
    },

    playShazi: function playShazi() {
        var anim1 = this.node.getChildByName("game").getChildByName("shaizi").getChildByName("shaizi1").getComponent(cc.Animation);
        anim1.play("shaizi");
        var anim2 = this.node.getChildByName("game").getChildByName("shaizi").getChildByName("shaizi2").getComponent(cc.Animation);
        anim2.play("shaizi2");
        this.onfinished(false);
        anim2.on("finished", this.onfinished, this);
    },

    onfinished: function onfinished(isshow) {
        var show = true;
        isshow == false ? show = false : {};
        var side = this.node.getChildByName("game").getChildByName("myself");
        side.getChildByName("huas").active = show;
        side.getChildByName("holds").active = show;
        var side = this.node.getChildByName("game").getChildByName("left");
        side.getChildByName("huas").active = show;
        side.getChildByName("holds").active = show;
        var side = this.node.getChildByName("game").getChildByName("up");
        side.getChildByName("huas").active = show;
        side.getChildByName("holds").active = show;
        var side = this.node.getChildByName("game").getChildByName("right");
        side.getChildByName("huas").active = show;
        side.getChildByName("holds").active = show;
    },

    onGameBeign: function onGameBeign() {

        for (var i = 0; i < this._playEfxs.length; ++i) {
            this._playEfxs[i].node.active = false;
        }

        for (var i = 0; i < this._hupaiLists.length; ++i) {
            for (var j = 0; j < this._hupaiLists[i].childrenCount; ++j) {
                this._hupaiLists[i].children[j].active = false;
            }
        }

        for (var i = 0; i < cc.vv.gameNetMgr.seats.length; ++i) {
            var seatData = cc.vv.gameNetMgr.seats[i];
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            var hupai = this._hupaiTips[localIndex];
            hupai.active = seatData.hued;
            if (seatData.hued) {
                hupai.getChildByName("sprHu").active = !seatData.iszimo;
                hupai.getChildByName("sprZimo").active = seatData.iszimo;
            }

            if (seatData.huinfo) {
                for (var j = 0; j < seatData.huinfo.length; ++j) {
                    var info = seatData.huinfo[j];
                    if (info.ishupai) {
                        this.initHupai(localIndex, info.pai);
                    }
                }
            }
        }

        this.hideChupai();
        this.hideOptions();
        var sides = ["right", "up", "left"];
        var gameChild = this.node.getChildByName("game");
        for (var i = 0; i < sides.length; ++i) {
            var sideChild = gameChild.getChildByName(sides[i]);
            var holds = sideChild.getChildByName("holds");
            for (var j = 0; j < holds.childrenCount; ++j) {
                var nc = holds.children[j];
                nc.active = true;
                nc.scaleX = 1.0;
                nc.scaleY = 1.0;
                var sprite = nc.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.holdsEmpty[i + 1];
            }
        }

        if (cc.vv.gameNetMgr.gamestate == "" && cc.vv.replayMgr.isReplay() == false) {
            return;
        }

        this.gameRoot.active = true;
        this.prepareRoot.active = false;
        this.initMahjongs();
        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            var seatData = seats[i];
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            if (localIndex != 0) {
                this.initOtherMahjongs(seatData);
                if (i == cc.vv.gameNetMgr.turn) {
                    this.initMopai(i, -1);
                } else {
                    this.initMopai(i, null);
                }
            }
        }
        this.showChupai();
        if (cc.vv.gameNetMgr.curaction != null) {
            this.showAction(cc.vv.gameNetMgr.curaction);
            cc.vv.gameNetMgr.curaction = null;
        }

        this.checkQueYiMen();
    },

    onMJClicked: function onMJClicked(event) {
        console.log("event");
        console.log(event);
        if (cc.vv.gameNetMgr.isHuanSanZhang) {
            this.node.emit("mj_clicked", event.target);
            return;
        }

        //如果不是自己的轮子，则忽略
        if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
            console.log("not your turn." + cc.vv.gameNetMgr.turn);
            return;
        }

        for (var i = 0; i < this._myMJArr.length; ++i) {
            if (event.target == this._myMJArr[i].node) {
                //如果是再次点击，则出牌
                if (event.target == this._selectedMJ) {
                    this.shoot(this._selectedMJ.mjId);
                    this._selectedMJ.y = 0;
                    this._selectedMJ = null;
                    return;
                }
                if (this._selectedMJ != null) {
                    this._selectedMJ.y = 0;
                }
                event.target.y = 15;
                this._selectedMJ = event.target;
                return;
            }
        }
    },

    //如果摸到的牌是花，则会调用这个函数
    chuhua: (function (_chuhua) {
        function chuhua(_x) {
            return _chuhua.apply(this, arguments);
        }

        chuhua.toString = function () {
            return _chuhua.toString();
        };

        return chuhua;
    })(function (mjid) {
        console.log(chuhua);
    }),

    //出牌
    shoot: function shoot(mjId) {
        if (mjId == null) {
            return;
        }
        cc.vv.net.send('chupai', mjId);
    },

    getMJIndex: function getMJIndex(side, index) {
        if (side == "right" || side == "up") {
            return 13 - index;
        }
        return index;
    },

    initMopai: function initMopai(seatIndex, pai) {
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);

        var gameChild = this.node.getChildByName("game");
        var sideChild = gameChild.getChildByName(side);
        var holds = sideChild.getChildByName("holds");

        var lastIndex = this.getMJIndex(side, 13);
        var nc = holds.children[lastIndex];

        nc.scaleX = 1.0;
        nc.scaleY = 1.0;

        if (pai == null) {
            nc.active = false;
        } else if (pai >= 0) {
            nc.active = true;
            if (side == "up") {
                nc.scaleX = 0.73;
                nc.scaleY = 0.73;
            }
            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, pai);
        } else if (pai != null) {
            nc.active = true;
            if (side == "up") {
                nc.scaleX = 1.0;
                nc.scaleY = 1.0;
            }
            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getHoldsEmptySpriteFrame(side);
        }
    },

    initEmptySprites: function initEmptySprites(seatIndex) {
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);

        var gameChild = this.node.getChildByName("game");
        var sideChild = gameChild.getChildByName(side);
        var holds = sideChild.getChildByName("holds");
        var spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame(side);
        for (var i = 0; i < holds.childrenCount; ++i) {
            var nc = holds.children[i];
            nc.scaleX = 1.0;
            nc.scaleY = 1.0;

            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = spriteFrame;
        }
    },

    initOtherMahjongs: function initOtherMahjongs(seatData) {
        //console.log("seat:" + seatData.seatindex);
        var localIndex = this.getLocalIndex(seatData.seatindex);
        if (localIndex == 0) {
            return;
        }
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var game = this.node.getChildByName("game");
        var sideRoot = game.getChildByName(side);
        var sideHolds = sideRoot.getChildByName("holds");
        var num = seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length + seatData.chis.length;
        num *= 3;
        for (var i = 0; i < num; ++i) {
            var idx = this.getMJIndex(side, i);
            sideHolds.children[idx].active = false;
        }

        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var holds = this.sortHolds(seatData);
        if (holds != null && holds.length > 0) {
            for (var i = 0; i < holds.length; ++i) {
                var idx = this.getMJIndex(side, i + num);
                var sprite = sideHolds.children[idx].getComponent(cc.Sprite);
                if (side == "up") {
                    sprite.node.scaleX = 0.73;
                    sprite.node.scaleY = 0.73;
                }
                sprite.node.active = true;
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, holds[i]);
            }

            if (holds.length + num == 13) {
                var lasetIdx = this.getMJIndex(side, 13);
                sideHolds.children[lasetIdx].active = false;
            }
        }
    },

    sortHolds: function sortHolds(seatData) {
        var holds = seatData.holds;
        if (holds == null) {
            return null;
        }
        //如果手上的牌的数目是2,5,8,11,14，表示最后一张牌是刚摸到的牌
        var mopai = null;
        var l = holds.length;
        if (l == 2 || l == 5 || l == 8 || l == 11 || l == 14) {
            mopai = holds.pop();
        }

        var dingque = seatData.dingque;
        cc.vv.mahjongmgr.sortMJ(holds, dingque);

        //将摸牌添加到最后
        if (mopai != null) {
            holds.push(mopai);
        }
        return holds;
    },

    initMahjongs: function initMahjongs() {
        var seats = cc.vv.gameNetMgr.seats;
        var seatData = seats[cc.vv.gameNetMgr.seatIndex];
        var holds = this.sortHolds(seatData);
        if (holds == null) {
            return;
        }
        console.log(seats);
        //初始化手牌
        var lackingNum = (seatData.chis.length + seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length) * 3;
        for (var i = 0; i < holds.length; ++i) {
            var mjid = holds[i];
            var sprite = this._myMJArr[i + lackingNum];
            sprite.node.mjId = mjid;
            sprite.node.y = 0;
            this.setSpriteFrameByMJID("M_", sprite, mjid);
        }
        for (var i = 0; i < lackingNum; ++i) {
            var sprite = this._myMJArr[i];
            sprite.node.mjId = null;
            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
        for (var i = lackingNum + holds.length; i < this._myMJArr.length; ++i) {
            var sprite = this._myMJArr[i];
            sprite.node.mjId = null;
            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
    },

    setSpriteFrameByMJID: function setSpriteFrameByMJID(pre, sprite, mjid) {
        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
        sprite.node.active = true;
    },

    //如果玩家手上还有缺的牌没有打，则只能打缺牌
    checkQueYiMen: function checkQueYiMen() {
        if (cc.vv.gameNetMgr.conf == null || cc.vv.gameNetMgr.conf.type != "xlch" || !cc.vv.gameNetMgr.getSelfData().hued) {
            //遍历检查看是否有未打缺的牌 如果有，则需要将不是定缺的牌设置为不可用
            var dingque = cc.vv.gameNetMgr.dingque;
            //        console.log(dingque)
            var hasQue = false;
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
                for (var i = 0; i < this._myMJArr.length; ++i) {
                    var sprite = this._myMJArr[i];
                    //                console.log("sprite.node.mjId:" + sprite.node.mjId);
                    if (sprite.node.mjId != null) {
                        var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);
                        if (type == dingque) {
                            hasQue = true;
                            break;
                        }
                    }
                }
            }

            //        console.log("hasQue:" + hasQue);
            for (var i = 0; i < this._myMJArr.length; ++i) {
                var sprite = this._myMJArr[i];
                if (sprite.node.mjId != null) {
                    var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);
                    if (hasQue && type != dingque) {
                        sprite.node.getComponent(cc.Button).interactable = false;
                    } else {
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            }
        } else {
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = i == 13;
                    }
                }
            } else {
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            }
        }
    },

    getLocalIndex: function getLocalIndex(index) {
        var ret = (index - cc.vv.gameNetMgr.seatIndex + 4) % 4;
        //console.log("old:" + index + ",base:" + cc.vv.gameNetMgr.seatIndex + ",new:" + ret);
        return ret;
    },

    onOptionClicked: function onOptionClicked(event) {
        console.log(event.target.name);
        if (event.target.name == "btnPeng") {
            cc.vv.net.send("peng");
        } else if (event.target.name == "btnGang") {
            cc.vv.net.send("gang", event.target.pai);
        } else if (event.target.name == "btnHu") {
            cc.vv.net.send("hu");
        }
        //打开吃菜单
        else if (event.target.name == "btnChi") {
                this._options.getChildByName("chiop").active = true;

                for (var i = 0; i < this._options.childrenCount; ++i) {
                    var child = this._options.children[i];
                    if (child.name == "op") {
                        child.active = false;
                    }
                }
            }
            //左吃
            else if (event.target.name == "left") {
                    cc.vv.net.send("chi", "left");
                }
                //中吃
                else if (event.target.name == "mid") {
                        cc.vv.net.send("chi", "mid");
                    }
                    //右吃
                    else if (event.target.name == "right") {
                            cc.vv.net.send("chi", "right");
                        } else if (event.target.name == "btnGuo") {
                            cc.vv.net.send("guo");
                        }
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {},

    onDestroy: function onDestroy() {
        console.log("onDestroy");
        if (cc.vv) {
            cc.vv.gameNetMgr.clear();
        }
    }
});

cc._RFpop();
},{}],"MJRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '921dfQJZddJ+5GFUXqxmMmT', 'MJRoom');
// scripts/components/MJRoom.js

cc.Class({
    "extends": cc.Component,

    properties: {
        lblRoomNo: {
            "default": null,
            type: cc.Label
        },
        _seats: [],
        _seats2: [],
        _timeLabel: null,
        _voiceMsgQueue: [],
        _lastPlayingSeat: null,
        _playingSeat: null,
        _lastPlayTime: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this.initView();
        this.initSeats();
        this.initEventHandlers();

        var youkeorweixin = cc.sys.localStorage.getItem("youkeorweixin");
        if (cc.sys.os == cc.sys.OS_IOS && youkeorweixin == "0") {
            //隐藏显示下边按钮
            cc.find("Canvas/prepare/btnWeichat").active = false;
        }
    },

    initView: function initView() {
        var prepare = this.node.getChildByName("prepare");
        var seats = prepare.getChildByName("seats");
        for (var i = 0; i < seats.children.length; ++i) {
            this._seats.push(seats.children[i].getComponent("Seat"));
        }

        this.refreshBtns();

        this.lblRoomNo = cc.find("Canvas/infobar/shijian/Z_room_txt/New Label").getComponent(cc.Label);
        this._timeLabel = cc.find("Canvas/infobar/shijian/time").getComponent(cc.Label);

        //显示玩法
        cc.find("Canvas/infobar/wanfa").getComponent(cc.Label).string = cc.vv.gameNetMgr.getWanfa();

        this.lblRoomNo.string = cc.vv.gameNetMgr.roomId;
        var gameChild = this.node.getChildByName("game");
        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var sideNode = gameChild.getChildByName(sides[i]);
            var seat = sideNode.getChildByName("seat");
            this._seats2.push(seat.getComponent("Seat"));
        }

        var btnWechat = cc.find("Canvas/prepare/btnWeichat");
        if (btnWechat) {
            cc.vv.utils.addClickEvent(btnWechat, this.node, "MJRoom", "onBtnWeichatClicked");
        }

        var titles = cc.find("Canvas/typeTitle");
        for (var i = 0; i < titles.children.length; ++i) {
            titles.children[i].active = false;
        }

        if (cc.vv.gameNetMgr.conf) {
            //TODO:换成相应字样
            // var type = cc.vv.gameNetMgr.conf.type;
            // if(type == null || type == ""){
            //     type = "xzdd";
            // }
            // titles.getChildByName(type).active = true;  
        }
    },

    refreshBtns: function refreshBtns() {
        var prepare = this.node.getChildByName("prepare");
        var btnExit = prepare.getChildByName("btnExit");
        var btnDispress = prepare.getChildByName("btnDissolve");
        var btnWeichat = prepare.getChildByName("btnWeichat");
        var btnBack = prepare.getChildByName("btnBack");
        var isIdle = cc.vv.gameNetMgr.numOfGames == 0;
        console.log('isIdle' + isIdle);
        console.log(cc.vv.gameNetMgr.numOfGames);
        btnExit.active = !cc.vv.gameNetMgr.isOwner() && isIdle;
        btnDispress.active = cc.vv.gameNetMgr.isOwner() && isIdle;

        btnWeichat.active = isIdle;
        btnBack.active = isIdle;
    },

    initEventHandlers: function initEventHandlers() {
        var self = this;
        this.node.on('new_user', function (data) {
            self.initSingleSeat(data.detail);
        });

        this.node.on('user_state_changed', function (data) {
            self.initSingleSeat(data.detail);
        });

        this.node.on('game_begin', function (data) {
            self.refreshBtns();
            self.initSeats();
        });

        this.node.on('game_num', function (data) {
            self.refreshBtns();
        });

        this.node.on('game_huanpai', function (data) {
            for (var i in self._seats2) {
                self._seats2[i].refreshXuanPaiState();
            }
        });

        this.node.on('huanpai_notify', function (data) {
            var idx = data.detail.seatindex;
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            self._seats2[localIdx].refreshXuanPaiState();
        });

        this.node.on('game_huanpai_over', function (data) {
            for (var i in self._seats2) {
                self._seats2[i].refreshXuanPaiState();
            }
        });

        this.node.on('voice_msg', function (data) {
            var data = data.detail;
            self._voiceMsgQueue.push(data);
            self.playVoice();
        });

        this.node.on('chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            self._seats[localIdx].chat(data.content);
            self._seats2[localIdx].chat(data.content);
        });

        this.node.on('quick_chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);

            var index = data.content;
            var info = cc.vv.chat.getQuickChatInfo(index);
            self._seats[localIdx].chat(info.content);
            self._seats2[localIdx].chat(info.content);

            cc.vv.audioMgr.playSFX(info.sound);
        });

        this.node.on('emoji_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            console.log(data);
            self._seats[localIdx].emoji(data.content);
            self._seats2[localIdx].emoji(data.content);
        });
    },

    initSeats: function initSeats() {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < seats.length; ++i) {
            this.initSingleSeat(seats[i]);
        }
    },

    initSingleSeat: function initSingleSeat(seat) {
        var index = cc.vv.gameNetMgr.getLocalIndex(seat.seatindex);
        var isOffline = !seat.online;
        var isZhuang = seat.seatindex == cc.vv.gameNetMgr.button;

        console.log("isOffline:" + isOffline);

        this._seats[index].setInfo(seat.name, seat.score);
        this._seats[index].setReady(seat.ready);
        this._seats[index].setOffline(isOffline);
        this._seats[index].setID(seat.userid);
        this._seats[index].voiceMsg(false);

        this._seats2[index].setInfo(seat.name, seat.score);
        this._seats2[index].setZhuang(isZhuang);
        this._seats2[index].setOffline(isOffline);
        this._seats2[index].setID(seat.userid);
        this._seats2[index].voiceMsg(false);
        this._seats2[index].refreshXuanPaiState();
    },

    onBtnSettingsClicked: function onBtnSettingsClicked() {
        cc.vv.popupMgr.showSettings();
    },

    onBtnBackClicked: function onBtnBackClicked() {
        cc.vv.alert.show("返回大厅", "返回大厅房间仍会保留，快去邀请大伙来玩吧！", function () {
            cc.director.loadScene("hall");
        }, true);
    },

    onBtnChatClicked: function onBtnChatClicked() {},

    onBtnWeichatClicked: function onBtnWeichatClicked() {
        if (cc.vv.gameNetMgr.conf.type == "sjmmj") {
            var title = "<沈家门麻将>";
        } else if (cc.vv.gameNetMgr.conf.type == "dhmj") {
            var title = "<定海麻将>";
        } else if (cc.vv.gameNetMgr.conf.type == "tdh") {
            var title = "<推倒胡>";
        }
        //cc.vv.anysdkMgr.share("奇奇舟山麻将" + title,"房号:" + cc.vv.gameNetMgr.roomId + " 玩法:" + cc.vv.gameNetMgr.getWanfa());
        cc.vv.anysdkMgr.share("奇奇舟山麻将" + title + " 房号:【" + cc.vv.gameNetMgr.roomId + "】", "玩法:" + cc.vv.gameNetMgr.getWanfa());
    },

    onBtnDissolveClicked: function onBtnDissolveClicked() {
        cc.vv.alert.show("解散房间", "解散房间不扣房卡，是否确定解散？", function () {
            cc.vv.net.send("dispress");
        }, true);
    },

    onBtnExit: function onBtnExit() {
        cc.vv.net.send("exit");
    },

    playVoice: function playVoice() {
        if (this._playingSeat == null && this._voiceMsgQueue.length) {
            console.log("playVoice2");
            var data = this._voiceMsgQueue.shift();
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(idx);
            this._playingSeat = localIndex;
            this._seats[localIndex].voiceMsg(true);
            this._seats2[localIndex].voiceMsg(true);

            var msgInfo = JSON.parse(data.content);

            var msgfile = "voicemsg.amr";
            console.log(msgInfo.msg.length);
            cc.vv.voiceMgr.writeVoice(msgfile, msgInfo.msg);
            cc.vv.voiceMgr.play(msgfile);
            this._lastPlayTime = Date.now() + msgInfo.time;
        }
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        var minutes = Math.floor(Date.now() / 1000 / 60);
        if (this._lastMinute != minutes) {
            this._lastMinute = minutes;
            var date = new Date();
            var h = date.getHours();
            h = h < 10 ? "0" + h : h;

            var m = date.getMinutes();
            m = m < 10 ? "0" + m : m;
            this._timeLabel.string = "" + h + ":" + m;
        }

        if (this._lastPlayTime != null) {
            if (Date.now() > this._lastPlayTime + 200) {
                this.onPlayerOver();
                this._lastPlayTime = null;
            }
        } else {
            this.playVoice();
        }
    },

    onPlayerOver: function onPlayerOver() {
        cc.vv.audioMgr.resumeAll();
        console.log("onPlayCallback:" + this._playingSeat);
        var localIndex = this._playingSeat;
        this._playingSeat = null;
        this._seats[localIndex].voiceMsg(false);
        this._seats2[localIndex].voiceMsg(false);
    },

    onDestroy: function onDestroy() {
        cc.vv.voiceMgr.stop();
        //        cc.vv.voiceMgr.onPlayCallback = null;
    }
});

cc._RFpop();
},{}],"MahjongMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0ecea6X+IFIK5XFdJe38hXa', 'MahjongMgr');
// scripts/MahjongMgr.js

var mahjongSprites = [];

cc.Class({
    "extends": cc.Component,

    properties: {
        leftAtlas: {
            "default": null,
            type: cc.SpriteAtlas
        },

        rightAtlas: {
            "default": null,
            type: cc.SpriteAtlas
        },

        bottomAtlas: {
            "default": null,
            type: cc.SpriteAtlas
        },

        bottomFoldAtlas: {
            "default": null,
            type: cc.SpriteAtlas
        },

        pengPrefabSelf: {
            "default": null,
            type: cc.Prefab
        },

        pengPrefabLeft: {
            "default": null,
            type: cc.Prefab
        },

        emptyAtlas: {
            "default": null,
            type: cc.SpriteAtlas
        },

        holdsEmpty: {
            "default": [],
            type: [cc.SpriteFrame]
        },

        _sides: null,
        _pres: null,
        _foldPres: null
    },

    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sides = ["myself", "right", "up", "left"];
        this._pres = ["M_", "R_", "B_", "L_"];
        this._foldPres = ["B_", "R_", "B_", "L_"];
        cc.vv.mahjongmgr = this;
        //筒
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("dot_" + i);
        }

        //条
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("bamboo_" + i);
        }

        //万
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("character_" + i);
        }

        //中、发、白
        mahjongSprites.push("red");
        mahjongSprites.push("green");
        mahjongSprites.push("white");

        //东西南北风
        mahjongSprites.push("wind_east");
        mahjongSprites.push("wind_west");
        mahjongSprites.push("wind_south");
        mahjongSprites.push("wind_north");

        //春夏秋冬
        mahjongSprites.push("spring");
        mahjongSprites.push("summer");
        mahjongSprites.push("autumn");
        mahjongSprites.push("winter");

        //梅兰竹菊
        mahjongSprites.push("plum");
        mahjongSprites.push("orchid");
        mahjongSprites.push("bamboo");
        mahjongSprites.push("chrysanthemum");
    },

    getMahjongSpriteByID: function getMahjongSpriteByID(id) {
        return mahjongSprites[id];
    },

    getMahjongType: function getMahjongType(id) {
        if (id >= 0 && id < 9) {
            return 0;
        } else if (id >= 9 && id < 18) {
            return 1;
        } else if (id >= 18 && id < 27) {
            return 2;
        }
    },

    getSpriteFrameByMJID: function getSpriteFrameByMJID(pre, mjid) {
        var spriteFrameName = this.getMahjongSpriteByID(mjid);
        spriteFrameName = pre + spriteFrameName;
        if (pre == "M_") {
            return this.bottomAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "B_") {
            return this.bottomFoldAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "L_") {
            return this.leftAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "R_") {
            return this.rightAtlas.getSpriteFrame(spriteFrameName);
        }
    },

    getAudioURLByMJID: function getAudioURLByMJID(id) {
        var realId = 0;
        if (id >= 0 && id < 9) {
            realId = id + 21;
        } else if (id >= 9 && id < 18) {
            realId = id - 8;
        } else if (id >= 18 && id < 27) {
            realId = id - 7;
        }
        if (id == 30) {
            realId = 31;
        }

        if (id == 31) {
            realId = 41;
        }

        if (id == 32) {
            realId = 51;
        }

        if (id == 33) {
            realId = 61;
        }

        if (id == 27) {
            realId = 71;
        }

        if (id == 28) {
            realId = 81;
        }

        if (id == 29) {
            realId = 91;
        }

        return "nv/" + realId + ".mp3";
    },

    getEmptySpriteFrame: function getEmptySpriteFrame(side) {
        if (side == "up") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_up");
        } else if (side == "myself") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_bottom");
        } else if (side == "left") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_left");
        } else if (side == "right") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_right");
        }
    },

    getHoldsEmptySpriteFrame: function getHoldsEmptySpriteFrame(side) {
        if (side == "up") {
            return this.emptyAtlas.getSpriteFrame("e_mj_up");
        } else if (side == "myself") {
            return null;
        } else if (side == "left") {
            return this.emptyAtlas.getSpriteFrame("e_mj_left");
        } else if (side == "right") {
            return this.emptyAtlas.getSpriteFrame("e_mj_right");
        }
    },

    sortMJ: function sortMJ(mahjongs, dingque) {
        var self = this;
        mahjongs.sort(function (a, b) {
            if (dingque >= 0) {
                var t1 = self.getMahjongType(a);
                var t2 = self.getMahjongType(b);
                if (t1 != t2) {
                    if (dingque == t1) {
                        return 1;
                    } else if (dingque == t2) {
                        return -1;
                    }
                }
            }
            return a - b;
        });
    },

    getSide: function getSide(localIndex) {
        return this._sides[localIndex];
    },

    getPre: function getPre(localIndex) {
        return this._pres[localIndex];
    },

    getFoldPre: function getFoldPre(localIndex) {
        return this._foldPres[localIndex];
    }
});

cc._RFpop();
},{}],"Net":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b1cc9yRd15CXqFg0vTGKZUk', 'Net');
// scripts/Net.js

if (window.io == null) {
    window.io = require("socket-io");
}

var Global = cc.Class({
    "extends": cc.Component,
    statics: {
        ip: "",
        sio: null,
        isPinging: false,
        fnDisconnect: null,
        handlers: {},
        addHandler: function addHandler(event, fn) {
            if (this.handlers[event]) {
                console.log("event:" + event + "' handler has been registered.");
                return;
            }

            var handler = function handler(data) {
                //console.log(event + "(" + typeof(data) + "):" + (data? data.toString():"null"));
                if (event != "disconnect" && typeof data == "string") {
                    data = JSON.parse(data);
                }
                fn(data);
            };

            this.handlers[event] = handler;
            if (this.sio) {
                console.log("register:function " + event);
                this.sio.on(event, handler);
            }
        },
        connect: function connect(fnConnect, fnError) {
            var self = this;

            var opts = {
                'reconnection': false,
                'force new connection': true,
                'transports': ['websocket', 'polling']
            };
            this.sio = window.io.connect(this.ip, opts);
            this.sio.on('reconnect', function () {
                console.log('reconnection');
            });
            this.sio.on('connect', function (data) {
                self.sio.connected = true;
                fnConnect(data);
            });

            this.sio.on('disconnect', function (data) {
                console.log("disconnect");
                self.sio.connected = false;
                self.close();
            });

            this.sio.on('connect_failed', function () {
                console.log('connect_failed');
            });

            for (var key in this.handlers) {
                var value = this.handlers[key];
                if (typeof value == "function") {
                    if (key == 'disconnect') {
                        this.fnDisconnect = value;
                    } else {
                        console.log("register:function " + key);
                        this.sio.on(key, value);
                    }
                }
            }

            this.startHearbeat();
        },

        startHearbeat: function startHearbeat() {
            this.sio.on('game_pong', function () {
                console.log('game_pong');
                self.lastRecieveTime = Date.now();
            });
            this.lastRecieveTime = Date.now();
            var self = this;
            console.log(1);
            if (!self.isPinging) {
                console.log(1);
                self.isPinging = true;
                setInterval(function () {
                    console.log(3);
                    if (self.sio) {
                        console.log(4);
                        if (Date.now() - self.lastRecieveTime > 10000) {
                            self.close();
                        } else {
                            self.ping();
                        }
                    }
                }, 5000);
            }
        },
        send: function send(event, data) {
            if (this.sio.connected) {
                if (data != null && typeof data == "object") {
                    data = JSON.stringify(data);
                    //console.log(data);            
                }
                this.sio.emit(event, data);
            }
        },

        ping: function ping() {
            this.send('game_ping');
        },

        close: function close() {
            console.log('close');
            if (this.sio && this.sio.connected) {
                this.sio.connected = false;
                this.sio.disconnect();
                this.sio = null;
            }
            if (this.fnDisconnect) {
                this.fnDisconnect();
                this.fnDisconnect = null;
            }
        },

        test: function test(fnResult) {
            var xhr = null;
            var fn = function fn(ret) {
                fnResult(ret.isonline);
                xhr = null;
            };

            var arr = this.ip.split(':');
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                ip: arr[0],
                port: arr[1]
            };
            xhr = cc.vv.http.sendRequest("/is_server_online", data, fn);
            setTimeout(function () {
                if (xhr) {
                    xhr.abort();
                    fnResult(false);
                }
            }, 1500);
            /*
            var opts = {
                'reconnection':false,
                'force new connection': true,
                'transports':['websocket', 'polling']
            }
            var self = this;
            this.testsio = window.io.connect(this.ip,opts);
            this.testsio.on('connect',function(){
                console.log('connect');
                self.testsio.close();
                self.testsio = null;
                fnResult(true);
            });
            this.testsio.on('connect_error',function(){
                console.log('connect_failed');
                self.testsio = null;
                fnResult(false);
            });
            */
        }
    }
});

cc._RFpop();
},{"socket-io":"socket-io"}],"NoticeTip":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df61b4+FzFDvbpO5g8UNVIM', 'NoticeTip');
// scripts/components/NoticeTip.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _guohu: null,
        _info: null,
        _guohuTime: -1
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._guohu = cc.find("Canvas/tip_notice");
        this._guohu.active = false;

        this._info = cc.find("Canvas/tip_notice/info").getComponent(cc.Label);

        var self = this;
        this.node.on('push_notice', function (data) {
            var data = data.detail;
            self._guohu.active = true;
            self._guohuTime = data.time;
            self._info.string = data.info;
        });
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._guohuTime > 0) {
            this._guohuTime -= dt;
            if (this._guohuTime < 0) {
                this._guohu.active = false;
            }
        }
    }
});

cc._RFpop();
},{}],"OnBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6fd982Tyi5NOYJWt/fGY8Lj', 'OnBack');
// scripts/components/OnBack.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        var btn = this.node.getChildByName("btn_back");
        cc.vv.utils.addClickEvent(btn, this.node, "OnBack", "onBtnClicked");
    },

    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_back") {
            this.node.active = false;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"PengGangs":[function(require,module,exports){
"use strict";
cc._RFpush(module, '279d9pNFGRB3rD/ngr1LIXQ', 'PengGangs');
// scripts/components/PengGangs.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.vv) {
            return;
        }

        this.hidehuas();

        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName("myself");
        var pengangroot = myself.getChildByName("penggangs");
        var realwidth = cc.director.getVisibleSize().width;
        var scale = realwidth / 1280;
        pengangroot.scaleX *= scale;
        pengangroot.scaleY *= scale;

        var self = this;
        this.node.on('peng_notify', function (data) {
            //刷新所有的牌
            console.log("penggang plat");
            console.log(data.detail);
            var data = data.detail;
            self.onPengGangChanged(data);
        });

        this.node.on('gang_notify', function (data) {
            //刷新所有的牌
            //console.log(data.detail);
            var data = data.detail;
            self.onPengGangChanged(data.seatData);
        });

        this.node.on('chi_notify', function (data) {
            //刷新所有的牌
            console.log("penggang plat");
            console.log(data.detail);
            var data = data.detail;
            self.onPengGangChanged(data);
        });

        this.node.on('gethua_notify', function (data) {
            console.log("gethua_notify accept");
            //刷新所有的牌
            var data = data.detail;
            self.onHuaChanged(data);
        });

        this.node.on('game_begin', function (data) {
            self.onGameBein();
        });

        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            this.onPengGangChanged(seats[i]);
        }
    },

    //隐藏所有花牌
    hidehuas: function hidehuas() {
        //隐藏所有花牌
        var gameChild = this.node.getChildByName("game");
        var sides = new Array("right", "left", "up", "myself");
        for (var j = 0; j < 4; j++) {
            var side = gameChild.getChildByName(sides[j]);
            var huasroot = side.getChildByName("huas");
            for (var i = 0; i < huasroot.childrenCount; i++) {
                huasroot.children[i].active = false;
            }
        }
    },

    onGameBein: function onGameBein() {
        this.hideSide("myself");
        this.hideSide("right");
        this.hideSide("up");
        this.hideSide("left");
        this.hidehuas();
    },

    hideSide: function hideSide(side) {
        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName(side);
        var pengangroot = myself.getChildByName("penggangs");
        if (pengangroot) {
            for (var i = 0; i < pengangroot.childrenCount; ++i) {
                pengangroot.children[i].active = false;
            }
        }
    },

    onPengGangChanged: function onPengGangChanged(seatData) {

        if (seatData.angangs == null && seatData.diangangs == null && seatData.wangangs == null && seatData.pengs == null && seatData.chis == null) {
            return;
        }
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatData.seatindex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);

        console.log("localIndex = " + localIndex);
        console.log("side = " + side);
        console.log("pre = " + pre);
        console.log("onPengGangChanged" + localIndex);

        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName(side);
        var pengangroot = myself.getChildByName("penggangs");

        for (var i = 0; i < pengangroot.childrenCount; ++i) {
            pengangroot.children[i].active = false;
        }
        //初始化杠牌
        var index = 0;

        var gangs = seatData.angangs;
        for (var i = 0; i < gangs.length; ++i) {
            var mjid = gangs[i];
            this.initPengAndGangs(pengangroot, side, pre, index, mjid, "angang");
            index++;
        }
        var gangs = seatData.diangangs;
        for (var i = 0; i < gangs.length; ++i) {
            var mjid = gangs[i];
            this.initPengAndGangs(pengangroot, side, pre, index, mjid, "diangang");
            index++;
        }

        var gangs = seatData.wangangs;
        for (var i = 0; i < gangs.length; ++i) {
            var mjid = gangs[i];
            this.initPengAndGangs(pengangroot, side, pre, index, mjid, "wangang");
            index++;
        }

        //初始化碰牌
        var pengs = seatData.pengs;
        if (pengs) {
            for (var i = 0; i < pengs.length; ++i) {
                var mjid = pengs[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "peng");
                index++;
            }
        }

        //初始化吃牌
        console.log("初始化吃牌");
        console.log(seatData);
        var chis = seatData.chis;
        if (chis) {
            for (var i = 0; i < chis.length; ++i) {
                var mjid = chis[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "chi");
                index++;
            }
        }

        //初始化花牌
        console.log("初始化花牌");
        console.log(seatData);
        var huas = seatData.huas;
        if (huas) {
            for (var i = 0; i < huas.length; ++i) {
                var mjid = huas[i];
                this.onHuaChanged(seatData);
                index++;
            }
        }
    },

    initPengAndGangs: function initPengAndGangs(pengangroot, side, pre, index, mjid, flag) {
        var pgroot = null;
        if (pengangroot.childrenCount <= index) {
            if (side == "left" || side == "right") {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabLeft);
            } else {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabSelf);
            }

            pengangroot.addChild(pgroot);
        } else {
            pgroot = pengangroot.children[index];
            pgroot.active = true;
        }

        if (side == "left") {
            pgroot.y = -(index * 25 * 3);
        } else if (side == "right") {
            pgroot.y = index * 25 * 3;
            pgroot.setLocalZOrder(-index);
        } else if (side == "myself") {
            pgroot.x = index * 55 * 3 + index * 10;
        } else {
            pgroot.x = -(index * 55 * 3);
        }

        var sprites = pgroot.getComponentsInChildren(cc.Sprite);
        // if(flag == "chi"){
        //     console.log("排列吃！");
        //     console.log(mjid);
        //     for(var s = 0; s < 3; s++){
        //         var sprite = sprites[s];
        //         sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre,mjid[s]);
        //     }
        //     return;
        // }
        if (flag == "chi") {
            var mjid1 = [].concat(mjid);
            var pai = mjid1.pop();
            mjid1.sort(function (a, b) {
                return parseInt(a) - parseInt(b);
            });

            mjid1[2] = mjid1[1];
            mjid1[1] = mjid1[0];
            mjid1[0] = pai;
        }
        for (var s = 0; s < sprites.length; ++s) {
            console.log("in xunhuan");
            var sprite = sprites[s];
            if (sprite.node.name == "gang") {
                var isGang = flag != "peng";
                sprite.node.active = isGang;
                sprite.node.scaleX = 1.0;
                sprite.node.scaleY = 1.0;
                if (flag == "angang") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame(side);
                    if (side == "myself" || side == "up") {
                        sprite.node.scaleX = 1.4;
                        sprite.node.scaleY = 1.4;
                    }
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
                }
            } else {
                if (flag == "peng") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
                } else if (flag == "chi") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid1[s]);
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
                }
            }
        }
    },

    onHuaChanged: function onHuaChanged(seatData) {
        console.log("onHuaChanged!!!");
        console.log(seatData);
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatData.seatindex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);

        var gameChild = this.node.getChildByName("game");
        var side = gameChild.getChildByName(side);
        var huas = side.getChildByName("huas");

        console.log(side);
        console.log(huas);

        for (var i = 0; i < seatData.huas.length; i++) {
            console.log("show hua!" + seatData.huas[i]);
            var nowchild = huas.children[i];
            nowchild.active = true;
            console.log(nowchild.active);
            var sprite = nowchild.getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, seatData.huas[i]);
        }
    },

    initHuas: function initHuas() {}

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"PopupMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'bc0d2VLgL1Avo166tHLsjCJ', 'PopupMgr');
// scripts/components/PopupMgr.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _popuproot: null,
        _settings: null,
        _dissolveNotice: null,

        _endTime: -1,
        _extraInfo: null,
        _noticeLabel: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        cc.vv.popupMgr = this;

        this._popuproot = cc.find("Canvas/popups");
        this._settings = cc.find("Canvas/popups/settings");
        this._dissolveNotice = cc.find("Canvas/popups/dissolve_notice");
        this._noticeLabel = this._dissolveNotice.getChildByName("info").getComponent(cc.Label);

        this.closeAll();

        this.addBtnHandler("settings/btn_close");
        this.addBtnHandler("settings/btn_sqjsfj");
        this.addBtnHandler("dissolve_notice/btn_agree");
        this.addBtnHandler("dissolve_notice/btn_reject");
        this.addBtnHandler("dissolve_notice/btn_ok");

        var self = this;
        this.node.on("dissolve_notice", function (event) {
            var data = event.detail;
            self.showDissolveNotice(data);
        });

        this.node.on("dissolve_cancel", function (event) {
            self.closeAll();
        });
    },

    start: function start() {
        if (cc.vv.gameNetMgr.dissoveData) {
            this.showDissolveNotice(cc.vv.gameNetMgr.dissoveData);
        }
    },

    addBtnHandler: function addBtnHandler(btnName) {
        var btn = cc.find("Canvas/popups/" + btnName);
        this.addClickEvent(btn, this.node, "PopupMgr", "onBtnClicked");
    },

    addClickEvent: function addClickEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;

        var clickEvents = node.getComponent(cc.Button).clickEvents;
        clickEvents.push(eventHandler);
    },

    onBtnClicked: function onBtnClicked(event) {
        this.closeAll();
        var btnName = event.target.name;
        if (btnName == "btn_agree") {
            cc.vv.net.send("dissolve_agree");
        } else if (btnName == "btn_reject") {
            cc.vv.net.send("dissolve_reject");
        } else if (btnName == "btn_sqjsfj") {
            cc.vv.net.send("dissolve_request");
        }
    },

    closeAll: function closeAll() {
        this._popuproot.active = false;
        this._settings.active = false;
        this._dissolveNotice.active = false;
    },

    showSettings: function showSettings() {
        this.closeAll();
        this._popuproot.active = true;
        this._settings.active = true;
    },

    showDissolveRequest: function showDissolveRequest() {
        this.closeAll();
        this._popuproot.active = true;
    },

    showDissolveNotice: function showDissolveNotice(data) {
        this._endTime = Date.now() / 1000 + data.time;
        this._extraInfo = "";
        for (var i = 0; i < data.states.length; ++i) {
            var b = data.states[i];
            var name = cc.vv.gameNetMgr.seats[i].name;
            if (b) {
                this._extraInfo += "\n[已同意] " + name;
            } else {
                this._extraInfo += "\n[待确认] " + name;
            }
        }
        this.closeAll();
        this._popuproot.active = true;
        this._dissolveNotice.active = true;;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._endTime > 0) {
            var lastTime = this._endTime - Date.now() / 1000;
            if (lastTime < 0) {
                this._endTime = -1;
            }

            var m = Math.floor(lastTime / 60);
            var s = Math.ceil(lastTime - m * 60);

            var str = "";
            if (m > 0) {
                str += m + "分";
            }

            this._noticeLabel.string = str + s + "秒后房间将自动解散" + this._extraInfo;
        }
    }
});

cc._RFpop();
},{}],"RadioButton":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8d571y2U+9AiKntO+TSf0Fb', 'RadioButton');
// scripts/components/RadioButton.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        target: cc.Node,
        sprite: cc.SpriteFrame,
        checkedSprite: cc.SpriteFrame,
        checked: false,
        groupId: -1
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        if (cc.vv.radiogroupmgr == null) {
            var RadioGroupMgr = require("RadioGroupMgr");
            cc.vv.radiogroupmgr = new RadioGroupMgr();
            cc.vv.radiogroupmgr.init();
        }
        console.log(typeof cc.vv.radiogroupmgr.add);
        cc.vv.radiogroupmgr.add(this);

        this.refresh();
    },

    refresh: function refresh() {
        var targetSprite = this.target.getComponent(cc.Sprite);
        if (this.checked) {
            targetSprite.spriteFrame = this.checkedSprite;
        } else {
            targetSprite.spriteFrame = this.sprite;
        }
    },

    check: function check(value) {
        this.checked = value;
        this.refresh();
    },

    onClicked: function onClicked() {
        cc.vv.radiogroupmgr.check(this);
    },

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },

    onDestroy: function onDestroy() {
        if (cc.vv && cc.vv.radiogroupmgr) {
            cc.vv.radiogroupmgr.del(this);
        }
    }
});

cc._RFpop();
},{"RadioGroupMgr":"RadioGroupMgr"}],"RadioGroupMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '824eapeRYNKY4RJzg2Z4YA2', 'RadioGroupMgr');
// scripts/components/RadioGroupMgr.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _groups: null
    },

    // use this for initialization
    init: function init() {
        this._groups = {};
    },

    add: function add(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            buttons = [];
            this._groups[groupId] = buttons;
        }
        buttons.push(radioButton);
    },

    del: function del(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            return;
        }
        var idx = buttons.indexOf(radioButton);
        if (idx != -1) {
            buttons.splice(idx, 1);
        }
        if (buttons.length == 0) {
            delete this._groups[groupId];
        }
    },

    check: function check(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            return;
        }
        for (var i = 0; i < buttons.length; ++i) {
            var btn = buttons[i];
            if (btn == radioButton) {
                btn.check(true);
            } else {
                btn.check(false);
            }
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"ReConnect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7f553G0boRH6KrTE7wACaXx', 'ReConnect');
// scripts/components/ReConnect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _reconnect: null,
        _lblTip: null,
        _lastPing: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._reconnect = cc.find("Canvas/reconnect");
        this._lblTip = cc.find("Canvas/reconnect/tip").getComponent(cc.Label);
        var self = this;

        var fnTestServerOn = function fnTestServerOn() {
            cc.vv.net.test(function (ret) {
                if (ret) {
                    cc.director.loadScene('hall');
                } else {
                    setTimeout(fnTestServerOn, 3000);
                }
            });
        };

        var fn = function fn(data) {
            self.node.off('disconnect', fn);
            self._reconnect.active = true;
            fnTestServerOn();
        };
        console.log("adasfdasdfsdf");
        this.node.on('disconnect', fn);
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._reconnect.active) {
            var t = Math.floor(Date.now() / 1000) % 4;
            this._lblTip.string = "与服务器断开连接，正在尝试重连";
            for (var i = 0; i < t; ++i) {
                this._lblTip.string += '.';
            }
        }
    }
});

cc._RFpop();
},{}],"ReplayCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '21e6a+ajGNDTJwDHbV3A72m', 'ReplayCtrl');
// scripts/components/ReplayCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _nextPlayTime: 1,
        _replay: null,
        _isPlaying: true
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this._replay = cc.find("Canvas/replay");
        this._replay.active = cc.vv.replayMgr.isReplay();
    },

    onBtnPauseClicked: function onBtnPauseClicked() {
        this._isPlaying = false;
    },

    onBtnPlayClicked: function onBtnPlayClicked() {
        this._isPlaying = true;
    },

    onBtnBackClicked: function onBtnBackClicked() {
        cc.vv.replayMgr.clear();
        cc.vv.gameNetMgr.reset();
        cc.vv.gameNetMgr.roomId = null;
        cc.director.loadScene("hall");
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (cc.vv) {
            if (this._isPlaying && cc.vv.replayMgr.isReplay() == true && this._nextPlayTime > 0) {
                this._nextPlayTime -= dt;
                if (this._nextPlayTime < 0) {
                    this._nextPlayTime = cc.vv.replayMgr.takeAction();
                }
            }
        }
    }
});

cc._RFpop();
},{}],"ReplayMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1a6a1p86NFL6KZEZCnbu7tt', 'ReplayMgr');
// scripts/ReplayMgr.js

var ACTION_CHUPAI = 1;
var ACTION_MOPAI = 2;
var ACTION_PENG = 3;
var ACTION_GANG = 4;
var ACTION_HU = 5;

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _lastAction: null,
        _actionRecords: null,
        _currentIndex: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clear: function clear() {
        this._lastAction = null;
        this._actionRecords = null;
        this._currentIndex = 0;
    },

    init: function init(data) {
        this._actionRecords = data.action_records;
        if (this._actionRecords == null) {
            this._actionRecords = {};
        }
        this._currentIndex = 0;
        this._lastAction = null;
    },

    isReplay: function isReplay() {
        return this._actionRecords != null;
    },

    getNextAction: function getNextAction() {
        if (this._currentIndex >= this._actionRecords.length) {
            return null;
        }

        var si = this._actionRecords[this._currentIndex++];
        var action = this._actionRecords[this._currentIndex++];
        var pai = this._actionRecords[this._currentIndex++];
        return { si: si, type: action, pai: pai };
    },

    takeAction: function takeAction() {
        var action = this.getNextAction();
        if (this._lastAction != null && this._lastAction.type == ACTION_CHUPAI) {
            if (action != null && action.type != ACTION_PENG && action.type != ACTION_GANG && action.type != ACTION_HU) {
                cc.vv.gameNetMgr.doGuo(this._lastAction.si, this._lastAction.pai);
            }
        }
        this._lastAction = action;
        if (action == null) {
            return -1;
        }
        var nextActionDelay = 1.0;
        if (action.type == ACTION_CHUPAI) {
            //console.log("chupai");
            cc.vv.gameNetMgr.doChupai(action.si, action.pai);
            return 1.0;
        } else if (action.type == ACTION_MOPAI) {
            //console.log("mopai");
            cc.vv.gameNetMgr.doMopai(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 0.5;
        } else if (action.type == ACTION_PENG) {
            //console.log("peng");
            cc.vv.gameNetMgr.doPeng(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 1.0;
        } else if (action.type == ACTION_GANG) {
            //console.log("gang");
            cc.vv.gameNetMgr.dispatchEvent('hangang_notify', action.si);
            cc.vv.gameNetMgr.doGang(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 1.0;
        } else if (action.type == ACTION_HU) {
            //console.log("hu");
            cc.vv.gameNetMgr.doHu({ seatindex: action.si, hupai: action.pai, iszimo: false });
            return 1.5;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"Seat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '820870ltMZNDYlvzr+qCDEJ', 'Seat');
// scripts/components/Seat.js

cc.Class({
    "extends": cc.Component,

    properties: {
        _sprIcon: null,
        _zhuang: null,
        _ready: null,
        _offline: null,
        _lblName: null,
        _lblScore: null,
        _scoreBg: null,
        _nddayingjia: null,
        _voicemsg: null,

        _chatBubble: null,
        _emoji: null,
        _lastChatTime: -1,

        _userName: "",
        _score: 0,
        _dayingjia: false,
        _isOffline: false,
        _isReady: false,
        _isZhuang: false,
        _userId: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this._sprIcon = this.node.getChildByName("icon").getComponent("ImageLoader");
        this._lblName = this.node.getChildByName("name").getComponent(cc.Label);
        this._lblScore = this.node.getChildByName("score").getComponent(cc.Label);
        this._voicemsg = this.node.getChildByName("voicemsg");
        this._xuanpai = this.node.getChildByName("xuanpai");
        this.refreshXuanPaiState();

        if (this._voicemsg) {
            this._voicemsg.active = false;
        }

        if (this._sprIcon && this._sprIcon.getComponent(cc.Button)) {
            cc.vv.utils.addClickEvent(this._sprIcon, this.node, "Seat", "onIconClicked");
        }

        this._offline = this.node.getChildByName("offline");

        this._ready = this.node.getChildByName("ready");

        this._zhuang = this.node.getChildByName("zhuang");

        this._scoreBg = this.node.getChildByName("Z_money_frame");
        this._nddayingjia = this.node.getChildByName("dayingjia");

        this._chatBubble = this.node.getChildByName("ChatBubble");
        if (this._chatBubble != null) {
            this._chatBubble.active = false;
        }

        this._emoji = this.node.getChildByName("emoji");
        if (this._emoji != null) {
            this._emoji.active = false;
        }

        this.refresh();

        if (this._sprIcon && this._userId) {
            this._sprIcon.setUserID(this._userId);
        }
    },

    onIconClicked: function onIconClicked() {
        var iconSprite = this._sprIcon.node.getComponent(cc.Sprite);
        if (this._userId != null && this._userId > 0) {
            var seat = cc.vv.gameNetMgr.getSeatByID(this._userId);
            var sex = 0;
            if (cc.vv.baseInfoMap) {
                var info = cc.vv.baseInfoMap[this._userId];
                if (info) {
                    sex = info.sex;
                }
            }
            cc.vv.userinfoShow.show(seat.name, seat.userid, iconSprite, sex, seat.ip);
        }
    },

    refresh: function refresh() {
        if (this._lblName != null) {
            this._lblName.string = this._userName;
        }

        if (this._lblScore != null) {
            this._lblScore.string = this._score;
        }

        if (this._nddayingjia != null) {
            this._nddayingjia.active = this._dayingjia == true;
        }

        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }

        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }

        if (this._zhuang) {
            this._zhuang.active = this._isZhuang;
        }

        this.node.active = this._userName != null && this._userName != "";
    },

    setInfo: function setInfo(name, score, dayingjia) {
        this._userName = name;
        this._score = score;
        if (this._score == null) {
            this._score = 0;
        }
        this._dayingjia = dayingjia;

        if (this._scoreBg != null) {
            this._scoreBg.active = this._score != null;
        }

        if (this._lblScore != null) {
            this._lblScore.node.active = this._score != null;
        }

        this.refresh();
    },

    setZhuang: function setZhuang(value) {
        if (this._zhuang) {
            this._zhuang.active = value;
        }
    },

    setReady: function setReady(isReady) {
        this._isReady = isReady;
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
    },

    setID: function setID(id) {
        var idNode = this.node.getChildByName("id");
        if (idNode) {
            var lbl = idNode.getComponent(cc.Label);
            lbl.string = "ID:" + id;
        }

        this._userId = id;
        if (this._sprIcon) {
            this._sprIcon.setUserID(id);
        }
    },

    setOffline: function setOffline(isOffline) {
        this._isOffline = isOffline;
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
    },

    chat: function chat(content) {
        if (this._chatBubble == null || this._emoji == null) {
            return;
        }
        this._emoji.active = false;
        this._chatBubble.active = true;
        this._chatBubble.getComponent(cc.Label).string = content;
        this._chatBubble.getChildByName("New Label").getComponent(cc.Label).string = content;
        this._lastChatTime = 3;
    },

    emoji: function emoji(_emoji) {
        //emoji = JSON.parse(emoji);
        if (this._emoji == null || this._emoji == null) {
            return;
        }
        console.log(_emoji);
        this._chatBubble.active = false;
        this._emoji.active = true;
        this._emoji.getComponent(cc.Animation).play(_emoji);
        this._lastChatTime = 3;
    },

    voiceMsg: function voiceMsg(show) {
        if (this._voicemsg) {
            this._voicemsg.active = show;
        }
    },

    refreshXuanPaiState: function refreshXuanPaiState() {
        if (this._xuanpai == null) {
            return;
        }

        this._xuanpai.active = cc.vv.gameNetMgr.isHuanSanZhang;
        if (cc.vv.gameNetMgr.isHuanSanZhang == false) {
            return;
        }

        this._xuanpai.getChildByName("xz").active = false;
        this._xuanpai.getChildByName("xd").active = false;

        var seat = cc.vv.gameNetMgr.getSeatByID(this._userId);
        if (seat) {
            if (seat.huanpais == null) {
                this._xuanpai.getChildByName("xz").active = true;
            } else {
                this._xuanpai.getChildByName("xd").active = true;
            }
        }
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._lastChatTime > 0) {
            this._lastChatTime -= dt;
            if (this._lastChatTime < 0) {
                this._chatBubble.active = false;
                this._emoji.active = false;
                this._emoji.getComponent(cc.Animation).stop();
            }
        }
    }
});

cc._RFpop();
},{}],"Settings":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4c04fyd89JAZY7qGjvubi+f', 'Settings');
// scripts/components/Settings.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _btnYXOpen: null,
        _btnYXClose: null,
        _btnYYOpen: null,
        _btnYYClose: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this._btnYXOpen = this.node.getChildByName("yinxiao").getChildByName("btn_yx_open");
        this._btnYXClose = this.node.getChildByName("yinxiao").getChildByName("btn_yx_close");

        this._btnYYOpen = this.node.getChildByName("yinyue").getChildByName("btn_yy_open");
        this._btnYYClose = this.node.getChildByName("yinyue").getChildByName("btn_yy_close");

        this.initButtonHandler(this.node.getChildByName("btn_close"));
        this.initButtonHandler(this.node.getChildByName("btn_exit"));

        this.initButtonHandler(this._btnYXOpen);
        this.initButtonHandler(this._btnYXClose);
        this.initButtonHandler(this._btnYYOpen);
        this.initButtonHandler(this._btnYYClose);

        var slider = this.node.getChildByName("yinxiao").getChildByName("progress");
        cc.vv.utils.addSlideEvent(slider, this.node, "Settings", "onSlided");

        var slider = this.node.getChildByName("yinyue").getChildByName("progress");
        cc.vv.utils.addSlideEvent(slider, this.node, "Settings", "onSlided");

        this.refreshVolume();
    },

    onSlided: function onSlided(slider) {
        if (slider.node.parent.name == "yinxiao") {
            cc.vv.audioMgr.setSFXVolume(slider.progress);
        } else if (slider.node.parent.name == "yinyue") {
            cc.vv.audioMgr.setBGMVolume(slider.progress);
        }
        this.refreshVolume();
    },

    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "Settings", "onBtnClicked");
    },

    refreshVolume: function refreshVolume() {

        this._btnYXClose.active = cc.vv.audioMgr.sfxVolume > 0;
        this._btnYXOpen.active = !this._btnYXClose.active;

        var yx = this.node.getChildByName("yinxiao");
        var width = 368 * cc.vv.audioMgr.sfxVolume;
        var progress = yx.getChildByName("progress");
        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.sfxVolume;
        progress.getChildByName("progress").width = width;
        //yx.getChildByName("btn_progress").x = progress.x + width;

        this._btnYYClose.active = cc.vv.audioMgr.bgmVolume > 0;
        this._btnYYOpen.active = !this._btnYYClose.active;
        var yy = this.node.getChildByName("yinyue");
        var width = 368 * cc.vv.audioMgr.bgmVolume;
        var progress = yy.getChildByName("progress");
        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.bgmVolume;

        progress.getChildByName("progress").width = width;
        //yy.getChildByName("btn_progress").x = progress.x + width;
    },

    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_close") {
            this.node.active = false;
        } else if (event.target.name == "btn_exit") {
            cc.sys.localStorage.removeItem("wx_account");
            cc.sys.localStorage.removeItem("wx_sign");
            cc.director.loadScene("login");
        } else if (event.target.name == "btn_yx_open") {
            cc.vv.audioMgr.setSFXVolume(1.0);
            this.refreshVolume();
        } else if (event.target.name == "btn_yx_close") {
            cc.vv.audioMgr.setSFXVolume(0);
            this.refreshVolume();
        } else if (event.target.name == "btn_yy_open") {
            cc.vv.audioMgr.setBGMVolume(1);
            this.refreshVolume();
        } else if (event.target.name == "btn_yy_close") {
            cc.vv.audioMgr.setBGMVolume(0);
            this.refreshVolume();
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"TimePointer":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5b586erPK1H5bFfrMKWs+Y6', 'TimePointer');
// scripts/components/TimePointer.js

cc.Class({
    "extends": cc.Component,

    properties: {
        _arrow: null,
        _pointer: null,
        _timeLabel: null,
        _time: -1,
        _alertTime: -1
    },

    // foo: {
    //    default: null,
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    // use this for initialization
    onLoad: function onLoad() {
        var gameChild = this.node.getChildByName("game");
        this._arrow = gameChild.getChildByName("arrow");
        this._pointer = this._arrow.getChildByName("pointer");
        this.initPointer();

        this._timeLabel = this._arrow.getChildByName("lblTime").getComponent(cc.Label);
        this._timeLabel.string = "00";

        var self = this;

        this.node.on('game_begin', function (data) {
            self.initPointer();
        });

        this.node.on('game_chupai', function (data) {
            self.initPointer();
            self._time = 10;
            self._alertTime = 3;
        });
    },

    initPointer: function initPointer() {

        if (cc.vv == null) {
            return;
        }

        this._arrow.active = cc.vv.gameNetMgr.gamestate == "playing";
        if (!this._arrow.active) {
            return;
        }
        var turn = cc.vv.gameNetMgr.turn;
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(turn);
        for (var i = 0; i < this._pointer.children.length; ++i) {
            this._pointer.children[i].active = i == localIndex;
        }

        //旋转风向
        var button = cc.vv.gameNetMgr.button;
        var seatindex = cc.vv.gameNetMgr.seatIndex;
        var arrow_frame = this._arrow.getChildByName("Z_arrow_frame");
        var dis = seatindex - button;
        arrow_frame.rotation = dis * 90;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._time > 0) {
            this._time -= dt;
            if (this._alertTime > 0 && this._time < this._alertTime) {
                cc.vv.audioMgr.playSFX("timeup_alarm.mp3");
                this._alertTime = -1;
            }
            var pre = "";
            if (this._time < 0) {
                this._time = 0;
            }

            var t = Math.ceil(this._time);
            if (t < 10) {
                pre = "0";
            }
            this._timeLabel.string = pre + t;
        }
    }
});

cc._RFpop();
},{}],"UserInfoShow":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'fe4f16CAmpBlZphnpsH1ETv', 'UserInfoShow');
// scripts/components/UserInfoShow.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _userinfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }

        this._userinfo = cc.find("Canvas/userinfo");
        this._userinfo.active = false;
        cc.vv.utils.addClickEvent(this._userinfo, this.node, "UserInfoShow", "onClicked");

        cc.vv.userinfoShow = this;
    },

    show: function show(name, userId, iconSprite, sex, ip) {
        if (userId != null && userId > 0) {
            this._userinfo.active = true;
            this._userinfo.getChildByName("icon").getComponent(cc.Sprite).spriteFrame = iconSprite.spriteFrame;
            this._userinfo.getChildByName("name").getComponent(cc.Label).string = name;
            this._userinfo.getChildByName("ip").getComponent(cc.Label).string = "IP: " + ip.replace("::ffff:", "");
            this._userinfo.getChildByName("id").getComponent(cc.Label).string = "ID: " + userId;

            var sex_female = this._userinfo.getChildByName("sex_female");
            sex_female.active = false;

            var sex_male = this._userinfo.getChildByName("sex_male");
            sex_male.active = false;

            if (sex == 1) {
                sex_male.active = true;
            } else if (sex == 2) {
                sex_female.active = true;
            }
        }
    },

    onClicked: function onClicked() {
        this._userinfo.active = false;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"UserMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '74d78JBqHdDKY6hckY2YuL+', 'UserMgr');
// scripts/UserMgr.js

cc.Class({
    "extends": cc.Component,
    properties: {
        account: null,
        userId: null,
        userName: null,
        lv: 0,
        exp: 0,
        coins: 0,
        gems: 0,
        sign: 0,
        ip: "",
        sex: 0,
        roomData: null,
        oldRoomId: null
    },

    guestAuth: function guestAuth() {
        var account = cc.args["account"];
        if (account == null) {
            account = cc.sys.localStorage.getItem("account");
        }

        if (account == null) {
            account = Date.now();
            cc.sys.localStorage.setItem("account", account);
        }

        cc.vv.http.sendRequest("/guest", { account: account }, this.onAuth);
    },

    onAuth: function onAuth(ret) {
        var self = cc.vv.userMgr;
        if (ret.errcode !== 0) {
            console.log(ret.errmsg);
        } else {
            self.account = ret.account;
            self.sign = ret.sign;
            cc.vv.http.url = "http://" + cc.vv.SI.hall;
            self.login();
        }
    },

    login: function login() {
        var self = this;
        var onLogin = function onLogin(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                if (!ret.userid) {
                    //jump to register user info.
                    cc.director.loadScene("createrole");
                } else {
                    console.log(ret);
                    self.account = ret.account;
                    self.userId = ret.userid;
                    self.userName = ret.name;
                    self.lv = ret.lv;
                    self.exp = ret.exp;
                    self.coins = ret.coins;
                    self.gems = ret.gems;
                    self.roomData = ret.roomid;
                    self.sex = ret.sex;
                    self.ip = ret.ip;
                    cc.director.loadScene("hall");
                }
            }
        };
        cc.vv.wc.show("正在登录游戏");
        cc.vv.http.sendRequest("/login", { account: this.account, sign: this.sign }, onLogin);
    },

    create: function create(name) {
        var self = this;
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                self.login();
            }
        };

        var data = {
            account: this.account,
            sign: this.sign,
            name: name
        };
        cc.vv.http.sendRequest("/create_user", data, onCreate);
    },

    enterRoom: function enterRoom(roomId, callback) {
        var self = this;
        var onEnter = function onEnter(ret) {
            if (ret.errcode !== 0) {
                if (ret.errcode == -1) {
                    setTimeout(function () {
                        self.enterRoom(roomId, callback);
                    }, 5000);
                } else {
                    cc.vv.wc.hide();
                    if (callback != null) {
                        callback(ret);
                    }
                }
            } else {
                if (callback != null) {
                    callback(ret);
                }
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            roomid: roomId
        };
        cc.vv.wc.show("正在进入房间 " + roomId);
        cc.vv.http.sendRequest("/enter_private_room", data, onEnter);
    },
    getHistoryList: function getHistoryList(callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.history);
                if (callback != null) {
                    callback(ret.history);
                }
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_history_list", data, onGet);
    },
    getGamesOfRoom: function getGamesOfRoom(uuid, callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.data);
                callback(ret.data);
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            uuid: uuid
        };
        cc.vv.http.sendRequest("/get_games_of_room", data, onGet);
    },

    getDetailOfGame: function getDetailOfGame(uuid, index, callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.data);
                callback(ret.data);
            }
        };

        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            uuid: uuid,
            index: index
        };
        cc.vv.http.sendRequest("/get_detail_of_game", data, onGet);
    }
});

cc._RFpop();
},{}],"Utils":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b717fzww0hNzIqvNbb1t9wx', 'Utils');
// scripts/Utils.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    addClickEvent: function addClickEvent(node, target, component, handler) {
        console.log(component + ":" + handler);
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;

        var clickEvents = node.getComponent(cc.Button).clickEvents;
        clickEvents.push(eventHandler);
    },

    addSlideEvent: function addSlideEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;

        var slideEvents = node.getComponent(cc.Slider).slideEvents;
        slideEvents.push(eventHandler);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"VoiceMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1f066RbLAxKGJZtkDFO2kq/', 'VoiceMgr');
// scripts/VoiceMgr.js

var radix = 12;
var base = 128 - radix;
function crypto(value) {
    value -= base;
    var h = Math.floor(value / radix) + base;
    var l = value % radix + base;
    return String.fromCharCode(h) + String.fromCharCode(l);
}

var encodermap = {};
var decodermap = {};
for (var i = 0; i < 256; ++i) {
    var code = null;
    var v = i + 1;
    if (v >= base) {
        code = crypto(v);
    } else {
        code = String.fromCharCode(v);
    }

    encodermap[i] = code;
    decodermap[code] = i;
}

function encode(data) {
    var content = "";
    var len = data.length;
    var a = len >> 24 & 0xff;
    var b = len >> 16 & 0xff;
    var c = len >> 8 & 0xff;
    var d = len & 0xff;
    content += encodermap[a];
    content += encodermap[b];
    content += encodermap[c];
    content += encodermap[d];
    for (var i = 0; i < data.length; ++i) {
        content += encodermap[data[i]];
    }
    return content;
}

function getCode(content, index) {
    var c = content.charCodeAt(index);
    if (c >= base) {
        c = content.charAt(index) + content.charAt(index + 1);
    } else {
        c = content.charAt(index);
    }
    return c;
}
function decode(content) {
    var index = 0;
    var len = 0;
    for (var i = 0; i < 4; ++i) {
        var c = getCode(content, index);
        index += c.length;
        var v = decodermap[c];
        len |= v << (3 - i) * 8;
    }

    var newData = new Uint8Array(len);
    var cnt = 0;
    while (index < content.length) {
        var c = getCode(content, index);
        index += c.length;
        newData[cnt] = decodermap[c];
        cnt++;
    }
    return newData;
}

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        onPlayCallback: null,
        _voiceMediaPath: null
    },

    // use this for initialization
    init: function init() {
        /*
        var url = cc.url.raw("resources/test.amr");
        var fileData = jsb.fileUtils.getDataFromFile(url);
        var content = "";
        var sep = "";
        for(var i = 0; i < fileData.length; ++i){
            content += sep + fileData[i];
            sep = ",";
        }
        
        var url = cc.url.raw("resources/test.txt");
        jsb.fileUtils.writeStringToFile(content,url);
        
        var url = cc.url.raw("resources/test2.amrs");
        var content = encode(fileData);
        jsb.fileUtils.writeStringToFile(content,url);
        
        var url = cc.url.raw("resources/test2.amr");
        jsb.fileUtils.writeDataToFile(decode(content),url);
        */

        if (cc.sys.isNative) {
            this._voiceMediaPath = jsb.fileUtils.getWritablePath() + "/voicemsgs/";
            this.setStorageDir(this._voiceMediaPath);
        }
    },

    prepare: function prepare(filename) {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.pauseAll();
        this.clearCache(filename);
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "prepare", "(Ljava/lang/String;)V", filename);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "prepareRecord:", filename);
        }
    },

    release: function release() {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.resumeAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "release", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "finishRecord");
        }
    },

    cancel: function cancel() {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.resumeAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "cancel", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "cancelRecord");
        }
    },

    writeVoice: function writeVoice(filename, voiceData) {
        if (!cc.sys.isNative) {
            return;
        }
        if (voiceData && voiceData.length > 0) {
            var fileData = decode(voiceData);
            var url = this._voiceMediaPath + filename;
            this.clearCache(filename);
            jsb.fileUtils.writeDataToFile(fileData, url);
        }
    },

    clearCache: function clearCache(filename) {
        if (cc.sys.isNative) {
            var url = this._voiceMediaPath + filename;
            //console.log("check file:" + url);
            if (jsb.fileUtils.isFileExist(url)) {
                //console.log("remove:" + url);
                jsb.fileUtils.removeFile(url);
            }
            if (jsb.fileUtils.isFileExist(url + ".wav")) {
                //console.log("remove:" + url + ".wav");
                jsb.fileUtils.removeFile(url + ".wav");
            }
        }
    },

    play: function play(filename) {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.pauseAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoicePlayer", "play", "(Ljava/lang/String;)V", filename);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "play:", filename);
        } else {}
    },

    stop: function stop() {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.resumeAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoicePlayer", "stop", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "stopPlay");
        } else {}
    },

    getVoiceLevel: function getVoiceLevel(maxLevel) {
        return Math.floor(Math.random() * maxLevel + 1);
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            return jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "getVoiceLevel", "(I)I", maxLevel);
        } else if (cc.sys.os == cc.sys.OS_IOS) {} else {
            return Math.floor(Math.random() * maxLevel + 1);
        }
    },

    getVoiceData: function getVoiceData(filename) {
        if (cc.sys.isNative) {
            var url = this._voiceMediaPath + filename;
            console.log("getVoiceData:" + url);
            var fileData = jsb.fileUtils.getDataFromFile(url);
            if (fileData) {
                var content = encode(fileData);
                return content;
            }
        }
        return "";
    },

    download: function download() {},
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },

    setStorageDir: function setStorageDir(dir) {
        if (!cc.sys.isNative) {
            return;
        }
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "setStorageDir", "(Ljava/lang/String;)V", dir);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "setStorageDir:", dir);
            if (!jsb.fileUtils.isDirectoryExist(dir)) {
                jsb.fileUtils.createDirectory(dir);
            }
        }
    }
});

cc._RFpop();
},{}],"Voice":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f6db9z0CxdEzpRVgU569dDu', 'Voice');
// scripts/components/Voice.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _lastTouchTime: null,
        _voice: null,
        _volume: null,
        _voice_failed: null,
        _lastCheckTime: -1,
        _timeBar: null,
        MAX_TIME: 15000
    },

    // use this for initialization
    onLoad: function onLoad() {

        this._voice = cc.find("Canvas/voice");
        this._voice.active = false;

        this._voice_failed = cc.find("Canvas/voice/voice_failed");
        this._voice_failed.active = false;

        this._timeBar = cc.find("Canvas/voice/time");
        this._timeBar.scaleX = 0.0;

        this._volume = cc.find("Canvas/voice/volume");
        for (var i = 1; i < this._volume.children.length; ++i) {
            this._volume.children[i].active = false;
        }

        var btnVoice = cc.find("Canvas/voice/voice_failed/btn_ok");
        if (btnVoice) {
            cc.vv.utils.addClickEvent(btnVoice, this.node, "Voice", "onBtnOKClicked");
        }

        var self = this;
        var btnVoice = cc.find("Canvas/btn_voice");
        if (btnVoice) {
            btnVoice.on(cc.Node.EventType.TOUCH_START, function () {
                console.log("cc.Node.EventType.TOUCH_START");
                cc.vv.voiceMgr.prepare("record.amr");
                self._lastTouchTime = Date.now();
                self._voice.active = true;
                self._voice_failed.active = false;
            });

            btnVoice.on(cc.Node.EventType.TOUCH_MOVE, function () {
                console.log("cc.Node.EventType.TOUCH_MOVE");
            });

            btnVoice.on(cc.Node.EventType.TOUCH_END, function () {
                console.log("cc.Node.EventType.TOUCH_END");
                if (Date.now() - self._lastTouchTime < 1000) {
                    self._voice_failed.active = true;
                    cc.vv.voiceMgr.cancel();
                } else {
                    self.onVoiceOK();
                }
                self._lastTouchTime = null;
            });

            btnVoice.on(cc.Node.EventType.TOUCH_CANCEL, function () {
                console.log("cc.Node.EventType.TOUCH_CANCEL");
                cc.vv.voiceMgr.cancel();
                self._lastTouchTime = null;
                self._voice.active = false;
            });
        }
    },

    onVoiceOK: function onVoiceOK() {
        if (this._lastTouchTime != null) {
            cc.vv.voiceMgr.release();
            var time = Date.now() - this._lastTouchTime;
            var msg = cc.vv.voiceMgr.getVoiceData("record.amr");
            cc.vv.net.send("voice_msg", { msg: msg, time: time });
        }
        this._voice.active = false;
    },

    onBtnOKClicked: function onBtnOKClicked() {
        this._voice.active = false;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._voice.active == true && this._voice_failed.active == false) {
            if (Date.now() - this._lastCheckTime > 300) {
                for (var i = 0; i < this._volume.children.length; ++i) {
                    this._volume.children[i].active = false;
                }
                var v = cc.vv.voiceMgr.getVoiceLevel(7);
                if (v >= 1 && v <= 7) {
                    this._volume.children[v - 1].active = true;
                }
                this._lastCheckTime = Date.now();
            }
        }

        if (this._lastTouchTime) {
            var time = Date.now() - this._lastTouchTime;
            if (time >= this.MAX_TIME) {
                this.onVoiceOK();
                this._lastTouchTime = null;
            } else {
                var percent = time / this.MAX_TIME;
                this._timeBar.scaleX = 1 - percent;
            }
        }
    }
});

cc._RFpop();
},{}],"WaitingConnection":[function(require,module,exports){
"use strict";
cc._RFpush(module, '10e32jDstpLhIGHWrQEq2vN', 'WaitingConnection');
// scripts/components/WaitingConnection.js

cc.Class({
    "extends": cc.Component,
    properties: {
        target: cc.Node,
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _isShow: false,
        lblContent: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return null;
        }

        cc.vv.wc = this;
        this.node.active = this._isShow;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        this.target.rotation = this.target.rotation - dt * 45;
    },

    show: function show(content) {
        this._isShow = true;
        if (this.node) {
            this.node.active = this._isShow;
        }
        if (this.lblContent) {
            if (content == null) {
                content = "";
            }
            this.lblContent.string = content;
        }
    },
    hide: function hide() {
        this._isShow = false;
        if (this.node) {
            this.node.active = this._isShow;
        }
    }
});

cc._RFpop();
},{}],"socket-io":[function(require,module,exports){
(function (global){
"use strict";
cc._RFpush(module, '393290vPc1IIYfh8FrmxcNZ', 'socket-io');
// scripts/3rdparty/socket-io.js

if (!CC_JSB && !cc.sys.isNative) {
	(function (f) {
		if (typeof exports === "object" && typeof module !== "undefined") {
			module.exports = f();
		} else if (typeof define === "function" && define.amd) {
			define([], f);
		} else {
			var g;if (typeof window !== "undefined") {
				g = window;
			} else if (typeof global !== "undefined") {
				g = global;
			} else if (typeof self !== "undefined") {
				g = self;
			} else {
				g = this;
			}g.io = f();
		}
	})(function () {
		var define, module, exports;return (function e(t, n, r) {
			function s(o, u) {
				if (!n[o]) {
					if (!t[o]) {
						var a = typeof require == "function" && require;if (!u && a) return a(o, !0);if (i) return i(o, !0);var f = new Error("Cannot find module '" + o + "'");throw (f.code = "MODULE_NOT_FOUND", f);
					}var l = n[o] = { exports: {} };t[o][0].call(l.exports, function (e) {
						var n = t[o][1][e];return s(n ? n : e);
					}, l, l.exports, e, t, n, r);
				}return n[o].exports;
			}var i = typeof require == "function" && require;for (var o = 0; o < r.length; o++) s(r[o]);return s;
		})({ 1: [function (_dereq_, module, exports) {

				module.exports = _dereq_('./lib/');
			}, { "./lib/": 2 }], 2: [function (_dereq_, module, exports) {

				module.exports = _dereq_('./socket');

				/**
     * Exports parser
     *
     * @api public
     *
     */
				module.exports.parser = _dereq_('engine.io-parser');
			}, { "./socket": 3, "engine.io-parser": 19 }], 3: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var transports = _dereq_('./transports');
					var Emitter = _dereq_('component-emitter');
					var debug = _dereq_('debug')('engine.io-client:socket');
					var index = _dereq_('indexof');
					var parser = _dereq_('engine.io-parser');
					var parseuri = _dereq_('parseuri');
					var parsejson = _dereq_('parsejson');
					var parseqs = _dereq_('parseqs');

					/**
      * Module exports.
      */

					module.exports = Socket;

					/**
      * Noop function.
      *
      * @api private
      */

					function noop() {}

					/**
      * Socket constructor.
      *
      * @param {String|Object} uri or options
      * @param {Object} options
      * @api public
      */

					function Socket(uri, opts) {
						if (!(this instanceof Socket)) return new Socket(uri, opts);

						opts = opts || {};

						if (uri && 'object' == typeof uri) {
							opts = uri;
							uri = null;
						}

						if (uri) {
							uri = parseuri(uri);
							opts.hostname = uri.host;
							opts.secure = uri.protocol == 'https' || uri.protocol == 'wss';
							opts.port = uri.port;
							if (uri.query) opts.query = uri.query;
						} else if (opts.host) {
							opts.hostname = parseuri(opts.host).host;
						}

						this.secure = null != opts.secure ? opts.secure : global.location && 'https:' == location.protocol;

						if (opts.hostname && !opts.port) {
							// if no port is specified manually, use the protocol default
							opts.port = this.secure ? '443' : '80';
						}

						this.agent = opts.agent || false;
						this.hostname = opts.hostname || (global.location ? location.hostname : 'localhost');
						this.port = opts.port || (global.location && location.port ? location.port : this.secure ? 443 : 80);
						this.query = opts.query || {};
						if ('string' == typeof this.query) this.query = parseqs.decode(this.query);
						this.upgrade = false !== opts.upgrade;
						this.path = (opts.path || '/engine.io').replace(/\/$/, '') + '/';
						this.forceJSONP = !!opts.forceJSONP;
						this.jsonp = false !== opts.jsonp;
						this.forceBase64 = !!opts.forceBase64;
						this.enablesXDR = !!opts.enablesXDR;
						this.timestampParam = opts.timestampParam || 't';
						this.timestampRequests = opts.timestampRequests;
						this.transports = opts.transports || ['polling', 'websocket'];
						this.readyState = '';
						this.writeBuffer = [];
						this.policyPort = opts.policyPort || 843;
						this.rememberUpgrade = opts.rememberUpgrade || false;
						this.binaryType = null;
						this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;
						this.perMessageDeflate = false !== opts.perMessageDeflate ? opts.perMessageDeflate || {} : false;

						if (true === this.perMessageDeflate) this.perMessageDeflate = {};
						if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {
							this.perMessageDeflate.threshold = 1024;
						}

						// SSL options for Node.js client
						this.pfx = opts.pfx || null;
						this.key = opts.key || null;
						this.passphrase = opts.passphrase || null;
						this.cert = opts.cert || null;
						this.ca = opts.ca || null;
						this.ciphers = opts.ciphers || null;
						this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;

						// other options for Node.js client
						var freeGlobal = typeof global == 'object' && global;
						if (freeGlobal.global === freeGlobal) {
							if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {
								this.extraHeaders = opts.extraHeaders;
							}
						}

						this.open();
					}

					Socket.priorWebsocketSuccess = false;

					/**
      * Mix in `Emitter`.
      */

					Emitter(Socket.prototype);

					/**
      * Protocol version.
      *
      * @api public
      */

					Socket.protocol = parser.protocol; // this is an int

					/**
      * Expose deps for legacy compatibility
      * and standalone browser access.
      */

					Socket.Socket = Socket;
					Socket.Transport = _dereq_('./transport');
					Socket.transports = _dereq_('./transports');
					Socket.parser = _dereq_('engine.io-parser');

					/**
      * Creates transport of the given type.
      *
      * @param {String} transport name
      * @return {Transport}
      * @api private
      */

					Socket.prototype.createTransport = function (name) {
						debug('creating transport "%s"', name);
						var query = clone(this.query);

						// append engine.io protocol identifier
						query.EIO = parser.protocol;

						// transport name
						query.transport = name;

						// session id if we already have one
						if (this.id) query.sid = this.id;

						var transport = new transports[name]({
							agent: this.agent,
							hostname: this.hostname,
							port: this.port,
							secure: this.secure,
							path: this.path,
							query: query,
							forceJSONP: this.forceJSONP,
							jsonp: this.jsonp,
							forceBase64: this.forceBase64,
							enablesXDR: this.enablesXDR,
							timestampRequests: this.timestampRequests,
							timestampParam: this.timestampParam,
							policyPort: this.policyPort,
							socket: this,
							pfx: this.pfx,
							key: this.key,
							passphrase: this.passphrase,
							cert: this.cert,
							ca: this.ca,
							ciphers: this.ciphers,
							rejectUnauthorized: this.rejectUnauthorized,
							perMessageDeflate: this.perMessageDeflate,
							extraHeaders: this.extraHeaders
						});

						return transport;
					};

					function clone(obj) {
						var o = {};
						for (var i in obj) {
							if (obj.hasOwnProperty(i)) {
								o[i] = obj[i];
							}
						}
						return o;
					}

					/**
      * Initializes transport to use and starts probe.
      *
      * @api private
      */
					Socket.prototype.open = function () {
						var transport;
						if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') != -1) {
							transport = 'websocket';
						} else if (0 === this.transports.length) {
							// Emit error on next tick so it can be listened to
							var self = this;
							setTimeout(function () {
								self.emit('error', 'No transports available');
							}, 0);
							return;
						} else {
							transport = this.transports[0];
						}
						this.readyState = 'opening';

						// Retry with the next transport if the transport is disabled (jsonp: false)
						try {
							transport = this.createTransport(transport);
						} catch (e) {
							this.transports.shift();
							this.open();
							return;
						}

						transport.open();
						this.setTransport(transport);
					};

					/**
      * Sets the current transport. Disables the existing one (if any).
      *
      * @api private
      */

					Socket.prototype.setTransport = function (transport) {
						debug('setting transport %s', transport.name);
						var self = this;

						if (this.transport) {
							debug('clearing existing transport %s', this.transport.name);
							this.transport.removeAllListeners();
						}

						// set up transport
						this.transport = transport;

						// set up transport listeners
						transport.on('drain', function () {
							self.onDrain();
						}).on('packet', function (packet) {
							self.onPacket(packet);
						}).on('error', function (e) {
							self.onError(e);
						}).on('close', function () {
							self.onClose('transport close');
						});
					};

					/**
      * Probes a transport.
      *
      * @param {String} transport name
      * @api private
      */

					Socket.prototype.probe = function (name) {
						debug('probing transport "%s"', name);
						var transport = this.createTransport(name, { probe: 1 }),
						    failed = false,
						    self = this;

						Socket.priorWebsocketSuccess = false;

						function onTransportOpen() {
							if (self.onlyBinaryUpgrades) {
								var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;
								failed = failed || upgradeLosesBinary;
							}
							if (failed) return;

							debug('probe transport "%s" opened', name);
							transport.send([{ type: 'ping', data: 'probe' }]);
							transport.once('packet', function (msg) {
								if (failed) return;
								if ('pong' == msg.type && 'probe' == msg.data) {
									debug('probe transport "%s" pong', name);
									self.upgrading = true;
									self.emit('upgrading', transport);
									if (!transport) return;
									Socket.priorWebsocketSuccess = 'websocket' == transport.name;

									debug('pausing current transport "%s"', self.transport.name);
									self.transport.pause(function () {
										if (failed) return;
										if ('closed' == self.readyState) return;
										debug('changing transport and sending upgrade packet');

										cleanup();

										self.setTransport(transport);
										transport.send([{ type: 'upgrade' }]);
										self.emit('upgrade', transport);
										transport = null;
										self.upgrading = false;
										self.flush();
									});
								} else {
									debug('probe transport "%s" failed', name);
									var err = new Error('probe error');
									err.transport = transport.name;
									self.emit('upgradeError', err);
								}
							});
						}

						function freezeTransport() {
							if (failed) return;

							// Any callback called by transport should be ignored since now
							failed = true;

							cleanup();

							transport.close();
							transport = null;
						}

						//Handle any error that happens while probing
						function onerror(err) {
							var error = new Error('probe error: ' + err);
							error.transport = transport.name;

							freezeTransport();

							debug('probe transport "%s" failed because of error: %s', name, err);

							self.emit('upgradeError', error);
						}

						function onTransportClose() {
							onerror("transport closed");
						}

						//When the socket is closed while we're probing
						function onclose() {
							onerror("socket closed");
						}

						//When the socket is upgraded while we're probing
						function onupgrade(to) {
							if (transport && to.name != transport.name) {
								debug('"%s" works - aborting "%s"', to.name, transport.name);
								freezeTransport();
							}
						}

						//Remove all listeners on the transport and on self
						function cleanup() {
							transport.removeListener('open', onTransportOpen);
							transport.removeListener('error', onerror);
							transport.removeListener('close', onTransportClose);
							self.removeListener('close', onclose);
							self.removeListener('upgrading', onupgrade);
						}

						transport.once('open', onTransportOpen);
						transport.once('error', onerror);
						transport.once('close', onTransportClose);

						this.once('close', onclose);
						this.once('upgrading', onupgrade);

						transport.open();
					};

					/**
      * Called when connection is deemed open.
      *
      * @api public
      */

					Socket.prototype.onOpen = function () {
						debug('socket open');
						this.readyState = 'open';
						Socket.priorWebsocketSuccess = 'websocket' == this.transport.name;
						this.emit('open');
						this.flush();

						// we check for `readyState` in case an `open`
						// listener already closed the socket
						if ('open' == this.readyState && this.upgrade && this.transport.pause) {
							debug('starting upgrade probes');
							for (var i = 0, l = this.upgrades.length; i < l; i++) {
								this.probe(this.upgrades[i]);
							}
						}
					};

					/**
      * Handles a packet.
      *
      * @api private
      */

					Socket.prototype.onPacket = function (packet) {
						if ('opening' == this.readyState || 'open' == this.readyState) {
							debug('socket receive: type "%s", data "%s"', packet.type, packet.data);

							this.emit('packet', packet);

							// Socket is live - any packet counts
							this.emit('heartbeat');

							switch (packet.type) {
								case 'open':
									this.onHandshake(parsejson(packet.data));
									break;

								case 'pong':
									this.setPing();
									this.emit('pong');
									break;

								case 'error':
									var err = new Error('server error');
									err.code = packet.data;
									this.onError(err);
									break;

								case 'message':
									this.emit('data', packet.data);
									this.emit('message', packet.data);
									break;
							}
						} else {
							debug('packet received with socket readyState "%s"', this.readyState);
						}
					};

					/**
      * Called upon handshake completion.
      *
      * @param {Object} handshake obj
      * @api private
      */

					Socket.prototype.onHandshake = function (data) {
						this.emit('handshake', data);
						this.id = data.sid;
						this.transport.query.sid = data.sid;
						this.upgrades = this.filterUpgrades(data.upgrades);
						this.pingInterval = data.pingInterval;
						this.pingTimeout = data.pingTimeout;
						this.onOpen();
						// In case open handler closes socket
						if ('closed' == this.readyState) return;
						this.setPing();

						// Prolong liveness of socket on heartbeat
						this.removeListener('heartbeat', this.onHeartbeat);
						this.on('heartbeat', this.onHeartbeat);
					};

					/**
      * Resets ping timeout.
      *
      * @api private
      */

					Socket.prototype.onHeartbeat = function (timeout) {
						clearTimeout(this.pingTimeoutTimer);
						var self = this;
						self.pingTimeoutTimer = setTimeout(function () {
							if ('closed' == self.readyState) return;
							self.onClose('ping timeout');
						}, timeout || self.pingInterval + self.pingTimeout);
					};

					/**
      * Pings server every `this.pingInterval` and expects response
      * within `this.pingTimeout` or closes connection.
      *
      * @api private
      */

					Socket.prototype.setPing = function () {
						var self = this;
						clearTimeout(self.pingIntervalTimer);
						self.pingIntervalTimer = setTimeout(function () {
							debug('writing ping packet - expecting pong within %sms', self.pingTimeout);
							self.ping();
							self.onHeartbeat(self.pingTimeout);
						}, self.pingInterval);
					};

					/**
     * Sends a ping packet.
     *
     * @api private
     */

					Socket.prototype.ping = function () {
						var self = this;
						this.sendPacket('ping', function () {
							self.emit('ping');
						});
					};

					/**
      * Called on `drain` event
      *
      * @api private
      */

					Socket.prototype.onDrain = function () {
						this.writeBuffer.splice(0, this.prevBufferLen);

						// setting prevBufferLen = 0 is very important
						// for example, when upgrading, upgrade packet is sent over,
						// and a nonzero prevBufferLen could cause problems on `drain`
						this.prevBufferLen = 0;

						if (0 === this.writeBuffer.length) {
							this.emit('drain');
						} else {
							this.flush();
						}
					};

					/**
      * Flush write buffers.
      *
      * @api private
      */

					Socket.prototype.flush = function () {
						if ('closed' != this.readyState && this.transport.writable && !this.upgrading && this.writeBuffer.length) {
							debug('flushing %d packets in socket', this.writeBuffer.length);
							this.transport.send(this.writeBuffer);
							// keep track of current length of writeBuffer
							// splice writeBuffer and callbackBuffer on `drain`
							this.prevBufferLen = this.writeBuffer.length;
							this.emit('flush');
						}
					};

					/**
      * Sends a message.
      *
      * @param {String} message.
      * @param {Function} callback function.
      * @param {Object} options.
      * @return {Socket} for chaining.
      * @api public
      */

					Socket.prototype.write = Socket.prototype.send = function (msg, options, fn) {
						this.sendPacket('message', msg, options, fn);
						return this;
					};

					/**
      * Sends a packet.
      *
      * @param {String} packet type.
      * @param {String} data.
      * @param {Object} options.
      * @param {Function} callback function.
      * @api private
      */

					Socket.prototype.sendPacket = function (type, data, options, fn) {
						if ('function' == typeof data) {
							fn = data;
							data = undefined;
						}

						if ('function' == typeof options) {
							fn = options;
							options = null;
						}

						if ('closing' == this.readyState || 'closed' == this.readyState) {
							return;
						}

						options = options || {};
						options.compress = false !== options.compress;

						var packet = {
							type: type,
							data: data,
							options: options
						};
						this.emit('packetCreate', packet);
						this.writeBuffer.push(packet);
						if (fn) this.once('flush', fn);
						this.flush();
					};

					/**
      * Closes the connection.
      *
      * @api private
      */

					Socket.prototype.close = function () {
						if ('opening' == this.readyState || 'open' == this.readyState) {
							this.readyState = 'closing';

							var self = this;

							if (this.writeBuffer.length) {
								this.once('drain', function () {
									if (this.upgrading) {
										waitForUpgrade();
									} else {
										close();
									}
								});
							} else if (this.upgrading) {
								waitForUpgrade();
							} else {
								close();
							}
						}

						function close() {
							self.onClose('forced close');
							debug('socket closing - telling transport to close');
							self.transport.close();
						}

						function cleanupAndClose() {
							self.removeListener('upgrade', cleanupAndClose);
							self.removeListener('upgradeError', cleanupAndClose);
							close();
						}

						function waitForUpgrade() {
							// wait for upgrade to finish since we can't send packets while pausing a transport
							self.once('upgrade', cleanupAndClose);
							self.once('upgradeError', cleanupAndClose);
						}

						return this;
					};

					/**
      * Called upon transport error
      *
      * @api private
      */

					Socket.prototype.onError = function (err) {
						debug('socket error %j', err);
						Socket.priorWebsocketSuccess = false;
						this.emit('error', err);
						this.onClose('transport error', err);
					};

					/**
      * Called upon transport close.
      *
      * @api private
      */

					Socket.prototype.onClose = function (reason, desc) {
						if ('opening' == this.readyState || 'open' == this.readyState || 'closing' == this.readyState) {
							debug('socket close with reason: "%s"', reason);
							var self = this;

							// clear timers
							clearTimeout(this.pingIntervalTimer);
							clearTimeout(this.pingTimeoutTimer);

							// stop event from firing again for transport
							this.transport.removeAllListeners('close');

							// ensure transport won't stay open
							this.transport.close();

							// ignore further transport communication
							this.transport.removeAllListeners();

							// set ready state
							this.readyState = 'closed';

							// clear session id
							this.id = null;

							// emit close event
							this.emit('close', reason, desc);

							// clean buffers after, so users can still
							// grab the buffers on `close` event
							self.writeBuffer = [];
							self.prevBufferLen = 0;
						}
					};

					/**
      * Filters upgrades, returning only those matching client transports.
      *
      * @param {Array} server upgrades
      * @api private
      *
      */

					Socket.prototype.filterUpgrades = function (upgrades) {
						var filteredUpgrades = [];
						for (var i = 0, j = upgrades.length; i < j; i++) {
							if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);
						}
						return filteredUpgrades;
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./transport": 4, "./transports": 5, "component-emitter": 15, "debug": 17, "engine.io-parser": 19, "indexof": 23, "parsejson": 26, "parseqs": 27, "parseuri": 28 }], 4: [function (_dereq_, module, exports) {
				/**
     * Module dependencies.
     */

				var parser = _dereq_('engine.io-parser');
				var Emitter = _dereq_('component-emitter');

				/**
     * Module exports.
     */

				module.exports = Transport;

				/**
     * Transport abstract constructor.
     *
     * @param {Object} options.
     * @api private
     */

				function Transport(opts) {
					this.path = opts.path;
					this.hostname = opts.hostname;
					this.port = opts.port;
					this.secure = opts.secure;
					this.query = opts.query;
					this.timestampParam = opts.timestampParam;
					this.timestampRequests = opts.timestampRequests;
					this.readyState = '';
					this.agent = opts.agent || false;
					this.socket = opts.socket;
					this.enablesXDR = opts.enablesXDR;

					// SSL options for Node.js client
					this.pfx = opts.pfx;
					this.key = opts.key;
					this.passphrase = opts.passphrase;
					this.cert = opts.cert;
					this.ca = opts.ca;
					this.ciphers = opts.ciphers;
					this.rejectUnauthorized = opts.rejectUnauthorized;

					// other options for Node.js client
					this.extraHeaders = opts.extraHeaders;
				}

				/**
     * Mix in `Emitter`.
     */

				Emitter(Transport.prototype);

				/**
     * Emits an error.
     *
     * @param {String} str
     * @return {Transport} for chaining
     * @api public
     */

				Transport.prototype.onError = function (msg, desc) {
					var err = new Error(msg);
					err.type = 'TransportError';
					err.description = desc;
					this.emit('error', err);
					return this;
				};

				/**
     * Opens the transport.
     *
     * @api public
     */

				Transport.prototype.open = function () {
					if ('closed' == this.readyState || '' == this.readyState) {
						this.readyState = 'opening';
						this.doOpen();
					}

					return this;
				};

				/**
     * Closes the transport.
     *
     * @api private
     */

				Transport.prototype.close = function () {
					if ('opening' == this.readyState || 'open' == this.readyState) {
						this.doClose();
						this.onClose();
					}

					return this;
				};

				/**
     * Sends multiple packets.
     *
     * @param {Array} packets
     * @api private
     */

				Transport.prototype.send = function (packets) {
					if ('open' == this.readyState) {
						this.write(packets);
					} else {
						throw new Error('Transport not open');
					}
				};

				/**
     * Called upon open
     *
     * @api private
     */

				Transport.prototype.onOpen = function () {
					this.readyState = 'open';
					this.writable = true;
					this.emit('open');
				};

				/**
     * Called with data.
     *
     * @param {String} data
     * @api private
     */

				Transport.prototype.onData = function (data) {
					var packet = parser.decodePacket(data, this.socket.binaryType);
					this.onPacket(packet);
				};

				/**
     * Called with a decoded packet.
     */

				Transport.prototype.onPacket = function (packet) {
					this.emit('packet', packet);
				};

				/**
     * Called upon close.
     *
     * @api private
     */

				Transport.prototype.onClose = function () {
					this.readyState = 'closed';
					this.emit('close');
				};
			}, { "component-emitter": 15, "engine.io-parser": 19 }], 5: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies
      */

					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var XHR = _dereq_('./polling-xhr');
					var JSONP = _dereq_('./polling-jsonp');
					var websocket = _dereq_('./websocket');

					/**
      * Export transports.
      */

					exports.polling = polling;
					exports.websocket = websocket;

					/**
      * Polling transport polymorphic constructor.
      * Decides on xhr vs jsonp based on feature detection.
      *
      * @api private
      */

					function polling(opts) {
						var xhr;
						var xd = false;
						var xs = false;
						var jsonp = false !== opts.jsonp;

						if (global.location) {
							var isSSL = 'https:' == location.protocol;
							var port = location.port;

							// some user agents have empty `location.port`
							if (!port) {
								port = isSSL ? 443 : 80;
							}

							xd = opts.hostname != location.hostname || port != opts.port;
							xs = opts.secure != isSSL;
						}

						opts.xdomain = xd;
						opts.xscheme = xs;
						xhr = new XMLHttpRequest(opts);

						if ('open' in xhr && !opts.forceJSONP) {
							return new XHR(opts);
						} else {
							if (!jsonp) throw new Error('JSONP disabled');
							return new JSONP(opts);
						}
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./polling-jsonp": 6, "./polling-xhr": 7, "./websocket": 9, "xmlhttprequest-ssl": 10 }], 6: [function (_dereq_, module, exports) {
				(function (global) {

					/**
      * Module requirements.
      */

					var Polling = _dereq_('./polling');
					var inherit = _dereq_('component-inherit');

					/**
      * Module exports.
      */

					module.exports = JSONPPolling;

					/**
      * Cached regular expressions.
      */

					var rNewline = /\n/g;
					var rEscapedNewline = /\\n/g;

					/**
      * Global JSONP callbacks.
      */

					var callbacks;

					/**
      * Callbacks count.
      */

					var index = 0;

					/**
      * Noop.
      */

					function empty() {}

					/**
      * JSONP Polling constructor.
      *
      * @param {Object} opts.
      * @api public
      */

					function JSONPPolling(opts) {
						Polling.call(this, opts);

						this.query = this.query || {};

						// define global callbacks array if not present
						// we do this here (lazily) to avoid unneeded global pollution
						if (!callbacks) {
							// we need to consider multiple engines in the same page
							if (!global.___eio) global.___eio = [];
							callbacks = global.___eio;
						}

						// callback identifier
						this.index = callbacks.length;

						// add callback to jsonp global
						var self = this;
						callbacks.push(function (msg) {
							self.onData(msg);
						});

						// append to query string
						this.query.j = this.index;

						// prevent spurious errors from being emitted when the window is unloaded
						if (global.document && global.addEventListener) {
							global.addEventListener('beforeunload', function () {
								if (self.script) self.script.onerror = empty;
							}, false);
						}
					}

					/**
      * Inherits from Polling.
      */

					inherit(JSONPPolling, Polling);

					/*
      * JSONP only supports binary as base64 encoded strings
      */

					JSONPPolling.prototype.supportsBinary = false;

					/**
      * Closes the socket.
      *
      * @api private
      */

					JSONPPolling.prototype.doClose = function () {
						if (this.script) {
							this.script.parentNode.removeChild(this.script);
							this.script = null;
						}

						if (this.form) {
							this.form.parentNode.removeChild(this.form);
							this.form = null;
							this.iframe = null;
						}

						Polling.prototype.doClose.call(this);
					};

					/**
      * Starts a poll cycle.
      *
      * @api private
      */

					JSONPPolling.prototype.doPoll = function () {
						var self = this;
						var script = document.createElement('script');

						if (this.script) {
							this.script.parentNode.removeChild(this.script);
							this.script = null;
						}

						script.async = true;
						script.src = this.uri();
						script.onerror = function (e) {
							self.onError('jsonp poll error', e);
						};

						var insertAt = document.getElementsByTagName('script')[0];
						if (insertAt) {
							insertAt.parentNode.insertBefore(script, insertAt);
						} else {
							(document.head || document.body).appendChild(script);
						}
						this.script = script;

						var isUAgecko = 'undefined' != typeof navigator && /gecko/i.test(navigator.userAgent);

						if (isUAgecko) {
							setTimeout(function () {
								var iframe = document.createElement('iframe');
								document.body.appendChild(iframe);
								document.body.removeChild(iframe);
							}, 100);
						}
					};

					/**
      * Writes with a hidden iframe.
      *
      * @param {String} data to send
      * @param {Function} called upon flush.
      * @api private
      */

					JSONPPolling.prototype.doWrite = function (data, fn) {
						var self = this;

						if (!this.form) {
							var form = document.createElement('form');
							var area = document.createElement('textarea');
							var id = this.iframeId = 'eio_iframe_' + this.index;
							var iframe;

							form.className = 'socketio';
							form.style.position = 'absolute';
							form.style.top = '-1000px';
							form.style.left = '-1000px';
							form.target = id;
							form.method = 'POST';
							form.setAttribute('accept-charset', 'utf-8');
							area.name = 'd';
							form.appendChild(area);
							document.body.appendChild(form);

							this.form = form;
							this.area = area;
						}

						this.form.action = this.uri();

						function complete() {
							initIframe();
							fn();
						}

						function initIframe() {
							if (self.iframe) {
								try {
									self.form.removeChild(self.iframe);
								} catch (e) {
									self.onError('jsonp polling iframe removal error', e);
								}
							}

							try {
								// ie6 dynamic iframes with target="" support (thanks Chris Lambacher)
								var html = '<iframe src="javascript:0" name="' + self.iframeId + '">';
								iframe = document.createElement(html);
							} catch (e) {
								iframe = document.createElement('iframe');
								iframe.name = self.iframeId;
								iframe.src = 'javascript:0';
							}

							iframe.id = self.iframeId;

							self.form.appendChild(iframe);
							self.iframe = iframe;
						}

						initIframe();

						// escape \n to prevent it from being converted into \r\n by some UAs
						// double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side
						data = data.replace(rEscapedNewline, '\\\n');
						this.area.value = data.replace(rNewline, '\\n');

						try {
							this.form.submit();
						} catch (e) {}

						if (this.iframe.attachEvent) {
							this.iframe.onreadystatechange = function () {
								if (self.iframe.readyState == 'complete') {
									complete();
								}
							};
						} else {
							this.iframe.onload = complete;
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./polling": 8, "component-inherit": 16 }], 7: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module requirements.
      */

					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var Polling = _dereq_('./polling');
					var Emitter = _dereq_('component-emitter');
					var inherit = _dereq_('component-inherit');
					var debug = _dereq_('debug')('engine.io-client:polling-xhr');

					/**
      * Module exports.
      */

					module.exports = XHR;
					module.exports.Request = Request;

					/**
      * Empty function
      */

					function empty() {}

					/**
      * XHR Polling constructor.
      *
      * @param {Object} opts
      * @api public
      */

					function XHR(opts) {
						Polling.call(this, opts);

						if (global.location) {
							var isSSL = 'https:' == location.protocol;
							var port = location.port;

							// some user agents have empty `location.port`
							if (!port) {
								port = isSSL ? 443 : 80;
							}

							this.xd = opts.hostname != global.location.hostname || port != opts.port;
							this.xs = opts.secure != isSSL;
						} else {
							this.extraHeaders = opts.extraHeaders;
						}
					}

					/**
      * Inherits from Polling.
      */

					inherit(XHR, Polling);

					/**
      * XHR supports binary
      */

					XHR.prototype.supportsBinary = true;

					/**
      * Creates a request.
      *
      * @param {String} method
      * @api private
      */

					XHR.prototype.request = function (opts) {
						opts = opts || {};
						opts.uri = this.uri();
						opts.xd = this.xd;
						opts.xs = this.xs;
						opts.agent = this.agent || false;
						opts.supportsBinary = this.supportsBinary;
						opts.enablesXDR = this.enablesXDR;

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;

						// other options for Node.js client
						opts.extraHeaders = this.extraHeaders;

						return new Request(opts);
					};

					/**
      * Sends data.
      *
      * @param {String} data to send.
      * @param {Function} called upon flush.
      * @api private
      */

					XHR.prototype.doWrite = function (data, fn) {
						var isBinary = typeof data !== 'string' && data !== undefined;
						var req = this.request({ method: 'POST', data: data, isBinary: isBinary });
						var self = this;
						req.on('success', fn);
						req.on('error', function (err) {
							self.onError('xhr post error', err);
						});
						this.sendXhr = req;
					};

					/**
      * Starts a poll cycle.
      *
      * @api private
      */

					XHR.prototype.doPoll = function () {
						debug('xhr poll');
						var req = this.request();
						var self = this;
						req.on('data', function (data) {
							self.onData(data);
						});
						req.on('error', function (err) {
							self.onError('xhr poll error', err);
						});
						this.pollXhr = req;
					};

					/**
      * Request constructor
      *
      * @param {Object} options
      * @api public
      */

					function Request(opts) {
						this.method = opts.method || 'GET';
						this.uri = opts.uri;
						this.xd = !!opts.xd;
						this.xs = !!opts.xs;
						this.async = false !== opts.async;
						this.data = undefined != opts.data ? opts.data : null;
						this.agent = opts.agent;
						this.isBinary = opts.isBinary;
						this.supportsBinary = opts.supportsBinary;
						this.enablesXDR = opts.enablesXDR;

						// SSL options for Node.js client
						this.pfx = opts.pfx;
						this.key = opts.key;
						this.passphrase = opts.passphrase;
						this.cert = opts.cert;
						this.ca = opts.ca;
						this.ciphers = opts.ciphers;
						this.rejectUnauthorized = opts.rejectUnauthorized;

						// other options for Node.js client
						this.extraHeaders = opts.extraHeaders;

						this.create();
					}

					/**
      * Mix in `Emitter`.
      */

					Emitter(Request.prototype);

					/**
      * Creates the XHR object and sends the request.
      *
      * @api private
      */

					Request.prototype.create = function () {
						var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;

						var xhr = this.xhr = new XMLHttpRequest(opts);
						var self = this;

						try {
							debug('xhr open %s: %s', this.method, this.uri);
							xhr.open(this.method, this.uri, this.async);
							try {
								if (this.extraHeaders) {
									xhr.setDisableHeaderCheck(true);
									for (var i in this.extraHeaders) {
										if (this.extraHeaders.hasOwnProperty(i)) {
											xhr.setRequestHeader(i, this.extraHeaders[i]);
										}
									}
								}
							} catch (e) {}
							if (this.supportsBinary) {
								// This has to be done after open because Firefox is stupid
								// http://stackoverflow.com/questions/13216903/get-binary-data-with-xmlhttprequest-in-a-firefox-extension
								xhr.responseType = 'arraybuffer';
							}

							if ('POST' == this.method) {
								try {
									if (this.isBinary) {
										xhr.setRequestHeader('Content-type', 'application/octet-stream');
									} else {
										xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');
									}
								} catch (e) {}
							}

							// ie6 check
							if ('withCredentials' in xhr) {
								xhr.withCredentials = true;
							}

							if (this.hasXDR()) {
								xhr.onload = function () {
									self.onLoad();
								};
								xhr.onerror = function () {
									self.onError(xhr.responseText);
								};
							} else {
								xhr.onreadystatechange = function () {
									if (4 != xhr.readyState) return;
									if (200 == xhr.status || 1223 == xhr.status) {
										self.onLoad();
									} else {
										// make sure the `error` event handler that's user-set
										// does not throw in the same tick and gets caught here
										setTimeout(function () {
											self.onError(xhr.status);
										}, 0);
									}
								};
							}

							debug('xhr data %s', this.data);
							xhr.send(this.data);
						} catch (e) {
							// Need to defer since .create() is called directly fhrom the constructor
							// and thus the 'error' event can only be only bound *after* this exception
							// occurs.  Therefore, also, we cannot throw here at all.
							setTimeout(function () {
								self.onError(e);
							}, 0);
							return;
						}

						if (global.document) {
							this.index = Request.requestsCount++;
							Request.requests[this.index] = this;
						}
					};

					/**
      * Called upon successful response.
      *
      * @api private
      */

					Request.prototype.onSuccess = function () {
						this.emit('success');
						this.cleanup();
					};

					/**
      * Called if we have data.
      *
      * @api private
      */

					Request.prototype.onData = function (data) {
						this.emit('data', data);
						this.onSuccess();
					};

					/**
      * Called upon error.
      *
      * @api private
      */

					Request.prototype.onError = function (err) {
						this.emit('error', err);
						this.cleanup(true);
					};

					/**
      * Cleans up house.
      *
      * @api private
      */

					Request.prototype.cleanup = function (fromError) {
						if ('undefined' == typeof this.xhr || null === this.xhr) {
							return;
						}
						// xmlhttprequest
						if (this.hasXDR()) {
							this.xhr.onload = this.xhr.onerror = empty;
						} else {
							this.xhr.onreadystatechange = empty;
						}

						if (fromError) {
							try {
								this.xhr.abort();
							} catch (e) {}
						}

						if (global.document) {
							delete Request.requests[this.index];
						}

						this.xhr = null;
					};

					/**
      * Called upon load.
      *
      * @api private
      */

					Request.prototype.onLoad = function () {
						var data;
						try {
							var contentType;
							try {
								contentType = this.xhr.getResponseHeader('Content-Type').split(';')[0];
							} catch (e) {}
							if (contentType === 'application/octet-stream') {
								data = this.xhr.response;
							} else {
								if (!this.supportsBinary) {
									data = this.xhr.responseText;
								} else {
									try {
										data = String.fromCharCode.apply(null, new Uint8Array(this.xhr.response));
									} catch (e) {
										var ui8Arr = new Uint8Array(this.xhr.response);
										var dataArray = [];
										for (var idx = 0, length = ui8Arr.length; idx < length; idx++) {
											dataArray.push(ui8Arr[idx]);
										}

										data = String.fromCharCode.apply(null, dataArray);
									}
								}
							}
						} catch (e) {
							this.onError(e);
						}
						if (null != data) {
							this.onData(data);
						}
					};

					/**
      * Check if it has XDomainRequest.
      *
      * @api private
      */

					Request.prototype.hasXDR = function () {
						return 'undefined' !== typeof global.XDomainRequest && !this.xs && this.enablesXDR;
					};

					/**
      * Aborts the request.
      *
      * @api public
      */

					Request.prototype.abort = function () {
						this.cleanup();
					};

					/**
      * Aborts pending requests when unloading the window. This is needed to prevent
      * memory leaks (e.g. when using IE) and to ensure that no spurious error is
      * emitted.
      */

					if (global.document) {
						Request.requestsCount = 0;
						Request.requests = {};
						if (global.attachEvent) {
							global.attachEvent('onunload', unloadHandler);
						} else if (global.addEventListener) {
							global.addEventListener('beforeunload', unloadHandler, false);
						}
					}

					function unloadHandler() {
						for (var i in Request.requests) {
							if (Request.requests.hasOwnProperty(i)) {
								Request.requests[i].abort();
							}
						}
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./polling": 8, "component-emitter": 15, "component-inherit": 16, "debug": 17, "xmlhttprequest-ssl": 10 }], 8: [function (_dereq_, module, exports) {
				/**
     * Module dependencies.
     */

				var Transport = _dereq_('../transport');
				var parseqs = _dereq_('parseqs');
				var parser = _dereq_('engine.io-parser');
				var inherit = _dereq_('component-inherit');
				var yeast = _dereq_('yeast');
				var debug = _dereq_('debug')('engine.io-client:polling');

				/**
     * Module exports.
     */

				module.exports = Polling;

				/**
     * Is XHR2 supported?
     */

				var hasXHR2 = (function () {
					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var xhr = new XMLHttpRequest({ xdomain: false });
					return null != xhr.responseType;
				})();

				/**
     * Polling interface.
     *
     * @param {Object} opts
     * @api private
     */

				function Polling(opts) {
					var forceBase64 = opts && opts.forceBase64;
					if (!hasXHR2 || forceBase64) {
						this.supportsBinary = false;
					}
					Transport.call(this, opts);
				}

				/**
     * Inherits from Transport.
     */

				inherit(Polling, Transport);

				/**
     * Transport name.
     */

				Polling.prototype.name = 'polling';

				/**
     * Opens the socket (triggers polling). We write a PING message to determine
     * when the transport is open.
     *
     * @api private
     */

				Polling.prototype.doOpen = function () {
					this.poll();
				};

				/**
     * Pauses polling.
     *
     * @param {Function} callback upon buffers are flushed and transport is paused
     * @api private
     */

				Polling.prototype.pause = function (onPause) {
					var pending = 0;
					var self = this;

					this.readyState = 'pausing';

					function pause() {
						debug('paused');
						self.readyState = 'paused';
						onPause();
					}

					if (this.polling || !this.writable) {
						var total = 0;

						if (this.polling) {
							debug('we are currently polling - waiting to pause');
							total++;
							this.once('pollComplete', function () {
								debug('pre-pause polling complete');
								--total || pause();
							});
						}

						if (!this.writable) {
							debug('we are currently writing - waiting to pause');
							total++;
							this.once('drain', function () {
								debug('pre-pause writing complete');
								--total || pause();
							});
						}
					} else {
						pause();
					}
				};

				/**
     * Starts polling cycle.
     *
     * @api public
     */

				Polling.prototype.poll = function () {
					debug('polling');
					this.polling = true;
					this.doPoll();
					this.emit('poll');
				};

				/**
     * Overloads onData to detect payloads.
     *
     * @api private
     */

				Polling.prototype.onData = function (data) {
					var self = this;
					debug('polling got data %s', data);
					var callback = function callback(packet, index, total) {
						// if its the first message we consider the transport open
						if ('opening' == self.readyState) {
							self.onOpen();
						}

						// if its a close packet, we close the ongoing requests
						if ('close' == packet.type) {
							self.onClose();
							return false;
						}

						// otherwise bypass onData and handle the message
						self.onPacket(packet);
					};

					// decode payload
					parser.decodePayload(data, this.socket.binaryType, callback);

					// if an event did not trigger closing
					if ('closed' != this.readyState) {
						// if we got data we're not polling
						this.polling = false;
						this.emit('pollComplete');

						if ('open' == this.readyState) {
							this.poll();
						} else {
							debug('ignoring poll - transport state "%s"', this.readyState);
						}
					}
				};

				/**
     * For polling, send a close packet.
     *
     * @api private
     */

				Polling.prototype.doClose = function () {
					var self = this;

					function close() {
						debug('writing close packet');
						self.write([{ type: 'close' }]);
					}

					if ('open' == this.readyState) {
						debug('transport open - closing');
						close();
					} else {
						// in case we're trying to close while
						// handshaking is in progress (GH-164)
						debug('transport not open - deferring close');
						this.once('open', close);
					}
				};

				/**
     * Writes a packets payload.
     *
     * @param {Array} data packets
     * @param {Function} drain callback
     * @api private
     */

				Polling.prototype.write = function (packets) {
					var self = this;
					this.writable = false;
					var callbackfn = function callbackfn() {
						self.writable = true;
						self.emit('drain');
					};

					var self = this;
					parser.encodePayload(packets, this.supportsBinary, function (data) {
						self.doWrite(data, callbackfn);
					});
				};

				/**
     * Generates uri for connection.
     *
     * @api private
     */

				Polling.prototype.uri = function () {
					var query = this.query || {};
					var schema = this.secure ? 'https' : 'http';
					var port = '';

					// cache busting is forced
					if (false !== this.timestampRequests) {
						query[this.timestampParam] = yeast();
					}

					if (!this.supportsBinary && !query.sid) {
						query.b64 = 1;
					}

					query = parseqs.encode(query);

					// avoid port if default for schema
					if (this.port && ('https' == schema && this.port != 443 || 'http' == schema && this.port != 80)) {
						port = ':' + this.port;
					}

					// prepend ? to query
					if (query.length) {
						query = '?' + query;
					}

					var ipv6 = this.hostname.indexOf(':') !== -1;
					return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;
				};
			}, { "../transport": 4, "component-inherit": 16, "debug": 17, "engine.io-parser": 19, "parseqs": 27, "xmlhttprequest-ssl": 10, "yeast": 30 }], 9: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var Transport = _dereq_('../transport');
					var parser = _dereq_('engine.io-parser');
					var parseqs = _dereq_('parseqs');
					var inherit = _dereq_('component-inherit');
					var yeast = _dereq_('yeast');
					var debug = _dereq_('debug')('engine.io-client:websocket');
					var BrowserWebSocket = global.WebSocket || global.MozWebSocket;

					/**
      * Get either the `WebSocket` or `MozWebSocket` globals
      * in the browser or try to resolve WebSocket-compatible
      * interface exposed by `ws` for Node-like environment.
      */

					var WebSocket = BrowserWebSocket;
					if (!WebSocket && typeof window === 'undefined') {
						try {
							WebSocket = _dereq_('ws');
						} catch (e) {}
					}

					/**
      * Module exports.
      */

					module.exports = WS;

					/**
      * WebSocket transport constructor.
      *
      * @api {Object} connection options
      * @api public
      */

					function WS(opts) {
						var forceBase64 = opts && opts.forceBase64;
						if (forceBase64) {
							this.supportsBinary = false;
						}
						this.perMessageDeflate = opts.perMessageDeflate;
						Transport.call(this, opts);
					}

					/**
      * Inherits from Transport.
      */

					inherit(WS, Transport);

					/**
      * Transport name.
      *
      * @api public
      */

					WS.prototype.name = 'websocket';

					/*
      * WebSockets support binary
      */

					WS.prototype.supportsBinary = true;

					/**
      * Opens socket.
      *
      * @api private
      */

					WS.prototype.doOpen = function () {
						if (!this.check()) {
							// let probe timeout
							return;
						}

						var self = this;
						var uri = this.uri();
						var protocols = void 0;
						var opts = {
							agent: this.agent,
							perMessageDeflate: this.perMessageDeflate
						};

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;
						if (this.extraHeaders) {
							opts.headers = this.extraHeaders;
						}

						this.ws = BrowserWebSocket ? new WebSocket(uri) : new WebSocket(uri, protocols, opts);

						if (this.ws.binaryType === undefined) {
							this.supportsBinary = false;
						}

						if (this.ws.supports && this.ws.supports.binary) {
							this.supportsBinary = true;
							this.ws.binaryType = 'buffer';
						} else {
							this.ws.binaryType = 'arraybuffer';
						}

						this.addEventListeners();
					};

					/**
      * Adds event listeners to the socket
      *
      * @api private
      */

					WS.prototype.addEventListeners = function () {
						var self = this;

						this.ws.onopen = function () {
							self.onOpen();
						};
						this.ws.onclose = function () {
							self.onClose();
						};
						this.ws.onmessage = function (ev) {
							self.onData(ev.data);
						};
						this.ws.onerror = function (e) {
							self.onError('websocket error', e);
						};
					};

					/**
      * Override `onData` to use a timer on iOS.
      * See: https://gist.github.com/mloughran/2052006
      *
      * @api private
      */

					if ('undefined' != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)) {
						WS.prototype.onData = function (data) {
							var self = this;
							setTimeout(function () {
								Transport.prototype.onData.call(self, data);
							}, 0);
						};
					}

					/**
      * Writes data to socket.
      *
      * @param {Array} array of packets.
      * @api private
      */

					WS.prototype.write = function (packets) {
						var self = this;
						this.writable = false;

						// encodePacket efficient as it uses WS framing
						// no need for encodePayload
						var total = packets.length;
						for (var i = 0, l = total; i < l; i++) {
							(function (packet) {
								parser.encodePacket(packet, self.supportsBinary, function (data) {
									if (!BrowserWebSocket) {
										// always create a new object (GH-437)
										var opts = {};
										if (packet.options) {
											opts.compress = packet.options.compress;
										}

										if (self.perMessageDeflate) {
											var len = 'string' == typeof data ? global.Buffer.byteLength(data) : data.length;
											if (len < self.perMessageDeflate.threshold) {
												opts.compress = false;
											}
										}
									}

									//Sometimes the websocket has already been closed but the browser didn't
									//have a chance of informing us about it yet, in that case send will
									//throw an error
									try {
										if (BrowserWebSocket) {
											// TypeError is thrown when passing the second argument on Safari
											self.ws.send(data);
										} else {
											self.ws.send(data, opts);
										}
									} catch (e) {
										debug('websocket closed before onclose event');
									}

									--total || done();
								});
							})(packets[i]);
						}

						function done() {
							self.emit('flush');

							// fake drain
							// defer to next tick to allow Socket to clear writeBuffer
							setTimeout(function () {
								self.writable = true;
								self.emit('drain');
							}, 0);
						}
					};

					/**
      * Called upon close
      *
      * @api private
      */

					WS.prototype.onClose = function () {
						Transport.prototype.onClose.call(this);
					};

					/**
      * Closes socket.
      *
      * @api private
      */

					WS.prototype.doClose = function () {
						if (typeof this.ws !== 'undefined') {
							this.ws.close();
						}
					};

					/**
      * Generates uri for connection.
      *
      * @api private
      */

					WS.prototype.uri = function () {
						var query = this.query || {};
						var schema = this.secure ? 'wss' : 'ws';
						var port = '';

						// avoid port if default for schema
						if (this.port && ('wss' == schema && this.port != 443 || 'ws' == schema && this.port != 80)) {
							port = ':' + this.port;
						}

						// append timestamp to URI
						if (this.timestampRequests) {
							query[this.timestampParam] = yeast();
						}

						// communicate binary support capabilities
						if (!this.supportsBinary) {
							query.b64 = 1;
						}

						query = parseqs.encode(query);

						// prepend ? to query
						if (query.length) {
							query = '?' + query;
						}

						var ipv6 = this.hostname.indexOf(':') !== -1;
						return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;
					};

					/**
      * Feature detection for WebSocket.
      *
      * @return {Boolean} whether this transport is available.
      * @api public
      */

					WS.prototype.check = function () {
						return !!WebSocket && !('__initialize' in WebSocket && this.name === WS.prototype.name);
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "../transport": 4, "component-inherit": 16, "debug": 17, "engine.io-parser": 19, "parseqs": 27, "ws": undefined, "yeast": 30 }], 10: [function (_dereq_, module, exports) {
				// browser shim for xmlhttprequest module
				var hasCORS = _dereq_('has-cors');

				module.exports = function (opts) {
					var xdomain = opts.xdomain;

					// scheme must be same when usign XDomainRequest
					// http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx
					var xscheme = opts.xscheme;

					// XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.
					// https://github.com/Automattic/engine.io-client/pull/217
					var enablesXDR = opts.enablesXDR;

					// XMLHttpRequest can be disabled on IE
					try {
						if ('undefined' != typeof XMLHttpRequest && (!xdomain || hasCORS)) {
							return new XMLHttpRequest();
						}
					} catch (e) {}

					// Use XDomainRequest for IE8 if enablesXDR is true
					// because loading bar keeps flashing when using jsonp-polling
					// https://github.com/yujiosaka/socke.io-ie8-loading-example
					try {
						if ('undefined' != typeof XDomainRequest && !xscheme && enablesXDR) {
							return new XDomainRequest();
						}
					} catch (e) {}

					if (!xdomain) {
						try {
							return new ActiveXObject('Microsoft.XMLHTTP');
						} catch (e) {}
					}
				};
			}, { "has-cors": 22 }], 11: [function (_dereq_, module, exports) {
				module.exports = after;

				function after(count, callback, err_cb) {
					var bail = false;
					err_cb = err_cb || noop;
					proxy.count = count;

					return count === 0 ? callback() : proxy;

					function proxy(err, result) {
						if (proxy.count <= 0) {
							throw new Error('after called too many times');
						}
						--proxy.count;

						// after first error, rest are passed to err_cb
						if (err) {
							bail = true;
							callback(err);
							// future error callbacks will go to error handler
							callback = err_cb;
						} else if (proxy.count === 0 && !bail) {
							callback(null, result);
						}
					}
				}

				function noop() {}
			}, {}], 12: [function (_dereq_, module, exports) {
				/**
     * An abstraction for slicing an arraybuffer even when
     * ArrayBuffer.prototype.slice is not supported
     *
     * @api public
     */

				module.exports = function (arraybuffer, start, end) {
					var bytes = arraybuffer.byteLength;
					start = start || 0;
					end = end || bytes;

					if (arraybuffer.slice) {
						return arraybuffer.slice(start, end);
					}

					if (start < 0) {
						start += bytes;
					}
					if (end < 0) {
						end += bytes;
					}
					if (end > bytes) {
						end = bytes;
					}

					if (start >= bytes || start >= end || bytes === 0) {
						return new ArrayBuffer(0);
					}

					var abv = new Uint8Array(arraybuffer);
					var result = new Uint8Array(end - start);
					for (var i = start, ii = 0; i < end; i++, ii++) {
						result[ii] = abv[i];
					}
					return result.buffer;
				};
			}, {}], 13: [function (_dereq_, module, exports) {
				/*
     * base64-arraybuffer
     * https://github.com/niklasvh/base64-arraybuffer
     *
     * Copyright (c) 2012 Niklas von Hertzen
     * Licensed under the MIT license.
     */
				(function (chars) {
					"use strict";

					exports.encode = function (arraybuffer) {
						var bytes = new Uint8Array(arraybuffer),
						    i,
						    len = bytes.length,
						    base64 = "";

						for (i = 0; i < len; i += 3) {
							base64 += chars[bytes[i] >> 2];
							base64 += chars[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];
							base64 += chars[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];
							base64 += chars[bytes[i + 2] & 63];
						}

						if (len % 3 === 2) {
							base64 = base64.substring(0, base64.length - 1) + "=";
						} else if (len % 3 === 1) {
							base64 = base64.substring(0, base64.length - 2) + "==";
						}

						return base64;
					};

					exports.decode = function (base64) {
						var bufferLength = base64.length * 0.75,
						    len = base64.length,
						    i,
						    p = 0,
						    encoded1,
						    encoded2,
						    encoded3,
						    encoded4;

						if (base64[base64.length - 1] === "=") {
							bufferLength--;
							if (base64[base64.length - 2] === "=") {
								bufferLength--;
							}
						}

						var arraybuffer = new ArrayBuffer(bufferLength),
						    bytes = new Uint8Array(arraybuffer);

						for (i = 0; i < len; i += 4) {
							encoded1 = chars.indexOf(base64[i]);
							encoded2 = chars.indexOf(base64[i + 1]);
							encoded3 = chars.indexOf(base64[i + 2]);
							encoded4 = chars.indexOf(base64[i + 3]);

							bytes[p++] = encoded1 << 2 | encoded2 >> 4;
							bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;
							bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;
						}

						return arraybuffer;
					};
				})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
			}, {}], 14: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Create a blob builder even when vendor prefixes exist
      */

					var BlobBuilder = global.BlobBuilder || global.WebKitBlobBuilder || global.MSBlobBuilder || global.MozBlobBuilder;

					/**
      * Check if Blob constructor is supported
      */

					var blobSupported = (function () {
						try {
							var a = new Blob(['hi']);
							return a.size === 2;
						} catch (e) {
							return false;
						}
					})();

					/**
      * Check if Blob constructor supports ArrayBufferViews
      * Fails in Safari 6, so we need to map to ArrayBuffers there.
      */

					var blobSupportsArrayBufferView = blobSupported && (function () {
						try {
							var b = new Blob([new Uint8Array([1, 2])]);
							return b.size === 2;
						} catch (e) {
							return false;
						}
					})();

					/**
      * Check if BlobBuilder is supported
      */

					var blobBuilderSupported = BlobBuilder && BlobBuilder.prototype.append && BlobBuilder.prototype.getBlob;

					/**
      * Helper function that maps ArrayBufferViews to ArrayBuffers
      * Used by BlobBuilder constructor and old browsers that didn't
      * support it in the Blob constructor.
      */

					function mapArrayBufferViews(ary) {
						for (var i = 0; i < ary.length; i++) {
							var chunk = ary[i];
							if (chunk.buffer instanceof ArrayBuffer) {
								var buf = chunk.buffer;

								// if this is a subarray, make a copy so we only
								// include the subarray region from the underlying buffer
								if (chunk.byteLength !== buf.byteLength) {
									var copy = new Uint8Array(chunk.byteLength);
									copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));
									buf = copy.buffer;
								}

								ary[i] = buf;
							}
						}
					}

					function BlobBuilderConstructor(ary, options) {
						options = options || {};

						var bb = new BlobBuilder();
						mapArrayBufferViews(ary);

						for (var i = 0; i < ary.length; i++) {
							bb.append(ary[i]);
						}

						return options.type ? bb.getBlob(options.type) : bb.getBlob();
					};

					function BlobConstructor(ary, options) {
						mapArrayBufferViews(ary);
						return new Blob(ary, options || {});
					};

					module.exports = (function () {
						if (blobSupported) {
							return blobSupportsArrayBufferView ? global.Blob : BlobConstructor;
						} else if (blobBuilderSupported) {
							return BlobBuilderConstructor;
						} else {
							return undefined;
						}
					})();
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}], 15: [function (_dereq_, module, exports) {

				/**
     * Expose `Emitter`.
     */

				module.exports = Emitter;

				/**
     * Initialize a new `Emitter`.
     *
     * @api public
     */

				function Emitter(obj) {
					if (obj) return mixin(obj);
				};

				/**
     * Mixin the emitter properties.
     *
     * @param {Object} obj
     * @return {Object}
     * @api private
     */

				function mixin(obj) {
					for (var key in Emitter.prototype) {
						obj[key] = Emitter.prototype[key];
					}
					return obj;
				}

				/**
     * Listen on the given `event` with `fn`.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};
					(this._callbacks[event] = this._callbacks[event] || []).push(fn);
					return this;
				};

				/**
     * Adds an `event` listener that will be invoked a single
     * time then automatically removed.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.once = function (event, fn) {
					var self = this;
					this._callbacks = this._callbacks || {};

					function on() {
						self.off(event, on);
						fn.apply(this, arguments);
					}

					on.fn = fn;
					this.on(event, on);
					return this;
				};

				/**
     * Remove the given callback for `event` or all
     * registered callbacks.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};

					// all
					if (0 == arguments.length) {
						this._callbacks = {};
						return this;
					}

					// specific event
					var callbacks = this._callbacks[event];
					if (!callbacks) return this;

					// remove all handlers
					if (1 == arguments.length) {
						delete this._callbacks[event];
						return this;
					}

					// remove specific handler
					var cb;
					for (var i = 0; i < callbacks.length; i++) {
						cb = callbacks[i];
						if (cb === fn || cb.fn === fn) {
							callbacks.splice(i, 1);
							break;
						}
					}
					return this;
				};

				/**
     * Emit `event` with the given args.
     *
     * @param {String} event
     * @param {Mixed} ...
     * @return {Emitter}
     */

				Emitter.prototype.emit = function (event) {
					this._callbacks = this._callbacks || {};
					var args = [].slice.call(arguments, 1),
					    callbacks = this._callbacks[event];

					if (callbacks) {
						callbacks = callbacks.slice(0);
						for (var i = 0, len = callbacks.length; i < len; ++i) {
							callbacks[i].apply(this, args);
						}
					}

					return this;
				};

				/**
     * Return array of callbacks for `event`.
     *
     * @param {String} event
     * @return {Array}
     * @api public
     */

				Emitter.prototype.listeners = function (event) {
					this._callbacks = this._callbacks || {};
					return this._callbacks[event] || [];
				};

				/**
     * Check if this emitter has `event` handlers.
     *
     * @param {String} event
     * @return {Boolean}
     * @api public
     */

				Emitter.prototype.hasListeners = function (event) {
					return !!this.listeners(event).length;
				};
			}, {}], 16: [function (_dereq_, module, exports) {

				module.exports = function (a, b) {
					var fn = function fn() {};
					fn.prototype = b.prototype;
					a.prototype = new fn();
					a.prototype.constructor = a;
				};
			}, {}], 17: [function (_dereq_, module, exports) {

				/**
     * This is the web browser implementation of `debug()`.
     *
     * Expose `debug()` as the module.
     */

				exports = module.exports = _dereq_('./debug');
				exports.log = log;
				exports.formatArgs = formatArgs;
				exports.save = save;
				exports.load = load;
				exports.useColors = useColors;
				exports.storage = 'undefined' != typeof chrome && 'undefined' != typeof chrome.storage ? chrome.storage.local : localstorage();

				/**
     * Colors.
     */

				exports.colors = ['lightseagreen', 'forestgreen', 'goldenrod', 'dodgerblue', 'darkorchid', 'crimson'];

				/**
     * Currently only WebKit-based Web Inspectors, Firefox >= v31,
     * and the Firebug extension (any Firefox version) are known
     * to support "%c" CSS customizations.
     *
     * TODO: add a `localStorage` variable to explicitly enable/disable colors
     */

				function useColors() {
					// is webkit? http://stackoverflow.com/a/16459606/376773
					return 'WebkitAppearance' in document.documentElement.style ||
					// is firebug? http://stackoverflow.com/a/398120/376773
					window.console && (console.firebug || console.exception && console.table) ||
					// is firefox >= v31?
					// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages
					navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31;
				}

				/**
     * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.
     */

				exports.formatters.j = function (v) {
					return JSON.stringify(v);
				};

				/**
     * Colorize log arguments if enabled.
     *
     * @api public
     */

				function formatArgs() {
					var args = arguments;
					var useColors = this.useColors;

					args[0] = (useColors ? '%c' : '') + this.namespace + (useColors ? ' %c' : ' ') + args[0] + (useColors ? '%c ' : ' ') + '+' + exports.humanize(this.diff);

					if (!useColors) return args;

					var c = 'color: ' + this.color;
					args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));

					// the final "%c" is somewhat tricky, because there could be other
					// arguments passed either before or after the %c, so we need to
					// figure out the correct index to insert the CSS into
					var index = 0;
					var lastC = 0;
					args[0].replace(/%[a-z%]/g, function (match) {
						if ('%%' === match) return;
						index++;
						if ('%c' === match) {
							// we only are interested in the *last* %c
							// (the user may have provided their own)
							lastC = index;
						}
					});

					args.splice(lastC, 0, c);
					return args;
				}

				/**
     * Invokes `console.log()` when available.
     * No-op when `console.log` is not a "function".
     *
     * @api public
     */

				function log() {
					// this hackery is required for IE8/9, where
					// the `console.log` function doesn't have 'apply'
					return 'object' === typeof console && console.log && Function.prototype.apply.call(console.log, console, arguments);
				}

				/**
     * Save `namespaces`.
     *
     * @param {String} namespaces
     * @api private
     */

				function save(namespaces) {
					try {
						if (null == namespaces) {
							exports.storage.removeItem('debug');
						} else {
							exports.storage.debug = namespaces;
						}
					} catch (e) {}
				}

				/**
     * Load `namespaces`.
     *
     * @return {String} returns the previously persisted debug modes
     * @api private
     */

				function load() {
					var r;
					try {
						r = exports.storage.debug;
					} catch (e) {}
					return r;
				}

				/**
     * Enable namespaces listed in `localStorage.debug` initially.
     */

				exports.enable(load());

				/**
     * Localstorage attempts to return the localstorage.
     *
     * This is necessary because safari throws
     * when a user disables cookies/localstorage
     * and you attempt to access it.
     *
     * @return {LocalStorage}
     * @api private
     */

				function localstorage() {
					try {
						return window.localStorage;
					} catch (e) {}
				}
			}, { "./debug": 18 }], 18: [function (_dereq_, module, exports) {

				/**
     * This is the common logic for both the Node.js and web browser
     * implementations of `debug()`.
     *
     * Expose `debug()` as the module.
     */

				exports = module.exports = debug;
				exports.coerce = coerce;
				exports.disable = disable;
				exports.enable = enable;
				exports.enabled = enabled;
				exports.humanize = _dereq_('ms');

				/**
     * The currently active debug mode names, and names to skip.
     */

				exports.names = [];
				exports.skips = [];

				/**
     * Map of special "%n" handling functions, for the debug "format" argument.
     *
     * Valid key names are a single, lowercased letter, i.e. "n".
     */

				exports.formatters = {};

				/**
     * Previously assigned color.
     */

				var prevColor = 0;

				/**
     * Previous log timestamp.
     */

				var prevTime;

				/**
     * Select a color.
     *
     * @return {Number}
     * @api private
     */

				function selectColor() {
					return exports.colors[prevColor++ % exports.colors.length];
				}

				/**
     * Create a debugger with the given `namespace`.
     *
     * @param {String} namespace
     * @return {Function}
     * @api public
     */

				function debug(namespace) {

					// define the `disabled` version
					function disabled() {}
					disabled.enabled = false;

					// define the `enabled` version
					function enabled() {

						var self = enabled;

						// set `diff` timestamp
						var curr = +new Date();
						var ms = curr - (prevTime || curr);
						self.diff = ms;
						self.prev = prevTime;
						self.curr = curr;
						prevTime = curr;

						// add the `color` if not set
						if (null == self.useColors) self.useColors = exports.useColors();
						if (null == self.color && self.useColors) self.color = selectColor();

						var args = Array.prototype.slice.call(arguments);

						args[0] = exports.coerce(args[0]);

						if ('string' !== typeof args[0]) {
							// anything else let's inspect with %o
							args = ['%o'].concat(args);
						}

						// apply any `formatters` transformations
						var index = 0;
						args[0] = args[0].replace(/%([a-z%])/g, function (match, format) {
							// if we encounter an escaped % then don't increase the array index
							if (match === '%%') return match;
							index++;
							var formatter = exports.formatters[format];
							if ('function' === typeof formatter) {
								var val = args[index];
								match = formatter.call(self, val);

								// now we need to remove `args[index]` since it's inlined in the `format`
								args.splice(index, 1);
								index--;
							}
							return match;
						});

						if ('function' === typeof exports.formatArgs) {
							args = exports.formatArgs.apply(self, args);
						}
						var logFn = enabled.log || exports.log || console.log.bind(console);
						logFn.apply(self, args);
					}
					enabled.enabled = true;

					var fn = exports.enabled(namespace) ? enabled : disabled;

					fn.namespace = namespace;

					return fn;
				}

				/**
     * Enables a debug mode by namespaces. This can include modes
     * separated by a colon and wildcards.
     *
     * @param {String} namespaces
     * @api public
     */

				function enable(namespaces) {
					exports.save(namespaces);

					var split = (namespaces || '').split(/[\s,]+/);
					var len = split.length;

					for (var i = 0; i < len; i++) {
						if (!split[i]) continue; // ignore empty strings
						namespaces = split[i].replace(/\*/g, '.*?');
						if (namespaces[0] === '-') {
							exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));
						} else {
							exports.names.push(new RegExp('^' + namespaces + '$'));
						}
					}
				}

				/**
     * Disable debug output.
     *
     * @api public
     */

				function disable() {
					exports.enable('');
				}

				/**
     * Returns true if the given mode name is enabled, false otherwise.
     *
     * @param {String} name
     * @return {Boolean}
     * @api public
     */

				function enabled(name) {
					var i, len;
					for (i = 0, len = exports.skips.length; i < len; i++) {
						if (exports.skips[i].test(name)) {
							return false;
						}
					}
					for (i = 0, len = exports.names.length; i < len; i++) {
						if (exports.names[i].test(name)) {
							return true;
						}
					}
					return false;
				}

				/**
     * Coerce `val`.
     *
     * @param {Mixed} val
     * @return {Mixed}
     * @api private
     */

				function coerce(val) {
					if (val instanceof Error) return val.stack || val.message;
					return val;
				}
			}, { "ms": 25 }], 19: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var keys = _dereq_('./keys');
					var hasBinary = _dereq_('has-binary');
					var sliceBuffer = _dereq_('arraybuffer.slice');
					var base64encoder = _dereq_('base64-arraybuffer');
					var after = _dereq_('after');
					var utf8 = _dereq_('utf8');

					/**
      * Check if we are running an android browser. That requires us to use
      * ArrayBuffer with polling transports...
      *
      * http://ghinda.net/jpeg-blob-ajax-android/
      */

					var isAndroid = navigator.userAgent.match(/Android/i);

					/**
      * Check if we are running in PhantomJS.
      * Uploading a Blob with PhantomJS does not work correctly, as reported here:
      * https://github.com/ariya/phantomjs/issues/11395
      * @type boolean
      */
					var isPhantomJS = /PhantomJS/i.test(navigator.userAgent);

					/**
      * When true, avoids using Blobs to encode payloads.
      * @type boolean
      */
					var dontSendBlobs = isAndroid || isPhantomJS;

					/**
      * Current protocol version.
      */

					exports.protocol = 3;

					/**
      * Packet types.
      */

					var packets = exports.packets = {
						open: 0, // non-ws
						close: 1, // non-ws
						ping: 2,
						pong: 3,
						message: 4,
						upgrade: 5,
						noop: 6
					};

					var packetslist = keys(packets);

					/**
      * Premade error packet.
      */

					var err = { type: 'error', data: 'parser error' };

					/**
      * Create a blob api even for blob builder when vendor prefixes exist
      */

					var Blob = _dereq_('blob');

					/**
      * Encodes a packet.
      *
      *     <packet type id> [ <data> ]
      *
      * Example:
      *
      *     5hello world
      *     3
      *     4
      *
      * Binary is encoded in an identical principle
      *
      * @api private
      */

					exports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {
						if ('function' == typeof supportsBinary) {
							callback = supportsBinary;
							supportsBinary = false;
						}

						if ('function' == typeof utf8encode) {
							callback = utf8encode;
							utf8encode = null;
						}

						var data = packet.data === undefined ? undefined : packet.data.buffer || packet.data;

						if (global.ArrayBuffer && data instanceof ArrayBuffer) {
							return encodeArrayBuffer(packet, supportsBinary, callback);
						} else if (Blob && data instanceof global.Blob) {
							return encodeBlob(packet, supportsBinary, callback);
						}

						// might be an object with { base64: true, data: dataAsBase64String }
						if (data && data.base64) {
							return encodeBase64Object(packet, callback);
						}

						// Sending data as a utf-8 string
						var encoded = packets[packet.type];

						// data fragment is optional
						if (undefined !== packet.data) {
							encoded += utf8encode ? utf8.encode(String(packet.data)) : String(packet.data);
						}

						return callback('' + encoded);
					};

					function encodeBase64Object(packet, callback) {
						// packet data is an object { base64: true, data: dataAsBase64String }
						var message = 'b' + exports.packets[packet.type] + packet.data.data;
						return callback(message);
					}

					/**
      * Encode packet helpers for binary types
      */

					function encodeArrayBuffer(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						var data = packet.data;
						var contentArray = new Uint8Array(data);
						var resultBuffer = new Uint8Array(1 + data.byteLength);

						resultBuffer[0] = packets[packet.type];
						for (var i = 0; i < contentArray.length; i++) {
							resultBuffer[i + 1] = contentArray[i];
						}

						return callback(resultBuffer.buffer);
					}

					function encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						var fr = new FileReader();
						fr.onload = function () {
							packet.data = fr.result;
							exports.encodePacket(packet, supportsBinary, true, callback);
						};
						return fr.readAsArrayBuffer(packet.data);
					}

					function encodeBlob(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						if (dontSendBlobs) {
							return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);
						}

						var length = new Uint8Array(1);
						length[0] = packets[packet.type];
						var blob = new Blob([length.buffer, packet.data]);

						return callback(blob);
					}

					/**
      * Encodes a packet with binary data in a base64 string
      *
      * @param {Object} packet, has `type` and `data`
      * @return {String} base64 encoded message
      */

					exports.encodeBase64Packet = function (packet, callback) {
						var message = 'b' + exports.packets[packet.type];
						if (Blob && packet.data instanceof global.Blob) {
							var fr = new FileReader();
							fr.onload = function () {
								var b64 = fr.result.split(',')[1];
								callback(message + b64);
							};
							return fr.readAsDataURL(packet.data);
						}

						var b64data;
						try {
							b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));
						} catch (e) {
							// iPhone Safari doesn't let you apply with typed arrays
							var typed = new Uint8Array(packet.data);
							var basic = new Array(typed.length);
							for (var i = 0; i < typed.length; i++) {
								basic[i] = typed[i];
							}
							b64data = String.fromCharCode.apply(null, basic);
						}
						message += global.btoa(b64data);
						return callback(message);
					};

					/**
      * Decodes a packet. Changes format to Blob if requested.
      *
      * @return {Object} with `type` and `data` (if any)
      * @api private
      */

					exports.decodePacket = function (data, binaryType, utf8decode) {
						// String data
						if (typeof data == 'string' || data === undefined) {
							if (data.charAt(0) == 'b') {
								return exports.decodeBase64Packet(data.substr(1), binaryType);
							}

							if (utf8decode) {
								try {
									data = utf8.decode(data);
								} catch (e) {
									return err;
								}
							}
							var type = data.charAt(0);

							if (Number(type) != type || !packetslist[type]) {
								return err;
							}

							if (data.length > 1) {
								return { type: packetslist[type], data: data.substring(1) };
							} else {
								return { type: packetslist[type] };
							}
						}

						var asArray = new Uint8Array(data);
						var type = asArray[0];
						var rest = sliceBuffer(data, 1);
						if (Blob && binaryType === 'blob') {
							rest = new Blob([rest]);
						}
						return { type: packetslist[type], data: rest };
					};

					/**
      * Decodes a packet encoded in a base64 string
      *
      * @param {String} base64 encoded message
      * @return {Object} with `type` and `data` (if any)
      */

					exports.decodeBase64Packet = function (msg, binaryType) {
						var type = packetslist[msg.charAt(0)];
						if (!global.ArrayBuffer) {
							return { type: type, data: { base64: true, data: msg.substr(1) } };
						}

						var data = base64encoder.decode(msg.substr(1));

						if (binaryType === 'blob' && Blob) {
							data = new Blob([data]);
						}

						return { type: type, data: data };
					};

					/**
      * Encodes multiple messages (payload).
      *
      *     <length>:data
      *
      * Example:
      *
      *     11:hello world2:hi
      *
      * If any contents are binary, they will be encoded as base64 strings. Base64
      * encoded strings are marked with a b before the length specifier
      *
      * @param {Array} packets
      * @api private
      */

					exports.encodePayload = function (packets, supportsBinary, callback) {
						if (typeof supportsBinary == 'function') {
							callback = supportsBinary;
							supportsBinary = null;
						}

						var isBinary = hasBinary(packets);

						if (supportsBinary && isBinary) {
							if (Blob && !dontSendBlobs) {
								return exports.encodePayloadAsBlob(packets, callback);
							}

							return exports.encodePayloadAsArrayBuffer(packets, callback);
						}

						if (!packets.length) {
							return callback('0:');
						}

						function setLengthHeader(message) {
							return message.length + ':' + message;
						}

						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, !isBinary ? false : supportsBinary, true, function (message) {
								doneCallback(null, setLengthHeader(message));
							});
						}

						map(packets, encodeOne, function (err, results) {
							return callback(results.join(''));
						});
					};

					/**
      * Async array map using after
      */

					function map(ary, each, done) {
						var result = new Array(ary.length);
						var next = after(ary.length, done);

						var eachWithIndex = function eachWithIndex(i, el, cb) {
							each(el, function (error, msg) {
								result[i] = msg;
								cb(error, result);
							});
						};

						for (var i = 0; i < ary.length; i++) {
							eachWithIndex(i, ary[i], next);
						}
					}

					/*
      * Decodes data when a payload is maybe expected. Possible binary contents are
      * decoded from their base64 representation
      *
      * @param {String} data, callback method
      * @api public
      */

					exports.decodePayload = function (data, binaryType, callback) {
						if (typeof data != 'string') {
							return exports.decodePayloadAsBinary(data, binaryType, callback);
						}

						if (typeof binaryType === 'function') {
							callback = binaryType;
							binaryType = null;
						}

						var packet;
						if (data == '') {
							// parser error - ignoring payload
							return callback(err, 0, 1);
						}

						var length = '',
						    n,
						    msg;

						for (var i = 0, l = data.length; i < l; i++) {
							var chr = data.charAt(i);

							if (':' != chr) {
								length += chr;
							} else {
								if ('' == length || length != (n = Number(length))) {
									// parser error - ignoring payload
									return callback(err, 0, 1);
								}

								msg = data.substr(i + 1, n);

								if (length != msg.length) {
									// parser error - ignoring payload
									return callback(err, 0, 1);
								}

								if (msg.length) {
									packet = exports.decodePacket(msg, binaryType, true);

									if (err.type == packet.type && err.data == packet.data) {
										// parser error in individual packet - ignoring payload
										return callback(err, 0, 1);
									}

									var ret = callback(packet, i + n, l);
									if (false === ret) return;
								}

								// advance cursor
								i += n;
								length = '';
							}
						}

						if (length != '') {
							// parser error - ignoring payload
							return callback(err, 0, 1);
						}
					};

					/**
      * Encodes multiple messages (payload) as binary.
      *
      * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number
      * 255><data>
      *
      * Example:
      * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers
      *
      * @param {Array} packets
      * @return {ArrayBuffer} encoded payload
      * @api private
      */

					exports.encodePayloadAsArrayBuffer = function (packets, callback) {
						if (!packets.length) {
							return callback(new ArrayBuffer(0));
						}

						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, true, true, function (data) {
								return doneCallback(null, data);
							});
						}

						map(packets, encodeOne, function (err, encodedPackets) {
							var totalLength = encodedPackets.reduce(function (acc, p) {
								var len;
								if (typeof p === 'string') {
									len = p.length;
								} else {
									len = p.byteLength;
								}
								return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2
							}, 0);

							var resultArray = new Uint8Array(totalLength);

							var bufferIndex = 0;
							encodedPackets.forEach(function (p) {
								var isString = typeof p === 'string';
								var ab = p;
								if (isString) {
									var view = new Uint8Array(p.length);
									for (var i = 0; i < p.length; i++) {
										view[i] = p.charCodeAt(i);
									}
									ab = view.buffer;
								}

								if (isString) {
									// not true binary
									resultArray[bufferIndex++] = 0;
								} else {
									// true binary
									resultArray[bufferIndex++] = 1;
								}

								var lenStr = ab.byteLength.toString();
								for (var i = 0; i < lenStr.length; i++) {
									resultArray[bufferIndex++] = parseInt(lenStr[i]);
								}
								resultArray[bufferIndex++] = 255;

								var view = new Uint8Array(ab);
								for (var i = 0; i < view.length; i++) {
									resultArray[bufferIndex++] = view[i];
								}
							});

							return callback(resultArray.buffer);
						});
					};

					/**
      * Encode as Blob
      */

					exports.encodePayloadAsBlob = function (packets, callback) {
						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, true, true, function (encoded) {
								var binaryIdentifier = new Uint8Array(1);
								binaryIdentifier[0] = 1;
								if (typeof encoded === 'string') {
									var view = new Uint8Array(encoded.length);
									for (var i = 0; i < encoded.length; i++) {
										view[i] = encoded.charCodeAt(i);
									}
									encoded = view.buffer;
									binaryIdentifier[0] = 0;
								}

								var len = encoded instanceof ArrayBuffer ? encoded.byteLength : encoded.size;

								var lenStr = len.toString();
								var lengthAry = new Uint8Array(lenStr.length + 1);
								for (var i = 0; i < lenStr.length; i++) {
									lengthAry[i] = parseInt(lenStr[i]);
								}
								lengthAry[lenStr.length] = 255;

								if (Blob) {
									var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);
									doneCallback(null, blob);
								}
							});
						}

						map(packets, encodeOne, function (err, results) {
							return callback(new Blob(results));
						});
					};

					/*
      * Decodes data when a payload is maybe expected. Strings are decoded by
      * interpreting each byte as a key code for entries marked to start with 0. See
      * description of encodePayloadAsBinary
      *
      * @param {ArrayBuffer} data, callback method
      * @api public
      */

					exports.decodePayloadAsBinary = function (data, binaryType, callback) {
						if (typeof binaryType === 'function') {
							callback = binaryType;
							binaryType = null;
						}

						var bufferTail = data;
						var buffers = [];

						var numberTooLong = false;
						while (bufferTail.byteLength > 0) {
							var tailArray = new Uint8Array(bufferTail);
							var isString = tailArray[0] === 0;
							var msgLength = '';

							for (var i = 1;; i++) {
								if (tailArray[i] == 255) break;

								if (msgLength.length > 310) {
									numberTooLong = true;
									break;
								}

								msgLength += tailArray[i];
							}

							if (numberTooLong) return callback(err, 0, 1);

							bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);
							msgLength = parseInt(msgLength);

							var msg = sliceBuffer(bufferTail, 0, msgLength);
							if (isString) {
								try {
									msg = String.fromCharCode.apply(null, new Uint8Array(msg));
								} catch (e) {
									// iPhone Safari doesn't let you apply to typed arrays
									var typed = new Uint8Array(msg);
									msg = '';
									for (var i = 0; i < typed.length; i++) {
										msg += String.fromCharCode(typed[i]);
									}
								}
							}

							buffers.push(msg);
							bufferTail = sliceBuffer(bufferTail, msgLength);
						}

						var total = buffers.length;
						buffers.forEach(function (buffer, i) {
							callback(exports.decodePacket(buffer, binaryType, true), i, total);
						});
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./keys": 20, "after": 11, "arraybuffer.slice": 12, "base64-arraybuffer": 13, "blob": 14, "has-binary": 21, "utf8": 29 }], 20: [function (_dereq_, module, exports) {

				/**
     * Gets the keys for an object.
     *
     * @return {Array} keys
     * @api private
     */

				module.exports = Object.keys || function keys(obj) {
					var arr = [];
					var has = Object.prototype.hasOwnProperty;

					for (var i in obj) {
						if (has.call(obj, i)) {
							arr.push(i);
						}
					}
					return arr;
				};
			}, {}], 21: [function (_dereq_, module, exports) {
				(function (global) {

					/*
      * Module requirements.
      */

					var isArray = _dereq_('isarray');

					/**
      * Module exports.
      */

					module.exports = hasBinary;

					/**
      * Checks for binary data.
      *
      * Right now only Buffer and ArrayBuffer are supported..
      *
      * @param {Object} anything
      * @api public
      */

					function hasBinary(data) {

						function _hasBinary(obj) {
							if (!obj) return false;

							if (global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								return true;
							}

							if (isArray(obj)) {
								for (var i = 0; i < obj.length; i++) {
									if (_hasBinary(obj[i])) {
										return true;
									}
								}
							} else if (obj && 'object' == typeof obj) {
								if (obj.toJSON) {
									obj = obj.toJSON();
								}

								for (var key in obj) {
									if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
										return true;
									}
								}
							}

							return false;
						}

						return _hasBinary(data);
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "isarray": 24 }], 22: [function (_dereq_, module, exports) {

				/**
     * Module exports.
     *
     * Logic borrowed from Modernizr:
     *
     *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js
     */

				try {
					module.exports = typeof XMLHttpRequest !== 'undefined' && 'withCredentials' in new XMLHttpRequest();
				} catch (err) {
					// if XMLHttp support is disabled in IE then it will throw
					// when trying to create
					module.exports = false;
				}
			}, {}], 23: [function (_dereq_, module, exports) {

				var indexOf = [].indexOf;

				module.exports = function (arr, obj) {
					if (indexOf) return arr.indexOf(obj);
					for (var i = 0; i < arr.length; ++i) {
						if (arr[i] === obj) return i;
					}
					return -1;
				};
			}, {}], 24: [function (_dereq_, module, exports) {
				module.exports = Array.isArray || function (arr) {
					return Object.prototype.toString.call(arr) == '[object Array]';
				};
			}, {}], 25: [function (_dereq_, module, exports) {
				/**
     * Helpers.
     */

				var s = 1000;
				var m = s * 60;
				var h = m * 60;
				var d = h * 24;
				var y = d * 365.25;

				/**
     * Parse or format the given `val`.
     *
     * Options:
     *
     *  - `long` verbose formatting [false]
     *
     * @param {String|Number} val
     * @param {Object} options
     * @return {String|Number}
     * @api public
     */

				module.exports = function (val, options) {
					options = options || {};
					if ('string' == typeof val) return parse(val);
					return options.long ? long(val) : short(val);
				};

				/**
     * Parse the given `str` and return milliseconds.
     *
     * @param {String} str
     * @return {Number}
     * @api private
     */

				function parse(str) {
					str = '' + str;
					if (str.length > 10000) return;
					var match = /^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);
					if (!match) return;
					var n = parseFloat(match[1]);
					var type = (match[2] || 'ms').toLowerCase();
					switch (type) {
						case 'years':
						case 'year':
						case 'yrs':
						case 'yr':
						case 'y':
							return n * y;
						case 'days':
						case 'day':
						case 'd':
							return n * d;
						case 'hours':
						case 'hour':
						case 'hrs':
						case 'hr':
						case 'h':
							return n * h;
						case 'minutes':
						case 'minute':
						case 'mins':
						case 'min':
						case 'm':
							return n * m;
						case 'seconds':
						case 'second':
						case 'secs':
						case 'sec':
						case 's':
							return n * s;
						case 'milliseconds':
						case 'millisecond':
						case 'msecs':
						case 'msec':
						case 'ms':
							return n;
					}
				}

				/**
     * Short format for `ms`.
     *
     * @param {Number} ms
     * @return {String}
     * @api private
     */

				function short(ms) {
					if (ms >= d) return Math.round(ms / d) + 'd';
					if (ms >= h) return Math.round(ms / h) + 'h';
					if (ms >= m) return Math.round(ms / m) + 'm';
					if (ms >= s) return Math.round(ms / s) + 's';
					return ms + 'ms';
				}

				/**
     * Long format for `ms`.
     *
     * @param {Number} ms
     * @return {String}
     * @api private
     */

				function long(ms) {
					return plural(ms, d, 'day') || plural(ms, h, 'hour') || plural(ms, m, 'minute') || plural(ms, s, 'second') || ms + ' ms';
				}

				/**
     * Pluralization helper.
     */

				function plural(ms, n, name) {
					if (ms < n) return;
					if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;
					return Math.ceil(ms / n) + ' ' + name + 's';
				}
			}, {}], 26: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * JSON parse.
      *
      * @see Based on jQuery#parseJSON (MIT) and JSON2
      * @api private
      */

					var rvalidchars = /^[\],:{}\s]*$/;
					var rvalidescape = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
					var rvalidtokens = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
					var rvalidbraces = /(?:^|:|,)(?:\s*\[)+/g;
					var rtrimLeft = /^\s+/;
					var rtrimRight = /\s+$/;

					module.exports = function parsejson(data) {
						if ('string' != typeof data || !data) {
							return null;
						}

						data = data.replace(rtrimLeft, '').replace(rtrimRight, '');

						// Attempt to parse using the native JSON parser first
						if (global.JSON && JSON.parse) {
							return JSON.parse(data);
						}

						if (rvalidchars.test(data.replace(rvalidescape, '@').replace(rvalidtokens, ']').replace(rvalidbraces, ''))) {
							return new Function('return ' + data)();
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}], 27: [function (_dereq_, module, exports) {
				/**
     * Compiles a querystring
     * Returns string representation of the object
     *
     * @param {Object}
     * @api private
     */

				exports.encode = function (obj) {
					var str = '';

					for (var i in obj) {
						if (obj.hasOwnProperty(i)) {
							if (str.length) str += '&';
							str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);
						}
					}

					return str;
				};

				/**
     * Parses a simple querystring into an object
     *
     * @param {String} qs
     * @api private
     */

				exports.decode = function (qs) {
					var qry = {};
					var pairs = qs.split('&');
					for (var i = 0, l = pairs.length; i < l; i++) {
						var pair = pairs[i].split('=');
						qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
					}
					return qry;
				};
			}, {}], 28: [function (_dereq_, module, exports) {
				/**
     * Parses an URI
     *
     * @author Steven Levithan <stevenlevithan.com> (MIT license)
     * @api private
     */

				var re = /^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;

				var parts = ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'];

				module.exports = function parseuri(str) {
					var src = str,
					    b = str.indexOf('['),
					    e = str.indexOf(']');

					if (b != -1 && e != -1) {
						str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);
					}

					var m = re.exec(str || ''),
					    uri = {},
					    i = 14;

					while (i--) {
						uri[parts[i]] = m[i] || '';
					}

					if (b != -1 && e != -1) {
						uri.source = src;
						uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');
						uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');
						uri.ipv6uri = true;
					}

					return uri;
				};
			}, {}], 29: [function (_dereq_, module, exports) {
				(function (global) {
					/*! https://mths.be/utf8js v2.0.0 by @mathias */
					;(function (root) {

						// Detect free variables `exports`
						var freeExports = typeof exports == 'object' && exports;

						// Detect free variable `module`
						var freeModule = typeof module == 'object' && module && module.exports == freeExports && module;

						// Detect free variable `global`, from Node.js or Browserified code,
						// and use it as `root`
						var freeGlobal = typeof global == 'object' && global;
						if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
							root = freeGlobal;
						}

						/*--------------------------------------------------------------------------*/

						var stringFromCharCode = String.fromCharCode;

						// Taken from https://mths.be/punycode
						function ucs2decode(string) {
							var output = [];
							var counter = 0;
							var length = string.length;
							var value;
							var extra;
							while (counter < length) {
								value = string.charCodeAt(counter++);
								if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
									// high surrogate, and there is a next character
									extra = string.charCodeAt(counter++);
									if ((extra & 0xFC00) == 0xDC00) {
										// low surrogate
										output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
									} else {
										// unmatched surrogate; only append this code unit, in case the next
										// code unit is the high surrogate of a surrogate pair
										output.push(value);
										counter--;
									}
								} else {
									output.push(value);
								}
							}
							return output;
						}

						// Taken from https://mths.be/punycode
						function ucs2encode(array) {
							var length = array.length;
							var index = -1;
							var value;
							var output = '';
							while (++index < length) {
								value = array[index];
								if (value > 0xFFFF) {
									value -= 0x10000;
									output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
									value = 0xDC00 | value & 0x3FF;
								}
								output += stringFromCharCode(value);
							}
							return output;
						}

						function checkScalarValue(codePoint) {
							if (codePoint >= 0xD800 && codePoint <= 0xDFFF) {
								throw Error('Lone surrogate U+' + codePoint.toString(16).toUpperCase() + ' is not a scalar value');
							}
						}
						/*--------------------------------------------------------------------------*/

						function createByte(codePoint, shift) {
							return stringFromCharCode(codePoint >> shift & 0x3F | 0x80);
						}

						function encodeCodePoint(codePoint) {
							if ((codePoint & 0xFFFFFF80) == 0) {
								// 1-byte sequence
								return stringFromCharCode(codePoint);
							}
							var symbol = '';
							if ((codePoint & 0xFFFFF800) == 0) {
								// 2-byte sequence
								symbol = stringFromCharCode(codePoint >> 6 & 0x1F | 0xC0);
							} else if ((codePoint & 0xFFFF0000) == 0) {
								// 3-byte sequence
								checkScalarValue(codePoint);
								symbol = stringFromCharCode(codePoint >> 12 & 0x0F | 0xE0);
								symbol += createByte(codePoint, 6);
							} else if ((codePoint & 0xFFE00000) == 0) {
								// 4-byte sequence
								symbol = stringFromCharCode(codePoint >> 18 & 0x07 | 0xF0);
								symbol += createByte(codePoint, 12);
								symbol += createByte(codePoint, 6);
							}
							symbol += stringFromCharCode(codePoint & 0x3F | 0x80);
							return symbol;
						}

						function utf8encode(string) {
							var codePoints = ucs2decode(string);
							var length = codePoints.length;
							var index = -1;
							var codePoint;
							var byteString = '';
							while (++index < length) {
								codePoint = codePoints[index];
								byteString += encodeCodePoint(codePoint);
							}
							return byteString;
						}

						/*--------------------------------------------------------------------------*/

						function readContinuationByte() {
							if (byteIndex >= byteCount) {
								throw Error('Invalid byte index');
							}

							var continuationByte = byteArray[byteIndex] & 0xFF;
							byteIndex++;

							if ((continuationByte & 0xC0) == 0x80) {
								return continuationByte & 0x3F;
							}

							// If we end up here, it’s not a continuation byte
							throw Error('Invalid continuation byte');
						}

						function decodeSymbol() {
							var byte1;
							var byte2;
							var byte3;
							var byte4;
							var codePoint;

							if (byteIndex > byteCount) {
								throw Error('Invalid byte index');
							}

							if (byteIndex == byteCount) {
								return false;
							}

							// Read first byte
							byte1 = byteArray[byteIndex] & 0xFF;
							byteIndex++;

							// 1-byte sequence (no continuation bytes)
							if ((byte1 & 0x80) == 0) {
								return byte1;
							}

							// 2-byte sequence
							if ((byte1 & 0xE0) == 0xC0) {
								var byte2 = readContinuationByte();
								codePoint = (byte1 & 0x1F) << 6 | byte2;
								if (codePoint >= 0x80) {
									return codePoint;
								} else {
									throw Error('Invalid continuation byte');
								}
							}

							// 3-byte sequence (may include unpaired surrogates)
							if ((byte1 & 0xF0) == 0xE0) {
								byte2 = readContinuationByte();
								byte3 = readContinuationByte();
								codePoint = (byte1 & 0x0F) << 12 | byte2 << 6 | byte3;
								if (codePoint >= 0x0800) {
									checkScalarValue(codePoint);
									return codePoint;
								} else {
									throw Error('Invalid continuation byte');
								}
							}

							// 4-byte sequence
							if ((byte1 & 0xF8) == 0xF0) {
								byte2 = readContinuationByte();
								byte3 = readContinuationByte();
								byte4 = readContinuationByte();
								codePoint = (byte1 & 0x0F) << 0x12 | byte2 << 0x0C | byte3 << 0x06 | byte4;
								if (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {
									return codePoint;
								}
							}

							throw Error('Invalid UTF-8 detected');
						}

						var byteArray;
						var byteCount;
						var byteIndex;
						function utf8decode(byteString) {
							byteArray = ucs2decode(byteString);
							byteCount = byteArray.length;
							byteIndex = 0;
							var codePoints = [];
							var tmp;
							while ((tmp = decodeSymbol()) !== false) {
								codePoints.push(tmp);
							}
							return ucs2encode(codePoints);
						}

						/*--------------------------------------------------------------------------*/

						var utf8 = {
							'version': '2.0.0',
							'encode': utf8encode,
							'decode': utf8decode
						};

						// Some AMD build optimizers, like r.js, check for specific condition patterns
						// like the following:
						if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {
							define(function () {
								return utf8;
							});
						} else if (freeExports && !freeExports.nodeType) {
							if (freeModule) {
								// in Node.js or RingoJS v0.8.0+
								freeModule.exports = utf8;
							} else {
								// in Narwhal or RingoJS v0.7.0-
								var object = {};
								var hasOwnProperty = object.hasOwnProperty;
								for (var key in utf8) {
									hasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);
								}
							}
						} else {
							// in Rhino or a web browser
							root.utf8 = utf8;
						}
					})(this);
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}], 30: [function (_dereq_, module, exports) {
				'use strict';

				var alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''),
				    length = 64,
				    map = {},
				    seed = 0,
				    i = 0,
				    prev;

				/**
     * Return a string representing the specified number.
     *
     * @param {Number} num The number to convert.
     * @returns {String} The string representation of the number.
     * @api public
     */
				function encode(num) {
					var encoded = '';

					do {
						encoded = alphabet[num % length] + encoded;
						num = Math.floor(num / length);
					} while (num > 0);

					return encoded;
				}

				/**
     * Return the integer value specified by the given string.
     *
     * @param {String} str The string to convert.
     * @returns {Number} The integer value represented by the string.
     * @api public
     */
				function decode(str) {
					var decoded = 0;

					for (i = 0; i < str.length; i++) {
						decoded = decoded * length + map[str.charAt(i)];
					}

					return decoded;
				}

				/**
     * Yeast: A tiny growing id generator.
     *
     * @returns {String} A unique id.
     * @api public
     */
				function yeast() {
					var now = encode(+new Date());

					if (now !== prev) return seed = 0, prev = now;
					return now + '.' + encode(seed++);
				}

				//
				// Map each character to its index.
				//
				for (; i < length; i++) map[alphabet[i]] = i;

				//
				// Expose the `yeast`, `encode` and `decode` functions.
				//
				yeast.encode = encode;
				yeast.decode = decode;
				module.exports = yeast;
			}, {}], 31: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var url = _dereq_('./url');
				var parser = _dereq_('socket.io-parser');
				var Manager = _dereq_('./manager');
				var debug = _dereq_('debug')('socket.io-client');

				/**
     * Module exports.
     */

				module.exports = exports = lookup;

				/**
     * Managers cache.
     */

				var cache = exports.managers = {};

				/**
     * Looks up an existing `Manager` for multiplexing.
     * If the user summons:
     *
     *   `io('http://localhost/a');`
     *   `io('http://localhost/b');`
     *
     * We reuse the existing instance based on same scheme/port/host,
     * and we initialize sockets for each namespace.
     *
     * @api public
     */

				function lookup(uri, opts) {
					if (typeof uri == 'object') {
						opts = uri;
						uri = undefined;
					}

					opts = opts || {};

					var parsed = url(uri);
					var source = parsed.source;
					var id = parsed.id;
					var path = parsed.path;
					var sameNamespace = cache[id] && path in cache[id].nsps;
					var newConnection = opts.forceNew || opts['force new connection'] || false === opts.multiplex || sameNamespace;

					var io;

					if (newConnection) {
						debug('ignoring socket cache for %s', source);
						io = Manager(source, opts);
					} else {
						if (!cache[id]) {
							debug('new io instance for %s', source);
							cache[id] = Manager(source, opts);
						}
						io = cache[id];
					}

					return io.socket(parsed.path);
				}

				/**
     * Protocol version.
     *
     * @api public
     */

				exports.protocol = parser.protocol;

				/**
     * `connect`.
     *
     * @param {String} uri
     * @api public
     */

				exports.connect = lookup;

				/**
     * Expose constructors for standalone build.
     *
     * @api public
     */

				exports.Manager = _dereq_('./manager');
				exports.Socket = _dereq_('./socket');
			}, { "./manager": 32, "./socket": 34, "./url": 35, "debug": 39, "socket.io-parser": 47 }], 32: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var eio = _dereq_('engine.io-client');
				var Socket = _dereq_('./socket');
				var Emitter = _dereq_('component-emitter');
				var parser = _dereq_('socket.io-parser');
				var on = _dereq_('./on');
				var bind = _dereq_('component-bind');
				var debug = _dereq_('debug')('socket.io-client:manager');
				var indexOf = _dereq_('indexof');
				var Backoff = _dereq_('backo2');

				/**
     * IE6+ hasOwnProperty
     */

				var has = Object.prototype.hasOwnProperty;

				/**
     * Module exports
     */

				module.exports = Manager;

				/**
     * `Manager` constructor.
     *
     * @param {String} engine instance or engine uri/opts
     * @param {Object} options
     * @api public
     */

				function Manager(uri, opts) {
					if (!(this instanceof Manager)) return new Manager(uri, opts);
					if (uri && 'object' == typeof uri) {
						opts = uri;
						uri = undefined;
					}
					opts = opts || {};

					opts.path = opts.path || '/socket.io';
					this.nsps = {};
					this.subs = [];
					this.opts = opts;
					this.reconnection(opts.reconnection !== false);
					this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);
					this.reconnectionDelay(opts.reconnectionDelay || 1000);
					this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);
					this.randomizationFactor(opts.randomizationFactor || 0.5);
					this.backoff = new Backoff({
						min: this.reconnectionDelay(),
						max: this.reconnectionDelayMax(),
						jitter: this.randomizationFactor()
					});
					this.timeout(null == opts.timeout ? 20000 : opts.timeout);
					this.readyState = 'closed';
					this.uri = uri;
					this.connecting = [];
					this.lastPing = null;
					this.encoding = false;
					this.packetBuffer = [];
					this.encoder = new parser.Encoder();
					this.decoder = new parser.Decoder();
					this.autoConnect = opts.autoConnect !== false;
					if (this.autoConnect) this.open();
				}

				/**
     * Propagate given event to sockets and emit on `this`
     *
     * @api private
     */

				Manager.prototype.emitAll = function () {
					this.emit.apply(this, arguments);
					for (var nsp in this.nsps) {
						if (has.call(this.nsps, nsp)) {
							this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);
						}
					}
				};

				/**
     * Update `socket.id` of all sockets
     *
     * @api private
     */

				Manager.prototype.updateSocketIds = function () {
					for (var nsp in this.nsps) {
						if (has.call(this.nsps, nsp)) {
							this.nsps[nsp].id = this.engine.id;
						}
					}
				};

				/**
     * Mix in `Emitter`.
     */

				Emitter(Manager.prototype);

				/**
     * Sets the `reconnection` config.
     *
     * @param {Boolean} true/false if it should automatically reconnect
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnection = function (v) {
					if (!arguments.length) return this._reconnection;
					this._reconnection = !!v;
					return this;
				};

				/**
     * Sets the reconnection attempts config.
     *
     * @param {Number} max reconnection attempts before giving up
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionAttempts = function (v) {
					if (!arguments.length) return this._reconnectionAttempts;
					this._reconnectionAttempts = v;
					return this;
				};

				/**
     * Sets the delay between reconnections.
     *
     * @param {Number} delay
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionDelay = function (v) {
					if (!arguments.length) return this._reconnectionDelay;
					this._reconnectionDelay = v;
					this.backoff && this.backoff.setMin(v);
					return this;
				};

				Manager.prototype.randomizationFactor = function (v) {
					if (!arguments.length) return this._randomizationFactor;
					this._randomizationFactor = v;
					this.backoff && this.backoff.setJitter(v);
					return this;
				};

				/**
     * Sets the maximum delay between reconnections.
     *
     * @param {Number} delay
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionDelayMax = function (v) {
					if (!arguments.length) return this._reconnectionDelayMax;
					this._reconnectionDelayMax = v;
					this.backoff && this.backoff.setMax(v);
					return this;
				};

				/**
     * Sets the connection timeout. `false` to disable
     *
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.timeout = function (v) {
					if (!arguments.length) return this._timeout;
					this._timeout = v;
					return this;
				};

				/**
     * Starts trying to reconnect if reconnection is enabled and we have not
     * started reconnecting yet
     *
     * @api private
     */

				Manager.prototype.maybeReconnectOnOpen = function () {
					// Only try to reconnect if it's the first time we're connecting
					if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {
						// keeps reconnection from firing twice for the same reconnection loop
						this.reconnect();
					}
				};

				/**
     * Sets the current transport `socket`.
     *
     * @param {Function} optional, callback
     * @return {Manager} self
     * @api public
     */

				Manager.prototype.open = Manager.prototype.connect = function (fn) {
					debug('readyState %s', this.readyState);
					if (~this.readyState.indexOf('open')) return this;

					debug('opening %s', this.uri);
					this.engine = eio(this.uri, this.opts);
					var socket = this.engine;
					var self = this;
					this.readyState = 'opening';
					this.skipReconnect = false;

					// emit `open`
					var openSub = on(socket, 'open', function () {
						self.onopen();
						fn && fn();
					});

					// emit `connect_error`
					var errorSub = on(socket, 'error', function (data) {
						debug('connect_error');
						self.cleanup();
						self.readyState = 'closed';
						self.emitAll('connect_error', data);
						if (fn) {
							var err = new Error('Connection error');
							err.data = data;
							fn(err);
						} else {
							// Only do this if there is no fn to handle the error
							self.maybeReconnectOnOpen();
						}
					});

					// emit `connect_timeout`
					if (false !== this._timeout) {
						var timeout = this._timeout;
						debug('connect attempt will timeout after %d', timeout);

						// set timer
						var timer = setTimeout(function () {
							debug('connect attempt timed out after %d', timeout);
							openSub.destroy();
							socket.close();
							socket.emit('error', 'timeout');
							self.emitAll('connect_timeout', timeout);
						}, timeout);

						this.subs.push({
							destroy: function destroy() {
								clearTimeout(timer);
							}
						});
					}

					this.subs.push(openSub);
					this.subs.push(errorSub);

					return this;
				};

				/**
     * Called upon transport open.
     *
     * @api private
     */

				Manager.prototype.onopen = function () {
					debug('open');

					// clear old subs
					this.cleanup();

					// mark as open
					this.readyState = 'open';
					this.emit('open');

					// add new subs
					var socket = this.engine;
					this.subs.push(on(socket, 'data', bind(this, 'ondata')));
					this.subs.push(on(socket, 'ping', bind(this, 'onping')));
					this.subs.push(on(socket, 'pong', bind(this, 'onpong')));
					this.subs.push(on(socket, 'error', bind(this, 'onerror')));
					this.subs.push(on(socket, 'close', bind(this, 'onclose')));
					this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));
				};

				/**
     * Called upon a ping.
     *
     * @api private
     */

				Manager.prototype.onping = function () {
					this.lastPing = new Date();
					this.emitAll('ping');
				};

				/**
     * Called upon a packet.
     *
     * @api private
     */

				Manager.prototype.onpong = function () {
					this.emitAll('pong', new Date() - this.lastPing);
				};

				/**
     * Called with data.
     *
     * @api private
     */

				Manager.prototype.ondata = function (data) {
					this.decoder.add(data);
				};

				/**
     * Called when parser fully decodes a packet.
     *
     * @api private
     */

				Manager.prototype.ondecoded = function (packet) {
					this.emit('packet', packet);
				};

				/**
     * Called upon socket error.
     *
     * @api private
     */

				Manager.prototype.onerror = function (err) {
					debug('error', err);
					this.emitAll('error', err);
				};

				/**
     * Creates a new socket for the given `nsp`.
     *
     * @return {Socket}
     * @api public
     */

				Manager.prototype.socket = function (nsp) {
					var socket = this.nsps[nsp];
					if (!socket) {
						socket = new Socket(this, nsp);
						this.nsps[nsp] = socket;
						var self = this;
						socket.on('connecting', onConnecting);
						socket.on('connect', function () {
							socket.id = self.engine.id;
						});

						if (this.autoConnect) {
							// manually call here since connecting evnet is fired before listening
							onConnecting();
						}
					}

					function onConnecting() {
						if (! ~indexOf(self.connecting, socket)) {
							self.connecting.push(socket);
						}
					}

					return socket;
				};

				/**
     * Called upon a socket close.
     *
     * @param {Socket} socket
     */

				Manager.prototype.destroy = function (socket) {
					var index = indexOf(this.connecting, socket);
					if (~index) this.connecting.splice(index, 1);
					if (this.connecting.length) return;

					this.close();
				};

				/**
     * Writes a packet.
     *
     * @param {Object} packet
     * @api private
     */

				Manager.prototype.packet = function (packet) {
					debug('writing packet %j', packet);
					var self = this;

					if (!self.encoding) {
						// encode, then write to engine with result
						self.encoding = true;
						this.encoder.encode(packet, function (encodedPackets) {
							for (var i = 0; i < encodedPackets.length; i++) {
								self.engine.write(encodedPackets[i], packet.options);
							}
							self.encoding = false;
							self.processPacketQueue();
						});
					} else {
						// add packet to the queue
						self.packetBuffer.push(packet);
					}
				};

				/**
     * If packet buffer is non-empty, begins encoding the
     * next packet in line.
     *
     * @api private
     */

				Manager.prototype.processPacketQueue = function () {
					if (this.packetBuffer.length > 0 && !this.encoding) {
						var pack = this.packetBuffer.shift();
						this.packet(pack);
					}
				};

				/**
     * Clean up transport subscriptions and packet buffer.
     *
     * @api private
     */

				Manager.prototype.cleanup = function () {
					debug('cleanup');

					var sub;
					while (sub = this.subs.shift()) sub.destroy();

					this.packetBuffer = [];
					this.encoding = false;
					this.lastPing = null;

					this.decoder.destroy();
				};

				/**
     * Close the current socket.
     *
     * @api private
     */

				Manager.prototype.close = Manager.prototype.disconnect = function () {
					debug('disconnect');
					this.skipReconnect = true;
					this.reconnecting = false;
					if ('opening' == this.readyState) {
						// `onclose` will not fire because
						// an open event never happened
						this.cleanup();
					}
					this.backoff.reset();
					this.readyState = 'closed';
					if (this.engine) this.engine.close();
				};

				/**
     * Called upon engine close.
     *
     * @api private
     */

				Manager.prototype.onclose = function (reason) {
					debug('onclose');

					this.cleanup();
					this.backoff.reset();
					this.readyState = 'closed';
					this.emit('close', reason);

					if (this._reconnection && !this.skipReconnect) {
						this.reconnect();
					}
				};

				/**
     * Attempt a reconnection.
     *
     * @api private
     */

				Manager.prototype.reconnect = function () {
					if (this.reconnecting || this.skipReconnect) return this;

					var self = this;

					if (this.backoff.attempts >= this._reconnectionAttempts) {
						debug('reconnect failed');
						this.backoff.reset();
						this.emitAll('reconnect_failed');
						this.reconnecting = false;
					} else {
						var delay = this.backoff.duration();
						debug('will wait %dms before reconnect attempt', delay);

						this.reconnecting = true;
						var timer = setTimeout(function () {
							if (self.skipReconnect) return;

							debug('attempting reconnect');
							self.emitAll('reconnect_attempt', self.backoff.attempts);
							self.emitAll('reconnecting', self.backoff.attempts);

							// check again for the case socket closed in above events
							if (self.skipReconnect) return;

							self.open(function (err) {
								if (err) {
									debug('reconnect attempt error');
									self.reconnecting = false;
									self.reconnect();
									self.emitAll('reconnect_error', err.data);
								} else {
									debug('reconnect success');
									self.onreconnect();
								}
							});
						}, delay);

						this.subs.push({
							destroy: function destroy() {
								clearTimeout(timer);
							}
						});
					}
				};

				/**
     * Called upon successful reconnect.
     *
     * @api private
     */

				Manager.prototype.onreconnect = function () {
					var attempt = this.backoff.attempts;
					this.reconnecting = false;
					this.backoff.reset();
					this.updateSocketIds();
					this.emitAll('reconnect', attempt);
				};
			}, { "./on": 33, "./socket": 34, "backo2": 36, "component-bind": 37, "component-emitter": 38, "debug": 39, "engine.io-client": 1, "indexof": 42, "socket.io-parser": 47 }], 33: [function (_dereq_, module, exports) {

				/**
     * Module exports.
     */

				module.exports = on;

				/**
     * Helper for subscriptions.
     *
     * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`
     * @param {String} event name
     * @param {Function} callback
     * @api public
     */

				function on(obj, ev, fn) {
					obj.on(ev, fn);
					return {
						destroy: function destroy() {
							obj.removeListener(ev, fn);
						}
					};
				}
			}, {}], 34: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var parser = _dereq_('socket.io-parser');
				var Emitter = _dereq_('component-emitter');
				var toArray = _dereq_('to-array');
				var on = _dereq_('./on');
				var bind = _dereq_('component-bind');
				var debug = _dereq_('debug')('socket.io-client:socket');
				var hasBin = _dereq_('has-binary');

				/**
     * Module exports.
     */

				module.exports = exports = Socket;

				/**
     * Internal events (blacklisted).
     * These events can't be emitted by the user.
     *
     * @api private
     */

				var events = {
					connect: 1,
					connect_error: 1,
					connect_timeout: 1,
					connecting: 1,
					disconnect: 1,
					error: 1,
					reconnect: 1,
					reconnect_attempt: 1,
					reconnect_failed: 1,
					reconnect_error: 1,
					reconnecting: 1,
					ping: 1,
					pong: 1
				};

				/**
     * Shortcut to `Emitter#emit`.
     */

				var emit = Emitter.prototype.emit;

				/**
     * `Socket` constructor.
     *
     * @api public
     */

				function Socket(io, nsp) {
					this.io = io;
					this.nsp = nsp;
					this.json = this; // compat
					this.ids = 0;
					this.acks = {};
					this.receiveBuffer = [];
					this.sendBuffer = [];
					this.connected = false;
					this.disconnected = true;
					if (this.io.autoConnect) this.open();
				}

				/**
     * Mix in `Emitter`.
     */

				Emitter(Socket.prototype);

				/**
     * Subscribe to open, close and packet events
     *
     * @api private
     */

				Socket.prototype.subEvents = function () {
					if (this.subs) return;

					var io = this.io;
					this.subs = [on(io, 'open', bind(this, 'onopen')), on(io, 'packet', bind(this, 'onpacket')), on(io, 'close', bind(this, 'onclose'))];
				};

				/**
     * "Opens" the socket.
     *
     * @api public
     */

				Socket.prototype.open = Socket.prototype.connect = function () {
					if (this.connected) return this;

					this.subEvents();
					this.io.open(); // ensure open
					if ('open' == this.io.readyState) this.onopen();
					this.emit('connecting');
					return this;
				};

				/**
     * Sends a `message` event.
     *
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.send = function () {
					var args = toArray(arguments);
					args.unshift('message');
					this.emit.apply(this, args);
					return this;
				};

				/**
     * Override `emit`.
     * If the event is in `events`, it's emitted normally.
     *
     * @param {String} event name
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.emit = function (ev) {
					if (events.hasOwnProperty(ev)) {
						emit.apply(this, arguments);
						return this;
					}

					var args = toArray(arguments);
					var parserType = parser.EVENT; // default
					if (hasBin(args)) {
						parserType = parser.BINARY_EVENT;
					} // binary
					var packet = { type: parserType, data: args };

					packet.options = {};
					packet.options.compress = !this.flags || false !== this.flags.compress;

					// event ack callback
					if ('function' == typeof args[args.length - 1]) {
						debug('emitting packet with ack id %d', this.ids);
						this.acks[this.ids] = args.pop();
						packet.id = this.ids++;
					}

					if (this.connected) {
						this.packet(packet);
					} else {
						this.sendBuffer.push(packet);
					}

					delete this.flags;

					return this;
				};

				/**
     * Sends a packet.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.packet = function (packet) {
					packet.nsp = this.nsp;
					this.io.packet(packet);
				};

				/**
     * Called upon engine `open`.
     *
     * @api private
     */

				Socket.prototype.onopen = function () {
					debug('transport is open - connecting');

					// write connect packet if necessary
					if ('/' != this.nsp) {
						this.packet({ type: parser.CONNECT });
					}
				};

				/**
     * Called upon engine `close`.
     *
     * @param {String} reason
     * @api private
     */

				Socket.prototype.onclose = function (reason) {
					debug('close (%s)', reason);
					this.connected = false;
					this.disconnected = true;
					delete this.id;
					this.emit('disconnect', reason);
				};

				/**
     * Called with socket packet.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onpacket = function (packet) {
					if (packet.nsp != this.nsp) return;

					switch (packet.type) {
						case parser.CONNECT:
							this.onconnect();
							break;

						case parser.EVENT:
							this.onevent(packet);
							break;

						case parser.BINARY_EVENT:
							this.onevent(packet);
							break;

						case parser.ACK:
							this.onack(packet);
							break;

						case parser.BINARY_ACK:
							this.onack(packet);
							break;

						case parser.DISCONNECT:
							this.ondisconnect();
							break;

						case parser.ERROR:
							this.emit('error', packet.data);
							break;
					}
				};

				/**
     * Called upon a server event.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onevent = function (packet) {
					var args = packet.data || [];
					debug('emitting event %j', args);

					if (null != packet.id) {
						debug('attaching ack callback to event');
						args.push(this.ack(packet.id));
					}

					if (this.connected) {
						emit.apply(this, args);
					} else {
						this.receiveBuffer.push(args);
					}
				};

				/**
     * Produces an ack callback to emit with an event.
     *
     * @api private
     */

				Socket.prototype.ack = function (id) {
					var self = this;
					var sent = false;
					return function () {
						// prevent double callbacks
						if (sent) return;
						sent = true;
						var args = toArray(arguments);
						debug('sending ack %j', args);

						var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;
						self.packet({
							type: type,
							id: id,
							data: args
						});
					};
				};

				/**
     * Called upon a server acknowlegement.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onack = function (packet) {
					var ack = this.acks[packet.id];
					if ('function' == typeof ack) {
						debug('calling ack %s with %j', packet.id, packet.data);
						ack.apply(this, packet.data);
						delete this.acks[packet.id];
					} else {
						debug('bad ack %s', packet.id);
					}
				};

				/**
     * Called upon server connect.
     *
     * @api private
     */

				Socket.prototype.onconnect = function () {
					this.connected = true;
					this.disconnected = false;
					this.emit('connect');
					this.emitBuffered();
				};

				/**
     * Emit buffered events (received and emitted).
     *
     * @api private
     */

				Socket.prototype.emitBuffered = function () {
					var i;
					for (i = 0; i < this.receiveBuffer.length; i++) {
						emit.apply(this, this.receiveBuffer[i]);
					}
					this.receiveBuffer = [];

					for (i = 0; i < this.sendBuffer.length; i++) {
						this.packet(this.sendBuffer[i]);
					}
					this.sendBuffer = [];
				};

				/**
     * Called upon server disconnect.
     *
     * @api private
     */

				Socket.prototype.ondisconnect = function () {
					debug('server disconnect (%s)', this.nsp);
					this.destroy();
					this.onclose('io server disconnect');
				};

				/**
     * Called upon forced client/server side disconnections,
     * this method ensures the manager stops tracking us and
     * that reconnections don't get triggered for this.
     *
     * @api private.
     */

				Socket.prototype.destroy = function () {
					if (this.subs) {
						// clean subscriptions to avoid reconnections
						for (var i = 0; i < this.subs.length; i++) {
							this.subs[i].destroy();
						}
						this.subs = null;
					}

					this.io.destroy(this);
				};

				/**
     * Disconnects the socket manually.
     *
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.close = Socket.prototype.disconnect = function () {
					if (this.connected) {
						debug('performing disconnect (%s)', this.nsp);
						this.packet({ type: parser.DISCONNECT });
					}

					// remove socket from pool
					this.destroy();

					if (this.connected) {
						// fire events
						this.onclose('io client disconnect');
					}
					return this;
				};

				/**
     * Sets the compress flag.
     *
     * @param {Boolean} if `true`, compresses the sending data
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.compress = function (compress) {
					this.flags = this.flags || {};
					this.flags.compress = compress;
					return this;
				};
			}, { "./on": 33, "component-bind": 37, "component-emitter": 38, "debug": 39, "has-binary": 41, "socket.io-parser": 47, "to-array": 51 }], 35: [function (_dereq_, module, exports) {
				(function (global) {

					/**
      * Module dependencies.
      */

					var parseuri = _dereq_('parseuri');
					var debug = _dereq_('debug')('socket.io-client:url');

					/**
      * Module exports.
      */

					module.exports = url;

					/**
      * URL parser.
      *
      * @param {String} url
      * @param {Object} An object meant to mimic window.location.
      *                 Defaults to window.location.
      * @api public
      */

					function url(uri, loc) {
						var obj = uri;

						// default to window.location
						var loc = loc || global.location;
						if (null == uri) uri = loc.protocol + '//' + loc.host;

						// relative path support
						if ('string' == typeof uri) {
							if ('/' == uri.charAt(0)) {
								if ('/' == uri.charAt(1)) {
									uri = loc.protocol + uri;
								} else {
									uri = loc.host + uri;
								}
							}

							if (!/^(https?|wss?):\/\//.test(uri)) {
								debug('protocol-less url %s', uri);
								if ('undefined' != typeof loc) {
									uri = loc.protocol + '//' + uri;
								} else {
									uri = 'https://' + uri;
								}
							}

							// parse
							debug('parse %s', uri);
							obj = parseuri(uri);
						}

						// make sure we treat `localhost:80` and `localhost` equally
						if (!obj.port) {
							if (/^(http|ws)$/.test(obj.protocol)) {
								obj.port = '80';
							} else if (/^(http|ws)s$/.test(obj.protocol)) {
								obj.port = '443';
							}
						}

						obj.path = obj.path || '/';

						var ipv6 = obj.host.indexOf(':') !== -1;
						var host = ipv6 ? '[' + obj.host + ']' : obj.host;

						// define unique id
						obj.id = obj.protocol + '://' + host + ':' + obj.port;
						// define href
						obj.href = obj.protocol + '://' + host + (loc && loc.port == obj.port ? '' : ':' + obj.port);

						return obj;
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "debug": 39, "parseuri": 45 }], 36: [function (_dereq_, module, exports) {

				/**
     * Expose `Backoff`.
     */

				module.exports = Backoff;

				/**
     * Initialize backoff timer with `opts`.
     *
     * - `min` initial timeout in milliseconds [100]
     * - `max` max timeout [10000]
     * - `jitter` [0]
     * - `factor` [2]
     *
     * @param {Object} opts
     * @api public
     */

				function Backoff(opts) {
					opts = opts || {};
					this.ms = opts.min || 100;
					this.max = opts.max || 10000;
					this.factor = opts.factor || 2;
					this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;
					this.attempts = 0;
				}

				/**
     * Return the backoff duration.
     *
     * @return {Number}
     * @api public
     */

				Backoff.prototype.duration = function () {
					var ms = this.ms * Math.pow(this.factor, this.attempts++);
					if (this.jitter) {
						var rand = Math.random();
						var deviation = Math.floor(rand * this.jitter * ms);
						ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;
					}
					return Math.min(ms, this.max) | 0;
				};

				/**
     * Reset the number of attempts.
     *
     * @api public
     */

				Backoff.prototype.reset = function () {
					this.attempts = 0;
				};

				/**
     * Set the minimum duration
     *
     * @api public
     */

				Backoff.prototype.setMin = function (min) {
					this.ms = min;
				};

				/**
     * Set the maximum duration
     *
     * @api public
     */

				Backoff.prototype.setMax = function (max) {
					this.max = max;
				};

				/**
     * Set the jitter
     *
     * @api public
     */

				Backoff.prototype.setJitter = function (jitter) {
					this.jitter = jitter;
				};
			}, {}], 37: [function (_dereq_, module, exports) {
				/**
     * Slice reference.
     */

				var slice = [].slice;

				/**
     * Bind `obj` to `fn`.
     *
     * @param {Object} obj
     * @param {Function|String} fn or string
     * @return {Function}
     * @api public
     */

				module.exports = function (obj, fn) {
					if ('string' == typeof fn) fn = obj[fn];
					if ('function' != typeof fn) throw new Error('bind() requires a function');
					var args = slice.call(arguments, 2);
					return function () {
						return fn.apply(obj, args.concat(slice.call(arguments)));
					};
				};
			}, {}], 38: [function (_dereq_, module, exports) {

				/**
     * Expose `Emitter`.
     */

				module.exports = Emitter;

				/**
     * Initialize a new `Emitter`.
     *
     * @api public
     */

				function Emitter(obj) {
					if (obj) return mixin(obj);
				};

				/**
     * Mixin the emitter properties.
     *
     * @param {Object} obj
     * @return {Object}
     * @api private
     */

				function mixin(obj) {
					for (var key in Emitter.prototype) {
						obj[key] = Emitter.prototype[key];
					}
					return obj;
				}

				/**
     * Listen on the given `event` with `fn`.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};
					(this._callbacks['$' + event] = this._callbacks['$' + event] || []).push(fn);
					return this;
				};

				/**
     * Adds an `event` listener that will be invoked a single
     * time then automatically removed.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.once = function (event, fn) {
					function on() {
						this.off(event, on);
						fn.apply(this, arguments);
					}

					on.fn = fn;
					this.on(event, on);
					return this;
				};

				/**
     * Remove the given callback for `event` or all
     * registered callbacks.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};

					// all
					if (0 == arguments.length) {
						this._callbacks = {};
						return this;
					}

					// specific event
					var callbacks = this._callbacks['$' + event];
					if (!callbacks) return this;

					// remove all handlers
					if (1 == arguments.length) {
						delete this._callbacks['$' + event];
						return this;
					}

					// remove specific handler
					var cb;
					for (var i = 0; i < callbacks.length; i++) {
						cb = callbacks[i];
						if (cb === fn || cb.fn === fn) {
							callbacks.splice(i, 1);
							break;
						}
					}
					return this;
				};

				/**
     * Emit `event` with the given args.
     *
     * @param {String} event
     * @param {Mixed} ...
     * @return {Emitter}
     */

				Emitter.prototype.emit = function (event) {
					this._callbacks = this._callbacks || {};
					var args = [].slice.call(arguments, 1),
					    callbacks = this._callbacks['$' + event];

					if (callbacks) {
						callbacks = callbacks.slice(0);
						for (var i = 0, len = callbacks.length; i < len; ++i) {
							callbacks[i].apply(this, args);
						}
					}

					return this;
				};

				/**
     * Return array of callbacks for `event`.
     *
     * @param {String} event
     * @return {Array}
     * @api public
     */

				Emitter.prototype.listeners = function (event) {
					this._callbacks = this._callbacks || {};
					return this._callbacks['$' + event] || [];
				};

				/**
     * Check if this emitter has `event` handlers.
     *
     * @param {String} event
     * @return {Boolean}
     * @api public
     */

				Emitter.prototype.hasListeners = function (event) {
					return !!this.listeners(event).length;
				};
			}, {}], 39: [function (_dereq_, module, exports) {
				arguments[4][17][0].apply(exports, arguments);
			}, { "./debug": 40, "dup": 17 }], 40: [function (_dereq_, module, exports) {
				arguments[4][18][0].apply(exports, arguments);
			}, { "dup": 18, "ms": 44 }], 41: [function (_dereq_, module, exports) {
				(function (global) {

					/*
      * Module requirements.
      */

					var isArray = _dereq_('isarray');

					/**
      * Module exports.
      */

					module.exports = hasBinary;

					/**
      * Checks for binary data.
      *
      * Right now only Buffer and ArrayBuffer are supported..
      *
      * @param {Object} anything
      * @api public
      */

					function hasBinary(data) {

						function _hasBinary(obj) {
							if (!obj) return false;

							if (global.Buffer && global.Buffer.isBuffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								return true;
							}

							if (isArray(obj)) {
								for (var i = 0; i < obj.length; i++) {
									if (_hasBinary(obj[i])) {
										return true;
									}
								}
							} else if (obj && 'object' == typeof obj) {
								// see: https://github.com/Automattic/has-binary/pull/4
								if (obj.toJSON && 'function' == typeof obj.toJSON) {
									obj = obj.toJSON();
								}

								for (var key in obj) {
									if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
										return true;
									}
								}
							}

							return false;
						}

						return _hasBinary(data);
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "isarray": 43 }], 42: [function (_dereq_, module, exports) {
				arguments[4][23][0].apply(exports, arguments);
			}, { "dup": 23 }], 43: [function (_dereq_, module, exports) {
				arguments[4][24][0].apply(exports, arguments);
			}, { "dup": 24 }], 44: [function (_dereq_, module, exports) {
				arguments[4][25][0].apply(exports, arguments);
			}, { "dup": 25 }], 45: [function (_dereq_, module, exports) {
				arguments[4][28][0].apply(exports, arguments);
			}, { "dup": 28 }], 46: [function (_dereq_, module, exports) {
				(function (global) {
					/*global Blob,File*/

					/**
      * Module requirements
      */

					var isArray = _dereq_('isarray');
					var isBuf = _dereq_('./is-buffer');

					/**
      * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.
      * Anything with blobs or files should be fed through removeBlobs before coming
      * here.
      *
      * @param {Object} packet - socket.io event packet
      * @return {Object} with deconstructed packet and list of buffers
      * @api public
      */

					exports.deconstructPacket = function (packet) {
						var buffers = [];
						var packetData = packet.data;

						function _deconstructPacket(data) {
							if (!data) return data;

							if (isBuf(data)) {
								var placeholder = { _placeholder: true, num: buffers.length };
								buffers.push(data);
								return placeholder;
							} else if (isArray(data)) {
								var newData = new Array(data.length);
								for (var i = 0; i < data.length; i++) {
									newData[i] = _deconstructPacket(data[i]);
								}
								return newData;
							} else if ('object' == typeof data && !(data instanceof Date)) {
								var newData = {};
								for (var key in data) {
									newData[key] = _deconstructPacket(data[key]);
								}
								return newData;
							}
							return data;
						}

						var pack = packet;
						pack.data = _deconstructPacket(packetData);
						pack.attachments = buffers.length; // number of binary 'attachments'
						return { packet: pack, buffers: buffers };
					};

					/**
      * Reconstructs a binary packet from its placeholder packet and buffers
      *
      * @param {Object} packet - event packet with placeholders
      * @param {Array} buffers - binary buffers to put in placeholder positions
      * @return {Object} reconstructed packet
      * @api public
      */

					exports.reconstructPacket = function (packet, buffers) {
						var curPlaceHolder = 0;

						function _reconstructPacket(data) {
							if (data && data._placeholder) {
								var buf = buffers[data.num]; // appropriate buffer (should be natural order anyway)
								return buf;
							} else if (isArray(data)) {
								for (var i = 0; i < data.length; i++) {
									data[i] = _reconstructPacket(data[i]);
								}
								return data;
							} else if (data && 'object' == typeof data) {
								for (var key in data) {
									data[key] = _reconstructPacket(data[key]);
								}
								return data;
							}
							return data;
						}

						packet.data = _reconstructPacket(packet.data);
						packet.attachments = undefined; // no longer useful
						return packet;
					};

					/**
      * Asynchronously removes Blobs or Files from data via
      * FileReader's readAsArrayBuffer method. Used before encoding
      * data as msgpack. Calls callback with the blobless data.
      *
      * @param {Object} data
      * @param {Function} callback
      * @api private
      */

					exports.removeBlobs = function (data, callback) {
						function _removeBlobs(obj, curKey, containingObject) {
							if (!obj) return obj;

							// convert any blob
							if (global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								pendingBlobs++;

								// async filereader
								var fileReader = new FileReader();
								fileReader.onload = function () {
									// this.result == arraybuffer
									if (containingObject) {
										containingObject[curKey] = this.result;
									} else {
										bloblessData = this.result;
									}

									// if nothing pending its callback time
									if (! --pendingBlobs) {
										callback(bloblessData);
									}
								};

								fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer
							} else if (isArray(obj)) {
									// handle array
									for (var i = 0; i < obj.length; i++) {
										_removeBlobs(obj[i], i, obj);
									}
								} else if (obj && 'object' == typeof obj && !isBuf(obj)) {
									// and object
									for (var key in obj) {
										_removeBlobs(obj[key], key, obj);
									}
								}
						}

						var pendingBlobs = 0;
						var bloblessData = data;
						_removeBlobs(bloblessData);
						if (!pendingBlobs) {
							callback(bloblessData);
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, { "./is-buffer": 48, "isarray": 43 }], 47: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var debug = _dereq_('debug')('socket.io-parser');
				var json = _dereq_('json3');
				var isArray = _dereq_('isarray');
				var Emitter = _dereq_('component-emitter');
				var binary = _dereq_('./binary');
				var isBuf = _dereq_('./is-buffer');

				/**
     * Protocol version.
     *
     * @api public
     */

				exports.protocol = 4;

				/**
     * Packet types.
     *
     * @api public
     */

				exports.types = ['CONNECT', 'DISCONNECT', 'EVENT', 'BINARY_EVENT', 'ACK', 'BINARY_ACK', 'ERROR'];

				/**
     * Packet type `connect`.
     *
     * @api public
     */

				exports.CONNECT = 0;

				/**
     * Packet type `disconnect`.
     *
     * @api public
     */

				exports.DISCONNECT = 1;

				/**
     * Packet type `event`.
     *
     * @api public
     */

				exports.EVENT = 2;

				/**
     * Packet type `ack`.
     *
     * @api public
     */

				exports.ACK = 3;

				/**
     * Packet type `error`.
     *
     * @api public
     */

				exports.ERROR = 4;

				/**
     * Packet type 'binary event'
     *
     * @api public
     */

				exports.BINARY_EVENT = 5;

				/**
     * Packet type `binary ack`. For acks with binary arguments.
     *
     * @api public
     */

				exports.BINARY_ACK = 6;

				/**
     * Encoder constructor.
     *
     * @api public
     */

				exports.Encoder = Encoder;

				/**
     * Decoder constructor.
     *
     * @api public
     */

				exports.Decoder = Decoder;

				/**
     * A socket.io Encoder instance
     *
     * @api public
     */

				function Encoder() {}

				/**
     * Encode a packet as a single string if non-binary, or as a
     * buffer sequence, depending on packet type.
     *
     * @param {Object} obj - packet object
     * @param {Function} callback - function to handle encodings (likely engine.write)
     * @return Calls callback with Array of encodings
     * @api public
     */

				Encoder.prototype.encode = function (obj, callback) {
					debug('encoding packet %j', obj);

					if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
						encodeAsBinary(obj, callback);
					} else {
						var encoding = encodeAsString(obj);
						callback([encoding]);
					}
				};

				/**
     * Encode packet as string.
     *
     * @param {Object} packet
     * @return {String} encoded
     * @api private
     */

				function encodeAsString(obj) {
					var str = '';
					var nsp = false;

					// first is type
					str += obj.type;

					// attachments if we have them
					if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
						str += obj.attachments;
						str += '-';
					}

					// if we have a namespace other than `/`
					// we append it followed by a comma `,`
					if (obj.nsp && '/' != obj.nsp) {
						nsp = true;
						str += obj.nsp;
					}

					// immediately followed by the id
					if (null != obj.id) {
						if (nsp) {
							str += ',';
							nsp = false;
						}
						str += obj.id;
					}

					// json data
					if (null != obj.data) {
						if (nsp) str += ',';
						str += json.stringify(obj.data);
					}

					debug('encoded %j as %s', obj, str);
					return str;
				}

				/**
     * Encode packet as 'buffer sequence' by removing blobs, and
     * deconstructing packet into object with placeholders and
     * a list of buffers.
     *
     * @param {Object} packet
     * @return {Buffer} encoded
     * @api private
     */

				function encodeAsBinary(obj, callback) {

					function writeEncoding(bloblessData) {
						var deconstruction = binary.deconstructPacket(bloblessData);
						var pack = encodeAsString(deconstruction.packet);
						var buffers = deconstruction.buffers;

						buffers.unshift(pack); // add packet info to beginning of data list
						callback(buffers); // write all the buffers
					}

					binary.removeBlobs(obj, writeEncoding);
				}

				/**
     * A socket.io Decoder instance
     *
     * @return {Object} decoder
     * @api public
     */

				function Decoder() {
					this.reconstructor = null;
				}

				/**
     * Mix in `Emitter` with Decoder.
     */

				Emitter(Decoder.prototype);

				/**
     * Decodes an ecoded packet string into packet JSON.
     *
     * @param {String} obj - encoded packet
     * @return {Object} packet
     * @api public
     */

				Decoder.prototype.add = function (obj) {
					var packet;
					if ('string' == typeof obj) {
						packet = decodeString(obj);
						if (exports.BINARY_EVENT == packet.type || exports.BINARY_ACK == packet.type) {
							// binary packet's json
							this.reconstructor = new BinaryReconstructor(packet);

							// no attachments, labeled binary but no binary data to follow
							if (this.reconstructor.reconPack.attachments === 0) {
								this.emit('decoded', packet);
							}
						} else {
							// non-binary full packet
							this.emit('decoded', packet);
						}
					} else if (isBuf(obj) || obj.base64) {
						// raw binary data
						if (!this.reconstructor) {
							throw new Error('got binary data when not reconstructing a packet');
						} else {
							packet = this.reconstructor.takeBinaryData(obj);
							if (packet) {
								// received final buffer
								this.reconstructor = null;
								this.emit('decoded', packet);
							}
						}
					} else {
						throw new Error('Unknown type: ' + obj);
					}
				};

				/**
     * Decode a packet String (JSON data)
     *
     * @param {String} str
     * @return {Object} packet
     * @api private
     */

				function decodeString(str) {
					var p = {};
					var i = 0;

					// look up type
					p.type = Number(str.charAt(0));
					if (null == exports.types[p.type]) return error();

					// look up attachments if type binary
					if (exports.BINARY_EVENT == p.type || exports.BINARY_ACK == p.type) {
						var buf = '';
						while (str.charAt(++i) != '-') {
							buf += str.charAt(i);
							if (i == str.length) break;
						}
						if (buf != Number(buf) || str.charAt(i) != '-') {
							throw new Error('Illegal attachments');
						}
						p.attachments = Number(buf);
					}

					// look up namespace (if any)
					if ('/' == str.charAt(i + 1)) {
						p.nsp = '';
						while (++i) {
							var c = str.charAt(i);
							if (',' == c) break;
							p.nsp += c;
							if (i == str.length) break;
						}
					} else {
						p.nsp = '/';
					}

					// look up id
					var next = str.charAt(i + 1);
					if ('' !== next && Number(next) == next) {
						p.id = '';
						while (++i) {
							var c = str.charAt(i);
							if (null == c || Number(c) != c) {
								--i;
								break;
							}
							p.id += str.charAt(i);
							if (i == str.length) break;
						}
						p.id = Number(p.id);
					}

					// look up json data
					if (str.charAt(++i)) {
						try {
							p.data = json.parse(str.substr(i));
						} catch (e) {
							return error();
						}
					}

					debug('decoded %s as %j', str, p);
					return p;
				}

				/**
     * Deallocates a parser's resources
     *
     * @api public
     */

				Decoder.prototype.destroy = function () {
					if (this.reconstructor) {
						this.reconstructor.finishedReconstruction();
					}
				};

				/**
     * A manager of a binary event's 'buffer sequence'. Should
     * be constructed whenever a packet of type BINARY_EVENT is
     * decoded.
     *
     * @param {Object} packet
     * @return {BinaryReconstructor} initialized reconstructor
     * @api private
     */

				function BinaryReconstructor(packet) {
					this.reconPack = packet;
					this.buffers = [];
				}

				/**
     * Method to be called when binary data received from connection
     * after a BINARY_EVENT packet.
     *
     * @param {Buffer | ArrayBuffer} binData - the raw binary data received
     * @return {null | Object} returns null if more binary data is expected or
     *   a reconstructed packet object if all buffers have been received.
     * @api private
     */

				BinaryReconstructor.prototype.takeBinaryData = function (binData) {
					this.buffers.push(binData);
					if (this.buffers.length == this.reconPack.attachments) {
						// done with buffer list
						var packet = binary.reconstructPacket(this.reconPack, this.buffers);
						this.finishedReconstruction();
						return packet;
					}
					return null;
				};

				/**
     * Cleans up binary packet reconstruction variables.
     *
     * @api private
     */

				BinaryReconstructor.prototype.finishedReconstruction = function () {
					this.reconPack = null;
					this.buffers = [];
				};

				function error(data) {
					return {
						type: exports.ERROR,
						data: 'parser error'
					};
				}
			}, { "./binary": 46, "./is-buffer": 48, "component-emitter": 49, "debug": 39, "isarray": 43, "json3": 50 }], 48: [function (_dereq_, module, exports) {
				(function (global) {

					module.exports = isBuf;

					/**
      * Returns true if obj is a buffer or an arraybuffer.
      *
      * @api private
      */

					function isBuf(obj) {
						return global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer;
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}], 49: [function (_dereq_, module, exports) {
				arguments[4][15][0].apply(exports, arguments);
			}, { "dup": 15 }], 50: [function (_dereq_, module, exports) {
				(function (global) {
					/*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org */
					;(function () {
						// Detect the `define` function exposed by asynchronous module loaders. The
						// strict `define` check is necessary for compatibility with `r.js`.
						var isLoader = typeof define === "function" && define.amd;

						// A set of types used to distinguish objects from primitives.
						var objectTypes = {
							"function": true,
							"object": true
						};

						// Detect the `exports` object exposed by CommonJS implementations.
						var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;

						// Use the `global` object exposed by Node (including Browserify via
						// `insert-module-globals`), Narwhal, and Ringo as the default context,
						// and the `window` object in browsers. Rhino exports a `global` function
						// instead.
						var root = objectTypes[typeof window] && window || this,
						    freeGlobal = freeExports && objectTypes[typeof module] && module && !module.nodeType && typeof global == "object" && global;

						if (freeGlobal && (freeGlobal["global"] === freeGlobal || freeGlobal["window"] === freeGlobal || freeGlobal["self"] === freeGlobal)) {
							root = freeGlobal;
						}

						// Public: Initializes JSON 3 using the given `context` object, attaching the
						// `stringify` and `parse` functions to the specified `exports` object.
						function runInContext(context, exports) {
							context || (context = root["Object"]());
							exports || (exports = root["Object"]());

							// Native constructor aliases.
							var Number = context["Number"] || root["Number"],
							    String = context["String"] || root["String"],
							    Object = context["Object"] || root["Object"],
							    Date = context["Date"] || root["Date"],
							    SyntaxError = context["SyntaxError"] || root["SyntaxError"],
							    TypeError = context["TypeError"] || root["TypeError"],
							    Math = context["Math"] || root["Math"],
							    nativeJSON = context["JSON"] || root["JSON"];

							// Delegate to the native `stringify` and `parse` implementations.
							if (typeof nativeJSON == "object" && nativeJSON) {
								exports.stringify = nativeJSON.stringify;
								exports.parse = nativeJSON.parse;
							}

							// Convenience aliases.
							var objectProto = Object.prototype,
							    getClass = objectProto.toString,
							    isProperty,
							    forEach,
							    undef;

							// Test the `Date#getUTC*` methods. Based on work by @Yaffle.
							var isExtended = new Date(-3509827334573292);
							try {
								// The `getUTCFullYear`, `Month`, and `Date` methods return nonsensical
								// results for certain dates in Opera >= 10.53.
								isExtended = isExtended.getUTCFullYear() == -109252 && isExtended.getUTCMonth() === 0 && isExtended.getUTCDate() === 1 &&
								// Safari < 2.0.2 stores the internal millisecond time value correctly,
								// but clips the values returned by the date methods to the range of
								// signed 32-bit integers ([-2 ** 31, 2 ** 31 - 1]).
								isExtended.getUTCHours() == 10 && isExtended.getUTCMinutes() == 37 && isExtended.getUTCSeconds() == 6 && isExtended.getUTCMilliseconds() == 708;
							} catch (exception) {}

							// Internal: Determines whether the native `JSON.stringify` and `parse`
							// implementations are spec-compliant. Based on work by Ken Snyder.
							function has(name) {
								if (has[name] !== undef) {
									// Return cached feature test result.
									return has[name];
								}
								var isSupported;
								if (name == "bug-string-char-index") {
									// IE <= 7 doesn't support accessing string characters using square
									// bracket notation. IE 8 only supports this for primitives.
									isSupported = "a"[0] != "a";
								} else if (name == "json") {
									// Indicates whether both `JSON.stringify` and `JSON.parse` are
									// supported.
									isSupported = has("json-stringify") && has("json-parse");
								} else {
									var value,
									    serialized = "{\"a\":[1,true,false,null,\"\\u0000\\b\\n\\f\\r\\t\"]}";
									// Test `JSON.stringify`.
									if (name == "json-stringify") {
										var stringify = exports.stringify,
										    stringifySupported = typeof stringify == "function" && isExtended;
										if (stringifySupported) {
											// A test function object with a custom `toJSON` method.
											(value = function () {
												return 1;
											}).toJSON = value;
											try {
												stringifySupported =
												// Firefox 3.1b1 and b2 serialize string, number, and boolean
												// primitives as object literals.
												stringify(0) === "0" &&
												// FF 3.1b1, b2, and JSON 2 serialize wrapped primitives as object
												// literals.
												stringify(new Number()) === "0" && stringify(new String()) == '""' &&
												// FF 3.1b1, 2 throw an error if the value is `null`, `undefined`, or
												// does not define a canonical JSON representation (this applies to
												// objects with `toJSON` properties as well, *unless* they are nested
												// within an object or array).
												stringify(getClass) === undef &&
												// IE 8 serializes `undefined` as `"undefined"`. Safari <= 5.1.7 and
												// FF 3.1b3 pass this test.
												stringify(undef) === undef &&
												// Safari <= 5.1.7 and FF 3.1b3 throw `Error`s and `TypeError`s,
												// respectively, if the value is omitted entirely.
												stringify() === undef &&
												// FF 3.1b1, 2 throw an error if the given value is not a number,
												// string, array, object, Boolean, or `null` literal. This applies to
												// objects with custom `toJSON` methods as well, unless they are nested
												// inside object or array literals. YUI 3.0.0b1 ignores custom `toJSON`
												// methods entirely.
												stringify(value) === "1" && stringify([value]) == "[1]" &&
												// Prototype <= 1.6.1 serializes `[undefined]` as `"[]"` instead of
												// `"[null]"`.
												stringify([undef]) == "[null]" &&
												// YUI 3.0.0b1 fails to serialize `null` literals.
												stringify(null) == "null" &&
												// FF 3.1b1, 2 halts serialization if an array contains a function:
												// `[1, true, getClass, 1]` serializes as "[1,true,],". FF 3.1b3
												// elides non-JSON values from objects and arrays, unless they
												// define custom `toJSON` methods.
												stringify([undef, getClass, null]) == "[null,null,null]" &&
												// Simple serialization test. FF 3.1b1 uses Unicode escape sequences
												// where character escape codes are expected (e.g., `\b` => `\u0008`).
												stringify({ "a": [value, true, false, null, "\x00\b\n\f\r\t"] }) == serialized &&
												// FF 3.1b1 and b2 ignore the `filter` and `width` arguments.
												stringify(null, value) === "1" && stringify([1, 2], null, 1) == "[\n 1,\n 2\n]" &&
												// JSON 2, Prototype <= 1.7, and older WebKit builds incorrectly
												// serialize extended years.
												stringify(new Date(-8.64e15)) == '"-271821-04-20T00:00:00.000Z"' &&
												// The milliseconds are optional in ES 5, but required in 5.1.
												stringify(new Date(8.64e15)) == '"+275760-09-13T00:00:00.000Z"' &&
												// Firefox <= 11.0 incorrectly serializes years prior to 0 as negative
												// four-digit years instead of six-digit years. Credits: @Yaffle.
												stringify(new Date(-621987552e5)) == '"-000001-01-01T00:00:00.000Z"' &&
												// Safari <= 5.1.5 and Opera >= 10.53 incorrectly serialize millisecond
												// values less than 1000. Credits: @Yaffle.
												stringify(new Date(-1)) == '"1969-12-31T23:59:59.999Z"';
											} catch (exception) {
												stringifySupported = false;
											}
										}
										isSupported = stringifySupported;
									}
									// Test `JSON.parse`.
									if (name == "json-parse") {
										var parse = exports.parse;
										if (typeof parse == "function") {
											try {
												// FF 3.1b1, b2 will throw an exception if a bare literal is provided.
												// Conforming implementations should also coerce the initial argument to
												// a string prior to parsing.
												if (parse("0") === 0 && !parse(false)) {
													// Simple parsing test.
													value = parse(serialized);
													var parseSupported = value["a"].length == 5 && value["a"][0] === 1;
													if (parseSupported) {
														try {
															// Safari <= 5.1.2 and FF 3.1b1 allow unescaped tabs in strings.
															parseSupported = !parse('"\t"');
														} catch (exception) {}
														if (parseSupported) {
															try {
																// FF 4.0 and 4.0.1 allow leading `+` signs and leading
																// decimal points. FF 4.0, 4.0.1, and IE 9-10 also allow
																// certain octal literals.
																parseSupported = parse("01") !== 1;
															} catch (exception) {}
														}
														if (parseSupported) {
															try {
																// FF 4.0, 4.0.1, and Rhino 1.7R3-R4 allow trailing decimal
																// points. These environments, along with FF 3.1b1 and 2,
																// also allow trailing commas in JSON objects and arrays.
																parseSupported = parse("1.") !== 1;
															} catch (exception) {}
														}
													}
												}
											} catch (exception) {
												parseSupported = false;
											}
										}
										isSupported = parseSupported;
									}
								}
								return has[name] = !!isSupported;
							}

							if (!has("json")) {
								// Common `[[Class]]` name aliases.
								var functionClass = "[object Function]",
								    dateClass = "[object Date]",
								    numberClass = "[object Number]",
								    stringClass = "[object String]",
								    arrayClass = "[object Array]",
								    booleanClass = "[object Boolean]";

								// Detect incomplete support for accessing string characters by index.
								var charIndexBuggy = has("bug-string-char-index");

								// Define additional utility methods if the `Date` methods are buggy.
								if (!isExtended) {
									var floor = Math.floor;
									// A mapping between the months of the year and the number of days between
									// January 1st and the first of the respective month.
									var Months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
									// Internal: Calculates the number of days between the Unix epoch and the
									// first day of the given month.
									var getDay = function getDay(year, month) {
										return Months[month] + 365 * (year - 1970) + floor((year - 1969 + (month = +(month > 1))) / 4) - floor((year - 1901 + month) / 100) + floor((year - 1601 + month) / 400);
									};
								}

								// Internal: Determines if a property is a direct property of the given
								// object. Delegates to the native `Object#hasOwnProperty` method.
								if (!(isProperty = objectProto.hasOwnProperty)) {
									isProperty = function (property) {
										var members = {},
										    constructor;
										if ((members.__proto__ = null, members.__proto__ = {
											// The *proto* property cannot be set multiple times in recent
											// versions of Firefox and SeaMonkey.
											"toString": 1
										}, members).toString != getClass) {
											// Safari <= 2.0.3 doesn't implement `Object#hasOwnProperty`, but
											// supports the mutable *proto* property.
											isProperty = function (property) {
												// Capture and break the object's prototype chain (see section 8.6.2
												// of the ES 5.1 spec). The parenthesized expression prevents an
												// unsafe transformation by the Closure Compiler.
												var original = this.__proto__,
												    result = (property in (this.__proto__ = null, this));
												// Restore the original prototype chain.
												this.__proto__ = original;
												return result;
											};
										} else {
											// Capture a reference to the top-level `Object` constructor.
											constructor = members.constructor;
											// Use the `constructor` property to simulate `Object#hasOwnProperty` in
											// other environments.
											isProperty = function (property) {
												var parent = (this.constructor || constructor).prototype;
												return property in this && !(property in parent && this[property] === parent[property]);
											};
										}
										members = null;
										return isProperty.call(this, property);
									};
								}

								// Internal: Normalizes the `for...in` iteration algorithm across
								// environments. Each enumerated key is yielded to a `callback` function.
								forEach = function (object, callback) {
									var size = 0,
									    Properties,
									    members,
									    property;

									// Tests for bugs in the current environment's `for...in` algorithm. The
									// `valueOf` property inherits the non-enumerable flag from
									// `Object.prototype` in older versions of IE, Netscape, and Mozilla.
									(Properties = function () {
										this.valueOf = 0;
									}).prototype.valueOf = 0;

									// Iterate over a new instance of the `Properties` class.
									members = new Properties();
									for (property in members) {
										// Ignore all properties inherited from `Object.prototype`.
										if (isProperty.call(members, property)) {
											size++;
										}
									}
									Properties = members = null;

									// Normalize the iteration algorithm.
									if (!size) {
										// A list of non-enumerable properties inherited from `Object.prototype`.
										members = ["valueOf", "toString", "toLocaleString", "propertyIsEnumerable", "isPrototypeOf", "hasOwnProperty", "constructor"];
										// IE <= 8, Mozilla 1.0, and Netscape 6.2 ignore shadowed non-enumerable
										// properties.
										forEach = function (object, callback) {
											var isFunction = getClass.call(object) == functionClass,
											    property,
											    length;
											var hasProperty = !isFunction && typeof object.constructor != "function" && objectTypes[typeof object.hasOwnProperty] && object.hasOwnProperty || isProperty;
											for (property in object) {
												// Gecko <= 1.0 enumerates the `prototype` property of functions under
												// certain conditions; IE does not.
												if (!(isFunction && property == "prototype") && hasProperty.call(object, property)) {
													callback(property);
												}
											}
											// Manually invoke the callback for each non-enumerable property.
											for (length = members.length; property = members[--length]; hasProperty.call(object, property) && callback(property));
										};
									} else if (size == 2) {
										// Safari <= 2.0.4 enumerates shadowed properties twice.
										forEach = function (object, callback) {
											// Create a set of iterated properties.
											var members = {},
											    isFunction = getClass.call(object) == functionClass,
											    property;
											for (property in object) {
												// Store each property name to prevent double enumeration. The
												// `prototype` property of functions is not enumerated due to cross-
												// environment inconsistencies.
												if (!(isFunction && property == "prototype") && !isProperty.call(members, property) && (members[property] = 1) && isProperty.call(object, property)) {
													callback(property);
												}
											}
										};
									} else {
										// No bugs detected; use the standard `for...in` algorithm.
										forEach = function (object, callback) {
											var isFunction = getClass.call(object) == functionClass,
											    property,
											    isConstructor;
											for (property in object) {
												if (!(isFunction && property == "prototype") && isProperty.call(object, property) && !(isConstructor = property === "constructor")) {
													callback(property);
												}
											}
											// Manually invoke the callback for the `constructor` property due to
											// cross-environment inconsistencies.
											if (isConstructor || isProperty.call(object, property = "constructor")) {
												callback(property);
											}
										};
									}
									return forEach(object, callback);
								};

								// Public: Serializes a JavaScript `value` as a JSON string. The optional
								// `filter` argument may specify either a function that alters how object and
								// array members are serialized, or an array of strings and numbers that
								// indicates which properties should be serialized. The optional `width`
								// argument may be either a string or number that specifies the indentation
								// level of the output.
								if (!has("json-stringify")) {
									// Internal: A map of control characters and their escaped equivalents.
									var Escapes = {
										92: "\\\\",
										34: '\\"',
										8: "\\b",
										12: "\\f",
										10: "\\n",
										13: "\\r",
										9: "\\t"
									};

									// Internal: Converts `value` into a zero-padded string such that its
									// length is at least equal to `width`. The `width` must be <= 6.
									var leadingZeroes = "000000";
									var toPaddedString = function toPaddedString(width, value) {
										// The `|| 0` expression is necessary to work around a bug in
										// Opera <= 7.54u2 where `0 == -0`, but `String(-0) !== "0"`.
										return (leadingZeroes + (value || 0)).slice(-width);
									};

									// Internal: Double-quotes a string `value`, replacing all ASCII control
									// characters (characters with code unit values between 0 and 31) with
									// their escaped equivalents. This is an implementation of the
									// `Quote(value)` operation defined in ES 5.1 section 15.12.3.
									var unicodePrefix = "\\u00";
									var quote = function quote(value) {
										var result = '"',
										    index = 0,
										    length = value.length,
										    useCharIndex = !charIndexBuggy || length > 10;
										var symbols = useCharIndex && (charIndexBuggy ? value.split("") : value);
										for (; index < length; index++) {
											var charCode = value.charCodeAt(index);
											// If the character is a control character, append its Unicode or
											// shorthand escape sequence; otherwise, append the character as-is.
											switch (charCode) {
												case 8:case 9:case 10:case 12:case 13:case 34:case 92:
													result += Escapes[charCode];
													break;
												default:
													if (charCode < 32) {
														result += unicodePrefix + toPaddedString(2, charCode.toString(16));
														break;
													}
													result += useCharIndex ? symbols[index] : value.charAt(index);
											}
										}
										return result + '"';
									};

									// Internal: Recursively serializes an object. Implements the
									// `Str(key, holder)`, `JO(value)`, and `JA(value)` operations.
									var serialize = function serialize(property, object, callback, properties, whitespace, indentation, stack) {
										var value, className, year, month, date, time, hours, minutes, seconds, milliseconds, results, element, index, length, prefix, result;
										try {
											// Necessary for host object support.
											value = object[property];
										} catch (exception) {}
										if (typeof value == "object" && value) {
											className = getClass.call(value);
											if (className == dateClass && !isProperty.call(value, "toJSON")) {
												if (value > -1 / 0 && value < 1 / 0) {
													// Dates are serialized according to the `Date#toJSON` method
													// specified in ES 5.1 section 15.9.5.44. See section 15.9.1.15
													// for the ISO 8601 date time string format.
													if (getDay) {
														// Manually compute the year, month, date, hours, minutes,
														// seconds, and milliseconds if the `getUTC*` methods are
														// buggy. Adapted from @Yaffle's `date-shim` project.
														date = floor(value / 864e5);
														for (year = floor(date / 365.2425) + 1970 - 1; getDay(year + 1, 0) <= date; year++);
														for (month = floor((date - getDay(year, 0)) / 30.42); getDay(year, month + 1) <= date; month++);
														date = 1 + date - getDay(year, month);
														// The `time` value specifies the time within the day (see ES
														// 5.1 section 15.9.1.2). The formula `(A % B + B) % B` is used
														// to compute `A modulo B`, as the `%` operator does not
														// correspond to the `modulo` operation for negative numbers.
														time = (value % 864e5 + 864e5) % 864e5;
														// The hours, minutes, seconds, and milliseconds are obtained by
														// decomposing the time within the day. See section 15.9.1.10.
														hours = floor(time / 36e5) % 24;
														minutes = floor(time / 6e4) % 60;
														seconds = floor(time / 1e3) % 60;
														milliseconds = time % 1e3;
													} else {
														year = value.getUTCFullYear();
														month = value.getUTCMonth();
														date = value.getUTCDate();
														hours = value.getUTCHours();
														minutes = value.getUTCMinutes();
														seconds = value.getUTCSeconds();
														milliseconds = value.getUTCMilliseconds();
													}
													// Serialize extended years correctly.
													value = (year <= 0 || year >= 1e4 ? (year < 0 ? "-" : "+") + toPaddedString(6, year < 0 ? -year : year) : toPaddedString(4, year)) + "-" + toPaddedString(2, month + 1) + "-" + toPaddedString(2, date) +
													// Months, dates, hours, minutes, and seconds should have two
													// digits; milliseconds should have three.
													"T" + toPaddedString(2, hours) + ":" + toPaddedString(2, minutes) + ":" + toPaddedString(2, seconds) +
													// Milliseconds are optional in ES 5.0, but required in 5.1.
													"." + toPaddedString(3, milliseconds) + "Z";
												} else {
													value = null;
												}
											} else if (typeof value.toJSON == "function" && (className != numberClass && className != stringClass && className != arrayClass || isProperty.call(value, "toJSON"))) {
												// Prototype <= 1.6.1 adds non-standard `toJSON` methods to the
												// `Number`, `String`, `Date`, and `Array` prototypes. JSON 3
												// ignores all `toJSON` methods on these objects unless they are
												// defined directly on an instance.
												value = value.toJSON(property);
											}
										}
										if (callback) {
											// If a replacement function was provided, call it to obtain the value
											// for serialization.
											value = callback.call(object, property, value);
										}
										if (value === null) {
											return "null";
										}
										className = getClass.call(value);
										if (className == booleanClass) {
											// Booleans are represented literally.
											return "" + value;
										} else if (className == numberClass) {
											// JSON numbers must be finite. `Infinity` and `NaN` are serialized as
											// `"null"`.
											return value > -1 / 0 && value < 1 / 0 ? "" + value : "null";
										} else if (className == stringClass) {
											// Strings are double-quoted and escaped.
											return quote("" + value);
										}
										// Recursively serialize objects and arrays.
										if (typeof value == "object") {
											// Check for cyclic structures. This is a linear search; performance
											// is inversely proportional to the number of unique nested objects.
											for (length = stack.length; length--;) {
												if (stack[length] === value) {
													// Cyclic structures cannot be serialized by `JSON.stringify`.
													throw TypeError();
												}
											}
											// Add the object to the stack of traversed objects.
											stack.push(value);
											results = [];
											// Save the current indentation level and indent one additional level.
											prefix = indentation;
											indentation += whitespace;
											if (className == arrayClass) {
												// Recursively serialize array elements.
												for (index = 0, length = value.length; index < length; index++) {
													element = serialize(index, value, callback, properties, whitespace, indentation, stack);
													results.push(element === undef ? "null" : element);
												}
												result = results.length ? whitespace ? "[\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "]" : "[" + results.join(",") + "]" : "[]";
											} else {
												// Recursively serialize object members. Members are selected from
												// either a user-specified list of property names, or the object
												// itself.
												forEach(properties || value, function (property) {
													var element = serialize(property, value, callback, properties, whitespace, indentation, stack);
													if (element !== undef) {
														// According to ES 5.1 section 15.12.3: "If `gap` {whitespace}
														// is not the empty string, let `member` {quote(property) + ":"}
														// be the concatenation of `member` and the `space` character."
														// The "`space` character" refers to the literal space
														// character, not the `space` {width} argument provided to
														// `JSON.stringify`.
														results.push(quote(property) + ":" + (whitespace ? " " : "") + element);
													}
												});
												result = results.length ? whitespace ? "{\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "}" : "{" + results.join(",") + "}" : "{}";
											}
											// Remove the object from the traversed object stack.
											stack.pop();
											return result;
										}
									};

									// Public: `JSON.stringify`. See ES 5.1 section 15.12.3.
									exports.stringify = function (source, filter, width) {
										var whitespace, callback, properties, className;
										if (objectTypes[typeof filter] && filter) {
											if ((className = getClass.call(filter)) == functionClass) {
												callback = filter;
											} else if (className == arrayClass) {
												// Convert the property names array into a makeshift set.
												properties = {};
												for (var index = 0, length = filter.length, value; index < length; value = filter[index++], (className = getClass.call(value), className == stringClass || className == numberClass) && (properties[value] = 1));
											}
										}
										if (width) {
											if ((className = getClass.call(width)) == numberClass) {
												// Convert the `width` to an integer and create a string containing
												// `width` number of space characters.
												if ((width -= width % 1) > 0) {
													for (whitespace = "", width > 10 && (width = 10); whitespace.length < width; whitespace += " ");
												}
											} else if (className == stringClass) {
												whitespace = width.length <= 10 ? width : width.slice(0, 10);
											}
										}
										// Opera <= 7.54u2 discards the values associated with empty string keys
										// (`""`) only if they are used directly within an object member list
										// (e.g., `!("" in { "": 1})`).
										return serialize("", (value = {}, value[""] = source, value), callback, properties, whitespace, "", []);
									};
								}

								// Public: Parses a JSON source string.
								if (!has("json-parse")) {
									var fromCharCode = String.fromCharCode;

									// Internal: A map of escaped control characters and their unescaped
									// equivalents.
									var Unescapes = {
										92: "\\",
										34: '"',
										47: "/",
										98: "\b",
										116: "\t",
										110: "\n",
										102: "\f",
										114: "\r"
									};

									// Internal: Stores the parser state.
									var Index, Source;

									// Internal: Resets the parser state and throws a `SyntaxError`.
									var abort = function abort() {
										Index = Source = null;
										throw SyntaxError();
									};

									// Internal: Returns the next token, or `"$"` if the parser has reached
									// the end of the source string. A token may be a string, number, `null`
									// literal, or Boolean literal.
									var lex = function lex() {
										var source = Source,
										    length = source.length,
										    value,
										    begin,
										    position,
										    isSigned,
										    charCode;
										while (Index < length) {
											charCode = source.charCodeAt(Index);
											switch (charCode) {
												case 9:case 10:case 13:case 32:
													// Skip whitespace tokens, including tabs, carriage returns, line
													// feeds, and space characters.
													Index++;
													break;
												case 123:case 125:case 91:case 93:case 58:case 44:
													// Parse a punctuator token (`{`, `}`, `[`, `]`, `:`, or `,`) at
													// the current position.
													value = charIndexBuggy ? source.charAt(Index) : source[Index];
													Index++;
													return value;
												case 34:
													// `"` delimits a JSON string; advance to the next character and
													// begin parsing the string. String tokens are prefixed with the
													// sentinel `@` character to distinguish them from punctuators and
													// end-of-string tokens.
													for (value = "@", Index++; Index < length;) {
														charCode = source.charCodeAt(Index);
														if (charCode < 32) {
															// Unescaped ASCII control characters (those with a code unit
															// less than the space character) are not permitted.
															abort();
														} else if (charCode == 92) {
															// A reverse solidus (`\`) marks the beginning of an escaped
															// control character (including `"`, `\`, and `/`) or Unicode
															// escape sequence.
															charCode = source.charCodeAt(++Index);
															switch (charCode) {
																case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:
																	// Revive escaped control characters.
																	value += Unescapes[charCode];
																	Index++;
																	break;
																case 117:
																	// `\u` marks the beginning of a Unicode escape sequence.
																	// Advance to the first character and validate the
																	// four-digit code point.
																	begin = ++Index;
																	for (position = Index + 4; Index < position; Index++) {
																		charCode = source.charCodeAt(Index);
																		// A valid sequence comprises four hexdigits (case-
																		// insensitive) that form a single hexadecimal value.
																		if (!(charCode >= 48 && charCode <= 57 || charCode >= 97 && charCode <= 102 || charCode >= 65 && charCode <= 70)) {
																			// Invalid Unicode escape sequence.
																			abort();
																		}
																	}
																	// Revive the escaped character.
																	value += fromCharCode("0x" + source.slice(begin, Index));
																	break;
																default:
																	// Invalid escape sequence.
																	abort();
															}
														} else {
															if (charCode == 34) {
																// An unescaped double-quote character marks the end of the
																// string.
																break;
															}
															charCode = source.charCodeAt(Index);
															begin = Index;
															// Optimize for the common case where a string is valid.
															while (charCode >= 32 && charCode != 92 && charCode != 34) {
																charCode = source.charCodeAt(++Index);
															}
															// Append the string as-is.
															value += source.slice(begin, Index);
														}
													}
													if (source.charCodeAt(Index) == 34) {
														// Advance to the next character and return the revived string.
														Index++;
														return value;
													}
													// Unterminated string.
													abort();
												default:
													// Parse numbers and literals.
													begin = Index;
													// Advance past the negative sign, if one is specified.
													if (charCode == 45) {
														isSigned = true;
														charCode = source.charCodeAt(++Index);
													}
													// Parse an integer or floating-point value.
													if (charCode >= 48 && charCode <= 57) {
														// Leading zeroes are interpreted as octal literals.
														if (charCode == 48 && (charCode = source.charCodeAt(Index + 1), charCode >= 48 && charCode <= 57)) {
															// Illegal octal literal.
															abort();
														}
														isSigned = false;
														// Parse the integer component.
														for (; Index < length && (charCode = source.charCodeAt(Index), charCode >= 48 && charCode <= 57); Index++);
														// Floats cannot contain a leading decimal point; however, this
														// case is already accounted for by the parser.
														if (source.charCodeAt(Index) == 46) {
															position = ++Index;
															// Parse the decimal component.
															for (; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++);
															if (position == Index) {
																// Illegal trailing decimal.
																abort();
															}
															Index = position;
														}
														// Parse exponents. The `e` denoting the exponent is
														// case-insensitive.
														charCode = source.charCodeAt(Index);
														if (charCode == 101 || charCode == 69) {
															charCode = source.charCodeAt(++Index);
															// Skip past the sign following the exponent, if one is
															// specified.
															if (charCode == 43 || charCode == 45) {
																Index++;
															}
															// Parse the exponential component.
															for (position = Index; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++);
															if (position == Index) {
																// Illegal empty exponent.
																abort();
															}
															Index = position;
														}
														// Coerce the parsed value to a JavaScript number.
														return +source.slice(begin, Index);
													}
													// A negative sign may only precede numbers.
													if (isSigned) {
														abort();
													}
													// `true`, `false`, and `null` literals.
													if (source.slice(Index, Index + 4) == "true") {
														Index += 4;
														return true;
													} else if (source.slice(Index, Index + 5) == "false") {
														Index += 5;
														return false;
													} else if (source.slice(Index, Index + 4) == "null") {
														Index += 4;
														return null;
													}
													// Unrecognized token.
													abort();
											}
										}
										// Return the sentinel `$` character if the parser has reached the end
										// of the source string.
										return "$";
									};

									// Internal: Parses a JSON `value` token.
									var get = function get(value) {
										var results, hasMembers;
										if (value == "$") {
											// Unexpected end of input.
											abort();
										}
										if (typeof value == "string") {
											if ((charIndexBuggy ? value.charAt(0) : value[0]) == "@") {
												// Remove the sentinel `@` character.
												return value.slice(1);
											}
											// Parse object and array literals.
											if (value == "[") {
												// Parses a JSON array, returning a new JavaScript array.
												results = [];
												for (;; hasMembers || (hasMembers = true)) {
													value = lex();
													// A closing square bracket marks the end of the array literal.
													if (value == "]") {
														break;
													}
													// If the array literal contains elements, the current token
													// should be a comma separating the previous element from the
													// next.
													if (hasMembers) {
														if (value == ",") {
															value = lex();
															if (value == "]") {
																// Unexpected trailing `,` in array literal.
																abort();
															}
														} else {
															// A `,` must separate each array element.
															abort();
														}
													}
													// Elisions and leading commas are not permitted.
													if (value == ",") {
														abort();
													}
													results.push(get(value));
												}
												return results;
											} else if (value == "{") {
												// Parses a JSON object, returning a new JavaScript object.
												results = {};
												for (;; hasMembers || (hasMembers = true)) {
													value = lex();
													// A closing curly brace marks the end of the object literal.
													if (value == "}") {
														break;
													}
													// If the object literal contains members, the current token
													// should be a comma separator.
													if (hasMembers) {
														if (value == ",") {
															value = lex();
															if (value == "}") {
																// Unexpected trailing `,` in object literal.
																abort();
															}
														} else {
															// A `,` must separate each object member.
															abort();
														}
													}
													// Leading commas are not permitted, object property names must be
													// double-quoted strings, and a `:` must separate each property
													// name and value.
													if (value == "," || typeof value != "string" || (charIndexBuggy ? value.charAt(0) : value[0]) != "@" || lex() != ":") {
														abort();
													}
													results[value.slice(1)] = get(lex());
												}
												return results;
											}
											// Unexpected token encountered.
											abort();
										}
										return value;
									};

									// Internal: Updates a traversed object member.
									var update = function update(source, property, callback) {
										var element = walk(source, property, callback);
										if (element === undef) {
											delete source[property];
										} else {
											source[property] = element;
										}
									};

									// Internal: Recursively traverses a parsed JSON object, invoking the
									// `callback` function for each value. This is an implementation of the
									// `Walk(holder, name)` operation defined in ES 5.1 section 15.12.2.
									var walk = function walk(source, property, callback) {
										var value = source[property],
										    length;
										if (typeof value == "object" && value) {
											// `forEach` can't be used to traverse an array in Opera <= 8.54
											// because its `Object#hasOwnProperty` implementation returns `false`
											// for array indices (e.g., `![1, 2, 3].hasOwnProperty("0")`).
											if (getClass.call(value) == arrayClass) {
												for (length = value.length; length--;) {
													update(value, length, callback);
												}
											} else {
												forEach(value, function (property) {
													update(value, property, callback);
												});
											}
										}
										return callback.call(source, property, value);
									};

									// Public: `JSON.parse`. See ES 5.1 section 15.12.2.
									exports.parse = function (source, callback) {
										var result, value;
										Index = 0;
										Source = "" + source;
										result = get(lex());
										// If a JSON string contains multiple tokens, it is invalid.
										if (lex() != "$") {
											abort();
										}
										// Reset the parser state.
										Index = Source = null;
										return callback && getClass.call(callback) == functionClass ? walk((value = {}, value[""] = result, value), "", callback) : result;
									};
								}
							}

							exports["runInContext"] = runInContext;
							return exports;
						}

						if (freeExports && !isLoader) {
							// Export for CommonJS environments.
							runInContext(root, freeExports);
						} else {
							// Export for web browsers and JavaScript engines.
							var nativeJSON = root.JSON,
							    previousJSON = root["JSON3"],
							    isRestored = false;

							var JSON3 = runInContext(root, root["JSON3"] = {
								// Public: Restores the original value of the global `JSON` object and
								// returns a reference to the `JSON3` object.
								"noConflict": function noConflict() {
									if (!isRestored) {
										isRestored = true;
										root.JSON = nativeJSON;
										root["JSON3"] = previousJSON;
										nativeJSON = previousJSON = null;
									}
									return JSON3;
								}
							});

							root.JSON = {
								"parse": JSON3.parse,
								"stringify": JSON3.stringify
							};
						}

						// Export for asynchronous module loaders.
						if (isLoader) {
							define(function () {
								return JSON3;
							});
						}
					}).call(this);
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}], 51: [function (_dereq_, module, exports) {
				module.exports = toArray;

				function toArray(list, index) {
					var array = [];

					index = index || 0;

					for (var i = index || 0; i < list.length; i++) {
						array[i - index] = list[i];
					}

					return array;
				}
			}, {}] }, {}, [31])(31);
	});
}

cc._RFpop();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},["Folds","MahjongMgr","JoinGameInput","WaitingConnection","ReplayMgr","VoiceMgr","ReplayCtrl","HotUpdate","Global","PengGangs","GameResult","LoadingLogic","socket-io","Settings","History","AudioMgr","Login","Chat","TimePointer","CreateRole","Hall","OnBack","UserMgr","ReConnect","MJGame","Seat","RadioGroupMgr","DingQue","HTTP","MJRoom","RadioButton","GameNetMgr","HuanSanZhang","Net","Utils","PopupMgr","Alert","CheckBox","NoticeTip","ImageLoader","CreateRoom","AnysdkMgr","Voice","GameOver","UserInfoShow"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9Db2Nvc0NyZWF0b3IuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vQXBwbGljYXRpb25zL0NvY29zQ3JlYXRvci5hcHAvQ29udGVudHMvUmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9BcHBsaWNhdGlvbnMvQ29jb3NDcmVhdG9yLmFwcC9Db250ZW50cy9SZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2J1ZmZlci9pbmRleC5qcyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9Db2Nvc0NyZWF0b3IuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaWVlZTc1NC9pbmRleC5qcyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9Db2Nvc0NyZWF0b3IuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvQWxlcnQuanMiLCJhc3NldHMvc2NyaXB0cy9BbnlzZGtNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpb01nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvQ2hhdC5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvQ2hlY2tCb3guanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0NyZWF0ZVJvbGUuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0NyZWF0ZVJvb20uanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0RpbmdRdWUuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0ZvbGRzLmpzIiwiYXNzZXRzL3NjcmlwdHMvR2FtZU5ldE1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvR2FtZU92ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0dhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9HbG9iYWwuanMiLCJhc3NldHMvc2NyaXB0cy9IVFRQLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9IYWxsLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5LmpzIiwiYXNzZXRzL3NjcmlwdHMvSG90VXBkYXRlLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9IdWFuU2FuWmhhbmcuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0ltYWdlTG9hZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Kb2luR2FtZUlucHV0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Mb2FkaW5nTG9naWMuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0xvZ2luLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9NSkdhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL01KUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL01haGpvbmdNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9OZXQuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL05vdGljZVRpcC5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvT25CYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9QZW5nR2FuZ3MuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1BvcHVwTWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9SYWRpb0J1dHRvbi5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvUmFkaW9Hcm91cE1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvUmVDb25uZWN0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9SZXBsYXlDdHJsLmpzIiwiYXNzZXRzL3NjcmlwdHMvUmVwbGF5TWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9TZWF0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9TZXR0aW5ncy5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvVGltZVBvaW50ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvU2hvdy5qcyIsImFzc2V0cy9zY3JpcHRzL1VzZXJNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9VdGlscy5qcyIsImFzc2V0cy9zY3JpcHRzL1ZvaWNlTWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Wb2ljZS5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvV2FpdGluZ0Nvbm5lY3Rpb24uanMiLCJhc3NldHMvc2NyaXB0cy8zcmRwYXJ0eS9zb2NrZXQtaW8uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM3dkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcHhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM3T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Y4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnXG5cbmV4cG9ydHMuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcbmV4cG9ydHMudG9CeXRlQXJyYXkgPSB0b0J5dGVBcnJheVxuZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gZnJvbUJ5dGVBcnJheVxuXG52YXIgbG9va3VwID0gW11cbnZhciByZXZMb29rdXAgPSBbXVxudmFyIEFyciA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheVxuXG52YXIgY29kZSA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJ1xuZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvZGUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgbG9va3VwW2ldID0gY29kZVtpXVxuICByZXZMb29rdXBbY29kZS5jaGFyQ29kZUF0KGkpXSA9IGlcbn1cblxucmV2TG9va3VwWyctJy5jaGFyQ29kZUF0KDApXSA9IDYyXG5yZXZMb29rdXBbJ18nLmNoYXJDb2RlQXQoMCldID0gNjNcblxuZnVuY3Rpb24gcGxhY2VIb2xkZXJzQ291bnQgKGI2NCkge1xuICB2YXIgbGVuID0gYjY0Lmxlbmd0aFxuICBpZiAobGVuICUgNCA+IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RyaW5nLiBMZW5ndGggbXVzdCBiZSBhIG11bHRpcGxlIG9mIDQnKVxuICB9XG5cbiAgLy8gdGhlIG51bWJlciBvZiBlcXVhbCBzaWducyAocGxhY2UgaG9sZGVycylcbiAgLy8gaWYgdGhlcmUgYXJlIHR3byBwbGFjZWhvbGRlcnMsIHRoYW4gdGhlIHR3byBjaGFyYWN0ZXJzIGJlZm9yZSBpdFxuICAvLyByZXByZXNlbnQgb25lIGJ5dGVcbiAgLy8gaWYgdGhlcmUgaXMgb25seSBvbmUsIHRoZW4gdGhlIHRocmVlIGNoYXJhY3RlcnMgYmVmb3JlIGl0IHJlcHJlc2VudCAyIGJ5dGVzXG4gIC8vIHRoaXMgaXMganVzdCBhIGNoZWFwIGhhY2sgdG8gbm90IGRvIGluZGV4T2YgdHdpY2VcbiAgcmV0dXJuIGI2NFtsZW4gLSAyXSA9PT0gJz0nID8gMiA6IGI2NFtsZW4gLSAxXSA9PT0gJz0nID8gMSA6IDBcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoYjY0KSB7XG4gIC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuICByZXR1cm4gYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxufVxuXG5mdW5jdGlvbiB0b0J5dGVBcnJheSAoYjY0KSB7XG4gIHZhciBpLCBqLCBsLCB0bXAsIHBsYWNlSG9sZGVycywgYXJyXG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIHBsYWNlSG9sZGVycyA9IHBsYWNlSG9sZGVyc0NvdW50KGI2NClcblxuICBhcnIgPSBuZXcgQXJyKGxlbiAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG4gIC8vIGlmIHRoZXJlIGFyZSBwbGFjZWhvbGRlcnMsIG9ubHkgZ2V0IHVwIHRvIHRoZSBsYXN0IGNvbXBsZXRlIDQgY2hhcnNcbiAgbCA9IHBsYWNlSG9sZGVycyA+IDAgPyBsZW4gLSA0IDogbGVuXG5cbiAgdmFyIEwgPSAwXG5cbiAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBsOyBpICs9IDQsIGogKz0gMykge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDE4KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCAxMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPDwgNikgfCByZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDMpXVxuICAgIGFycltMKytdID0gKHRtcCA+PiAxNikgJiAweEZGXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgaWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldID4+IDQpXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH0gZWxzZSBpZiAocGxhY2VIb2xkZXJzID09PSAxKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTApIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDQpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildID4+IDIpXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDgpICYgMHhGRlxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIGFyclxufVxuXG5mdW5jdGlvbiB0cmlwbGV0VG9CYXNlNjQgKG51bSkge1xuICByZXR1cm4gbG9va3VwW251bSA+PiAxOCAmIDB4M0ZdICsgbG9va3VwW251bSA+PiAxMiAmIDB4M0ZdICsgbG9va3VwW251bSA+PiA2ICYgMHgzRl0gKyBsb29rdXBbbnVtICYgMHgzRl1cbn1cblxuZnVuY3Rpb24gZW5jb2RlQ2h1bmsgKHVpbnQ4LCBzdGFydCwgZW5kKSB7XG4gIHZhciB0bXBcbiAgdmFyIG91dHB1dCA9IFtdXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAzKSB7XG4gICAgdG1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuICAgIG91dHB1dC5wdXNoKHRyaXBsZXRUb0Jhc2U2NCh0bXApKVxuICB9XG4gIHJldHVybiBvdXRwdXQuam9pbignJylcbn1cblxuZnVuY3Rpb24gZnJvbUJ5dGVBcnJheSAodWludDgpIHtcbiAgdmFyIHRtcFxuICB2YXIgbGVuID0gdWludDgubGVuZ3RoXG4gIHZhciBleHRyYUJ5dGVzID0gbGVuICUgMyAvLyBpZiB3ZSBoYXZlIDEgYnl0ZSBsZWZ0LCBwYWQgMiBieXRlc1xuICB2YXIgb3V0cHV0ID0gJydcbiAgdmFyIHBhcnRzID0gW11cbiAgdmFyIG1heENodW5rTGVuZ3RoID0gMTYzODMgLy8gbXVzdCBiZSBtdWx0aXBsZSBvZiAzXG5cbiAgLy8gZ28gdGhyb3VnaCB0aGUgYXJyYXkgZXZlcnkgdGhyZWUgYnl0ZXMsIHdlJ2xsIGRlYWwgd2l0aCB0cmFpbGluZyBzdHVmZiBsYXRlclxuICBmb3IgKHZhciBpID0gMCwgbGVuMiA9IGxlbiAtIGV4dHJhQnl0ZXM7IGkgPCBsZW4yOyBpICs9IG1heENodW5rTGVuZ3RoKSB7XG4gICAgcGFydHMucHVzaChlbmNvZGVDaHVuayh1aW50OCwgaSwgKGkgKyBtYXhDaHVua0xlbmd0aCkgPiBsZW4yID8gbGVuMiA6IChpICsgbWF4Q2h1bmtMZW5ndGgpKSlcbiAgfVxuXG4gIC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcbiAgaWYgKGV4dHJhQnl0ZXMgPT09IDEpIHtcbiAgICB0bXAgPSB1aW50OFtsZW4gLSAxXVxuICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDJdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gJz09J1xuICB9IGVsc2UgaWYgKGV4dHJhQnl0ZXMgPT09IDIpIHtcbiAgICB0bXAgPSAodWludDhbbGVuIC0gMl0gPDwgOCkgKyAodWludDhbbGVuIC0gMV0pXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMTBdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wID4+IDQpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgMikgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPSdcbiAgfVxuXG4gIHBhcnRzLnB1c2gob3V0cHV0KVxuXG4gIHJldHVybiBwYXJ0cy5qb2luKCcnKVxufVxuIiwiLyohXG4gKiBUaGUgYnVmZmVyIG1vZHVsZSBmcm9tIG5vZGUuanMsIGZvciB0aGUgYnJvd3Nlci5cbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi9cblxuJ3VzZSBzdHJpY3QnXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXNhcnJheScpXG5cbmV4cG9ydHMuQnVmZmVyID0gQnVmZmVyXG5leHBvcnRzLlNsb3dCdWZmZXIgPSBTbG93QnVmZmVyXG5leHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTID0gNTBcblxuLyoqXG4gKiBJZiBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgOlxuICogICA9PT0gdHJ1ZSAgICBVc2UgVWludDhBcnJheSBpbXBsZW1lbnRhdGlvbiAoZmFzdGVzdClcbiAqICAgPT09IGZhbHNlICAgVXNlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiAobW9zdCBjb21wYXRpYmxlLCBldmVuIElFNilcbiAqXG4gKiBCcm93c2VycyB0aGF0IHN1cHBvcnQgdHlwZWQgYXJyYXlzIGFyZSBJRSAxMCssIEZpcmVmb3ggNCssIENocm9tZSA3KywgU2FmYXJpIDUuMSssXG4gKiBPcGVyYSAxMS42KywgaU9TIDQuMisuXG4gKlxuICogRHVlIHRvIHZhcmlvdXMgYnJvd3NlciBidWdzLCBzb21ldGltZXMgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiB3aWxsIGJlIHVzZWQgZXZlblxuICogd2hlbiB0aGUgYnJvd3NlciBzdXBwb3J0cyB0eXBlZCBhcnJheXMuXG4gKlxuICogTm90ZTpcbiAqXG4gKiAgIC0gRmlyZWZveCA0LTI5IGxhY2tzIHN1cHBvcnQgZm9yIGFkZGluZyBuZXcgcHJvcGVydGllcyB0byBgVWludDhBcnJheWAgaW5zdGFuY2VzLFxuICogICAgIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9Njk1NDM4LlxuICpcbiAqICAgLSBDaHJvbWUgOS0xMCBpcyBtaXNzaW5nIHRoZSBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uLlxuICpcbiAqICAgLSBJRTEwIGhhcyBhIGJyb2tlbiBgVHlwZWRBcnJheS5wcm90b3R5cGUuc3ViYXJyYXlgIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYXJyYXlzIG9mXG4gKiAgICAgaW5jb3JyZWN0IGxlbmd0aCBpbiBzb21lIHNpdHVhdGlvbnMuXG5cbiAqIFdlIGRldGVjdCB0aGVzZSBidWdneSBicm93c2VycyBhbmQgc2V0IGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGAgdG8gYGZhbHNlYCBzbyB0aGV5XG4gKiBnZXQgdGhlIE9iamVjdCBpbXBsZW1lbnRhdGlvbiwgd2hpY2ggaXMgc2xvd2VyIGJ1dCBiZWhhdmVzIGNvcnJlY3RseS5cbiAqL1xuQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgPSBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVCAhPT0gdW5kZWZpbmVkXG4gID8gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgOiB0eXBlZEFycmF5U3VwcG9ydCgpXG5cbi8qXG4gKiBFeHBvcnQga01heExlbmd0aCBhZnRlciB0eXBlZCBhcnJheSBzdXBwb3J0IGlzIGRldGVybWluZWQuXG4gKi9cbmV4cG9ydHMua01heExlbmd0aCA9IGtNYXhMZW5ndGgoKVxuXG5mdW5jdGlvbiB0eXBlZEFycmF5U3VwcG9ydCAoKSB7XG4gIHRyeSB7XG4gICAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KDEpXG4gICAgYXJyLl9fcHJvdG9fXyA9IHtfX3Byb3RvX186IFVpbnQ4QXJyYXkucHJvdG90eXBlLCBmb286IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDQyIH19XG4gICAgcmV0dXJuIGFyci5mb28oKSA9PT0gNDIgJiYgLy8gdHlwZWQgYXJyYXkgaW5zdGFuY2VzIGNhbiBiZSBhdWdtZW50ZWRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgYXJyLnN1YmFycmF5KDEsIDEpLmJ5dGVMZW5ndGggPT09IDAgLy8gaWUxMCBoYXMgYnJva2VuIGBzdWJhcnJheWBcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGtNYXhMZW5ndGggKCkge1xuICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgICA/IDB4N2ZmZmZmZmZcbiAgICA6IDB4M2ZmZmZmZmZcbn1cblxuZnVuY3Rpb24gY3JlYXRlQnVmZmVyICh0aGF0LCBsZW5ndGgpIHtcbiAgaWYgKGtNYXhMZW5ndGgoKSA8IGxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHR5cGVkIGFycmF5IGxlbmd0aCcpXG4gIH1cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aClcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgaWYgKHRoYXQgPT09IG51bGwpIHtcbiAgICAgIHRoYXQgPSBuZXcgQnVmZmVyKGxlbmd0aClcbiAgICB9XG4gICAgdGhhdC5sZW5ndGggPSBsZW5ndGhcbiAgfVxuXG4gIHJldHVybiB0aGF0XG59XG5cbi8qKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBoYXZlIHRoZWlyXG4gKiBwcm90b3R5cGUgY2hhbmdlZCB0byBgQnVmZmVyLnByb3RvdHlwZWAuIEZ1cnRoZXJtb3JlLCBgQnVmZmVyYCBpcyBhIHN1YmNsYXNzIG9mXG4gKiBgVWludDhBcnJheWAsIHNvIHRoZSByZXR1cm5lZCBpbnN0YW5jZXMgd2lsbCBoYXZlIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBtZXRob2RzXG4gKiBhbmQgdGhlIGBVaW50OEFycmF5YCBtZXRob2RzLiBTcXVhcmUgYnJhY2tldCBub3RhdGlvbiB3b3JrcyBhcyBleHBlY3RlZCAtLSBpdFxuICogcmV0dXJucyBhIHNpbmdsZSBvY3RldC5cbiAqXG4gKiBUaGUgYFVpbnQ4QXJyYXlgIHByb3RvdHlwZSByZW1haW5zIHVubW9kaWZpZWQuXG4gKi9cblxuZnVuY3Rpb24gQnVmZmVyIChhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmICEodGhpcyBpbnN0YW5jZW9mIEJ1ZmZlcikpIHtcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIC8vIENvbW1vbiBjYXNlLlxuICBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicpIHtcbiAgICBpZiAodHlwZW9mIGVuY29kaW5nT3JPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZydcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIGFsbG9jVW5zYWZlKHRoaXMsIGFyZylcbiAgfVxuICByZXR1cm4gZnJvbSh0aGlzLCBhcmcsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnBvb2xTaXplID0gODE5MiAvLyBub3QgdXNlZCBieSB0aGlzIGltcGxlbWVudGF0aW9uXG5cbi8vIFRPRE86IExlZ2FjeSwgbm90IG5lZWRlZCBhbnltb3JlLiBSZW1vdmUgaW4gbmV4dCBtYWpvciB2ZXJzaW9uLlxuQnVmZmVyLl9hdWdtZW50ID0gZnVuY3Rpb24gKGFycikge1xuICBhcnIuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIGZyb20gKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKVxuICB9XG5cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHJldHVybiBmcm9tQXJyYXlCdWZmZXIodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZyb21TdHJpbmcodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQpXG4gIH1cblxuICByZXR1cm4gZnJvbU9iamVjdCh0aGF0LCB2YWx1ZSlcbn1cblxuLyoqXG4gKiBGdW5jdGlvbmFsbHkgZXF1aXZhbGVudCB0byBCdWZmZXIoYXJnLCBlbmNvZGluZykgYnV0IHRocm93cyBhIFR5cGVFcnJvclxuICogaWYgdmFsdWUgaXMgYSBudW1iZXIuXG4gKiBCdWZmZXIuZnJvbShzdHJbLCBlbmNvZGluZ10pXG4gKiBCdWZmZXIuZnJvbShhcnJheSlcbiAqIEJ1ZmZlci5mcm9tKGJ1ZmZlcilcbiAqIEJ1ZmZlci5mcm9tKGFycmF5QnVmZmVyWywgYnl0ZU9mZnNldFssIGxlbmd0aF1dKVxuICoqL1xuQnVmZmVyLmZyb20gPSBmdW5jdGlvbiAodmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gZnJvbShudWxsLCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5pZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgQnVmZmVyLnByb3RvdHlwZS5fX3Byb3RvX18gPSBVaW50OEFycmF5LnByb3RvdHlwZVxuICBCdWZmZXIuX19wcm90b19fID0gVWludDhBcnJheVxuICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnNwZWNpZXMgJiZcbiAgICAgIEJ1ZmZlcltTeW1ib2wuc3BlY2llc10gPT09IEJ1ZmZlcikge1xuICAgIC8vIEZpeCBzdWJhcnJheSgpIGluIEVTMjAxNi4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZmVyb3NzL2J1ZmZlci9wdWxsLzk3XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1ZmZlciwgU3ltYm9sLnNwZWNpZXMsIHtcbiAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiBhc3NlcnRTaXplIChzaXplKSB7XG4gIGlmICh0eXBlb2Ygc2l6ZSAhPT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IGJlIGEgbnVtYmVyJylcbiAgfSBlbHNlIGlmIChzaXplIDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInNpemVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBuZWdhdGl2ZScpXG4gIH1cbn1cblxuZnVuY3Rpb24gYWxsb2MgKHRoYXQsIHNpemUsIGZpbGwsIGVuY29kaW5nKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgaWYgKHNpemUgPD0gMCkge1xuICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbiAgfVxuICBpZiAoZmlsbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gT25seSBwYXkgYXR0ZW50aW9uIHRvIGVuY29kaW5nIGlmIGl0J3MgYSBzdHJpbmcuIFRoaXNcbiAgICAvLyBwcmV2ZW50cyBhY2NpZGVudGFsbHkgc2VuZGluZyBpbiBhIG51bWJlciB0aGF0IHdvdWxkXG4gICAgLy8gYmUgaW50ZXJwcmV0dGVkIGFzIGEgc3RhcnQgb2Zmc2V0LlxuICAgIHJldHVybiB0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnXG4gICAgICA/IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwsIGVuY29kaW5nKVxuICAgICAgOiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsKVxuICB9XG4gIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSlcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiBhbGxvYyhzaXplWywgZmlsbFssIGVuY29kaW5nXV0pXG4gKiovXG5CdWZmZXIuYWxsb2MgPSBmdW5jdGlvbiAoc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGFsbG9jKG51bGwsIHNpemUsIGZpbGwsIGVuY29kaW5nKVxufVxuXG5mdW5jdGlvbiBhbGxvY1Vuc2FmZSAodGhhdCwgc2l6ZSkge1xuICBhc3NlcnRTaXplKHNpemUpXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSA8IDAgPyAwIDogY2hlY2tlZChzaXplKSB8IDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7ICsraSkge1xuICAgICAgdGhhdFtpXSA9IDBcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIEJ1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICogKi9cbkJ1ZmZlci5hbGxvY1Vuc2FmZSA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIFNsb3dCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlU2xvdyA9IGZ1bmN0aW9uIChzaXplKSB7XG4gIHJldHVybiBhbGxvY1Vuc2FmZShudWxsLCBzaXplKVxufVxuXG5mdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gIH1cblxuICBpZiAoIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiZW5jb2RpbmdcIiBtdXN0IGJlIGEgdmFsaWQgc3RyaW5nIGVuY29kaW5nJylcbiAgfVxuXG4gIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcblxuICB2YXIgYWN0dWFsID0gdGhhdC53cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuXG4gIGlmIChhY3R1YWwgIT09IGxlbmd0aCkge1xuICAgIC8vIFdyaXRpbmcgYSBoZXggc3RyaW5nLCBmb3IgZXhhbXBsZSwgdGhhdCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgd2lsbFxuICAgIC8vIGNhdXNlIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGZpcnN0IGludmFsaWQgY2hhcmFjdGVyIHRvIGJlIGlnbm9yZWQuIChlLmcuXG4gICAgLy8gJ2FieHhjZCcgd2lsbCBiZSB0cmVhdGVkIGFzICdhYicpXG4gICAgdGhhdCA9IHRoYXQuc2xpY2UoMCwgYWN0dWFsKVxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5TGlrZSAodGhhdCwgYXJyYXkpIHtcbiAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCA8IDAgPyAwIDogY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbmd0aClcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21BcnJheUJ1ZmZlciAodGhhdCwgYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aCkge1xuICBhcnJheS5ieXRlTGVuZ3RoIC8vIHRoaXMgdGhyb3dzIGlmIGBhcnJheWAgaXMgbm90IGEgdmFsaWQgQXJyYXlCdWZmZXJcblxuICBpZiAoYnl0ZU9mZnNldCA8IDAgfHwgYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXFwnb2Zmc2V0XFwnIGlzIG91dCBvZiBib3VuZHMnKVxuICB9XG5cbiAgaWYgKGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0ICsgKGxlbmd0aCB8fCAwKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdsZW5ndGhcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYnl0ZU9mZnNldCA9PT0gdW5kZWZpbmVkICYmIGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSlcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQpXG4gIH0gZWxzZSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IGFycmF5XG4gICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIHRoYXQgPSBmcm9tQXJyYXlMaWtlKHRoYXQsIGFycmF5KVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21PYmplY3QgKHRoYXQsIG9iaikge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKG9iaikpIHtcbiAgICB2YXIgbGVuID0gY2hlY2tlZChvYmoubGVuZ3RoKSB8IDBcbiAgICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIGxlbilcblxuICAgIGlmICh0aGF0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoYXRcbiAgICB9XG5cbiAgICBvYmouY29weSh0aGF0LCAwLCAwLCBsZW4pXG4gICAgcmV0dXJuIHRoYXRcbiAgfVxuXG4gIGlmIChvYmopIHtcbiAgICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fCAnbGVuZ3RoJyBpbiBvYmopIHtcbiAgICAgIGlmICh0eXBlb2Ygb2JqLmxlbmd0aCAhPT0gJ251bWJlcicgfHwgaXNuYW4ob2JqLmxlbmd0aCkpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCAwKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqKVxuICAgIH1cblxuICAgIGlmIChvYmoudHlwZSA9PT0gJ0J1ZmZlcicgJiYgaXNBcnJheShvYmouZGF0YSkpIHtcbiAgICAgIHJldHVybiBmcm9tQXJyYXlMaWtlKHRoYXQsIG9iai5kYXRhKVxuICAgIH1cbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4nKVxufVxuXG5mdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHtcbiAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aCgpYCBoZXJlIGJlY2F1c2UgdGhhdCBmYWlscyB3aGVuXG4gIC8vIGxlbmd0aCBpcyBOYU4gKHdoaWNoIGlzIG90aGVyd2lzZSBjb2VyY2VkIHRvIHplcm8uKVxuICBpZiAobGVuZ3RoID49IGtNYXhMZW5ndGgoKSkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplOiAweCcgKyBrTWF4TGVuZ3RoKCkudG9TdHJpbmcoMTYpICsgJyBieXRlcycpXG4gIH1cbiAgcmV0dXJuIGxlbmd0aCB8IDBcbn1cblxuZnVuY3Rpb24gU2xvd0J1ZmZlciAobGVuZ3RoKSB7XG4gIGlmICgrbGVuZ3RoICE9IGxlbmd0aCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGVxZXFlcVxuICAgIGxlbmd0aCA9IDBcbiAgfVxuICByZXR1cm4gQnVmZmVyLmFsbG9jKCtsZW5ndGgpXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpXG4gIH1cblxuICBpZiAoYSA9PT0gYikgcmV0dXJuIDBcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcblxuICBmb3IgKHZhciBpID0gMCwgbGVuID0gTWF0aC5taW4oeCwgeSk7IGkgPCBsZW47ICsraSkge1xuICAgIGlmIChhW2ldICE9PSBiW2ldKSB7XG4gICAgICB4ID0gYVtpXVxuICAgICAgeSA9IGJbaV1cbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgaWYgKHggPCB5KSByZXR1cm4gLTFcbiAgaWYgKHkgPCB4KSByZXR1cm4gMVxuICByZXR1cm4gMFxufVxuXG5CdWZmZXIuaXNFbmNvZGluZyA9IGZ1bmN0aW9uIGlzRW5jb2RpbmcgKGVuY29kaW5nKSB7XG4gIHN3aXRjaCAoU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgY2FzZSAnaGV4JzpcbiAgICBjYXNlICd1dGY4JzpcbiAgICBjYXNlICd1dGYtOCc6XG4gICAgY2FzZSAnYXNjaWknOlxuICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgY2FzZSAnYmluYXJ5JzpcbiAgICBjYXNlICdiYXNlNjQnOlxuICAgIGNhc2UgJ3VjczInOlxuICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICBjYXNlICd1dGYxNmxlJzpcbiAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5CdWZmZXIuY29uY2F0ID0gZnVuY3Rpb24gY29uY2F0IChsaXN0LCBsZW5ndGgpIHtcbiAgaWYgKCFpc0FycmF5KGxpc3QpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBCdWZmZXIuYWxsb2MoMClcbiAgfVxuXG4gIHZhciBpXG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IDBcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkge1xuICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZmZlciA9IEJ1ZmZlci5hbGxvY1Vuc2FmZShsZW5ndGgpXG4gIHZhciBwb3MgPSAwXG4gIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGJ1ZiA9IGxpc3RbaV1cbiAgICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICAgIH1cbiAgICBidWYuY29weShidWZmZXIsIHBvcylcbiAgICBwb3MgKz0gYnVmLmxlbmd0aFxuICB9XG4gIHJldHVybiBidWZmZXJcbn1cblxuZnVuY3Rpb24gYnl0ZUxlbmd0aCAoc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAoQnVmZmVyLmlzQnVmZmVyKHN0cmluZykpIHtcbiAgICByZXR1cm4gc3RyaW5nLmxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgIChBcnJheUJ1ZmZlci5pc1ZpZXcoc3RyaW5nKSB8fCBzdHJpbmcgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcbiAgICByZXR1cm4gc3RyaW5nLmJ5dGVMZW5ndGhcbiAgfVxuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICBzdHJpbmcgPSAnJyArIHN0cmluZ1xuICB9XG5cbiAgdmFyIGxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBVc2UgYSBmb3IgbG9vcCB0byBhdm9pZCByZWN1cnNpb25cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGVuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiBsZW4gKiAyXG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gbGVuID4+PiAxXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICByZXR1cm4gYmFzZTY0VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSByZXR1cm4gdXRmOFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGggLy8gYXNzdW1lIHV0ZjhcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cbkJ1ZmZlci5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgLy8gTm8gbmVlZCB0byB2ZXJpZnkgdGhhdCBcInRoaXMubGVuZ3RoIDw9IE1BWF9VSU5UMzJcIiBzaW5jZSBpdCdzIGEgcmVhZC1vbmx5XG4gIC8vIHByb3BlcnR5IG9mIGEgdHlwZWQgYXJyYXkuXG5cbiAgLy8gVGhpcyBiZWhhdmVzIG5laXRoZXIgbGlrZSBTdHJpbmcgbm9yIFVpbnQ4QXJyYXkgaW4gdGhhdCB3ZSBzZXQgc3RhcnQvZW5kXG4gIC8vIHRvIHRoZWlyIHVwcGVyL2xvd2VyIGJvdW5kcyBpZiB0aGUgdmFsdWUgcGFzc2VkIGlzIG91dCBvZiByYW5nZS5cbiAgLy8gdW5kZWZpbmVkIGlzIGhhbmRsZWQgc3BlY2lhbGx5IGFzIHBlciBFQ01BLTI2MiA2dGggRWRpdGlvbixcbiAgLy8gU2VjdGlvbiAxMy4zLjMuNyBSdW50aW1lIFNlbWFudGljczogS2V5ZWRCaW5kaW5nSW5pdGlhbGl6YXRpb24uXG4gIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkIHx8IHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIC8vIFJldHVybiBlYXJseSBpZiBzdGFydCA+IHRoaXMubGVuZ3RoLiBEb25lIGhlcmUgdG8gcHJldmVudCBwb3RlbnRpYWwgdWludDMyXG4gIC8vIGNvZXJjaW9uIGZhaWwgYmVsb3cuXG4gIGlmIChzdGFydCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBpZiAoZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICBlbmQgPSB0aGlzLmxlbmd0aFxuICB9XG5cbiAgaWYgKGVuZCA8PSAwKSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICAvLyBGb3JjZSBjb2Vyc2lvbiB0byB1aW50MzIuIFRoaXMgd2lsbCBhbHNvIGNvZXJjZSBmYWxzZXkvTmFOIHZhbHVlcyB0byAwLlxuICBlbmQgPj4+PSAwXG4gIHN0YXJ0ID4+Pj0gMFxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgd2hpbGUgKHRydWUpIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG4vLyBUaGUgcHJvcGVydHkgaXMgdXNlZCBieSBgQnVmZmVyLmlzQnVmZmVyYCBhbmQgYGlzLWJ1ZmZlcmAgKGluIFNhZmFyaSA1LTcpIHRvIGRldGVjdFxuLy8gQnVmZmVyIGluc3RhbmNlcy5cbkJ1ZmZlci5wcm90b3R5cGUuX2lzQnVmZmVyID0gdHJ1ZVxuXG5mdW5jdGlvbiBzd2FwIChiLCBuLCBtKSB7XG4gIHZhciBpID0gYltuXVxuICBiW25dID0gYlttXVxuICBiW21dID0gaVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAxNiA9IGZ1bmN0aW9uIHN3YXAxNiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgMiAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMTYtYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDEpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwMzIgPSBmdW5jdGlvbiBzd2FwMzIgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDQgIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDMyLWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyAzKVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyAyKVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDY0ID0gZnVuY3Rpb24gc3dhcDY0ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSA4ICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA2NC1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA4KSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgNylcbiAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgNilcbiAgICBzd2FwKHRoaXMsIGkgKyAyLCBpICsgNSlcbiAgICBzd2FwKHRoaXMsIGkgKyAzLCBpICsgNClcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAodGFyZ2V0LCBzdGFydCwgZW5kLCB0aGlzU3RhcnQsIHRoaXNFbmQpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIodGFyZ2V0KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKVxuICB9XG5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQpIHtcbiAgICBzdGFydCA9IDBcbiAgfVxuICBpZiAoZW5kID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmQgPSB0YXJnZXQgPyB0YXJnZXQubGVuZ3RoIDogMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXNTdGFydCA9IDBcbiAgfVxuICBpZiAodGhpc0VuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc0VuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA+IHRhcmdldC5sZW5ndGggfHwgdGhpc1N0YXJ0IDwgMCB8fCB0aGlzRW5kID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCAmJiBzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMFxuICB9XG4gIGlmICh0aGlzU3RhcnQgPj0gdGhpc0VuZCkge1xuICAgIHJldHVybiAtMVxuICB9XG4gIGlmIChzdGFydCA+PSBlbmQpIHtcbiAgICByZXR1cm4gMVxuICB9XG5cbiAgc3RhcnQgPj4+PSAwXG4gIGVuZCA+Pj49IDBcbiAgdGhpc1N0YXJ0ID4+Pj0gMFxuICB0aGlzRW5kID4+Pj0gMFxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQpIHJldHVybiAwXG5cbiAgdmFyIHggPSB0aGlzRW5kIC0gdGhpc1N0YXJ0XG4gIHZhciB5ID0gZW5kIC0gc3RhcnRcbiAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpXG5cbiAgdmFyIHRoaXNDb3B5ID0gdGhpcy5zbGljZSh0aGlzU3RhcnQsIHRoaXNFbmQpXG4gIHZhciB0YXJnZXRDb3B5ID0gdGFyZ2V0LnNsaWNlKHN0YXJ0LCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIGlmICh0aGlzQ29weVtpXSAhPT0gdGFyZ2V0Q29weVtpXSkge1xuICAgICAgeCA9IHRoaXNDb3B5W2ldXG4gICAgICB5ID0gdGFyZ2V0Q29weVtpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbi8vIEZpbmRzIGVpdGhlciB0aGUgZmlyc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0ID49IGBieXRlT2Zmc2V0YCxcbi8vIE9SIHRoZSBsYXN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA8PSBgYnl0ZU9mZnNldGAuXG4vL1xuLy8gQXJndW1lbnRzOlxuLy8gLSBidWZmZXIgLSBhIEJ1ZmZlciB0byBzZWFyY2hcbi8vIC0gdmFsIC0gYSBzdHJpbmcsIEJ1ZmZlciwgb3IgbnVtYmVyXG4vLyAtIGJ5dGVPZmZzZXQgLSBhbiBpbmRleCBpbnRvIGBidWZmZXJgOyB3aWxsIGJlIGNsYW1wZWQgdG8gYW4gaW50MzJcbi8vIC0gZW5jb2RpbmcgLSBhbiBvcHRpb25hbCBlbmNvZGluZywgcmVsZXZhbnQgaXMgdmFsIGlzIGEgc3RyaW5nXG4vLyAtIGRpciAtIHRydWUgZm9yIGluZGV4T2YsIGZhbHNlIGZvciBsYXN0SW5kZXhPZlxuZnVuY3Rpb24gYmlkaXJlY3Rpb25hbEluZGV4T2YgKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKSB7XG4gIC8vIEVtcHR5IGJ1ZmZlciBtZWFucyBubyBtYXRjaFxuICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG5cbiAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXRcbiAgaWYgKHR5cGVvZiBieXRlT2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gYnl0ZU9mZnNldFxuICAgIGJ5dGVPZmZzZXQgPSAwXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA+IDB4N2ZmZmZmZmYpIHtcbiAgICBieXRlT2Zmc2V0ID0gMHg3ZmZmZmZmZlxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAtMHg4MDAwMDAwMCkge1xuICAgIGJ5dGVPZmZzZXQgPSAtMHg4MDAwMDAwMFxuICB9XG4gIGJ5dGVPZmZzZXQgPSArYnl0ZU9mZnNldCAgLy8gQ29lcmNlIHRvIE51bWJlci5cbiAgaWYgKGlzTmFOKGJ5dGVPZmZzZXQpKSB7XG4gICAgLy8gYnl0ZU9mZnNldDogaXQgaXQncyB1bmRlZmluZWQsIG51bGwsIE5hTiwgXCJmb29cIiwgZXRjLCBzZWFyY2ggd2hvbGUgYnVmZmVyXG4gICAgYnl0ZU9mZnNldCA9IGRpciA/IDAgOiAoYnVmZmVyLmxlbmd0aCAtIDEpXG4gIH1cblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldDogbmVnYXRpdmUgb2Zmc2V0cyBzdGFydCBmcm9tIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlclxuICBpZiAoYnl0ZU9mZnNldCA8IDApIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoICsgYnl0ZU9mZnNldFxuICBpZiAoYnl0ZU9mZnNldCA+PSBidWZmZXIubGVuZ3RoKSB7XG4gICAgaWYgKGRpcikgcmV0dXJuIC0xXG4gICAgZWxzZSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCAtIDFcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgMCkge1xuICAgIGlmIChkaXIpIGJ5dGVPZmZzZXQgPSAwXG4gICAgZWxzZSByZXR1cm4gLTFcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSB2YWxcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgdmFsID0gQnVmZmVyLmZyb20odmFsLCBlbmNvZGluZylcbiAgfVxuXG4gIC8vIEZpbmFsbHksIHNlYXJjaCBlaXRoZXIgaW5kZXhPZiAoaWYgZGlyIGlzIHRydWUpIG9yIGxhc3RJbmRleE9mXG4gIGlmIChCdWZmZXIuaXNCdWZmZXIodmFsKSkge1xuICAgIC8vIFNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nL2J1ZmZlciBhbHdheXMgZmFpbHNcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIC0xXG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpXG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAweEZGIC8vIFNlYXJjaCBmb3IgYSBieXRlIHZhbHVlIFswLTI1NV1cbiAgICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiZcbiAgICAgICAgdHlwZW9mIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGlmIChkaXIpIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgWyB2YWwgXSwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbmZ1bmN0aW9uIGFycmF5SW5kZXhPZiAoYXJyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgdmFyIGluZGV4U2l6ZSA9IDFcbiAgdmFyIGFyckxlbmd0aCA9IGFyci5sZW5ndGhcbiAgdmFyIHZhbExlbmd0aCA9IHZhbC5sZW5ndGhcblxuICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gU3RyaW5nKGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGVuY29kaW5nID09PSAndWNzMicgfHwgZW5jb2RpbmcgPT09ICd1Y3MtMicgfHxcbiAgICAgICAgZW5jb2RpbmcgPT09ICd1dGYxNmxlJyB8fCBlbmNvZGluZyA9PT0gJ3V0Zi0xNmxlJykge1xuICAgICAgaWYgKGFyci5sZW5ndGggPCAyIHx8IHZhbC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiAtMVxuICAgICAgfVxuICAgICAgaW5kZXhTaXplID0gMlxuICAgICAgYXJyTGVuZ3RoIC89IDJcbiAgICAgIHZhbExlbmd0aCAvPSAyXG4gICAgICBieXRlT2Zmc2V0IC89IDJcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZWFkIChidWYsIGkpIHtcbiAgICBpZiAoaW5kZXhTaXplID09PSAxKSB7XG4gICAgICByZXR1cm4gYnVmW2ldXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBidWYucmVhZFVJbnQxNkJFKGkgKiBpbmRleFNpemUpXG4gICAgfVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGRpcikge1xuICAgIHZhciBmb3VuZEluZGV4ID0gLTFcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpIDwgYXJyTGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChyZWFkKGFyciwgaSkgPT09IHJlYWQodmFsLCBmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleCkpIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWxMZW5ndGgpIHJldHVybiBmb3VuZEluZGV4ICogaW5kZXhTaXplXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZm91bmRJbmRleCAhPT0gLTEpIGkgLT0gaSAtIGZvdW5kSW5kZXhcbiAgICAgICAgZm91bmRJbmRleCA9IC0xXG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChieXRlT2Zmc2V0ICsgdmFsTGVuZ3RoID4gYXJyTGVuZ3RoKSBieXRlT2Zmc2V0ID0gYXJyTGVuZ3RoIC0gdmFsTGVuZ3RoXG4gICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciBmb3VuZCA9IHRydWVcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdmFsTGVuZ3RoOyBqKyspIHtcbiAgICAgICAgaWYgKHJlYWQoYXJyLCBpICsgaikgIT09IHJlYWQodmFsLCBqKSkge1xuICAgICAgICAgIGZvdW5kID0gZmFsc2VcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZm91bmQpIHJldHVybiBpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiBpbmNsdWRlcyAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gdGhpcy5pbmRleE9mKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpICE9PSAtMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBpbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCB0cnVlKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gbGFzdEluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGZhbHNlKVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKVxuXG4gIGlmIChsZW5ndGggPiBzdHJMZW4gLyAyKSB7XG4gICAgbGVuZ3RoID0gc3RyTGVuIC8gMlxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQoc3RyaW5nLnN1YnN0cihpICogMiwgMiksIDE2KVxuICAgIGlmIChpc05hTihwYXJzZWQpKSByZXR1cm4gaVxuICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHBhcnNlZFxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIHV0ZjhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjhUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGFzY2lpV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihhc2NpaVRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gbGF0aW4xV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYXNjaWlXcml0ZShidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJhc2U2NFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYmFzZTY0VG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiB1Y3MyV3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGYxNmxlVG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gd3JpdGUgKHN0cmluZywgb2Zmc2V0LCBsZW5ndGgsIGVuY29kaW5nKSB7XG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcpXG4gIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIGVuY29kaW5nKVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBvZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgb2Zmc2V0WywgbGVuZ3RoXVssIGVuY29kaW5nXSlcbiAgfSBlbHNlIGlmIChpc0Zpbml0ZShvZmZzZXQpKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICAgIGlmIChpc0Zpbml0ZShsZW5ndGgpKSB7XG4gICAgICBsZW5ndGggPSBsZW5ndGggfCAwXG4gICAgICBpZiAoZW5jb2RpbmcgPT09IHVuZGVmaW5lZCkgZW5jb2RpbmcgPSAndXRmOCdcbiAgICB9IGVsc2Uge1xuICAgICAgZW5jb2RpbmcgPSBsZW5ndGhcbiAgICAgIGxlbmd0aCA9IHVuZGVmaW5lZFxuICAgIH1cbiAgLy8gbGVnYWN5IHdyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldCwgbGVuZ3RoKSAtIHJlbW92ZSBpbiB2MC4xM1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCdcbiAgICApXG4gIH1cblxuICB2YXIgcmVtYWluaW5nID0gdGhpcy5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkIHx8IGxlbmd0aCA+IHJlbWFpbmluZykgbGVuZ3RoID0gcmVtYWluaW5nXG5cbiAgaWYgKChzdHJpbmcubGVuZ3RoID4gMCAmJiAobGVuZ3RoIDwgMCB8fCBvZmZzZXQgPCAwKSkgfHwgb2Zmc2V0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMnKVxuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsYXRpbjFXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGxhdGluMVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSB0aGlzLnN1YmFycmF5KHN0YXJ0LCBlbmQpXG4gICAgbmV3QnVmLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyArK2kpIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJidWZmZXJcIiBhcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyIGluc3RhbmNlJylcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBtYXhCeXRlcyA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSAtIDFcbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBtYXhCeXRlcywgMClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKHZhbHVlIC8gbXVsKSAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50OCA9IGZ1bmN0aW9uIHdyaXRlVUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHhmZiwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQxNiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCAyKTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSAmICgweGZmIDw8ICg4ICogKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkpKSkgPj4+XG4gICAgICAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSAqIDhcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5mdW5jdGlvbiBvYmplY3RXcml0ZVVJbnQzMiAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4pIHtcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgNCk7IGkgPCBqOyArK2kpIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgPj4+IChsaXR0bGVFbmRpYW4gPyBpIDogMyAtIGkpICogOCkgJiAweGZmXG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50TEUgPSBmdW5jdGlvbiB3cml0ZUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gMFxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldF0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgLSAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50QkUgPSBmdW5jdGlvbiB3cml0ZUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbGltaXQgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCAtIDEpXG5cbiAgICBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBsaW1pdCAtIDEsIC1saW1pdClcbiAgfVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aCAtIDFcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICBpZiAodmFsdWUgPCAwICYmIHN1YiA9PT0gMCAmJiB0aGlzW29mZnNldCArIGkgKyAxXSAhPT0gMCkge1xuICAgICAgc3ViID0gMVxuICAgIH1cbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKVxuICBpZiAob2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRmxvYXQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgNCwgMy40MDI4MjM0NjYzODUyODg2ZSszOCwgLTMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgMjMsIDQpXG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdExFID0gZnVuY3Rpb24gd3JpdGVGbG9hdExFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0QkUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuZnVuY3Rpb24gd3JpdGVEb3VibGUgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tJRUVFNzU0KGJ1ZiwgdmFsdWUsIG9mZnNldCwgOCwgMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgsIC0xLjc5NzY5MzEzNDg2MjMxNTdFKzMwOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCA1MiwgOClcbiAgcmV0dXJuIG9mZnNldCArIDhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUxFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlQkUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG4vLyBjb3B5KHRhcmdldEJ1ZmZlciwgdGFyZ2V0U3RhcnQ9MCwgc291cmNlU3RhcnQ9MCwgc291cmNlRW5kPWJ1ZmZlci5sZW5ndGgpXG5CdWZmZXIucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiBjb3B5ICh0YXJnZXQsIHRhcmdldFN0YXJ0LCBzdGFydCwgZW5kKSB7XG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCAmJiBlbmQgIT09IDApIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXRTdGFydCA+PSB0YXJnZXQubGVuZ3RoKSB0YXJnZXRTdGFydCA9IHRhcmdldC5sZW5ndGhcbiAgaWYgKCF0YXJnZXRTdGFydCkgdGFyZ2V0U3RhcnQgPSAwXG4gIGlmIChlbmQgPiAwICYmIGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydFxuXG4gIC8vIENvcHkgMCBieXRlczsgd2UncmUgZG9uZVxuICBpZiAoZW5kID09PSBzdGFydCkgcmV0dXJuIDBcbiAgaWYgKHRhcmdldC5sZW5ndGggPT09IDAgfHwgdGhpcy5sZW5ndGggPT09IDApIHJldHVybiAwXG5cbiAgLy8gRmF0YWwgZXJyb3IgY29uZGl0aW9uc1xuICBpZiAodGFyZ2V0U3RhcnQgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3RhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICB9XG4gIGlmIChzdGFydCA8IDAgfHwgc3RhcnQgPj0gdGhpcy5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgaWYgKGVuZCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcycpXG5cbiAgLy8gQXJlIHdlIG9vYj9cbiAgaWYgKGVuZCA+IHRoaXMubGVuZ3RoKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0IDwgZW5kIC0gc3RhcnQpIHtcbiAgICBlbmQgPSB0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgKyBzdGFydFxuICB9XG5cbiAgdmFyIGxlbiA9IGVuZCAtIHN0YXJ0XG4gIHZhciBpXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCAmJiBzdGFydCA8IHRhcmdldFN0YXJ0ICYmIHRhcmdldFN0YXJ0IDwgZW5kKSB7XG4gICAgLy8gZGVzY2VuZGluZyBjb3B5IGZyb20gZW5kXG4gICAgZm9yIChpID0gbGVuIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2UgaWYgKGxlbiA8IDEwMDAgfHwgIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gYXNjZW5kaW5nIGNvcHkgZnJvbSBzdGFydFxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgVWludDhBcnJheS5wcm90b3R5cGUuc2V0LmNhbGwoXG4gICAgICB0YXJnZXQsXG4gICAgICB0aGlzLnN1YmFycmF5KHN0YXJ0LCBzdGFydCArIGxlbiksXG4gICAgICB0YXJnZXRTdGFydFxuICAgIClcbiAgfVxuXG4gIHJldHVybiBsZW5cbn1cblxuLy8gVXNhZ2U6XG4vLyAgICBidWZmZXIuZmlsbChudW1iZXJbLCBvZmZzZXRbLCBlbmRdXSlcbi8vICAgIGJ1ZmZlci5maWxsKGJ1ZmZlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoc3RyaW5nWywgb2Zmc2V0WywgZW5kXV1bLCBlbmNvZGluZ10pXG5CdWZmZXIucHJvdG90eXBlLmZpbGwgPSBmdW5jdGlvbiBmaWxsICh2YWwsIHN0YXJ0LCBlbmQsIGVuY29kaW5nKSB7XG4gIC8vIEhhbmRsZSBzdHJpbmcgY2FzZXM6XG4gIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgIGlmICh0eXBlb2Ygc3RhcnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IHN0YXJ0XG4gICAgICBzdGFydCA9IDBcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZW5kID09PSAnc3RyaW5nJykge1xuICAgICAgZW5jb2RpbmcgPSBlbmRcbiAgICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gICAgfVxuICAgIGlmICh2YWwubGVuZ3RoID09PSAxKSB7XG4gICAgICB2YXIgY29kZSA9IHZhbC5jaGFyQ29kZUF0KDApXG4gICAgICBpZiAoY29kZSA8IDI1Nikge1xuICAgICAgICB2YWwgPSBjb2RlXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2VuY29kaW5nIG11c3QgYmUgYSBzdHJpbmcnKVxuICAgIH1cbiAgICBpZiAodHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgdmFsID0gdmFsICYgMjU1XG4gIH1cblxuICAvLyBJbnZhbGlkIHJhbmdlcyBhcmUgbm90IHNldCB0byBhIGRlZmF1bHQsIHNvIGNhbiByYW5nZSBjaGVjayBlYXJseS5cbiAgaWYgKHN0YXJ0IDwgMCB8fCB0aGlzLmxlbmd0aCA8IHN0YXJ0IHx8IHRoaXMubGVuZ3RoIDwgZW5kKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ091dCBvZiByYW5nZSBpbmRleCcpXG4gIH1cblxuICBpZiAoZW5kIDw9IHN0YXJ0KSB7XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHN0YXJ0ID0gc3RhcnQgPj4+IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyB0aGlzLmxlbmd0aCA6IGVuZCA+Pj4gMFxuXG4gIGlmICghdmFsKSB2YWwgPSAwXG5cbiAgdmFyIGlcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgICAgdGhpc1tpXSA9IHZhbFxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgYnl0ZXMgPSBCdWZmZXIuaXNCdWZmZXIodmFsKVxuICAgICAgPyB2YWxcbiAgICAgIDogdXRmOFRvQnl0ZXMobmV3IEJ1ZmZlcih2YWwsIGVuY29kaW5nKS50b1N0cmluZygpKVxuICAgIHZhciBsZW4gPSBieXRlcy5sZW5ndGhcbiAgICBmb3IgKGkgPSAwOyBpIDwgZW5kIC0gc3RhcnQ7ICsraSkge1xuICAgICAgdGhpc1tpICsgc3RhcnRdID0gYnl0ZXNbaSAlIGxlbl1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpc1xufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IChsZWFkU3Vycm9nYXRlIC0gMHhEODAwIDw8IDEwIHwgY29kZVBvaW50IC0gMHhEQzAwKSArIDB4MTAwMDBcbiAgICB9IGVsc2UgaWYgKGxlYWRTdXJyb2dhdGUpIHtcbiAgICAgIC8vIHZhbGlkIGJtcCBjaGFyLCBidXQgbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgIH1cblxuICAgIGxlYWRTdXJyb2dhdGUgPSBudWxsXG5cbiAgICAvLyBlbmNvZGUgdXRmOFxuICAgIGlmIChjb2RlUG9pbnQgPCAweDgwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDEpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goY29kZVBvaW50KVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHg4MDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiB8IDB4QzAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDMpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgfCAweEUwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSA0KSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHgxMiB8IDB4RjAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweEMgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29kZSBwb2ludCcpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpVG9CeXRlcyAoc3RyKSB7XG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIC8vIE5vZGUncyBjb2RlIHNlZW1zIHRvIGJlIGRvaW5nIHRoaXMgYW5kIG5vdCAmIDB4N0YuLlxuICAgIGJ5dGVBcnJheS5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhGRilcbiAgfVxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIHV0ZjE2bGVUb0J5dGVzIChzdHIsIHVuaXRzKSB7XG4gIHZhciBjLCBoaSwgbG9cbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG5cbiAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSlcbiAgICBoaSA9IGMgPj4gOFxuICAgIGxvID0gYyAlIDI1NlxuICAgIGJ5dGVBcnJheS5wdXNoKGxvKVxuICAgIGJ5dGVBcnJheS5wdXNoKGhpKVxuICB9XG5cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiBiYXNlNjRUb0J5dGVzIChzdHIpIHtcbiAgcmV0dXJuIGJhc2U2NC50b0J5dGVBcnJheShiYXNlNjRjbGVhbihzdHIpKVxufVxuXG5mdW5jdGlvbiBibGl0QnVmZmVyIChzcmMsIGRzdCwgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIGlmICgoaSArIG9mZnNldCA+PSBkc3QubGVuZ3RoKSB8fCAoaSA+PSBzcmMubGVuZ3RoKSkgYnJlYWtcbiAgICBkc3RbaSArIG9mZnNldF0gPSBzcmNbaV1cbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiBpc25hbiAodmFsKSB7XG4gIHJldHVybiB2YWwgIT09IHZhbCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXNlbGYtY29tcGFyZVxufVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG1cbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIGUgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IG1MZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBpZiAoZSA9PT0gMCkge1xuICAgIGUgPSAxIC0gZUJpYXNcbiAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7XG4gICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpXG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKVxuICAgIGUgPSBlIC0gZUJpYXNcbiAgfVxuICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKVxufVxuXG5leHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IGUgKyBlQmlhc1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSAwXG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge31cblxuICBlID0gKGUgPDwgbUxlbikgfCBtXG4gIGVMZW4gKz0gbUxlblxuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9XG5cbiAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4XG59XG4iLCJ2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcblxubW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nO1xufTtcbiIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICdjMTI1NTNzeEN4Ry9vbjBCejdya1gwZicsICdBbGVydCcpO1xuLy8gc2NyaXB0cy9jb21wb25lbnRzL0FsZXJ0LmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBfYWxlcnQ6IG51bGwsXG4gICAgICAgIF9idG5PSzogbnVsbCxcbiAgICAgICAgX2J0bkNhbmNlbDogbnVsbCxcbiAgICAgICAgX3RpdGxlOiBudWxsLFxuICAgICAgICBfY29udGVudDogbnVsbCxcbiAgICAgICAgX29ub2s6IG51bGxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWxlcnQgPSBjYy5maW5kKFwiQ2FudmFzL2FsZXJ0XCIpO1xuICAgICAgICB0aGlzLl90aXRsZSA9IGNjLmZpbmQoXCJDYW52YXMvYWxlcnQvdGl0bGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgdGhpcy5fY29udGVudCA9IGNjLmZpbmQoXCJDYW52YXMvYWxlcnQvY29udGVudFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuXG4gICAgICAgIHRoaXMuX2J0bk9LID0gY2MuZmluZChcIkNhbnZhcy9hbGVydC9idG5fb2tcIik7XG4gICAgICAgIHRoaXMuX2J0bkNhbmNlbCA9IGNjLmZpbmQoXCJDYW52YXMvYWxlcnQvYnRuX2NhbmNlbFwiKTtcblxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX2J0bk9LLCB0aGlzLm5vZGUsIFwiQWxlcnRcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fYnRuQ2FuY2VsLCB0aGlzLm5vZGUsIFwiQWxlcnRcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XG5cbiAgICAgICAgdGhpcy5fYWxlcnQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIGNjLnZ2LmFsZXJ0ID0gdGhpcztcbiAgICB9LFxuXG4gICAgb25CdG5DbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkNsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX29rXCIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbm9rKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25vaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9vbm9rID0gbnVsbDtcbiAgICB9LFxuXG4gICAgc2hvdzogZnVuY3Rpb24gc2hvdyh0aXRsZSwgY29udGVudCwgb25vaywgbmVlZGNhbmNlbCkge1xuICAgICAgICB0aGlzLl9hbGVydC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9vbm9rID0gb25vaztcbiAgICAgICAgdGhpcy5fdGl0bGUuc3RyaW5nID0gdGl0bGU7XG4gICAgICAgIHRoaXMuX2NvbnRlbnQuc3RyaW5nID0gY29udGVudDtcbiAgICAgICAgaWYgKG5lZWRjYW5jZWwpIHtcbiAgICAgICAgICAgIHRoaXMuX2J0bkNhbmNlbC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fYnRuT0sueCA9IC0xNTA7XG4gICAgICAgICAgICB0aGlzLl9idG5DYW5jZWwueCA9IDE1MDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2J0bkNhbmNlbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2J0bk9LLnggPSAwO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uRGVzdG9yeTogZnVuY3Rpb24gb25EZXN0b3J5KCkge1xuICAgICAgICBpZiAoY2MudnYpIHtcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2Y1OGNlYTZscnBEWkpTTnMyQkdCcXhOJywgJ0FueXNka01ncicpO1xuLy8gc2NyaXB0cy9BbnlzZGtNZ3IuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9pc0NhcHR1cmluZzogZmFsc2VcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7fSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG5cbiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB0aGlzLkFORFJPSURfQVBJID0gXCJjb20vdml2aWdhbWVzL3NjbWovV1hBUElcIjtcbiAgICAgICAgdGhpcy5JT1NfQVBJID0gXCJBcHBDb250cm9sbGVyXCI7XG4gICAgfSxcblxuICAgIGxvZ2luOiBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZCh0aGlzLkFORFJPSURfQVBJLCBcIkxvZ2luXCIsIFwiKClWXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHRoaXMuSU9TX0FQSSwgXCJsb2dpblwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxhdGZvcm06XCIgKyBjYy5zeXMub3MgKyBcIiBkb3NuJ3QgaW1wbGVtZW50IHNoYXJlLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzaGFyZTogZnVuY3Rpb24gc2hhcmUodGl0bGUsIGRlc2MpIHtcbiAgICAgICAgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZCh0aGlzLkFORFJPSURfQVBJLCBcIlNoYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGNjLnZ2LlNJLmFwcHdlYiwgdGl0bGUsIGRlc2MpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHRoaXMuSU9TX0FQSSwgXCJzaGFyZTpzaGFyZVRpdGxlOnNoYXJlRGVzYzpcIiwgY2MudnYuU0kuYXBwd2ViLCB0aXRsZSwgZGVzYyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXRmb3JtOlwiICsgY2Muc3lzLm9zICsgXCIgZG9zbid0IGltcGxlbWVudCBzaGFyZS5cIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hhcmVSZXN1bHQ6IGZ1bmN0aW9uIHNoYXJlUmVzdWx0KCkge1xuICAgICAgICBpZiAodGhpcy5faXNDYXB0dXJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pc0NhcHR1cmluZyA9IHRydWU7XG4gICAgICAgIHZhciBzaXplID0gY2MuZGlyZWN0b3IuZ2V0V2luU2l6ZSgpO1xuICAgICAgICB2YXIgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgZmlsZU5hbWUgPSBcInJlc3VsdF9zaGFyZS5qcGdcIjtcbiAgICAgICAgdmFyIGZ1bGxQYXRoID0ganNiLmZpbGVVdGlscy5nZXRXcml0YWJsZVBhdGgoKSArIGZpbGVOYW1lO1xuICAgICAgICBpZiAoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpIHtcbiAgICAgICAgICAgIGpzYi5maWxlVXRpbHMucmVtb3ZlRmlsZShmdWxsUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRleHR1cmUgPSBuZXcgY2MuUmVuZGVyVGV4dHVyZShNYXRoLmZsb29yKHNpemUud2lkdGgpLCBNYXRoLmZsb29yKHNpemUuaGVpZ2h0KSk7XG4gICAgICAgIHRleHR1cmUuc2V0UG9zaXRpb24oY2MucChzaXplLndpZHRoIC8gMiwgc2l6ZS5oZWlnaHQgLyAyKSk7XG4gICAgICAgIHRleHR1cmUuYmVnaW4oKTtcbiAgICAgICAgY2MuZGlyZWN0b3IuZ2V0UnVubmluZ1NjZW5lKCkudmlzaXQoKTtcbiAgICAgICAgdGV4dHVyZS5lbmQoKTtcbiAgICAgICAgdGV4dHVyZS5zYXZlVG9GaWxlKGZpbGVOYW1lLCBjYy5JTUFHRV9GT1JNQVRfSlBHKTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0cnlUaW1lcyA9IDA7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKCkge1xuICAgICAgICAgICAgaWYgKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QoZnVsbFBhdGgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IDEwMDtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSBoZWlnaHQgLyBzaXplLmhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBNYXRoLmZsb29yKHNpemUud2lkdGggKiBzY2FsZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2Qoc2VsZi5BTkRST0lEX0FQSSwgXCJTaGFyZUlNR1wiLCBcIihMamF2YS9sYW5nL1N0cmluZztJSSlWXCIsIGZ1bGxQYXRoLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2Qoc2VsZi5JT1NfQVBJLCBcInNoYXJlSU1HOndpZHRoOmhlaWdodDpcIiwgZnVsbFBhdGgsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxhdGZvcm06XCIgKyBjYy5zeXMub3MgKyBcIiBkb3NuJ3QgaW1wbGVtZW50IHNoYXJlLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5faXNDYXB0dXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJ5VGltZXMrKztcbiAgICAgICAgICAgICAgICBpZiAodHJ5VGltZXMgPiAxMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRpbWUgb3V0Li4uXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm4sIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc2V0VGltZW91dChmbiwgNTApO1xuICAgIH0sXG5cbiAgICBvbkxvZ2luUmVzcDogZnVuY3Rpb24gb25Mb2dpblJlc3AoY29kZSkge1xuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbiBmbihyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwid3hfYWNjb3VudFwiLCByZXQuYWNjb3VudCk7XG4gICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwid3hfc2lnblwiLCByZXQuc2lnbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYy52di51c2VyTWdyLm9uQXV0aChyZXQpO1xuICAgICAgICB9O1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL3dlY2hhdF9hdXRoXCIsIHsgY29kZTogY29kZSwgb3M6IGNjLnN5cy5vcyB9LCBmbik7XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc1NWNhZXBjcHZGSzVyMEF4NWY4anNzNCcsICdBdWRpb01ncicpO1xuLy8gc2NyaXB0cy9BdWRpb01nci5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgYmdtVm9sdW1lOiAxLjAsXG4gICAgICAgIHNmeFZvbHVtZTogMS4wLFxuXG4gICAgICAgIGJnbUF1ZGlvSUQ6IC0xXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIHZhciB0ID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdtVm9sdW1lXCIpO1xuICAgICAgICBpZiAodCAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmJnbVZvbHVtZSA9IHBhcnNlRmxvYXQodCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInNmeFZvbHVtZVwiKTtcbiAgICAgICAgaWYgKHQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zZnhWb2x1bWUgPSBwYXJzZUZsb2F0KHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuYXVkaW9FbmdpbmUucGF1c2VBbGxcIik7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wYXVzZUFsbCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX1NIT1csIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuYXVkaW9FbmdpbmUucmVzdW1lQWxsXCIpO1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucmVzdW1lQWxsKCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxuXG4gICAgZ2V0VXJsOiBmdW5jdGlvbiBnZXRVcmwodXJsKSB7XG4gICAgICAgIHJldHVybiBjYy51cmwucmF3KFwicmVzb3VyY2VzL3NvdW5kcy9cIiArIHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlCR006IGZ1bmN0aW9uIHBsYXlCR00odXJsKSB7XG4gICAgICAgIHZhciBhdWRpb1VybCA9IHRoaXMuZ2V0VXJsKHVybCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGF1ZGlvVXJsKTtcbiAgICAgICAgaWYgKHRoaXMuYmdtQXVkaW9JRCA+PSAwKSB7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wKHRoaXMuYmdtQXVkaW9JRCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5iZ21BdWRpb0lEID0gY2MuYXVkaW9FbmdpbmUucGxheShhdWRpb1VybCwgdHJ1ZSwgdGhpcy5iZ21Wb2x1bWUpO1xuICAgIH0sXG5cbiAgICBwbGF5U0ZYOiBmdW5jdGlvbiBwbGF5U0ZYKHVybCkge1xuICAgICAgICB2YXIgYXVkaW9VcmwgPSB0aGlzLmdldFVybCh1cmwpO1xuICAgICAgICBpZiAodGhpcy5zZnhWb2x1bWUgPiAwKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXkoYXVkaW9VcmwsIGZhbHNlLCB0aGlzLnNmeFZvbHVtZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0U0ZYVm9sdW1lOiBmdW5jdGlvbiBzZXRTRlhWb2x1bWUodikge1xuICAgICAgICBpZiAodGhpcy5zZnhWb2x1bWUgIT0gdikge1xuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2Z4Vm9sdW1lXCIsIHYpO1xuICAgICAgICAgICAgdGhpcy5zZnhWb2x1bWUgPSB2O1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNldEJHTVZvbHVtZTogZnVuY3Rpb24gc2V0QkdNVm9sdW1lKHYsIGZvcmNlKSB7XG4gICAgICAgIGlmICh0aGlzLmJnbUF1ZGlvSUQgPj0gMCkge1xuICAgICAgICAgICAgaWYgKHYgPiAwKSB7XG4gICAgICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucmVzdW1lKHRoaXMuYmdtQXVkaW9JRCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlKHRoaXMuYmdtQXVkaW9JRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2NjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnbUF1ZGlvSUQsdGhpcy5iZ21Wb2x1bWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmJnbVZvbHVtZSAhPSB2IHx8IGZvcmNlKSB7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJiZ21Wb2x1bWVcIiwgdik7XG4gICAgICAgICAgICB0aGlzLmJnbVZvbHVtZSA9IHY7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ21BdWRpb0lELCB2KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBwYXVzZUFsbDogZnVuY3Rpb24gcGF1c2VBbGwoKSB7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlQWxsKCk7XG4gICAgfSxcblxuICAgIHJlc3VtZUFsbDogZnVuY3Rpb24gcmVzdW1lQWxsKCkge1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVBbGwoKTtcbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzU4ZjI3cnh1c3ROc1lsUlgzZnJ5TjhYJywgJ0NoYXQnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9DaGF0LmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX2NoYXRSb290OiBudWxsLFxuICAgICAgICBfdGFiUXVpY2s6IG51bGwsXG4gICAgICAgIF90YWJFbW9qaTogbnVsbCxcbiAgICAgICAgX2lwdENoYXQ6IG51bGwsXG5cbiAgICAgICAgX3F1aWNrQ2hhdEluZm86IG51bGwsXG4gICAgICAgIF9idG5DaGF0OiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2MudnYuY2hhdCA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5fYnRuQ2hhdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bl9jaGF0XCIpO1xuICAgICAgICB0aGlzLl9idG5DaGF0LmFjdGl2ZSA9IGNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpID09IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2NoYXRSb290ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY2hhdFwiKTtcbiAgICAgICAgdGhpcy5fY2hhdFJvb3QuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fdGFiUXVpY2sgPSB0aGlzLl9jaGF0Um9vdC5nZXRDaGlsZEJ5TmFtZShcInF1aWNrY2hhdGxpc3RcIik7XG4gICAgICAgIHRoaXMuX3RhYkVtb2ppID0gdGhpcy5fY2hhdFJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaXNcIik7XG5cbiAgICAgICAgdGhpcy5faXB0Q2hhdCA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwiaXB0Q2hhdFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCk7XG5cbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mbyA9IHt9O1xuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTBcIl0gPSB7IGluZGV4OiAwLCBjb250ZW50OiBcIuW/q+eCueWViu+8jOmDveetieWIsOaIkeiKseWEv+mDveiwouiwouS6hu+8gVwiLCBzb3VuZDogXCJmaXhfbXNnXzEubXAzXCIgfTtcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW0xXCJdID0geyBpbmRleDogMSwgY29udGVudDogXCLmgI7kuYjlj4jmlq3nur/kuobvvIznvZHnu5zmgI7kuYjov5nkuYjlt67llYrvvIFcIiwgc291bmQ6IFwiZml4X21zZ18yLm1wM1wiIH07XG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtMlwiXSA9IHsgaW5kZXg6IDIsIGNvbnRlbnQ6IFwi5LiN6KaB6LWw77yM5Yaz5oiY5Yiw5aSp5Lqu77yBXCIsIHNvdW5kOiBcImZpeF9tc2dfMy5tcDNcIiB9O1xuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTNcIl0gPSB7IGluZGV4OiAzLCBjb250ZW50OiBcIuS9oOeahOeJjOaJk+W+l+S5n+WkquWlveS6hu+8gVwiLCBzb3VuZDogXCJmaXhfbXNnXzQubXAzXCIgfTtcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW00XCJdID0geyBpbmRleDogNCwgY29udGVudDogXCLkvaDmmK/lprnlprnov5jmmK/lk6Xlk6XllYrvvJ9cIiwgc291bmQ6IFwiZml4X21zZ181Lm1wM1wiIH07XG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtNVwiXSA9IHsgaW5kZXg6IDUsIGNvbnRlbnQ6IFwi5ZKM5L2g5ZCI5L2c55yf5piv5aSq5oSJ5b+r5LqG77yBXCIsIHNvdW5kOiBcImZpeF9tc2dfNi5tcDNcIiB9O1xuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTZcIl0gPSB7IGluZGV4OiA2LCBjb250ZW50OiBcIuWkp+WutuWlve+8jOW+iOmrmOWFtOingeWIsOWQhOS9je+8gVwiLCBzb3VuZDogXCJmaXhfbXNnXzcubXAzXCIgfTtcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW03XCJdID0geyBpbmRleDogNywgY29udGVudDogXCLlkITkvY3vvIznnJ/mmK/kuI3lpb3mhI/mgJ3vvIzmiJHlvpfnprvlvIDkuIDkvJrlhL/jgIJcIiwgc291bmQ6IFwiZml4X21zZ184Lm1wM1wiIH07XG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtOFwiXSA9IHsgaW5kZXg6IDgsIGNvbnRlbnQ6IFwi5LiN6KaB5ZC15LqG77yM5LiT5b+D546p5ri45oiP5ZCn77yBXCIsIHNvdW5kOiBcImZpeF9tc2dfOS5tcDNcIiB9O1xuICAgIH0sXG5cbiAgICBnZXRRdWlja0NoYXRJbmZvOiBmdW5jdGlvbiBnZXRRdWlja0NoYXRJbmZvKGluZGV4KSB7XG4gICAgICAgIHZhciBrZXkgPSBcIml0ZW1cIiArIGluZGV4O1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVpY2tDaGF0SW5mb1trZXldO1xuICAgIH0sXG5cbiAgICBvbkJ0bkNoYXRDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkNoYXRDbGlja2VkKCkge1xuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBvbkJnQ2xpY2tlZDogZnVuY3Rpb24gb25CZ0NsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBvblRhYkNsaWNrZWQ6IGZ1bmN0aW9uIG9uVGFiQ2xpY2tlZChldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJRdWlja1wiKSB7XG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fdGFiRW1vamkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJFbW9qaVwiKSB7XG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3RhYkVtb2ppLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25RdWlja0NoYXRJdGVtQ2xpY2tlZDogZnVuY3Rpb24gb25RdWlja0NoYXRJdGVtQ2xpY2tlZChldmVudCkge1xuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGluZm8gPSB0aGlzLl9xdWlja0NoYXRJbmZvW2V2ZW50LnRhcmdldC5uYW1lXTtcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJxdWlja19jaGF0XCIsIGluZm8uaW5kZXgpO1xuICAgIH0sXG5cbiAgICBvbkVtb2ppSXRlbUNsaWNrZWQ6IGZ1bmN0aW9uIG9uRW1vamlJdGVtQ2xpY2tlZChldmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQubmFtZSk7XG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBjYy52di5uZXQuc2VuZChcImVtb2ppXCIsIGV2ZW50LnRhcmdldC5uYW1lKTtcbiAgICB9LFxuXG4gICAgb25CdG5TZW5kQ2hhdENsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuU2VuZENoYXRDbGlja2VkKCkge1xuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuX2lwdENoYXQuc3RyaW5nID09IFwiXCIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYy52di5uZXQuc2VuZChcImNoYXRcIiwgdGhpcy5faXB0Q2hhdC5zdHJpbmcpO1xuICAgICAgICB0aGlzLl9pcHRDaGF0LnN0cmluZyA9IFwiXCI7XG4gICAgfVxuXG59KTtcbi8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4vLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4vLyB9LFxuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnZGM5ZTVoY2VnRkJGcGJoMEN3VUZ3OFYnLCAnQ2hlY2tCb3gnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9DaGVja0JveC5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHRhcmdldDogY2MuTm9kZSxcbiAgICAgICAgc3ByaXRlOiBjYy5TcHJpdGVGcmFtZSxcbiAgICAgICAgY2hlY2tlZFNwcml0ZTogY2MuU3ByaXRlRnJhbWUsXG4gICAgICAgIGNoZWNrZWQ6IGZhbHNlXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9LFxuXG4gICAgb25DbGlja2VkOiBmdW5jdGlvbiBvbkNsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICBzd2l0Y2hUb1VuY2hlY2tlZDogZnVuY3Rpb24gc3dpdGNoVG9VbmNoZWNrZWQoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9LFxuXG4gICAgcmVmcmVzaDogZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgdmFyIHRhcmdldFNwcml0ZSA9IHRoaXMudGFyZ2V0LmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICBpZiAodGhpcy5jaGVja2VkKSB7XG4gICAgICAgICAgICB0YXJnZXRTcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLmNoZWNrZWRTcHJpdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXRTcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLnNwcml0ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzVkNTZiRll5L1JFYjc3cFFDcTlZSGg2JywgJ0NyZWF0ZVJvbGUnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9DcmVhdGVSb2xlLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpbnB1dE5hbWU6IGNjLkVkaXRCb3hcbiAgICB9LFxuXG4gICAgLy8gZm9vOiB7XG4gICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAvLyB9LFxuICAgIC8vIC4uLlxuICAgIG9uUmFuZG9tQnRuQ2xpY2tlZDogZnVuY3Rpb24gb25SYW5kb21CdG5DbGlja2VkKCkge1xuICAgICAgICB2YXIgbmFtZXMgPSBbXCLkuIrlrphcIiwgXCLmrKfpmLNcIiwgXCLkuJzmlrlcIiwgXCLnq6/mnKhcIiwgXCLni6zlraRcIiwgXCLlj7jpqaxcIiwgXCLljZflrqtcIiwgXCLlpI/kvq9cIiwgXCLor7jokZtcIiwgXCLnmofnlKtcIiwgXCLplb/lrZlcIiwgXCLlrofmlodcIiwgXCLovanovpVcIiwgXCLkuJzpg61cIiwgXCLlrZDovaZcIiwgXCLkuJzpmLNcIiwgXCLlrZDoqIBcIl07XG5cbiAgICAgICAgdmFyIG5hbWVzMiA9IFtcIumbgOWco1wiLCBcIui1jOS+oFwiLCBcIui1jOWco1wiLCBcIueos+i1olwiLCBcIuS4jei+k1wiLCBcIuWlvei/kFwiLCBcIuiHquaRuFwiLCBcIuaciemSsVwiLCBcIuWcn+ixqlwiXTtcbiAgICAgICAgdmFyIGlkeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChuYW1lcy5sZW5ndGggLSAxKSk7XG4gICAgICAgIHZhciBpZHgyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG5hbWVzMi5sZW5ndGggLSAxKSk7XG4gICAgICAgIHRoaXMuaW5wdXROYW1lLnN0cmluZyA9IG5hbWVzW2lkeF0gKyBuYW1lczJbaWR4Ml07XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHZhciBjdnMgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkNhbnZhcyk7XG4gICAgICAgICAgICBjdnMuZml0SGVpZ2h0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGN2cy5maXRXaWR0aCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vblJhbmRvbUJ0bkNsaWNrZWQoKTtcbiAgICB9LFxuXG4gICAgb25CdG5Db25maXJtQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5Db25maXJtQ2xpY2tlZCgpIHtcbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLmlucHV0TmFtZS5zdHJpbmc7XG4gICAgICAgIGlmIChuYW1lID09IFwiXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW52YWxpZCBuYW1lLlwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhuYW1lKTtcbiAgICAgICAgY2MudnYudXNlck1nci5jcmVhdGUobmFtZSk7XG4gICAgfVxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2VlYzA3SHNMNHBCbjUvUGlUM1NZQmV3JywgJ0NyZWF0ZVJvb20nKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9DcmVhdGVSb29tLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBfbGVpeGluZ3h1YW56ZTogbnVsbCxcbiAgICAgICAgX2tvdWZlaTogbnVsbCxcbiAgICAgICAgX3F1YW5zaHU6IG51bGwsXG4gICAgICAgIF9qaWVzdWFuOiBudWxsLFxuICAgICAgICBfd2FuZmF4dWFuemU6IG51bGwsXG4gICAgICAgIF90eXBlczogW10gfSxcblxuICAgIC8v5a6a5LmJ5aSa56eN5ri45oiP57G75Z6LXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIC8v5pyJ5aSa56eN546p5rOV77yM5rKI5a626Zeo6bq75bCGIOWumua1t+m6u+WwhiDmjqjliLDog6HpurvlsIZcbiAgICAgICAgdGhpcy5fdHlwZXMgPSBbXCJzam1talwiLCBcImRobWpcIiwgXCJ0ZGhcIl07XG5cbiAgICAgICAgLy/pmpDol4/pmaTnrKzkuIDnp43lpJbnmoTlhbbku5bnjqnms5Ug55WM6Z2iXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5fdHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSh0aGlzLl90eXBlc1tpXSkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25CdG5CYWNrOiBmdW5jdGlvbiBvbkJ0bkJhY2soKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgb25CdG5PSzogZnVuY3Rpb24gb25CdG5PSyhldmVudCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIC8v56Gu5a6a5ri45oiP57G75Z6LXG4gICAgICAgIHZhciB0eXBlID0gZXZlbnQudGFyZ2V0LnBhcmVudC5uYW1lO1xuICAgICAgICAvL+WIhuWIq+i/m+WFpeS4jeWQjOeahOWIm+W7uumAu+i+kVxuICAgICAgICAvL1RPRE/vvJrorqnmt7vliqDkuIDkuKrmuLjmiI/lkozop4TliJnmm7TliqDmlrnkvr9cbiAgICAgICAgaWYgKHR5cGUgPT0gXCJzam1talwiKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVJvb21TSk1NSigpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gXCJkaG1qXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUm9vbURITUooKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IFwidGRoXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUm9vbVRESCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uVHlwZUNsaWNrZWQ6IGZ1bmN0aW9uIG9uVHlwZUNsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5zd2l0Y2hUeXBlKGV2ZW50LnRhcmdldC5wYXJlbnQuY2hpbGRyZW5bMV0ubmFtZSk7XG4gICAgfSxcblxuICAgIC8vdGFi55WM6Z2i5YiH5o2iXG4gICAgc3dpdGNoVHlwZTogZnVuY3Rpb24gc3dpdGNoVHlwZSh0eXBlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fdHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSh0aGlzLl90eXBlc1tpXSkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGNyZWF0ZVJvb21TSk1NSjogZnVuY3Rpb24gY3JlYXRlUm9vbVNKTU1KKCkge1xuXG4gICAgICAgIC8v6I635Y+W6ZyA6KaB55qE5omA5pyJ6YCJ6aG5XG5cbiAgICAgICAgLy/ov5nph4zkuIDlrpropoHlsI/lhpnvvIzlkI7nq6/kvJrnm7TmjqXmi7zmjqXov5nkuKrlrZfnrKbkuLJcbiAgICAgICAgdmFyIHR5cGUgPSBcInNqbW1qXCI7XG5cbiAgICAgICAgdGhpcy5fa291ZmVpID0gW107XG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmdldENoaWxkQnlOYW1lKFwia291ZmVpXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiUmFkaW9CdXR0b25cIik7XG4gICAgICAgICAgICBpZiAobiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fa291ZmVpLnB1c2gobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9xdWFuc2h1ID0gW107XG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmdldENoaWxkQnlOYW1lKFwicXVhbnNodVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlJhZGlvQnV0dG9uXCIpO1xuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1YW5zaHUucHVzaChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ppZXN1YW4gPSBbXTtcbiAgICAgICAgdmFyIHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUodHlwZSkuZ2V0Q2hpbGRCeU5hbWUoXCJqaWVzdWFuXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiUmFkaW9CdXR0b25cIik7XG4gICAgICAgICAgICBpZiAobiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5famllc3Vhbi5wdXNoKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fd2FuZmF4dWFuemUgPSBbXTtcbiAgICAgICAgdmFyIHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUodHlwZSkuZ2V0Q2hpbGRCeU5hbWUoXCJ3YW5mYXh1YW56ZVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpO1xuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dhbmZheHVhbnplLnB1c2gobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvbkNyZWF0ZSA9IGZ1bmN0aW9uIG9uQ3JlYXRlKHJldCkge1xuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmV0LmVycm1zZyk7XG4gICAgICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IDIyMjIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuaIv+WNoeS4jei2s++8jOWIm+W7uuaIv+mXtOWksei0pSFcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuWIm+W7uuaIv+mXtOWksei0pSzplJnor6/noIE6XCIgKyByZXQuZXJyY29kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmNvbm5lY3RHYW1lU2VydmVyKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGhvbmd6aG9uZ2RhbmdodWEgPSBzZWxmLl93YW5mYXh1YW56ZVswXS5jaGVja2VkO1xuXG4gICAgICAgIHZhciBrb3VmZWkgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX2tvdWZlaS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuX2tvdWZlaVtpXS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAga291ZmVpID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBxdWFuc2h1ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLl9xdWFuc2h1Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5fcXVhbnNodVtpXS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgcXVhbnNodSA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgamllc3VhbiA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5famllc3Vhbi5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuX2ppZXN1YW5baV0uY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIGppZXN1YW4gPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNvbmYgPSB7XG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgaG9uZ3pob25nZGFuZ2h1YTogaG9uZ3pob25nZGFuZ2h1YSxcbiAgICAgICAgICAgIGtvdWZlaToga291ZmVpLFxuICAgICAgICAgICAgcXVhbnNodTogcXVhbnNodSxcbiAgICAgICAgICAgIGppZXN1YW46IGppZXN1YW5cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcbiAgICAgICAgICAgIGNvbmY6IEpTT04uc3RyaW5naWZ5KGNvbmYpXG4gICAgICAgIH07XG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjliJvlu7rmiL/pl7RcIik7XG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvY3JlYXRlX3ByaXZhdGVfcm9vbVwiLCBkYXRhLCBvbkNyZWF0ZSk7XG4gICAgfSxcblxuICAgIGNyZWF0ZVJvb21ESE1KOiBmdW5jdGlvbiBjcmVhdGVSb29tREhNSigpIHtcblxuICAgICAgICAvL+iOt+WPlumcgOimgeeahOaJgOaciemAiemhuVxuICAgICAgICAvL+i/memHjOS4gOWumuimgeWwj+WGme+8jOWQjuerr+S8muebtOaOpeaLvOaOpei/meS4quWtl+espuS4slxuICAgICAgICB2YXIgdHlwZSA9IFwiZGhtalwiO1xuXG4gICAgICAgIHRoaXMuX2tvdWZlaSA9IFtdO1xuICAgICAgICB2YXIgdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSh0eXBlKS5nZXRDaGlsZEJ5TmFtZShcImtvdWZlaVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlJhZGlvQnV0dG9uXCIpO1xuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2tvdWZlaS5wdXNoKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcXVhbnNodSA9IFtdO1xuICAgICAgICB2YXIgdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSh0eXBlKS5nZXRDaGlsZEJ5TmFtZShcInF1YW5zaHVcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdC5jaGlsZHJlbkNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuID0gdC5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoXCJSYWRpb0J1dHRvblwiKTtcbiAgICAgICAgICAgIGlmIChuICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9xdWFuc2h1LnB1c2gobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9qaWVzdWFuID0gW107XG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmdldENoaWxkQnlOYW1lKFwiamllc3VhblwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlJhZGlvQnV0dG9uXCIpO1xuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ppZXN1YW4ucHVzaChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIG9uQ3JlYXRlID0gZnVuY3Rpb24gb25DcmVhdGUocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IDIyMjIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuaIv+WNoeS4jei2s++8jOWIm+W7uuaIv+mXtOWksei0pSFcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuWIm+W7uuaIv+mXtOWksei0pSzplJnor6/noIE6XCIgKyByZXQuZXJyY29kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmNvbm5lY3RHYW1lU2VydmVyKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy/liKTmlq3nlKjmiLflgZrkuoblk6rkupvpgInmi6lcbiAgICAgICAgLy/miaPotLkgMCDmiL/kuLvlh7rotYQgMSDnjqnlrrblubPliIZcbiAgICAgICAgLy/lnIjmlbAgMCA455uYIDEg5LiA5ZyIXG4gICAgICAgIC8v57uT566XIDAgNTAgIDEgMTIwXG5cbiAgICAgICAgdmFyIGtvdWZlaSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5fa291ZmVpLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5fa291ZmVpW2ldLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBrb3VmZWkgPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHF1YW5zaHUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX3F1YW5zaHUubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLl9xdWFuc2h1W2ldLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBxdWFuc2h1ID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBqaWVzdWFuID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLl9qaWVzdWFuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5famllc3VhbltpXS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgamllc3VhbiA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY29uZiA9IHtcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICBrb3VmZWk6IGtvdWZlaSxcbiAgICAgICAgICAgIHF1YW5zaHU6IHF1YW5zaHUsXG4gICAgICAgICAgICBqaWVzdWFuOiBqaWVzdWFuXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXG4gICAgICAgICAgICBjb25mOiBKU09OLnN0cmluZ2lmeShjb25mKVxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOWIm+W7uuaIv+mXtFwiKTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9jcmVhdGVfcHJpdmF0ZV9yb29tXCIsIGRhdGEsIG9uQ3JlYXRlKTtcbiAgICB9LFxuXG4gICAgY3JlYXRlUm9vbVRESDogZnVuY3Rpb24gY3JlYXRlUm9vbVRESCgpIHtcblxuICAgICAgICAvL+iOt+WPlumcgOimgeeahOaJgOaciemAiemhuVxuICAgICAgICAvL+i/memHjOS4gOWumuimgeWwj+WGme+8jOWQjuerr+S8muebtOaOpeaLvOaOpei/meS4quWtl+espuS4slxuICAgICAgICB2YXIgdHlwZSA9IFwidGRoXCI7XG5cbiAgICAgICAgdGhpcy5fa291ZmVpID0gW107XG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmdldENoaWxkQnlOYW1lKFwia291ZmVpXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiUmFkaW9CdXR0b25cIik7XG4gICAgICAgICAgICBpZiAobiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fa291ZmVpLnB1c2gobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9xdWFuc2h1ID0gW107XG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKHR5cGUpLmdldENoaWxkQnlOYW1lKFwicXVhbnNodVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlJhZGlvQnV0dG9uXCIpO1xuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1YW5zaHUucHVzaChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ppZXN1YW4gPSBbXTtcbiAgICAgICAgdmFyIHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUodHlwZSkuZ2V0Q2hpbGRCeU5hbWUoXCJqaWVzdWFuXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiUmFkaW9CdXR0b25cIik7XG4gICAgICAgICAgICBpZiAobiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5famllc3Vhbi5wdXNoKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgb25DcmVhdGUgPSBmdW5jdGlvbiBvbkNyZWF0ZShyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMjIyMikge1xuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5oi/5Y2h5LiN6Laz77yM5Yib5bu65oi/6Ze05aSx6LSlIVwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5Yib5bu65oi/6Ze05aSx6LSlLOmUmeivr+eggTpcIiArIHJldC5lcnJjb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdEdhbWVTZXJ2ZXIocmV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvL+WIpOaWreeUqOaIt+WBmuS6huWTquS6m+mAieaLqVxuICAgICAgICAvL+aJo+i0uSAwIOaIv+S4u+WHuui1hCAxIOeOqeWutuW5s+WIhlxuICAgICAgICAvL+WciOaVsCAwIDjnm5ggMSDkuIDlnIhcbiAgICAgICAgLy/nu5PnrpcgMCA1MCAgMSAxMjBcblxuICAgICAgICB2YXIga291ZmVpID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLl9rb3VmZWkubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLl9rb3VmZWlbaV0uY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIGtvdWZlaSA9IGk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcXVhbnNodSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5fcXVhbnNodS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuX3F1YW5zaHVbaV0uY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHF1YW5zaHUgPSBpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGppZXN1YW4gPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX2ppZXN1YW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLl9qaWVzdWFuW2ldLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBqaWVzdWFuID0gaTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjb25mID0ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIGtvdWZlaToga291ZmVpLFxuICAgICAgICAgICAgcXVhbnNodTogcXVhbnNodSxcbiAgICAgICAgICAgIGppZXN1YW46IGppZXN1YW5cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcbiAgICAgICAgICAgIGNvbmY6IEpTT04uc3RyaW5naWZ5KGNvbmYpXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo5Yib5bu65oi/6Ze0XCIpO1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2NyZWF0ZV9wcml2YXRlX3Jvb21cIiwgZGF0YSwgb25DcmVhdGUpO1xuICAgIH1cblxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc5MDc1ODJhd05KRm5vYkMvbVpHRkxCcScsICdEaW5nUXVlJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvRGluZ1F1ZS5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcXVlWWlNZW46IG51bGwsXG4gICAgICAgIHRpcHM6IFtdLFxuICAgICAgICBzZWxlY3RlZDogW10sXG4gICAgICAgIGRpbmdxdWVzOiBbXVxuICAgIH0sXG5cbiAgICAvLyBmb286IHtcbiAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgIC8vIH0sXG4gICAgLy8gLi4uXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0VmlldygpO1xuICAgICAgICB0aGlzLmluaXREaW5nUXVlKCk7XG4gICAgICAgIHRoaXMuaW5pdEV2ZW50SGFuZGxlcnMoKTtcbiAgICB9LFxuXG4gICAgaW5pdFZpZXc6IGZ1bmN0aW9uIGluaXRWaWV3KCkge1xuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcbiAgICAgICAgdGhpcy5xdWVZaU1lbiA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcImRpbmdxdWVcIik7XG4gICAgICAgIHRoaXMucXVlWWlNZW4uYWN0aXZlID0gY2MudnYuZ2FtZU5ldE1nci5pc0RpbmdRdWVpbmc7XG5cbiAgICAgICAgdmFyIGFyciA9IFtcIm15c2VsZlwiLCBcInJpZ2h0XCIsIFwidXBcIiwgXCJsZWZ0XCJdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNpZGUgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoYXJyW2ldKTtcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2lkZS5nZXRDaGlsZEJ5TmFtZShcInNlYXRcIik7XG4gICAgICAgICAgICB2YXIgZGluZ3F1ZSA9IHNlYXQuZ2V0Q2hpbGRCeU5hbWUoXCJxdWVcIik7XG4gICAgICAgICAgICB0aGlzLmRpbmdxdWVzLnB1c2goZGluZ3F1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHZhciB0aXBzID0gdGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShcInRpcHNcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGlwcy5jaGlsZHJlbkNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuID0gdGlwcy5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgIHRoaXMudGlwcy5wdXNoKG4uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5nYW1lc3RhdGUgPT0gXCJkaW5ncXVlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0RpbmdRdWVDaG9pY2UoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0RXZlbnRIYW5kbGVyczogZnVuY3Rpb24gaW5pdEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZGluZ3F1ZV9ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIHNlYXRJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLmRldGFpbCk7XG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChzZWF0SW5kZXgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJnYW1lX2RpbmdxdWVfbm90aWZ5OlwiICsgbG9jYWxJbmRleCk7XG4gICAgICAgICAgICBzZWxmLnRpcHNbbG9jYWxJbmRleF0ubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZGluZ3F1ZV9maW5pc2gnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL+mAmuefpeavj+S4gOS4queOqeWutuWumue8uueahOiKseiJslxuICAgICAgICAgICAgc2VsZi5xdWVZaU1lbi5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuaXNEaW5nUXVlaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLmluaXREaW5nUXVlKCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzaG93RGluZ1F1ZUNob2ljZTogZnVuY3Rpb24gc2hvd0RpbmdRdWVDaG9pY2UoKSB7XG4gICAgICAgIHRoaXMucXVlWWlNZW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNkID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWxmRGF0YSgpO1xuICAgICAgICB2YXIgdHlwZUNvdW50cyA9IFswLCAwLCAwXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZC5ob2xkcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHBhaSA9IHNkLmhvbGRzW2ldO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBjYy52di5tYWhqb25nbWdyLmdldE1haGpvbmdUeXBlKHBhaSk7XG4gICAgICAgICAgICB0eXBlQ291bnRzW3R5cGVdKys7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbWluID0gNjU1MzU7XG4gICAgICAgIHZhciBtaW5JbmRleCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHlwZUNvdW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHR5cGVDb3VudHNbaV0gPCBtaW4pIHtcbiAgICAgICAgICAgICAgICBtaW4gPSB0eXBlQ291bnRzW2ldO1xuICAgICAgICAgICAgICAgIG1pbkluZGV4ID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhcnIgPSBbXCJ0b25nXCIsIFwidGlhb1wiLCBcIndhblwiXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShhcnJbaV0pO1xuICAgICAgICAgICAgaWYgKG1pbkluZGV4ID09IGkpIHtcbiAgICAgICAgICAgICAgICBub2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pLnBsYXkoXCJkaW5ncXVlX3R1aWppYW5cIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy90aGlzLnF1ZVlpTWVuLmdldENoaWxkQnlOYW1lKGFycltpXSkuZ2V0Q2hpbGRCeU5hbWUoJ2ppYW4nKS5hY3RpdmUgPSBtaW5JbmRleCA9PSBpOyAgXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50aXBzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbiA9IHRoaXMudGlwc1tpXTtcbiAgICAgICAgICAgIGlmIChpID4gMCkge1xuICAgICAgICAgICAgICAgIG4ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbi5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdERpbmdRdWU6IGZ1bmN0aW9uIGluaXREaW5nUXVlKCkge1xuICAgICAgICB2YXIgYXJyID0gW1widG9uZ1wiLCBcInRpYW9cIiwgXCJ3YW5cIl07XG4gICAgICAgIHZhciBkYXRhID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgcXVlID0gZGF0YVtpXS5kaW5ncXVlO1xuICAgICAgICAgICAgaWYgKHF1ZSA9PSBudWxsIHx8IHF1ZSA8IDAgfHwgcXVlID49IGFyci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBxdWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBxdWUgPSBhcnJbcXVlXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaSk7XG4gICAgICAgICAgICBpZiAocXVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaW5ncXVlc1tsb2NhbEluZGV4XS5nZXRDaGlsZEJ5TmFtZShxdWUpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnNldEludGVyYWN0YWJsZSh0cnVlKTtcblxuICAgICAgICB0aGlzLnNlbGVjdGVkLnB1c2godGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShcInRvbmdfc2VsZWN0ZWRcIikpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkLnB1c2godGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShcInRpYW9fc2VsZWN0ZWRcIikpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkLnB1c2godGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShcIndhbl9zZWxlY3RlZFwiKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFtpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kaW5ncXVlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLmRpbmdxdWVzW2ldLmNoaWxkcmVuLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaW5ncXVlc1tpXS5jaGlsZHJlbltqXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvblF1ZVlpTWVuQ2xpY2tlZDogZnVuY3Rpb24gb25RdWVZaU1lbkNsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgdmFyIHR5cGUgPSAwO1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0b25nXCIpIHtcbiAgICAgICAgICAgIHR5cGUgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwidGlhb1wiKSB7XG4gICAgICAgICAgICB0eXBlID0gMTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIndhblwiKSB7XG4gICAgICAgICAgICB0eXBlID0gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZC5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFtpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdGVkW3R5cGVdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZGluZ3F1ZSA9IHR5cGU7XG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGluZ3F1ZVwiLCB0eXBlKTtcblxuICAgICAgICAvL3RoaXMuc2V0SW50ZXJhY3RhYmxlKGZhbHNlKTtcbiAgICB9LFxuXG4gICAgc2V0SW50ZXJhY3RhYmxlOiBmdW5jdGlvbiBzZXRJbnRlcmFjdGFibGUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5xdWVZaU1lbi5nZXRDaGlsZEJ5TmFtZShcInRvbmdcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdmFsdWU7XG4gICAgICAgIHRoaXMucXVlWWlNZW4uZ2V0Q2hpbGRCeU5hbWUoXCJ0aWFvXCIpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnF1ZVlpTWVuLmdldENoaWxkQnlOYW1lKFwid2FuXCIpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzBiZjYzZWlaRUZNV2JXMDNvOGhlcWE1JywgJ0ZvbGRzJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvRm9sZHMuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBfZm9sZHM6IG51bGxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluaXRWaWV3KCk7XG4gICAgICAgIHRoaXMuaW5pdEV2ZW50SGFuZGxlcigpO1xuXG4gICAgICAgIHRoaXMuaW5pdEFsbEZvbGRzKCk7XG4gICAgfSxcblxuICAgIGluaXRWaWV3OiBmdW5jdGlvbiBpbml0VmlldygpIHtcbiAgICAgICAgdGhpcy5fZm9sZHMgPSB7fTtcbiAgICAgICAgdmFyIGdhbWUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xuICAgICAgICB2YXIgc2lkZXMgPSBbXCJteXNlbGZcIiwgXCJyaWdodFwiLCBcInVwXCIsIFwibGVmdFwiXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaWRlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNpZGVOYW1lID0gc2lkZXNbaV07XG4gICAgICAgICAgICB2YXIgc2lkZVJvb3QgPSBnYW1lLmdldENoaWxkQnlOYW1lKHNpZGVOYW1lKTtcbiAgICAgICAgICAgIHZhciBmb2xkcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGZvbGRSb290ID0gc2lkZVJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJmb2xkc1wiKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZm9sZFJvb3QuY2hpbGRyZW4ubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IGZvbGRSb290LmNoaWxkcmVuW2pdO1xuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG4uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICBmb2xkcy5wdXNoKHNwcml0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9mb2xkc1tzaWRlTmFtZV0gPSBmb2xkcztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGlkZUFsbEZvbGRzKCk7XG4gICAgfSxcblxuICAgIGhpZGVBbGxGb2xkczogZnVuY3Rpb24gaGlkZUFsbEZvbGRzKCkge1xuICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMuX2ZvbGRzKSB7XG4gICAgICAgICAgICB2YXIgZiA9IHRoaXMuX2ZvbGRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmKSB7XG4gICAgICAgICAgICAgICAgZltpXS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluaXRFdmVudEhhbmRsZXI6IGZ1bmN0aW9uIGluaXRFdmVudEhhbmRsZXIoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdEFsbEZvbGRzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9zeW5jJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdEFsbEZvbGRzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9jaHVwYWlfbm90aWZ5JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdEZvbGRzKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdndW9fbm90aWZ5JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdEZvbGRzKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGluaXRBbGxGb2xkczogZnVuY3Rpb24gaW5pdEFsbEZvbGRzKCkge1xuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xuICAgICAgICBmb3IgKHZhciBpIGluIHNlYXRzKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRGb2xkcyhzZWF0c1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdEZvbGRzOiBmdW5jdGlvbiBpbml0Rm9sZHMoc2VhdERhdGEpIHtcbiAgICAgICAgdmFyIGZvbGRzID0gc2VhdERhdGEuZm9sZHM7XG4gICAgICAgIGlmIChmb2xkcyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoc2VhdERhdGEuc2VhdGluZGV4KTtcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XG5cbiAgICAgICAgdmFyIGZvbGRzU3ByaXRlcyA9IHRoaXMuX2ZvbGRzW3NpZGVdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvbGRzU3ByaXRlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gaTtcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwicmlnaHRcIiB8fCBzaWRlID09IFwidXBcIikge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gZm9sZHNTcHJpdGVzLmxlbmd0aCAtIGkgLSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IGZvbGRzU3ByaXRlc1tpbmRleF07XG4gICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zZXRTcHJpdGVGcmFtZUJ5TUpJRChwcmUsIHNwcml0ZSwgZm9sZHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSBmb2xkcy5sZW5ndGg7IGkgPCBmb2xkc1Nwcml0ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGk7XG4gICAgICAgICAgICBpZiAoc2lkZSA9PSBcInJpZ2h0XCIgfHwgc2lkZSA9PSBcInVwXCIpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGZvbGRzU3ByaXRlcy5sZW5ndGggLSBpIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBmb2xkc1Nwcml0ZXNbaW5kZXhdO1xuXG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0U3ByaXRlRnJhbWVCeU1KSUQ6IGZ1bmN0aW9uIHNldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgc3ByaXRlLCBtamlkKSB7XG4gICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBtamlkKTtcbiAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB9XG5cbn0pO1xuLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbi8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbi8vIH0sXG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc5NTQ1NjU5VEFSS1pMTW9IR3FYb1kyTicsICdHYW1lTmV0TWdyJyk7XG4vLyBzY3JpcHRzL0dhbWVOZXRNZ3IuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGRhdGFFdmVudEhhbmRsZXI6IG51bGwsXG4gICAgICAgIHJvb21JZDogbnVsbCxcbiAgICAgICAgbWF4TnVtT2ZHYW1lczogLTEsXG4gICAgICAgIG51bU9mR2FtZXM6IC0xLFxuICAgICAgICBudW1PZk1KOiAwLFxuICAgICAgICBzZWF0SW5kZXg6IC0xLFxuICAgICAgICBzZWF0czogbnVsbCxcbiAgICAgICAgdHVybjogLTEsXG4gICAgICAgIGJ1dHRvbjogLTEsXG4gICAgICAgIGRpbmdxdWU6IC0xLFxuICAgICAgICBjaHVwYWk6IC0xLFxuICAgICAgICBpc0RpbmdRdWVpbmc6IGZhbHNlLFxuICAgICAgICBpc0h1YW5TYW5aaGFuZzogZmFsc2UsXG4gICAgICAgIGdhbWVzdGF0ZTogXCJcIixcbiAgICAgICAgaXNPdmVyOiBmYWxzZSxcbiAgICAgICAgZGlzc292ZURhdGE6IG51bGwsXG5cbiAgICAgICAgLy/oiJ/lsbHpurvlsIbpop3lpJblsZ7mgKdcbiAgICAgICAgZmVuZ3hpYW5nOiBudWxsXG5cbiAgICB9LFxuXG4gICAgLy8gZm9vOiB7XG4gICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAvLyB9LFxuICAgIC8vIC4uLlxuICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgdGhpcy50dXJuID0gLTE7XG4gICAgICAgIHRoaXMuY2h1cGFpID0gLTEsIHRoaXMuZGluZ3F1ZSA9IC0xO1xuICAgICAgICB0aGlzLmJ1dHRvbiA9IC0xO1xuICAgICAgICB0aGlzLmdhbWVzdGF0ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZGluZ3F1ZSA9IC0xO1xuICAgICAgICB0aGlzLmlzRGluZ1F1ZWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzSHVhblNhblpoYW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY3VyYWN0aW9uID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlYXRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmhvbGRzID0gW107XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmZvbGRzID0gW107XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLnBlbmdzID0gW107XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmNoaXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0uaHVhcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5hbmdhbmdzID0gW107XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmRpYW5nYW5ncyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS53YW5nYW5ncyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5kaW5ncXVlID0gLTE7XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLnJlYWR5ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmh1ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0uaHVhbnBhaXMgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5odWFucGFpbWV0aG9kID0gLTE7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICB0aGlzLmRhdGFFdmVudEhhbmRsZXIgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5pc092ZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zZWF0cyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnJvb21JZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLm1heE51bU9mR2FtZXMgPSAwO1xuICAgICAgICAgICAgdGhpcy5udW1PZkdhbWVzID0gMDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBkaXNwYXRjaEV2ZW50OiBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50KGV2ZW50LCBkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLmRhdGFFdmVudEhhbmRsZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YUV2ZW50SGFuZGxlci5lbWl0KGV2ZW50LCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRTZWF0SW5kZXhCeUlEOiBmdW5jdGlvbiBnZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VhdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzID0gdGhpcy5zZWF0c1tpXTtcbiAgICAgICAgICAgIGlmIChzLnVzZXJpZCA9PSB1c2VySWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSxcblxuICAgIGlzT3duZXI6IGZ1bmN0aW9uIGlzT3duZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlYXRJbmRleCA9PSAwO1xuICAgIH0sXG5cbiAgICBnZXRTZWF0QnlJRDogZnVuY3Rpb24gZ2V0U2VhdEJ5SUQodXNlcklkKSB7XG4gICAgICAgIHZhciBzZWF0SW5kZXggPSB0aGlzLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcbiAgICAgICAgdmFyIHNlYXQgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIHJldHVybiBzZWF0O1xuICAgIH0sXG5cbiAgICBnZXRTZWxmRGF0YTogZnVuY3Rpb24gZ2V0U2VsZkRhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlYXRzW3RoaXMuc2VhdEluZGV4XTtcbiAgICB9LFxuXG4gICAgZ2V0TG9jYWxJbmRleDogZnVuY3Rpb24gZ2V0TG9jYWxJbmRleChpbmRleCkge1xuICAgICAgICB2YXIgcmV0ID0gKGluZGV4IC0gdGhpcy5zZWF0SW5kZXggKyA0KSAlIDQ7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIHByZXBhcmVSZXBsYXk6IGZ1bmN0aW9uIHByZXBhcmVSZXBsYXkocm9vbUluZm8sIGRldGFpbE9mR2FtZSkge1xuICAgICAgICB0aGlzLnJvb21JZCA9IHJvb21JbmZvLmlkO1xuICAgICAgICB0aGlzLnNlYXRzID0gcm9vbUluZm8uc2VhdHM7XG4gICAgICAgIHRoaXMudHVybiA9IGRldGFpbE9mR2FtZS5iYXNlX2luZm8uYnV0dG9uO1xuICAgICAgICB2YXIgYmFzZUluZm8gPSBkZXRhaWxPZkdhbWUuYmFzZV9pbmZvO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VhdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzID0gdGhpcy5zZWF0c1tpXTtcbiAgICAgICAgICAgIHMuc2VhdGluZGV4ID0gaTtcbiAgICAgICAgICAgIHMuc2NvcmUgPSBudWxsO1xuICAgICAgICAgICAgcy5ob2xkcyA9IGJhc2VJbmZvLmdhbWVfc2VhdHNbaV07XG4gICAgICAgICAgICBzLnBlbmdzID0gW107XG4gICAgICAgICAgICBzLmNoaXMgPSBbXTtcbiAgICAgICAgICAgIHMuaHVhcyA9IFtdO1xuICAgICAgICAgICAgcy5hbmdhbmdzID0gW107XG4gICAgICAgICAgICBzLmRpYW5nYW5ncyA9IFtdO1xuICAgICAgICAgICAgcy53YW5nYW5ncyA9IFtdO1xuICAgICAgICAgICAgcy5mb2xkcyA9IFtdO1xuICAgICAgICAgICAgY29uc29sZS5sb2cocyk7XG4gICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgPT0gcy51c2VyaWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXRJbmRleCA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25mID0ge1xuICAgICAgICAgICAgdHlwZTogYmFzZUluZm8udHlwZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5jb25mLnR5cGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jb25mLnR5cGUgPT0gXCJzam1tbWpcIjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRXYW5mYTogZnVuY3Rpb24gZ2V0V2FuZmEoKSB7XG4gICAgICAgIHZhciBjb25mID0gdGhpcy5jb25mO1xuICAgICAgICBpZiAoY29uZiAmJiBjb25mLm1heEdhbWVzICE9IG51bGwgJiYgY29uZi5tYXhGYW4gIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHN0ckFyciA9IFtdO1xuICAgICAgICAgICAgLy8gc3RyQXJyLnB1c2goY29uZi5tYXhHYW1lcyArIFwi5bGAXCIpO1xuICAgICAgICAgICAgLy8gc3RyQXJyLnB1c2goY29uZi5tYXhGYW4gKyBcIueVquWwgemhtlwiKTtcbiAgICAgICAgICAgIGlmIChjb25mLnR5cGUgPT0gXCJzam1talwiKSB7XG4gICAgICAgICAgICAgICAgY29uZi5rb3VmZWkgPT0gMCA/IHN0ckFyci5wdXNoKFwi5oi/5Li75Ye66LWEXCIpIDogc3RyQXJyLnB1c2goXCLnjqnlrrblubPliIZcIik7XG4gICAgICAgICAgICAgICAgY29uZi5ob25nemhvbmdkYW5naHVhID8gc3RyQXJyLnB1c2goXCLnuqLkuK3lvZPoirFcIikgOiB7fTtcbiAgICAgICAgICAgICAgICBjb25mLnF1YW5zaHUgPT0gMCA/IHN0ckFyci5wdXNoKFwiOOWxgFwiKSA6IHN0ckFyci5wdXNoKFwi5LiA5ZyIXCIpO1xuICAgICAgICAgICAgICAgIGlmIChjb25mLmppZXN1YW4gPT0gMCkgc3RyQXJyLnB1c2goXCLlubrljYpcIik7ZWxzZSBpZiAoY29uZi5qaWVzdWFuID09IDEpIHN0ckFyci5wdXNoKFwi5LiA5LqMXCIpO2Vsc2UgaWYgKGNvbmYuamllc3VhbiA9PSAyKSBzdHJBcnIucHVzaChcIuS6jOWbm1wiKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZi50eXBlID09IFwiZGhtalwiKSB7XG4gICAgICAgICAgICAgICAgY29uZi5rb3VmZWkgPT0gMCA/IHN0ckFyci5wdXNoKFwi5oi/5Li75Ye66LWEXCIpIDogc3RyQXJyLnB1c2goXCLnjqnlrrblubPliIZcIik7XG4gICAgICAgICAgICAgICAgY29uZi5xdWFuc2h1ID09IDAgPyBzdHJBcnIucHVzaChcIjjlsYBcIikgOiBzdHJBcnIucHVzaChcIuS4gOWciFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoY29uZi5qaWVzdWFuID09IDApIHN0ckFyci5wdXNoKFwiMTBcIik7ZWxzZSBpZiAoY29uZi5qaWVzdWFuID09IDEpIHN0ckFyci5wdXNoKFwiMjVcIik7ZWxzZSBpZiAoY29uZi5qaWVzdWFuID09IDIpIHN0ckFyci5wdXNoKFwiNTBcIik7ZWxzZSBpZiAoY29uZi5qaWVzdWFuID09IDMpIHN0ckFyci5wdXNoKFwiMTIwXCIpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25mLnR5cGUgPT0gXCJ0ZGhcIikge1xuICAgICAgICAgICAgICAgIGNvbmYua291ZmVpID09IDAgPyBzdHJBcnIucHVzaChcIuaIv+S4u+WHuui1hFwiKSA6IHN0ckFyci5wdXNoKFwi546p5a625bmz5YiGXCIpO1xuICAgICAgICAgICAgICAgIGNvbmYucXVhbnNodSA9PSAwID8gc3RyQXJyLnB1c2goXCI45bGAXCIpIDogc3RyQXJyLnB1c2goXCLkuIDlnIhcIik7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmYuamllc3VhbiA9PSAwKSBzdHJBcnIucHVzaChcIuacieiKsVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmKGNvbmYuemltbyA9PSAxKXtcbiAgICAgICAgICAgIC8vICAgICBzdHJBcnIucHVzaChcIuiHquaRuOWKoOeVqlwiKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGVsc2V7XG4gICAgICAgICAgICAvLyAgICAgc3RyQXJyLnB1c2goXCLoh6rmkbjliqDlupVcIik7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBpZihjb25mLmppYW5nZHVpKXtcbiAgICAgICAgICAgIC8vICAgICBzdHJBcnIucHVzaChcIuWwhuWvuVwiKTsgIFxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gaWYoY29uZi5kaWFuZ2FuZ2h1YSA9PSAxKXtcbiAgICAgICAgICAgIC8vICAgICBzdHJBcnIucHVzaChcIueCueadoOiKsSjoh6rmkbgpXCIpOyAgXG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBlbHNle1xuICAgICAgICAgICAgLy8gICAgIHN0ckFyci5wdXNoKFwi54K55p2g6IqxKOaUvueCrilcIik7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBpZihjb25mLm1lbnFpbmcpe1xuICAgICAgICAgICAgLy8gICAgIHN0ckFyci5wdXNoKFwi6Zeo5riF44CB5Lit5bygXCIpOyAgXG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBpZihjb25mLnRpYW5kaWh1KXtcbiAgICAgICAgICAgIC8vICAgICBzdHJBcnIucHVzaChcIuWkqeWcsOiDoVwiKTsgIFxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgcmV0dXJuIHN0ckFyci5qb2luKFwiIFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9LFxuXG4gICAgaW5pdEhhbmRsZXJzOiBmdW5jdGlvbiBpbml0SGFuZGxlcnMoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJsb2dpbl9yZXN1bHRcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fcmVzdWx0XCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBpZiAoZGF0YS5lcnJjb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBkYXRhLnJvb21pZDtcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmYgPSBkYXRhLmNvbmY7XG4gICAgICAgICAgICAgICAgc2VsZi5tYXhOdW1PZkdhbWVzID0gZGF0YS5jb25mLm1heEdhbWVzO1xuICAgICAgICAgICAgICAgIHNlbGYubnVtT2ZHYW1lcyA9IGRhdGEubnVtb2ZnYW1lcztcbiAgICAgICAgICAgICAgICBzZWxmLmZlbmd4aWFuZyA9IGRhdGEuZmVuZ3hpYW5nO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBkYXRhLnNlYXRzO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhdEluZGV4ID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcbiAgICAgICAgICAgICAgICBzZWxmLmlzT3ZlciA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhLmVycm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibG9naW5fZmluaXNoZWRcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fZmluaXNoZWRcIik7XG5cbiAgICAgICAgICAgIHZhciBsb2FkZ2FtZSA9IGZ1bmN0aW9uIGxvYWRnYW1lKCkge1xuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm1qZ2FtZVwiKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZmFkZW91dCA9IGNjLmZhZGVPdXQoMC4xKTtcbiAgICAgICAgICAgIHZhciBmaW5pc2ggPSBjYy5jYWxsRnVuYyhsb2FkZ2FtZSwgdGhpcyk7XG4gICAgICAgICAgICB2YXIgc2VxID0gY2Muc2VxdWVuY2UoZmFkZW91dCwgZmluaXNoKTtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmdldFNjZW5lKCkuZ2V0Q2hpbGRCeU5hbWUoJ0NhbnZhcycpLnJ1bkFjdGlvbihzZXEpO1xuXG4gICAgICAgICAgICAvL2NjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm1qZ2FtZVwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJleGl0X3Jlc3VsdFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xuICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XG4gICAgICAgICAgICBzZWxmLmRpbmdxdWUgPSAtMTtcbiAgICAgICAgICAgIHNlbGYuaXNEaW5nUXVlaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJleGl0X25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YTtcbiAgICAgICAgICAgIHZhciBzID0gc2VsZi5nZXRTZWF0QnlJRCh1c2VySWQpO1xuICAgICAgICAgICAgaWYgKHMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHMudXNlcmlkID0gMDtcbiAgICAgICAgICAgICAgICBzLm5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInVzZXJfc3RhdGVfY2hhbmdlZFwiLCBzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNwcmVzc19wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XG4gICAgICAgICAgICBzZWxmLnR1cm4gPSAtMTtcbiAgICAgICAgICAgIHNlbGYuZGluZ3F1ZSA9IC0xO1xuICAgICAgICAgICAgc2VsZi5pc0RpbmdRdWVpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImRpc2Nvbm5lY3RcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnJvb21JZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNPdmVyID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iub2xkUm9vbUlkID0gc2VsZi5yb29tSWQ7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRpc2Nvbm5lY3RcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJuZXdfdXNlcl9jb21lc19wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgdmFyIHNlYXRJbmRleCA9IGRhdGEuc2VhdGluZGV4O1xuICAgICAgICAgICAgaWYgKHNlbGYuc2VhdHNbc2VhdEluZGV4XS51c2VyaWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0c1tzZWF0SW5kZXhdLm9ubGluZSA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEub25saW5lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzW3NlYXRJbmRleF0gPSBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCduZXdfdXNlcicsIHNlbGYuc2VhdHNbc2VhdEluZGV4XSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwidXNlcl9zdGF0ZV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLmdldFNlYXRCeUlEKHVzZXJJZCk7XG4gICAgICAgICAgICBzZWF0Lm9ubGluZSA9IGRhdGEub25saW5lO1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCd1c2VyX3N0YXRlX2NoYW5nZWQnLCBzZWF0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJ1c2VyX3JlYWR5X3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuZ2V0U2VhdEJ5SUQodXNlcklkKTtcbiAgICAgICAgICAgIHNlYXQucmVhZHkgPSBkYXRhLnJlYWR5O1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCd1c2VyX3N0YXRlX2NoYW5nZWQnLCBzZWF0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2hvbGRzX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5zZWF0c1tzZWxmLnNlYXRJbmRleF07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHNlYXQuaG9sZHMgPSBkYXRhO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuc2VhdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHNlbGYuc2VhdHNbaV07XG4gICAgICAgICAgICAgICAgaWYgKHMuZm9sZHMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzLmZvbGRzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzLnBlbmdzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcy5wZW5ncyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocy5hbmdhbmdzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgcy5hbmdhbmdzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzLmRpYW5nYW5ncyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHMuZGlhbmdhbmdzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzLmNoaXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzLmNoaXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHMuaHVhcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHMuaHVhcyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocy53YW5nYW5ncyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHMud2FuZ2FuZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcy5yZWFkeSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2hvbGRzJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9mZW5nX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuZmVuZ3hpYW5nID0gZGF0YTtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9mZW5nJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9iZWdpbl9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9hY3Rpb25fcHVzaCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBzZWxmLmJ1dHRvbiA9IGRhdGE7XG4gICAgICAgICAgICBzZWxmLnR1cm4gPSBzZWxmLmJ1dHRvbjtcbiAgICAgICAgICAgIHNlbGYuZ2FtZXN0YXRlID0gXCJiZWdpblwiO1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2JlZ2luJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9wbGF5aW5nX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX3BsYXlpbmdfcHVzaCcpO1xuICAgICAgICAgICAgc2VsZi5nYW1lc3RhdGUgPSBcInBsYXlpbmdcIjtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9wbGF5aW5nJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9zeW5jX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2FtZV9zeW5jX3B1c2hcIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHNlbGYubnVtT2ZNSiA9IGRhdGEubnVtb2ZtajtcbiAgICAgICAgICAgIHNlbGYuZ2FtZXN0YXRlID0gZGF0YS5zdGF0ZTtcbiAgICAgICAgICAgIHNlbGYuZmVuZ3hpYW5nID0gZGF0YS5mZW5neGlhbmc7XG4gICAgICAgICAgICBpZiAoc2VsZi5nYW1lc3RhdGUgPT0gXCJkaW5ncXVlXCIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmlzRGluZ1F1ZWluZyA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYuZ2FtZXN0YXRlID09IFwiaHVhbnBhaVwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pc0h1YW5TYW5aaGFuZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLnR1cm4gPSBkYXRhLnR1cm47XG4gICAgICAgICAgICBzZWxmLmJ1dHRvbiA9IGRhdGEuYnV0dG9uO1xuICAgICAgICAgICAgc2VsZi5jaHVwYWkgPSBkYXRhLmNodVBhaTtcbiAgICAgICAgICAgIHNlbGYuaHVhbnBhaW1ldGhvZCA9IGRhdGEuaHVhbnBhaW1ldGhvZDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLnNlYXRzW2ldO1xuICAgICAgICAgICAgICAgIHZhciBzZCA9IGRhdGEuc2VhdHNbaV07XG4gICAgICAgICAgICAgICAgc2VhdC5ob2xkcyA9IHNkLmhvbGRzO1xuICAgICAgICAgICAgICAgIHNlYXQuZm9sZHMgPSBzZC5mb2xkcztcbiAgICAgICAgICAgICAgICBzZWF0LmFuZ2FuZ3MgPSBzZC5hbmdhbmdzO1xuICAgICAgICAgICAgICAgIHNlYXQuZGlhbmdhbmdzID0gc2QuZGlhbmdhbmdzO1xuICAgICAgICAgICAgICAgIHNlYXQud2FuZ2FuZ3MgPSBzZC53YW5nYW5ncztcbiAgICAgICAgICAgICAgICBzZWF0LnBlbmdzID0gc2QucGVuZ3M7XG4gICAgICAgICAgICAgICAgc2VhdC5jaGlzID0gc2QuY2hpcztcbiAgICAgICAgICAgICAgICBzZWF0Lmh1YXMgPSBzZC5odWFzO1xuICAgICAgICAgICAgICAgIHNlYXQuZGluZ3F1ZSA9IHNkLnF1ZTtcbiAgICAgICAgICAgICAgICBzZWF0Lmh1ZWQgPSBzZC5odWVkO1xuICAgICAgICAgICAgICAgIHNlYXQuaXN6aW1vID0gc2QuaXN6aW1vO1xuICAgICAgICAgICAgICAgIHNlYXQuaHVpbmZvID0gc2QuaHVpbmZvO1xuICAgICAgICAgICAgICAgIHNlYXQuaHVhbnBhaXMgPSBzZC5odWFucGFpcztcbiAgICAgICAgICAgICAgICBpZiAoaSA9PSBzZWxmLnNlYXRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmRpbmdxdWUgPSBzZC5xdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfaHVhbnBhaV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmlzSHVhblNhblpoYW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9odWFucGFpJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiaGFuZ2FuZ19ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdoYW5nYW5nX25vdGlmeScsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfYWN0aW9uX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuY3VyYWN0aW9uID0gZGF0YTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2FjdGlvbicsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfY2h1cGFpX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX2NodXBhaV9wdXNoJyk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgdmFyIHR1cm5Vc2VySUQgPSBkYXRhO1xuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHR1cm5Vc2VySUQpO1xuICAgICAgICAgICAgc2VsZi5kb1R1cm5DaGFuZ2Uoc2kpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbnVtX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYubnVtT2ZHYW1lcyA9IGRhdGE7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfbnVtJywgZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9vdmVyX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX292ZXJfcHVzaCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IGRhdGEucmVzdWx0cztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5zZWF0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbaV0uc2NvcmUgPSByZXN1bHRzLmxlbmd0aCA9PSAwID8gMCA6IHJlc3VsdHNbaV0udG90YWxzY29yZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9vdmVyJywgcmVzdWx0cyk7XG4gICAgICAgICAgICBpZiAoZGF0YS5lbmRpbmZvKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pc092ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9lbmQnLCBkYXRhLmVuZGluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5yZXNldCgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnNlYXRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCd1c2VyX3N0YXRlX2NoYW5nZWQnLCBzZWxmLnNlYXRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJtal9jb3VudF9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbWpfY291bnRfcHVzaCcpO1xuICAgICAgICAgICAgc2VsZi5udW1PZk1KID0gZGF0YTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ21qX2NvdW50JywgZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiaHVfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2h1X3B1c2gnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgc2VsZi5kb0h1KGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfY2h1cGFpX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VySWQ7XG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XG4gICAgICAgICAgICB2YXIgc2kgPSBzZWxmLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcbiAgICAgICAgICAgIHNlbGYuZG9DaHVwYWkoc2ksIHBhaSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9tb3BhaV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9tb3BhaV9wdXNoJyk7XG4gICAgICAgICAgICBzZWxmLmRvTW9wYWkoc2VsZi5zZWF0SW5kZXgsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImd1b19ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2d1b19ub3RpZnlfcHVzaCcpO1xuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcklkO1xuICAgICAgICAgICAgdmFyIHBhaSA9IGRhdGEucGFpO1xuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCk7XG4gICAgICAgICAgICBzZWxmLmRvR3VvKHNpLCBwYWkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImd1b19yZXN1bHRcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdndW9fcmVzdWx0Jyk7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2d1b19yZXN1bHQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJndW9odV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ3VvaHVfcHVzaCcpO1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwicHVzaF9ub3RpY2VcIiwgeyBpbmZvOiBcIui/h+iDoVwiLCB0aW1lOiAxLjUgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiaHVhbnBhaV9ub3RpZnlcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5nZXRTZWF0QnlJRChkYXRhLnNpKTtcbiAgICAgICAgICAgIHNlYXQuaHVhbnBhaXMgPSBkYXRhLmh1YW5wYWlzO1xuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdodWFucGFpX25vdGlmeScsIHNlYXQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfaHVhbnBhaV9vdmVyX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX2h1YW5wYWlfb3Zlcl9wdXNoJyk7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IFwiXCI7XG4gICAgICAgICAgICB2YXIgbWV0aG9kID0gZGF0YS5tZXRob2Q7XG4gICAgICAgICAgICBpZiAobWV0aG9kID09IDApIHtcbiAgICAgICAgICAgICAgICBpbmZvID0gXCLmjaLlr7nlrrbniYxcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09IDEpIHtcbiAgICAgICAgICAgICAgICBpbmZvID0gXCLmjaLkuIvlrrbniYxcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mbyA9IFwi5o2i5LiK5a6254mMXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmh1YW5wYWltZXRob2QgPSBtZXRob2Q7XG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmlzSHVhblNhblpoYW5nID0gZmFsc2U7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX2h1YW5wYWlfb3ZlclwiKTtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInB1c2hfbm90aWNlXCIsIHsgaW5mbzogaW5mbywgdGltZTogMiB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJwZW5nX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGVuZ19ub3RpZnlfcHVzaCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XG4gICAgICAgICAgICB2YXIgc2kgPSBzZWxmLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcbiAgICAgICAgICAgIHNlbGYuZG9QZW5nKHNpLCBkYXRhLnBhaSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FuZ19ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbmdfbm90aWZ5X3B1c2gnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xuICAgICAgICAgICAgdmFyIHBhaSA9IGRhdGEucGFpO1xuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCk7XG4gICAgICAgICAgICBzZWxmLmRvR2FuZyhzaSwgcGFpLCBkYXRhLmdhbmd0eXBlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjaGlfbm90aWZ5X3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGlfbm90aWZ5X3B1c2gnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xuICAgICAgICAgICAgdmFyIHBhaSA9IGRhdGEucGFpO1xuICAgICAgICAgICAgdmFyIGNoaWdyb3VwID0gZGF0YS5jaGlncm91cDtcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xuICAgICAgICAgICAgc2VsZi5kb0NoaShzaSwgZGF0YS5wYWksIGNoaWdyb3VwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnZXRodWFfbm90aWZ5X3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRodWFfbm90aWZ5X3B1c2gnKTtcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLnVzZXJpZDtcbiAgICAgICAgICAgIHZhciBwYWkgPSBkYXRhLnBhaTtcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xuICAgICAgICAgICAgc2VsZi5kb0h1YShzaSwgZGF0YS5wYWkpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL+W8gOWxgOihpeiKseS+puWQrCDlhajlsYBcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJidWh1YV9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2J1aHVhX25vdGlmeV9wdXNoJyk7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XG4gICAgICAgICAgICB2YXIgYnVodWFzID0gZGF0YS5idWh1YXM7XG4gICAgICAgICAgICB2YXIgc2kgPSBzZWxmLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcbiAgICAgICAgICAgIHNlbGYuZG9CdWh1YShzaSwgYnVodWFzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy/lvIDlsYDooaXoirHkvqblkKwg6Ieq5bexXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9idWh1YV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9idWh1YV9wdXNoJyk7XG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XG4gICAgICAgICAgICB2YXIgaG9sZHMgPSBkYXRhLmhvbGRzO1xuICAgICAgICAgICAgdmFyIGJ1aHVhcyA9IGRhdGEuYnVodWFzO1xuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCk7XG4gICAgICAgICAgICBzZWxmLmRvQnVodWFmb3JtZShzaSwgaG9sZHMsIGJ1aHVhcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9kaW5ncXVlX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfZGluZ3F1ZV9ub3RpZnknLCBkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2RpbmdxdWVfZmluaXNoX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbaV0uZGluZ3F1ZSA9IGRhdGFbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfZGluZ3F1ZV9maW5pc2gnLCBkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjaGF0X3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImNoYXRfcHVzaFwiLCBkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJxdWlja19jaGF0X3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInF1aWNrX2NoYXRfcHVzaFwiLCBkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJlbW9qaV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJlbW9qaV9wdXNoXCIsIGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImRpc3NvbHZlX25vdGljZV9wdXNoXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc3NvbHZlX25vdGljZV9wdXNoXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBzZWxmLmRpc3NvdmVEYXRhID0gZGF0YTtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRpc3NvbHZlX25vdGljZVwiLCBkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNzb2x2ZV9jYW5jZWxfcHVzaFwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5kaXNzb3ZlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJkaXNzb2x2ZV9jYW5jZWxcIiwgZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwidm9pY2VfbXNnX3B1c2hcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInZvaWNlX21zZ1wiLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGRvR3VvOiBmdW5jdGlvbiBkb0d1byhzZWF0SW5kZXgsIHBhaSkge1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIHZhciBmb2xkcyA9IHNlYXREYXRhLmZvbGRzO1xuICAgICAgICBmb2xkcy5wdXNoKHBhaSk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ3VvX25vdGlmeScsIHNlYXREYXRhKTtcbiAgICB9LFxuXG4gICAgZG9Nb3BhaTogZnVuY3Rpb24gZG9Nb3BhaShzZWF0SW5kZXgsIHBhaSkge1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xuICAgICAgICAgICAgc2VhdERhdGEuaG9sZHMucHVzaChwYWkpO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdnYW1lX21vcGFpJywgeyBzZWF0SW5kZXg6IHNlYXRJbmRleCwgcGFpOiBwYWkgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZG9DaHVwYWk6IGZ1bmN0aW9uIGRvQ2h1cGFpKHNlYXRJbmRleCwgcGFpKSB7XG4gICAgICAgIHRoaXMuY2h1cGFpID0gcGFpO1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xuICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YocGFpKTtcbiAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2FtZV9jaHVwYWlfbm90aWZ5JywgeyBzZWF0RGF0YTogc2VhdERhdGEsIHBhaTogcGFpIH0pO1xuICAgIH0sXG5cbiAgICBkb1Blbmc6IGZ1bmN0aW9uIGRvUGVuZyhzZWF0SW5kZXgsIHBhaSkge1xuICAgICAgICBjb25zb2xlLmxvZyhzZWF0SW5kZXgpO1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc2VhdHNbc2VhdEluZGV4XSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc2VhdHNbMF0pO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnNlYXRzW1wiMFwiXSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlYXREYXRhKTtcbiAgICAgICAgY29uc29sZS5sb2coc2VhdERhdGEuaHVhcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlYXREYXRhLnVzZXJpZCk7XG4gICAgICAgIC8v56e76Zmk5omL54mMXG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gc2VhdERhdGEuaG9sZHMuaW5kZXhPZihwYWkpO1xuICAgICAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy/mm7TmlrDnorDniYzmlbDmja5cbiAgICAgICAgdmFyIHBlbmdzID0gc2VhdERhdGEucGVuZ3M7XG4gICAgICAgIHBlbmdzLnB1c2gocGFpKTtcblxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ3Blbmdfbm90aWZ5Jywgc2VhdERhdGEpO1xuICAgIH0sXG5cbiAgICBkb0NoaTogZnVuY3Rpb24gZG9DaGkoc2VhdEluZGV4LCBwYWksIGNoaWdyb3VwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZG9jaGlcIik7XG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHRoaXMuc2VhdHNbc2VhdEluZGV4XTtcbiAgICAgICAgY29uc29sZS5sb2coc2VhdERhdGEpO1xuICAgICAgICAvL+enu+mZpOaJi+eJjFxuICAgICAgICBpZiAoc2VhdERhdGEuaG9sZHMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhaSA9PSBjaGlncm91cFtpXSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YoY2hpZ3JvdXBbaV0pO1xuICAgICAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy/mm7TmlrDlkIPniYzmlbDmja5cbiAgICAgICAgdmFyIGNoaXMgPSBzZWF0RGF0YS5jaGlzO1xuICAgICAgICBjaGlzLnB1c2goY2hpZ3JvdXApO1xuXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnY2hpX25vdGlmeScsIHNlYXREYXRhKTtcbiAgICB9LFxuXG4gICAgZG9IdWE6IGZ1bmN0aW9uIGRvSHVhKHNlYXRJbmRleCwgcGFpKSB7XG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHRoaXMuc2VhdHNbc2VhdEluZGV4XTtcbiAgICAgICAgLy/mm7TmlrDoirHniYzmlbDmja5cbiAgICAgICAgaWYgKHNlYXREYXRhLmh1YXMgPT0gdW5kZWZpbmVkIHx8IHNlYXREYXRhLmh1YXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgc2VhdERhdGEuaHVhcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBodWFzID0gc2VhdERhdGEuaHVhcztcbiAgICAgICAgaHVhcy5wdXNoKHBhaSk7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2V0aHVhX25vdGlmeScsIHNlYXREYXRhKTtcbiAgICB9LFxuXG4gICAgZG9CdWh1YTogZnVuY3Rpb24gZG9CdWh1YShzZWF0SW5kZXgsIGJ1aHVhcykge1xuICAgICAgICBjb25zb2xlLmxvZyhcImRhIGJ1aHVhXCIpO1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIC8v5pu05paw6Iqx54mM5pWw5o2uXG4gICAgICAgIGlmIChzZWF0RGF0YS5odWFzID09IHVuZGVmaW5lZCB8fCBzZWF0RGF0YS5odWFzID09IG51bGwpIHtcbiAgICAgICAgICAgIHNlYXREYXRhLmh1YXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaHVhcyA9IHNlYXREYXRhLmh1YXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVodWFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBodWFzLnB1c2goYnVodWFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2dldGh1YV9ub3RpZnknLCBzZWF0RGF0YSk7XG4gICAgfSxcblxuICAgIGRvQnVodWFmb3JtZTogZnVuY3Rpb24gZG9CdWh1YWZvcm1lKHNlYXRJbmRleCwgaG9sZHMsIGJ1aHVhcykge1xuICAgICAgICBjb25zb2xlLmxvZyhcImRhIGJ1aHVhXCIpO1xuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XG4gICAgICAgIC8vIGZvcih2YXIgaT0wIDsgaSA8IGhvbGRzLmxlbmd0aCA7IGkrKykge1xuICAgICAgICAvLyAgICAgc2VhdERhdGEuaG9sZHMucHVzaChob2xkc1tpXSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gZm9yKHZhciBpPTAgOyBpIDwgYnVodWFzLmxlbmd0aCA7IGkrKykge1xuICAgICAgICAvLyAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YoYnVodWFzW2ldKTtcbiAgICAgICAgLy8gICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsMSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgc2VhdERhdGEuaG9sZHMgPSBob2xkcztcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdidWh1YV9ub3RpZnknLCBzZWF0RGF0YSk7XG4gICAgfSxcblxuICAgIGdldEdhbmdUeXBlOiBmdW5jdGlvbiBnZXRHYW5nVHlwZShzZWF0RGF0YSwgcGFpKSB7XG4gICAgICAgIGlmIChzZWF0RGF0YS5wZW5ncy5pbmRleE9mKHBhaSkgIT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiBcIndhbmdhbmdcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjbnQgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0RGF0YS5ob2xkcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIGlmIChzZWF0RGF0YS5ob2xkc1tpXSA9PSBwYWkpIHtcbiAgICAgICAgICAgICAgICAgICAgY250Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNudCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGlhbmdhbmdcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYW5nYW5nXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZG9HYW5nOiBmdW5jdGlvbiBkb0dhbmcoc2VhdEluZGV4LCBwYWksIGdhbmd0eXBlKSB7XG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHRoaXMuc2VhdHNbc2VhdEluZGV4XTtcblxuICAgICAgICBpZiAoIWdhbmd0eXBlKSB7XG4gICAgICAgICAgICBnYW5ndHlwZSA9IHRoaXMuZ2V0R2FuZ1R5cGUoc2VhdERhdGEsIHBhaSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2FuZ3R5cGUgPT0gXCJ3YW5nYW5nXCIpIHtcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5wZW5ncy5pbmRleE9mKHBhaSkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gc2VhdERhdGEucGVuZ3MuaW5kZXhPZihwYWkpO1xuICAgICAgICAgICAgICAgIGlmIChpZHggIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhdERhdGEucGVuZ3Muc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VhdERhdGEud2FuZ2FuZ3MucHVzaChwYWkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gNDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YocGFpKTtcbiAgICAgICAgICAgICAgICBpZiAoaWR4ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5rKh5pyJ5om+5Yiw77yM6KGo56S656e75a6M5LqG77yM55u05o6l6Lez5Ye65b6q546vXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWF0RGF0YS5ob2xkcy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2FuZ3R5cGUgPT0gXCJhbmdhbmdcIikge1xuICAgICAgICAgICAgc2VhdERhdGEuYW5nYW5ncy5wdXNoKHBhaSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZ2FuZ3R5cGUgPT0gXCJkaWFuZ2FuZ1wiKSB7XG4gICAgICAgICAgICBzZWF0RGF0YS5kaWFuZ2FuZ3MucHVzaChwYWkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2FuZ19ub3RpZnknLCB7IHNlYXREYXRhOiBzZWF0RGF0YSwgZ2FuZ3R5cGU6IGdhbmd0eXBlIH0pO1xuICAgIH0sXG5cbiAgICBkb0h1OiBmdW5jdGlvbiBkb0h1KGRhdGEpIHtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdodXBhaScsIGRhdGEpO1xuICAgIH0sXG5cbiAgICBkb1R1cm5DaGFuZ2U6IGZ1bmN0aW9uIGRvVHVybkNoYW5nZShzaSkge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGxhc3Q6IHRoaXMudHVybixcbiAgICAgICAgICAgIHR1cm46IHNpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudHVybiA9IHNpO1xuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2dhbWVfY2h1cGFpJywgZGF0YSk7XG4gICAgfSxcblxuICAgIGNvbm5lY3RHYW1lU2VydmVyOiBmdW5jdGlvbiBjb25uZWN0R2FtZVNlcnZlcihkYXRhKSB7XG4gICAgICAgIHRoaXMuZGlzc292ZURhdGEgPSBudWxsO1xuICAgICAgICBjYy52di5uZXQuaXAgPSBkYXRhLmlwICsgXCI6XCIgKyBkYXRhLnBvcnQ7XG4gICAgICAgIGNvbnNvbGUubG9nKGNjLnZ2Lm5ldC5pcCk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICB2YXIgb25Db25uZWN0T0sgPSBmdW5jdGlvbiBvbkNvbm5lY3RPSygpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib25Db25uZWN0T0tcIik7XG4gICAgICAgICAgICB2YXIgc2QgPSB7XG4gICAgICAgICAgICAgICAgdG9rZW46IGRhdGEudG9rZW4sXG4gICAgICAgICAgICAgICAgcm9vbWlkOiBkYXRhLnJvb21pZCxcbiAgICAgICAgICAgICAgICB0aW1lOiBkYXRhLnRpbWUsXG4gICAgICAgICAgICAgICAgc2lnbjogZGF0YS5zaWduXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJsb2dpblwiLCBzZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG9uQ29ubmVjdEZhaWxlZCA9IGZ1bmN0aW9uIG9uQ29ubmVjdEZhaWxlZCgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmFpbGVkLlwiKTtcbiAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOi/m+WFpeaIv+mXtFwiKTtcbiAgICAgICAgY2MudnYubmV0LmNvbm5lY3Qob25Db25uZWN0T0ssIG9uQ29ubmVjdEZhaWxlZCk7XG4gICAgfVxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnZmFjZmRsam54NUYrckZEQXE1UWJtcWEnLCAnR2FtZU92ZXInKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9HYW1lT3Zlci5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9nYW1lb3ZlcjogbnVsbCxcbiAgICAgICAgX2dhbWVyZXN1bHQ6IG51bGwsXG4gICAgICAgIF9zZWF0czogW10sXG4gICAgICAgIF9pc0dhbWVFbmQ6IGZhbHNlLFxuICAgICAgICBfcGluZ2p1OiBudWxsLFxuICAgICAgICBfd2luOiBudWxsLFxuICAgICAgICBfbG9zZTogbnVsbFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvL1RPRE865Y+v6IO95Ye6546w5LiN5ZCM55qE6K6h5YiG5p2/XG4gICAgICAgIHRoaXMuX2dhbWVvdmVyID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZV9vdmVyX1wiICsgY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUpO1xuXG4gICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgNDsgbisrKSB7XG4gICAgICAgICAgICB2YXIgaHVhX25vZGUgPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdF9saXN0XCIpLmdldENoaWxkQnlOYW1lKFwic1wiICsgKG4gKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJodWFzXCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgbSA9IDA7IG0gPCBodWFfbm9kZS5jaGlsZHJlbkNvdW50OyBtKyspIHtcbiAgICAgICAgICAgICAgICBodWFfbm9kZS5jaGlsZHJlblttXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2dhbWVvdmVyLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3BpbmdqdSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicGluZ2p1XCIpO1xuICAgICAgICB0aGlzLl93aW4gPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcIndpblwiKTtcbiAgICAgICAgdGhpcy5fbG9zZSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwibG9zZVwiKTtcblxuICAgICAgICB0aGlzLl9nYW1lcmVzdWx0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZV9yZXN1bHRcIik7XG5cbiAgICAgICAgdmFyIHdhbmZhID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJ3YW5mYVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICB3YW5mYS5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLmdldFdhbmZhKCk7XG5cbiAgICAgICAgdmFyIGxpc3RSb290ID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJyZXN1bHRfbGlzdFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gNDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgcyA9IFwic1wiICsgaTtcbiAgICAgICAgICAgIHZhciBzbiA9IGxpc3RSb290LmdldENoaWxkQnlOYW1lKHMpO1xuICAgICAgICAgICAgLy/mlbTnkIbmiYDmnInpnIDopoHmmL7npLrlnKjorqHliIbmnb/kuIrnmoTkv6Hmga/nmoToioLngrlcbiAgICAgICAgICAgIHZhciB2aWV3ZGF0YSA9IHt9O1xuICAgICAgICAgICAgdmlld2RhdGEudXNlcm5hbWUgPSBzbi5nZXRDaGlsZEJ5TmFtZSgndXNlcm5hbWUnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgdmlld2RhdGEucmVhc29uID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ3JlYXNvbicpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICB2aWV3ZGF0YS50YWlzaSA9IHNuLmdldENoaWxkQnlOYW1lKCd0YWlzaScpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG5cbiAgICAgICAgICAgIHZhciBmID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ2ZhbicpO1xuICAgICAgICAgICAgaWYgKGYgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZpZXdkYXRhLmZhbiA9IGYuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmlld2RhdGEuc2NvcmUgPSBzbi5nZXRDaGlsZEJ5TmFtZSgnc2NvcmUnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgdmlld2RhdGEuaHUgPSBzbi5nZXRDaGlsZEJ5TmFtZSgnaHUnKTtcbiAgICAgICAgICAgIHZpZXdkYXRhLm1haGpvbmdzID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ3BhaScpO1xuICAgICAgICAgICAgdmlld2RhdGEuemh1YW5nID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ3podWFuZycpO1xuICAgICAgICAgICAgdmlld2RhdGEuaHVwYWkgPSBzbi5nZXRDaGlsZEJ5TmFtZSgnaHVwYWknKTtcbiAgICAgICAgICAgIHZpZXdkYXRhLl9wZW5nYW5kZ2FuZyA9IFtdO1xuXG4gICAgICAgICAgICB0aGlzLl9zZWF0cy5wdXNoKHZpZXdkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5Yid5aeL5YyW572R57uc5LqL5Lu255uR5ZCs5ZmoXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX292ZXInLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5vbkdhbWVPdmVyKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2VuZCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLl9pc0dhbWVFbmQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgb25HYW1lT3ZlcjogZnVuY3Rpb24gb25HYW1lT3ZlcihkYXRhKSB7XG4gICAgICAgIC8vVE9ETzrlpJrnp43liKTlrppcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlID09IFwic2ptbWpcIikge1xuICAgICAgICAgICAgdGhpcy5vbkdhbWVPdmVyX1NKTU1KKGRhdGEpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlID09IFwiZGhtalwiKSB7XG4gICAgICAgICAgICB0aGlzLm9uR2FtZU92ZXJfREhNSihkYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmIChjYy52di5nYW1lTmV0TWdyLmNvbmYudHlwZSA9PSBcInRkaFwiKSB7XG4gICAgICAgICAgICB0aGlzLm9uR2FtZU92ZXJfVERIKGRhdGEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uR2FtZU92ZXJfU0pNTUo6IGZ1bmN0aW9uIG9uR2FtZU92ZXJfU0pNTUooZGF0YSkge1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2dhbWVyZXN1bHQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9nYW1lb3Zlci5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9waW5nanUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3dpbi5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fbG9zZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB2YXIgbXlzY29yZSA9IGRhdGFbY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXhdLnNjb3JlO1xuICAgICAgICBpZiAobXlzY29yZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3dpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKG15c2NvcmUgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9sb3NlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9waW5nanUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5pi+56S6546p5a625L+h5oGvXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgc2VhdFZpZXcgPSB0aGlzLl9zZWF0c1tpXTtcbiAgICAgICAgICAgIHZhciB1c2VyRGF0YSA9IGRhdGFbaV07XG4gICAgICAgICAgICB2YXIgaHVlZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy/og6HniYznmoTnjqnlrrbmiY3mmL7npLog5piv5ZCm5riF5LiA6ImyIOaguXhu55qE5a2X5qC3XG4gICAgICAgICAgICB2YXIgbnVtT2ZHYW5ncyA9IHVzZXJEYXRhLmFuZ2FuZ3MubGVuZ3RoICsgdXNlckRhdGEud2FuZ2FuZ3MubGVuZ3RoICsgdXNlckRhdGEuZGlhbmdhbmdzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBudW1PZkdlbiA9IHVzZXJEYXRhLm51bW9mZ2VuO1xuICAgICAgICAgICAgdmFyIGFjdGlvbkFyciA9IFtdO1xuICAgICAgICAgICAgdmFyIGlzN3BhaXJzID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgaXNjaGFkYWppYW8gPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdXNlckRhdGEuYWN0aW9ucy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgIHZhciBhYyA9IHVzZXJEYXRhLmFjdGlvbnNbal07XG4gICAgICAgICAgICAgICAgaWYgKGFjLnR5cGUgPT0gXCJ6aW1vXCIgfHwgYWMudHlwZSA9PSBcImdhbmdodWFcIiB8fCBhYy50eXBlID09IFwiZGlhbmdhbmdodWFcIiB8fCBhYy50eXBlID09IFwiaHVcIiB8fCBhYy50eXBlID09IFwiZ2FuZ3Bhb2h1XCIgfHwgYWMudHlwZSA9PSBcInFpYW5nZ2FuZ2h1XCIgfHwgYWMudHlwZSA9PSBcImNoYWRhamlhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwiN3BhaXJzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5LiD5a+5XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJsN3BhaXJzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6b6Z5LiD5a+5XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJqN3BhaXJzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5bCG5LiD5a+5XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJkdWlkdWlcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLnorDnorDog6FcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodXNlckRhdGEucGF0dGVybiA9PSBcImppYW5nZHVpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5bCG5a+5XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjLnR5cGUgPT0gXCJ6aW1vXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6Ieq5pG4XCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJnYW5naHVhXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5p2g5LiK6IqxXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJkaWFuZ2FuZ2h1YVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIueCueadoOiKsVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZ2FuZ3Bhb2h1XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5p2g54Ku6IOhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJxaWFuZ2dhbmdodVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaKouadoOiDoVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiY2hhZGFqaWFvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzY2hhZGFqaWFvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBodWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJmYW5ncGFvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmlL7ngq5cIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiYW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmmpfmnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZGlhbmdhbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaYjuadoFwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJ3YW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlvK/mnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZmFuZ2dhbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaUvuadoFwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJ6aHVhbnNob3VnYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLovazmiYvmnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiYmVpcWlhbmdnYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLooqvmiqLmnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiYmVpY2hhZGFqaWFvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLooqvmn6Xlj6tcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5xaW5neWlzZSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIua4heS4gOiJslwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEubWVucWluZykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIumXqOa4hVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuemhvbmd6aGFuZykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4reW8oFwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuamluZ291aHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLph5Hpkqnog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmhhaWRpaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmtbflupXog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnRpYW5odSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWkqeiDoVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZGlodSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWcsOiDoVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobnVtT2ZHZW4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5qC5eFwiICsgbnVtT2ZHZW4pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc2NoYWRhamlhbykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuafpeWkp+WPq1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuaHVueWlzZSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIua3t+S4gOiJslwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZHVpZHVpaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlr7nlr7nog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnBhaWh1KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5o6S6IOhXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5nYW5nc2hhbmdodWEpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmnaDkuIroirFcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmthbikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWdjuaho1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuYmlhbikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIui+ueaho1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZGFuKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5Y2V5ZCKXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5kdWlkYW8pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlr7nlgJJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IDM7ICsrbykge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Lmh1LmNoaWxkcmVuW29dLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmh1b3JkZXIgPj0gMCkge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Lmh1LmNoaWxkcmVuW3VzZXJEYXRhLmh1b3JkZXJdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNlYXRWaWV3LnVzZXJuYW1lLnN0cmluZyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHNbaV0ubmFtZTtcbiAgICAgICAgICAgIHNlYXRWaWV3LnpodWFuZy5hY3RpdmUgPSBjYy52di5nYW1lTmV0TWdyLmJ1dHRvbiA9PSBpO1xuICAgICAgICAgICAgc2VhdFZpZXcucmVhc29uLnN0cmluZyA9IGFjdGlvbkFyci5qb2luKFwi44CBXCIpO1xuXG4gICAgICAgICAgICAvL+aYvuekuuS4neaVsOWPsOaVsFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLmmL7npLrlj7DlkozkuJ1cIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyRGF0YS50YWkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2codXNlckRhdGEuc2kpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc2VhdFZpZXcudGFpc2kuc3RyaW5nKTtcbiAgICAgICAgICAgIHNlYXRWaWV3LnRhaXNpLnN0cmluZyA9IHVzZXJEYXRhLnRhaSArIFwi5Y+wXCIgKyB1c2VyRGF0YS5zaSArIFwi5LidXCI7XG5cbiAgICAgICAgICAgIC8v5pi+56S66IOh5pWwXG4gICAgICAgICAgICB2YXIgZmFuID0gMDtcbiAgICAgICAgICAgIGZhbiA9IHVzZXJEYXRhLmZhbjtcbiAgICAgICAgICAgIHNlYXRWaWV3LmZhbi5zdHJpbmcgPSBmYW4gKyBcIuiDoVwiO1xuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnNjb3JlID4gMCkge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3LnNjb3JlLnN0cmluZyA9IFwiK1wiICsgdXNlckRhdGEuc2NvcmU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3LnNjb3JlLnN0cmluZyA9IHVzZXJEYXRhLnNjb3JlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaHVwYWkgPSAtMTtcbiAgICAgICAgICAgIGlmIChodWVkKSB7XG4gICAgICAgICAgICAgICAgaHVwYWkgPSB1c2VyRGF0YS5ob2xkcy5wb3AoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2MudnYubWFoam9uZ21nci5zb3J0TUoodXNlckRhdGEuaG9sZHMsIHVzZXJEYXRhLmRpbmdxdWUpO1xuXG4gICAgICAgICAgICAvL+iDoeeJjOS4jeWPguS4juaOkuW6j1xuICAgICAgICAgICAgaWYgKGh1ZWQpIHtcbiAgICAgICAgICAgICAgICB1c2VyRGF0YS5ob2xkcy5wdXNoKGh1cGFpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/pmpDol4/miYDmnInniYxcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgc2VhdFZpZXcubWFoam9uZ3MuY2hpbGRyZW5Db3VudDsgKytrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG4gPSBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbltrXTtcbiAgICAgICAgICAgICAgICBuLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGFja2luZ051bSA9ICh1c2VyRGF0YS5wZW5ncy5sZW5ndGggKyBudW1PZkdhbmdzICsgdXNlckRhdGEuY2hpcy5sZW5ndGgpICogMztcbiAgICAgICAgICAgIC8v5pi+56S655u45YWz55qE54mMXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHVzZXJEYXRhLmhvbGRzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhaSA9IHVzZXJEYXRhLmhvbGRzW2tdO1xuICAgICAgICAgICAgICAgIHZhciBuID0gc2VhdFZpZXcubWFoam9uZ3MuY2hpbGRyZW5bayArIGxhY2tpbmdOdW1dO1xuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgcGFpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBzZWF0Vmlldy5fcGVuZ2FuZGdhbmcubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICBzZWF0Vmlldy5fcGVuZ2FuZGdhbmdba10uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v5Yid5aeL5YyW5p2g54mMXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIGdhbmdzID0gdXNlckRhdGEuYW5nYW5ncztcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2FuZ3MubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwiYW5nYW5nXCIpO1xuICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBnYW5ncyA9IHVzZXJEYXRhLmRpYW5nYW5ncztcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2FuZ3MubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwiZGlhbmdhbmdcIik7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGdhbmdzID0gdXNlckRhdGEud2FuZ2FuZ3M7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGdhbmdzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBnYW5nc1trXTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3Moc2VhdFZpZXcsIGluZGV4LCBtamlkLCBcIndhbmdhbmdcIik7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/liJ3lp4vljJbnorDniYxcbiAgICAgICAgICAgIHZhciBwZW5ncyA9IHVzZXJEYXRhLnBlbmdzO1xuICAgICAgICAgICAgaWYgKHBlbmdzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwZW5ncy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWppZCA9IHBlbmdzW2tdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3Moc2VhdFZpZXcsIGluZGV4LCBtamlkLCBcInBlbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+WIneWni+WMluWQg+eJjFxuICAgICAgICAgICAgdmFyIGNoaXMgPSB1c2VyRGF0YS5jaGlzO1xuICAgICAgICAgICAgaWYgKGNoaXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNoaXMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBjaGlzW2tdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3Moc2VhdFZpZXcsIGluZGV4LCBtamlkLCBcImNoaVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v5Yid5aeL5YyW6Iqx54mMIFRPRE865ZKM5LiL6Z2i5LiA5qC35YaZ5Yid5aeL5YyW5Ye95pWwIOW5tuS4lOimgemmluWFiOmakOiXj+aJgOacieeahOiKsVxuXG4gICAgICAgICAgICB2YXIgaHVhcyA9IHVzZXJEYXRhLmh1YXM7XG4gICAgICAgICAgICB2YXIgaHVhX25vZGUgPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdF9saXN0XCIpLmdldENoaWxkQnlOYW1lKFwic1wiICsgKGkgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJodWFzXCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBodWFfbm9kZS5jaGlsZHJlbkNvdW50OyArK2spIHtcbiAgICAgICAgICAgICAgICBodWFfbm9kZS5jaGlsZHJlbltrXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChodWFzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBodWFzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtamlkID0gaHVhc1trXTtcbiAgICAgICAgICAgICAgICAgICAgaHVhX25vZGUuY2hpbGRyZW5ba10uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwID0gaHVhX25vZGUuY2hpbGRyZW5ba10uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHNwLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIG1qaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/kuJzljZfopb/ljJflsI/ml5flrZDovazmjaJcbiAgICAgICAgICAgIHZhciBzd2l0Y2hGZW5nRmxhZyA9IGZ1bmN0aW9uIHN3aXRjaEZlbmdGbGFnKGRpcmVjdGlvbiwgZGlyX3N0cikge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgNDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbi5jaGlsZHJlbltrXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uLmdldENoaWxkQnlOYW1lKGRpcl9zdHIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvL+aYvuekuuW9k+WJjemjjuWciOWSjOWxgOaVsFxuICAgICAgICAgICAgdmFyIG51bW9mZ2FtZXMgPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcIm51bW9mZ2FtZXNcIik7XG4gICAgICAgICAgICB2YXIgZmVuZ3F1YW4gPSBcIuS4nOmjjuWciFwiO1xuICAgICAgICAgICAgc3dpdGNoIChjYy52di5nYW1lTmV0TWdyLmZlbmd4aWFuZykge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgZmVuZ3F1YW4gPSBcIuS4nOmjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgZmVuZ3F1YW4gPSBcIuWNl+mjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgZmVuZ3F1YW4gPSBcIuilv+mjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgZmVuZ3F1YW4gPSBcIuWMl+mjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbnVtb2ZnYW1lcy5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGZlbmdxdWFuO1xuXG4gICAgICAgICAgICAvL+WIpOaWreS4nOWNl+ilv+WMl1xuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmJ1dHRvbikge1xuICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdF9saXN0XCIpLmdldENoaWxkQnlOYW1lKFwic1wiICsgKGkgJSA0ICsgMSkpLmdldENoaWxkQnlOYW1lKFwiZGlyZWN0aW9uXCIpO1xuICAgICAgICAgICAgICAgIHN3aXRjaEZlbmdGbGFnKGRpcmVjdGlvbiwgXCJkb25nXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoKGkgKyAxKSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcIm5hblwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdF9saXN0XCIpLmdldENoaWxkQnlOYW1lKFwic1wiICsgKChpICsgMikgJSA0ICsgMSkpLmdldENoaWxkQnlOYW1lKFwiZGlyZWN0aW9uXCIpO1xuICAgICAgICAgICAgICAgIHN3aXRjaEZlbmdGbGFnKGRpcmVjdGlvbiwgXCJ4aVwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLl9nYW1lb3Zlci5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdF9saXN0XCIpLmdldENoaWxkQnlOYW1lKFwic1wiICsgKChpICsgMykgJSA0ICsgMSkpLmdldENoaWxkQnlOYW1lKFwiZGlyZWN0aW9uXCIpO1xuICAgICAgICAgICAgICAgIHN3aXRjaEZlbmdGbGFnKGRpcmVjdGlvbiwgXCJiZWlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uR2FtZU92ZXJfREhNSjogZnVuY3Rpb24gb25HYW1lT3Zlcl9ESE1KKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9nYW1lcmVzdWx0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcGluZ2p1LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2xvc2UuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIG15c2NvcmUgPSBkYXRhW2NjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4XS5zY29yZTtcbiAgICAgICAgaWYgKG15c2NvcmUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChteXNjb3JlIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fbG9zZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcGluZ2p1LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvL+aYvuekuueOqeWutuS/oeaBr1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNlYXRWaWV3ID0gdGhpcy5fc2VhdHNbaV07XG4gICAgICAgICAgICB2YXIgdXNlckRhdGEgPSBkYXRhW2ldO1xuICAgICAgICAgICAgdmFyIGh1ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8v6IOh54mM55qE546p5a625omN5pi+56S6IOaYr+WQpua4heS4gOiJsiDmoLl4bueahOWtl+agt1xuICAgICAgICAgICAgdmFyIG51bU9mR2FuZ3MgPSB1c2VyRGF0YS5hbmdhbmdzLmxlbmd0aCArIHVzZXJEYXRhLndhbmdhbmdzLmxlbmd0aCArIHVzZXJEYXRhLmRpYW5nYW5ncy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgbnVtT2ZHZW4gPSB1c2VyRGF0YS5udW1vZmdlbjtcbiAgICAgICAgICAgIHZhciBhY3Rpb25BcnIgPSBbXTtcbiAgICAgICAgICAgIHZhciBpczdwYWlycyA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGlzY2hhZGFqaWFvID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHVzZXJEYXRhLmFjdGlvbnMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgYWMgPSB1c2VyRGF0YS5hY3Rpb25zW2pdO1xuICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiIHx8IGFjLnR5cGUgPT0gXCJnYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImRpYW5nYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImh1XCIgfHwgYWMudHlwZSA9PSBcImdhbmdwYW9odVwiIHx8IGFjLnR5cGUgPT0gXCJxaWFuZ2dhbmdodVwiIHx8IGFjLnR5cGUgPT0gXCJjaGFkYWppYW9cIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEucGF0dGVybiA9PSBcIjdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwibDdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIum+meS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwiajdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWwhuS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwiZHVpZHVpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi56Kw56Kw6IOhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJqaWFuZ2R1aVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWwhuWvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuiHquaRuFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZ2FuZ2h1YVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuadoOS4iuiKsVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZGlhbmdhbmdodWFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLngrnmnaDoirFcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImdhbmdwYW9odVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuadoOeCruiDoVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwicWlhbmdnYW5naHVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmiqLmnaDog6FcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImNoYWRhamlhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc2NoYWRhamlhbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaHVlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZmFuZ3Bhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5pS+54KuXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImFuZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5pqX5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImRpYW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmmI7mnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwid2FuZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5byv5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImZhbmdnYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmlL7mnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiemh1YW5zaG91Z2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6L2s5omL5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImJlaXFpYW5nZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6KKr5oqi5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImJlaWNoYWRhamlhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6KKr5p+l5Y+rXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcInNhbmNoaXNhbnBlbmcwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLkuInlkIPkuInnorDkuJxcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwic2FuY2hpc2FucGVuZzFcIikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4ieWQg+S4ieeisOWNl1wiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJzYW5jaGlzYW5wZW5nMlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5LiJ5ZCD5LiJ56Kw6KW/XCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcInNhbmNoaXNhbnBlbmczXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLkuInlkIPkuInnorDljJdcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5xaW5neWlzZSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIua4heS4gOiJslwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEubWVucWluZykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIumXqOa4hVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuemhvbmd6aGFuZykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4reW8oFwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuamluZ291aHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLph5Hpkqnog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmhhaWRpaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmtbflupXog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnRpYW5odSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWkqeiDoVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZGlodSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWcsOiDoVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobnVtT2ZHZW4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5qC5eFwiICsgbnVtT2ZHZW4pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc2NoYWRhamlhbykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuafpeWkp+WPq1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuaHVueWlzZSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIua3t+S4gOiJslwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZHVpZHVpaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlr7nlr7nog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnBhaWh1KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5o6S6IOhXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5nYW5nc2hhbmdodWEpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmnaDkuIroirFcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmthbikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWdjuaho1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuYmlhbikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIui+ueaho1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZGFuKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5Y2V5ZCKXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5kdWlkYW8pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlr7nlgJJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IDM7ICsrbykge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Lmh1LmNoaWxkcmVuW29dLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmh1b3JkZXIgPj0gMCkge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Lmh1LmNoaWxkcmVuW3VzZXJEYXRhLmh1b3JkZXJdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNlYXRWaWV3LnVzZXJuYW1lLnN0cmluZyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHNbaV0ubmFtZTtcbiAgICAgICAgICAgIHNlYXRWaWV3LnpodWFuZy5hY3RpdmUgPSBjYy52di5nYW1lTmV0TWdyLmJ1dHRvbiA9PSBpO1xuICAgICAgICAgICAgc2VhdFZpZXcucmVhc29uLnN0cmluZyA9IGFjdGlvbkFyci5qb2luKFwi44CBXCIpO1xuXG4gICAgICAgICAgICAvL+aYvuekuuS4neaVsOWPsOaVsFxuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnRhaSA9PSAtMSkgc2VhdFZpZXcudGFpc2kuc3RyaW5nID0gXCJcIjtlbHNlIHNlYXRWaWV3LnRhaXNpLnN0cmluZyA9IHVzZXJEYXRhLnRhaSArIFwi5Y+wXCI7XG5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuc2NvcmUuc3RyaW5nID0gXCIrXCIgKyB1c2VyRGF0YS5zY29yZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuc2NvcmUuc3RyaW5nID0gdXNlckRhdGEuc2NvcmU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodXBhaSA9IC0xO1xuICAgICAgICAgICAgaWYgKGh1ZWQpIHtcbiAgICAgICAgICAgICAgICBodXBhaSA9IHVzZXJEYXRhLmhvbGRzLnBvcCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYy52di5tYWhqb25nbWdyLnNvcnRNSih1c2VyRGF0YS5ob2xkcywgdXNlckRhdGEuZGluZ3F1ZSk7XG5cbiAgICAgICAgICAgIC8v6IOh54mM5LiN5Y+C5LiO5o6S5bqPXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhLmhvbGRzLnB1c2goaHVwYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+makOiXj+aJgOacieeJjFxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbkNvdW50OyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IHNlYXRWaWV3Lm1haGpvbmdzLmNoaWxkcmVuW2tdO1xuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYWNraW5nTnVtID0gKHVzZXJEYXRhLnBlbmdzLmxlbmd0aCArIG51bU9mR2FuZ3MgKyB1c2VyRGF0YS5jaGlzLmxlbmd0aCkgKiAzO1xuICAgICAgICAgICAgLy/mmL7npLrnm7jlhbPnmoTniYxcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdXNlckRhdGEuaG9sZHMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFpID0gdXNlckRhdGEuaG9sZHNba107XG4gICAgICAgICAgICAgICAgdmFyIG4gPSBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbltrICsgbGFja2luZ051bV07XG4gICAgICAgICAgICAgICAgbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZ1trXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/liJ3lp4vljJbmnaDniYxcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgZ2FuZ3MgPSB1c2VyRGF0YS5hbmdhbmdzO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnYW5ncy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3Nba107XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJhbmdhbmdcIik7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGdhbmdzID0gdXNlckRhdGEuZGlhbmdhbmdzO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnYW5ncy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3Nba107XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJkaWFuZ2FuZ1wiKTtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZ2FuZ3MgPSB1c2VyRGF0YS53YW5nYW5ncztcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2FuZ3MubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwid2FuZ2FuZ1wiKTtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+WIneWni+WMlueisOeJjFxuICAgICAgICAgICAgdmFyIHBlbmdzID0gdXNlckRhdGEucGVuZ3M7XG4gICAgICAgICAgICBpZiAocGVuZ3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBlbmdzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtamlkID0gcGVuZ3Nba107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwicGVuZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v5Yid5aeL5YyW5ZCD54mMXG4gICAgICAgICAgICB2YXIgY2hpcyA9IHVzZXJEYXRhLmNoaXM7XG4gICAgICAgICAgICBpZiAoY2hpcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2hpcy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGNoaXNba107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwiY2hpXCIpO1xuICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/liJ3lp4vljJboirHniYwgVE9ETzrlkozkuIvpnaLkuIDmoLflhpnliJ3lp4vljJblh73mlbAg5bm25LiU6KaB6aaW5YWI6ZqQ6JeP5omA5pyJ55qE6IqxXG5cbiAgICAgICAgICAgIHZhciBodWFzID0gdXNlckRhdGEuaHVhcztcbiAgICAgICAgICAgIHZhciBodWFfbm9kZSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoaSArIDEpKS5nZXRDaGlsZEJ5TmFtZShcImh1YXNcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGh1YV9ub2RlLmNoaWxkcmVuQ291bnQ7ICsraykge1xuICAgICAgICAgICAgICAgIGh1YV9ub2RlLmNoaWxkcmVuW2tdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGh1YXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGh1YXMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBodWFzW2tdO1xuICAgICAgICAgICAgICAgICAgICBodWFfbm9kZS5jaGlsZHJlbltrXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBodWFfbm9kZS5jaGlsZHJlbltrXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgICAgICAgICAgc3Auc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgbWppZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+S4nOWNl+ilv+WMl+Wwj+aXl+WtkOi9rOaNolxuICAgICAgICAgICAgdmFyIHN3aXRjaEZlbmdGbGFnID0gZnVuY3Rpb24gc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBkaXJfc3RyKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCA0OyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uLmNoaWxkcmVuW2tdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24uZ2V0Q2hpbGRCeU5hbWUoZGlyX3N0cikuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8v5pi+56S65b2T5YmN6aOO5ZyI5ZKM5bGA5pWwXG4gICAgICAgICAgICB2YXIgbnVtb2ZnYW1lcyA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwibnVtb2ZnYW1lc1wiKTtcbiAgICAgICAgICAgIHZhciBmZW5ncXVhbiA9IFwi5Lic6aOO5ZyIXCI7XG4gICAgICAgICAgICBzd2l0Y2ggKGNjLnZ2LmdhbWVOZXRNZ3IuZmVuZ3hpYW5nKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5Lic6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5Y2X6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi6KW/6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5YyX6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBudW1vZmdhbWVzLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZmVuZ3F1YW47XG5cbiAgICAgICAgICAgIC8v5Yik5pat5Lic5Y2X6KW/5YyXXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuYnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoaSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcImRvbmdcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJyZXN1bHRfbGlzdFwiKS5nZXRDaGlsZEJ5TmFtZShcInNcIiArICgoaSArIDEpICUgNCArIDEpKS5nZXRDaGlsZEJ5TmFtZShcImRpcmVjdGlvblwiKTtcbiAgICAgICAgICAgICAgICBzd2l0Y2hGZW5nRmxhZyhkaXJlY3Rpb24sIFwibmFuXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoKGkgKyAyKSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcInhpXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoKGkgKyAzKSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcImJlaVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25HYW1lT3Zlcl9UREg6IGZ1bmN0aW9uIG9uR2FtZU92ZXJfVERIKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9nYW1lcmVzdWx0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcGluZ2p1LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2xvc2UuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIG15c2NvcmUgPSBkYXRhW2NjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4XS5zY29yZTtcbiAgICAgICAgaWYgKG15c2NvcmUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChteXNjb3JlIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fbG9zZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcGluZ2p1LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvL+aYvuekuueOqeWutuS/oeaBr1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNlYXRWaWV3ID0gdGhpcy5fc2VhdHNbaV07XG4gICAgICAgICAgICB2YXIgdXNlckRhdGEgPSBkYXRhW2ldO1xuICAgICAgICAgICAgdmFyIGh1ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8v6IOh54mM55qE546p5a625omN5pi+56S6IOaYr+WQpua4heS4gOiJsiDmoLl4bueahOWtl+agt1xuICAgICAgICAgICAgdmFyIG51bU9mR2FuZ3MgPSB1c2VyRGF0YS5hbmdhbmdzLmxlbmd0aCArIHVzZXJEYXRhLndhbmdhbmdzLmxlbmd0aCArIHVzZXJEYXRhLmRpYW5nYW5ncy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgbnVtT2ZHZW4gPSB1c2VyRGF0YS5udW1vZmdlbjtcbiAgICAgICAgICAgIHZhciBhY3Rpb25BcnIgPSBbXTtcbiAgICAgICAgICAgIHZhciBpczdwYWlycyA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGlzY2hhZGFqaWFvID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHVzZXJEYXRhLmFjdGlvbnMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgYWMgPSB1c2VyRGF0YS5hY3Rpb25zW2pdO1xuICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiIHx8IGFjLnR5cGUgPT0gXCJnYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImRpYW5nYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImh1XCIgfHwgYWMudHlwZSA9PSBcImdhbmdwYW9odVwiIHx8IGFjLnR5cGUgPT0gXCJxaWFuZ2dhbmdodVwiIHx8IGFjLnR5cGUgPT0gXCJjaGFkYWppYW9cIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEucGF0dGVybiA9PSBcIjdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwibDdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIum+meS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwiajdwYWlyc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWwhuS4g+WvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyRGF0YS5wYXR0ZXJuID09IFwiZHVpZHVpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi56Kw56Kw6IOhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJqaWFuZ2R1aVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWwhuWvuVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuiHquaRuFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZ2FuZ2h1YVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuadoOS4iuiKsVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZGlhbmdhbmdodWFcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLngrnmnaDoirFcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImdhbmdwYW9odVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuadoOeCruiDoVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwicWlhbmdnYW5naHVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmiqLmnaDog6FcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImNoYWRhamlhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc2NoYWRhamlhbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaHVlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiZmFuZ3Bhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5pS+54KuXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImFuZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5pqX5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImRpYW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmmI7mnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwid2FuZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5byv5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImZhbmdnYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmlL7mnaBcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYy50eXBlID09IFwiemh1YW5zaG91Z2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6L2s5omL5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImJlaXFpYW5nZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6KKr5oqi5p2gXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImJlaWNoYWRhamlhb1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6KKr5p+l5Y+rXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGh1ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEucWluZ3lpc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmuIXkuIDoibJcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLm1lbnFpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLpl6jmuIVcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnpob25nemhhbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLkuK3lvKBcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmppbmdvdWh1KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6YeR6ZKp6IOhXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5oYWlkaWh1KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5rW35bqV6IOhXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS50aWFuaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlpKnog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmRpaHUpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlnLDog6FcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG51bU9mR2VuID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaguXhcIiArIG51bU9mR2VuKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNjaGFkYWppYW8pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmn6XlpKflj6tcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmh1bnlpc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmt7fkuIDoibJcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmR1aWR1aWh1KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5a+55a+56IOhXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5wYWlodSkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaOkuiDoVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZ2FuZ3NoYW5naHVhKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5p2g5LiK6IqxXCIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5rYW4pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlnY7moaNcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmJpYW4pIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLovrnmoaNcIik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmRhbikge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWNleWQilwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuZHVpZGFvKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5a+55YCSXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCAzOyArK28pIHtcbiAgICAgICAgICAgICAgICBzZWF0Vmlldy5odS5jaGlsZHJlbltvXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh1c2VyRGF0YS5odW9yZGVyID49IDApIHtcbiAgICAgICAgICAgICAgICBzZWF0Vmlldy5odS5jaGlsZHJlblt1c2VyRGF0YS5odW9yZGVyXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZWF0Vmlldy51c2VybmFtZS5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW2ldLm5hbWU7XG4gICAgICAgICAgICBzZWF0Vmlldy56aHVhbmcuYWN0aXZlID0gY2MudnYuZ2FtZU5ldE1nci5idXR0b24gPT0gaTtcbiAgICAgICAgICAgIHNlYXRWaWV3LnJlYXNvbi5zdHJpbmcgPSBhY3Rpb25BcnIuam9pbihcIuOAgVwiKTtcblxuICAgICAgICAgICAgLy/mmL7npLrkuJ3mlbDlj7DmlbBcbiAgICAgICAgICAgIHNlYXRWaWV3LnRhaXNpLnN0cmluZyA9IFwiXCI7XG5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuc2NvcmUuc3RyaW5nID0gXCIrXCIgKyB1c2VyRGF0YS5zY29yZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuc2NvcmUuc3RyaW5nID0gdXNlckRhdGEuc2NvcmU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodXBhaSA9IC0xO1xuICAgICAgICAgICAgaWYgKGh1ZWQpIHtcbiAgICAgICAgICAgICAgICBodXBhaSA9IHVzZXJEYXRhLmhvbGRzLnBvcCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYy52di5tYWhqb25nbWdyLnNvcnRNSih1c2VyRGF0YS5ob2xkcywgdXNlckRhdGEuZGluZ3F1ZSk7XG5cbiAgICAgICAgICAgIC8v6IOh54mM5LiN5Y+C5LiO5o6S5bqPXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xuICAgICAgICAgICAgICAgIHVzZXJEYXRhLmhvbGRzLnB1c2goaHVwYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+makOiXj+aJgOacieeJjFxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbkNvdW50OyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IHNlYXRWaWV3Lm1haGpvbmdzLmNoaWxkcmVuW2tdO1xuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYWNraW5nTnVtID0gKHVzZXJEYXRhLnBlbmdzLmxlbmd0aCArIG51bU9mR2FuZ3MgKyB1c2VyRGF0YS5jaGlzLmxlbmd0aCkgKiAzO1xuICAgICAgICAgICAgLy/mmL7npLrnm7jlhbPnmoTniYxcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdXNlckRhdGEuaG9sZHMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFpID0gdXNlckRhdGEuaG9sZHNba107XG4gICAgICAgICAgICAgICAgdmFyIG4gPSBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbltrICsgbGFja2luZ051bV07XG4gICAgICAgICAgICAgICAgbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZ1trXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/liJ3lp4vljJbmnaDniYxcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgZ2FuZ3MgPSB1c2VyRGF0YS5hbmdhbmdzO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnYW5ncy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3Nba107XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJhbmdhbmdcIik7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGdhbmdzID0gdXNlckRhdGEuZGlhbmdhbmdzO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnYW5ncy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3Nba107XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJkaWFuZ2FuZ1wiKTtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZ2FuZ3MgPSB1c2VyRGF0YS53YW5nYW5ncztcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2FuZ3MubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwid2FuZ2FuZ1wiKTtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+WIneWni+WMlueisOeJjFxuICAgICAgICAgICAgdmFyIHBlbmdzID0gdXNlckRhdGEucGVuZ3M7XG4gICAgICAgICAgICBpZiAocGVuZ3MpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBlbmdzLmxlbmd0aDsgKytrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtamlkID0gcGVuZ3Nba107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwicGVuZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v5Yid5aeL5YyW5ZCD54mMXG4gICAgICAgICAgICB2YXIgY2hpcyA9IHVzZXJEYXRhLmNoaXM7XG4gICAgICAgICAgICBpZiAoY2hpcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2hpcy5sZW5ndGg7ICsraykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGNoaXNba107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwiY2hpXCIpO1xuICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/liJ3lp4vljJboirHniYwgVE9ETzrlkozkuIvpnaLkuIDmoLflhpnliJ3lp4vljJblh73mlbAg5bm25LiU6KaB6aaW5YWI6ZqQ6JeP5omA5pyJ55qE6IqxXG5cbiAgICAgICAgICAgIHZhciBodWFzID0gdXNlckRhdGEuaHVhcztcbiAgICAgICAgICAgIHZhciBodWFfbm9kZSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoaSArIDEpKS5nZXRDaGlsZEJ5TmFtZShcImh1YXNcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGh1YV9ub2RlLmNoaWxkcmVuQ291bnQ7ICsraykge1xuICAgICAgICAgICAgICAgIGh1YV9ub2RlLmNoaWxkcmVuW2tdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGh1YXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGh1YXMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBodWFzW2tdO1xuICAgICAgICAgICAgICAgICAgICBodWFfbm9kZS5jaGlsZHJlbltrXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBodWFfbm9kZS5jaGlsZHJlbltrXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgICAgICAgICAgc3Auc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgbWppZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL+S4nOWNl+ilv+WMl+Wwj+aXl+WtkOi9rOaNolxuICAgICAgICAgICAgdmFyIHN3aXRjaEZlbmdGbGFnID0gZnVuY3Rpb24gc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBkaXJfc3RyKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCA0OyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uLmNoaWxkcmVuW2tdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24uZ2V0Q2hpbGRCeU5hbWUoZGlyX3N0cikuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8v5pi+56S65b2T5YmN6aOO5ZyI5ZKM5bGA5pWwXG4gICAgICAgICAgICB2YXIgbnVtb2ZnYW1lcyA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwibnVtb2ZnYW1lc1wiKTtcbiAgICAgICAgICAgIHZhciBmZW5ncXVhbiA9IFwi5Lic6aOO5ZyIXCI7XG4gICAgICAgICAgICBzd2l0Y2ggKGNjLnZ2LmdhbWVOZXRNZ3IuZmVuZ3hpYW5nKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5Lic6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5Y2X6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi6KW/6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBmZW5ncXVhbiA9IFwi5YyX6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBudW1vZmdhbWVzLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZmVuZ3F1YW47XG5cbiAgICAgICAgICAgIC8v5Yik5pat5Lic5Y2X6KW/5YyXXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuYnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoaSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcImRvbmdcIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJyZXN1bHRfbGlzdFwiKS5nZXRDaGlsZEJ5TmFtZShcInNcIiArICgoaSArIDEpICUgNCArIDEpKS5nZXRDaGlsZEJ5TmFtZShcImRpcmVjdGlvblwiKTtcbiAgICAgICAgICAgICAgICBzd2l0Y2hGZW5nRmxhZyhkaXJlY3Rpb24sIFwibmFuXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoKGkgKyAyKSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcInhpXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwicmVzdWx0X2xpc3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzXCIgKyAoKGkgKyAzKSAlIDQgKyAxKSkuZ2V0Q2hpbGRCeU5hbWUoXCJkaXJlY3Rpb25cIik7XG4gICAgICAgICAgICAgICAgc3dpdGNoRmVuZ0ZsYWcoZGlyZWN0aW9uLCBcImJlaVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0UGVuZ0FuZEdhbmdzOiBmdW5jdGlvbiBpbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgZmxhZykge1xuICAgICAgICB2YXIgcGdyb290ID0gbnVsbDtcbiAgICAgICAgaWYgKHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZy5sZW5ndGggPD0gaW5kZXgpIHtcbiAgICAgICAgICAgIHBncm9vdCA9IGNjLmluc3RhbnRpYXRlKGNjLnZ2Lm1haGpvbmdtZ3IucGVuZ1ByZWZhYlNlbGYpO1xuICAgICAgICAgICAgc2VhdFZpZXcuX3BlbmdhbmRnYW5nLnB1c2gocGdyb290KTtcbiAgICAgICAgICAgIHNlYXRWaWV3Lm1haGpvbmdzLmFkZENoaWxkKHBncm9vdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZ3Jvb3QgPSBzZWF0Vmlldy5fcGVuZ2FuZGdhbmdbaW5kZXhdO1xuICAgICAgICAgICAgcGdyb290LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3ByaXRlcyA9IHBncm9vdC5nZXRDb21wb25lbnRzSW5DaGlsZHJlbihjYy5TcHJpdGUpO1xuICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHNwcml0ZXMubGVuZ3RoOyArK3MpIHtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBzcHJpdGVzW3NdO1xuICAgICAgICAgICAgaWYgKHNwcml0ZS5ub2RlLm5hbWUgPT0gXCJnYW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNHYW5nID0gZmxhZyAhPSBcInBlbmdcIjtcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSBpc0dhbmc7XG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuc2NhbGVYID0gMS4wO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDEuMDtcbiAgICAgICAgICAgICAgICBpZiAoZmxhZyA9PSBcImFuZ2FuZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0RW1wdHlTcHJpdGVGcmFtZShcIm15c2VsZlwiKTtcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuc2NhbGVYID0gMS40O1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVkgPSAxLjQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIkJfXCIsIG1qaWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGZsYWcgPT0gXCJwZW5nXCIpIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJCX1wiLCBtamlkKTtlbHNlIGlmIChmbGFnID09IFwiY2hpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIkJfXCIsIG1qaWRbc10pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJCX1wiLCBtamlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcGdyb290LnggPSBpbmRleCAqIDU1ICogMyArIGluZGV4ICogMTA7XG4gICAgfSxcblxuICAgIG9uQnRuUmVhZHlDbGlja2VkOiBmdW5jdGlvbiBvbkJ0blJlYWR5Q2xpY2tlZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkJ0blJlYWR5Q2xpY2tlZFwiKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzR2FtZUVuZCkge1xuICAgICAgICAgICAgdGhpcy5fZ2FtZXJlc3VsdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoJ3JlYWR5Jyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uQnRuU2hhcmVDbGlja2VkOiBmdW5jdGlvbiBvbkJ0blNoYXJlQ2xpY2tlZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkJ0blNoYXJlQ2xpY2tlZFwiKTtcbiAgICB9XG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICcyYjA4ZDhwbTBWQkRMWWxaSWRmTHVQUycsICdHYW1lUmVzdWx0Jyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvR2FtZVJlc3VsdC5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9nYW1lcmVzdWx0OiBudWxsLFxuICAgICAgICBfc2VhdHM6IFtdXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZ2FtZXJlc3VsdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVfcmVzdWx0XCIpO1xuICAgICAgICAvL3RoaXMuX2dhbWVyZXN1bHQuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHNlYXRzID0gdGhpcy5fZ2FtZXJlc3VsdC5nZXRDaGlsZEJ5TmFtZShcInNlYXRzXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXRzLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLl9zZWF0cy5wdXNoKHNlYXRzLmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlNlYXRcIikpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGJ0bkNsb3NlID0gY2MuZmluZChcIkNhbnZhcy9nYW1lX3Jlc3VsdC9idG5DbG9zZVwiKTtcbiAgICAgICAgaWYgKGJ0bkNsb3NlKSB7XG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0bkNsb3NlLCB0aGlzLm5vZGUsIFwiR2FtZVJlc3VsdFwiLCBcIm9uQnRuQ2xvc2VDbGlja2VkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGJ0blNoYXJlID0gY2MuZmluZChcIkNhbnZhcy9nYW1lX3Jlc3VsdC9idG5TaGFyZVwiKTtcbiAgICAgICAgaWYgKGJ0blNoYXJlKSB7XG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0blNoYXJlLCB0aGlzLm5vZGUsIFwiR2FtZVJlc3VsdFwiLCBcIm9uQnRuU2hhcmVDbGlja2VkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy/liJ3lp4vljJbnvZHnu5zkuovku7bnm5HlkKzlmahcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZW5kJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYub25HYW1lRW5kKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNob3dSZXN1bHQ6IGZ1bmN0aW9uIHNob3dSZXN1bHQoc2VhdCwgaW5mbywgaXNadWlKaWFQYW9TaG91KSB7XG4gICAgICAgIHNlYXQubm9kZS5nZXRDaGlsZEJ5TmFtZShcInp1aWppYXBhb3Nob3VcIikuYWN0aXZlID0gaXNadWlKaWFQYW9TaG91O1xuXG4gICAgICAgIHNlYXQubm9kZS5nZXRDaGlsZEJ5TmFtZShcInppbW9jaXNodVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGluZm8ubnVtemltbztcbiAgICAgICAgc2VhdC5ub2RlLmdldENoaWxkQnlOYW1lKFwiamllcGFvY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWppZXBhbztcbiAgICAgICAgc2VhdC5ub2RlLmdldENoaWxkQnlOYW1lKFwiZGlhbnBhb2Npc2h1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gaW5mby5udW1kaWFucGFvO1xuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJhbmdhbmdjaXNodVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGluZm8ubnVtYW5nYW5nO1xuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJtaW5nZ2FuZ2Npc2h1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gaW5mby5udW1taW5nZ2FuZztcbiAgICAgICAgLy9zZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaGFqaWFvY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWNoYWRhamlhbztcbiAgICB9LFxuXG4gICAgb25HYW1lRW5kOiBmdW5jdGlvbiBvbkdhbWVFbmQoZW5kaW5mbykge1xuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xuICAgICAgICB2YXIgbWF4c2NvcmUgPSAtMTtcbiAgICAgICAgdmFyIG1heGRpYW5wYW8gPSAwO1xuICAgICAgICB2YXIgZGlhbnBhb2dhb3Nob3UgPSAtMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWF0c1tpXTtcbiAgICAgICAgICAgIGlmIChzZWF0LnNjb3JlID4gbWF4c2NvcmUpIHtcbiAgICAgICAgICAgICAgICBtYXhzY29yZSA9IHNlYXQuc2NvcmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW5kaW5mb1tpXS5udW1kaWFucGFvID4gbWF4ZGlhbnBhbykge1xuICAgICAgICAgICAgICAgIG1heGRpYW5wYW8gPSBlbmRpbmZvW2ldLm51bWRpYW5wYW87XG4gICAgICAgICAgICAgICAgZGlhbnBhb2dhb3Nob3UgPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWF0c1tpXTtcbiAgICAgICAgICAgIHZhciBpc0JpZ3dpbiA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHNlYXQuc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICAgICAgaXNCaWd3aW4gPSBzZWF0LnNjb3JlID09IG1heHNjb3JlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc2VhdHNbaV0uc2V0SW5mbyhzZWF0Lm5hbWUsIHNlYXQuc2NvcmUsIGlzQmlnd2luKTtcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzW2ldLnNldElEKHNlYXQudXNlcmlkKTtcbiAgICAgICAgICAgIHZhciBpc1p1aUppYVBhb1Nob3UgPSBkaWFucGFvZ2Fvc2hvdSA9PSBpO1xuICAgICAgICAgICAgdGhpcy5zaG93UmVzdWx0KHRoaXMuX3NlYXRzW2ldLCBlbmRpbmZvW2ldLCBpc1p1aUppYVBhb1Nob3UpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uQnRuQ2xvc2VDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkNsb3NlQ2xpY2tlZCgpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTtcbiAgICB9LFxuXG4gICAgb25CdG5TaGFyZUNsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuU2hhcmVDbGlja2VkKCkge1xuICAgICAgICBjYy52di5hbnlzZGtNZ3Iuc2hhcmVSZXN1bHQoKTtcbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzI0ZTMwWkpMZ2RIM3JzMVIxQ3ZxTjhVJywgJ0dsb2JhbCcpO1xuLy8gc2NyaXB0cy9HbG9iYWwuanNcblxudmFyIEdsb2JhbCA9IGNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgaXNzdGFydGVkOiBmYWxzZSxcbiAgICAgICAgbmV0aW5pdGVkOiBmYWxzZSxcbiAgICAgICAgdXNlcmd1aWQ6IDAsXG4gICAgICAgIG5pY2tuYW1lOiBcIlwiLFxuICAgICAgICBtb25leTogMCxcbiAgICAgICAgbHY6IDAsXG4gICAgICAgIHJvb21JZDogMFxuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnOTBhZTYxSjUyNUpRSXQ1dGFGM05jZTInLCAnSFRUUCcpO1xuLy8gc2NyaXB0cy9IVFRQLmpzXG5cbi8vbG9jYWxcblxuLy92YXIgVVJMID0gXCJodHRwOi8vMTkyLjE2OC4xLjEyMTo5MDAwXCI7XG4vL0RFViBTRVJWRVJcbi8vdmFyIFVSTCA9IFwiaHR0cDovLzEzOS4yMTkuMjI0LjE0Mzo5MDAwXCI7XG4vL0ZPUk1BTCBTRVJWRVJcbnZhciBVUkwgPSBcImh0dHA6Ly8xMTkuMjMuMjUwLjExNTo5MDAwXCI7XG5cbmNjLlZFUlNJT04gPSAyMDE2MTIyNztcbnZhciBIVFRQID0gY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIHNlc3Npb25JZDogMCxcbiAgICAgICAgdXNlcklkOiAwLFxuICAgICAgICBtYXN0ZXJfdXJsOiBVUkwsXG4gICAgICAgIHVybDogVVJMLFxuICAgICAgICBzZW5kUmVxdWVzdDogZnVuY3Rpb24gc2VuZFJlcXVlc3QocGF0aCwgZGF0YSwgaGFuZGxlciwgZXh0cmFVcmwpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBjYy5sb2FkZXIuZ2V0WE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci50aW1lb3V0ID0gNTAwMDtcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIj9cIjtcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChzdHIgIT0gXCI/XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9IFwiJlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdHIgKz0gayArIFwiPVwiICsgZGF0YVtrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChleHRyYVVybCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZXh0cmFVcmwgPSBIVFRQLnVybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXF1ZXN0VVJMID0gZXh0cmFVcmwgKyBwYXRoICsgZW5jb2RlVVJJKHN0cik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlcXVlc3RVUkw6XCIgKyByZXF1ZXN0VVJMKTtcbiAgICAgICAgICAgIHhoci5vcGVuKFwiR0VUXCIsIHJlcXVlc3RVUkwsIHRydWUpO1xuICAgICAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQWNjZXB0LUVuY29kaW5nXCIsIFwiZ3ppcCxkZWZsYXRlXCIsIFwidGV4dC9odG1sO2NoYXJzZXQ9VVRGLThcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coeGhyKTtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQgJiYgeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImh0dHAgcmVzKFwiICsgeGhyLnJlc3BvbnNlVGV4dC5sZW5ndGggKyBcIik6XCIgKyB4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKHJldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IC8qIGNvZGUgKi9cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIgKyBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaGFuZGxlcihudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYy52diAmJiBjYy52di53Yykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIGNjLnZ2LndjLmhpZGUoKTsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN0YXR1cz1cIiArIHhoci5yZWFkeVN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2VsZi51cmwgPSBcImh0dHA6Ly8xMzkuMjE5LjIyNC4xNDM6OTAwMFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9IVFRQLnVybCA9IFwiaHR0cDovLzEzOS4yMTkuMjI0LjE0Mzo5MDAwXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChjYy52diAmJiBjYy52di53Yykge1xuICAgICAgICAgICAgICAgIC8vY2MudnYud2Muc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgICAgIHJldHVybiB4aHI7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzZlZGIzamp4K0ZCZXBTMW1rMXhLREYyJywgJ0hhbGwnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9IYWxsLmpzXG5cbnZhciBOZXQgPSByZXF1aXJlKFwiTmV0XCIpO1xudmFyIEdsb2JhbCA9IHJlcXVpcmUoXCJHbG9iYWxcIik7XG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGJsTmFtZTogY2MuTGFiZWwsXG4gICAgICAgIGxibE1vbmV5OiBjYy5MYWJlbCxcbiAgICAgICAgbGJsR2VtczogY2MuTGFiZWwsXG4gICAgICAgIGxibElEOiBjYy5MYWJlbCxcbiAgICAgICAgbGJsTm90aWNlOiBjYy5MYWJlbCxcbiAgICAgICAgam9pbkdhbWVXaW46IGNjLk5vZGUsXG4gICAgICAgIGNyZWF0ZVJvb21XaW46IGNjLk5vZGUsXG4gICAgICAgIHNldHRpbmdzV2luOiBjYy5Ob2RlLFxuICAgICAgICBoZWxwV2luOiBjYy5Ob2RlLFxuICAgICAgICB4aWFveGlXaW46IGNjLk5vZGUsXG4gICAgICAgIGJ0bkpvaW5HYW1lOiBjYy5Ob2RlLFxuICAgICAgICBidG5SZXR1cm5HYW1lOiBjYy5Ob2RlLFxuICAgICAgICBzcHJIZWFkSW1nOiBjYy5TcHJpdGVcbiAgICB9LFxuXG4gICAgLy8gZm9vOiB7XG4gICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAvLyB9LFxuICAgIC8vIC4uLlxuICAgIGluaXROZXRIYW5kbGVyczogZnVuY3Rpb24gaW5pdE5ldEhhbmRsZXJzKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgfSxcblxuICAgIG9uU2hhcmU6IGZ1bmN0aW9uIG9uU2hhcmUoKSB7XG4gICAgICAgIGNjLnZ2LmFueXNka01nci5zaGFyZShcIuiIn+Wxsem6u+WwhlwiLCBcIuiIn+Wxsem6u+Wwhu+8jOWMheWQq+S6huayiOWutumXqOm6u+WwhuOAgeWumua1t+m6u+WwhuOAgeaOqOWIsOiDoeetieWkmuenjeiIn+Wxsea1geihjOm6u+WwhueOqeazleOAglwiKTtcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlICYmIGNjLnN5cy5pc01vYmlsZSkge1xuICAgICAgICAgICAgdmFyIGN2cyA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuQ2FudmFzKTtcbiAgICAgICAgICAgIGN2cy5maXRIZWlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgY3ZzLmZpdFdpZHRoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNjLnZ2KSB7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJsb2FkaW5nXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdExhYmVscygpO1xuXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnJvb21JZCA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmJ0bkpvaW5HYW1lLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmJ0blJldHVybkdhbWUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ0bkpvaW5HYW1lLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5idG5SZXR1cm5HYW1lLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvL3ZhciBwYXJhbXMgPSBjYy52di5hcmdzO1xuICAgICAgICB2YXIgcm9vbUlkID0gY2MudnYudXNlck1nci5vbGRSb29tSWQ7XG4gICAgICAgIGlmIChyb29tSWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2MudnYudXNlck1nci5vbGRSb29tSWQgPSBudWxsO1xuICAgICAgICAgICAgY2MudnYudXNlck1nci5lbnRlclJvb20ocm9vbUlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbWdMb2FkZXIgPSB0aGlzLnNwckhlYWRJbWcubm9kZS5nZXRDb21wb25lbnQoXCJJbWFnZUxvYWRlclwiKTtcbiAgICAgICAgaW1nTG9hZGVyLnNldFVzZXJJRChjYy52di51c2VyTWdyLnVzZXJJZCk7XG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5zcHJIZWFkSW1nLm5vZGUsIHRoaXMubm9kZSwgXCJIYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiVXNlckluZm9TaG93XCIpO1xuXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl9zaGV6aGlcIik7XG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl9oZWxwXCIpO1xuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKFwiQ2FudmFzL3JpZ2h0X2JvdHRvbS9idG5feGlhb3hpXCIpO1xuICAgICAgICB0aGlzLmhlbHBXaW4uYWRkQ29tcG9uZW50KFwiT25CYWNrXCIpO1xuICAgICAgICB0aGlzLnhpYW94aVdpbi5hZGRDb21wb25lbnQoXCJPbkJhY2tcIik7XG5cbiAgICAgICAgaWYgKCFjYy52di51c2VyTWdyLm5vdGljZSkge1xuICAgICAgICAgICAgY2MudnYudXNlck1nci5ub3RpY2UgPSB7XG4gICAgICAgICAgICAgICAgdmVyc2lvbjogbnVsbCxcbiAgICAgICAgICAgICAgICBtc2c6IFwi5pWw5o2u6K+35rGC5LitLi4uXCJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWNjLnZ2LnVzZXJNZ3IuZ2Vtc3RpcCkge1xuICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zdGlwID0ge1xuICAgICAgICAgICAgICAgIHZlcnNpb246IG51bGwsXG4gICAgICAgICAgICAgICAgbXNnOiBcIuaVsOaNruivt+axguS4rS4uLlwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sYmxOb3RpY2Uuc3RyaW5nID0gY2MudnYudXNlck1nci5ub3RpY2UubXNnO1xuXG4gICAgICAgIHRoaXMucmVmcmVzaEluZm8oKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoTm90aWNlKCk7XG4gICAgICAgIHRoaXMucmVmcmVzaEdlbXNUaXAoKTtcblxuICAgICAgICBjYy52di5hdWRpb01nci5wbGF5QkdNKFwiYmdNYWluLm1wM1wiKTtcblxuICAgICAgICAvL+mihOWKoOi9vem6u+Wwhua4uOaIj+eVjOmdolxuICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ21qZ2FtZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNjLmxvZygncHJlbG9hZCBtamdhbWUgY29tcGxldGUhISEnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHlvdWtlb3J3ZWl4aW4gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ5b3VrZW9yd2VpeGluXCIpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MgJiYgeW91a2VvcndlaXhpbiA9PSBcIjBcIikge1xuICAgICAgICAgICAgLy/pmpDol4/mmL7npLrkuIvovrnmjInpkq5cbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvaGFsbEJnL2Z1amlhbm1hamlhbmdcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2hhbGxCZy9hbmh1aW1hamlhbmdcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2hhbGxCZy9xaXFpYnV5dVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvaGFsbEJnL3FpcWlwdWtlXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9oYWxsQmcvbW9yZVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvaGFsbEJnL3hpeGlhMDAxXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy90b3BfbGVmdC9oZWFkaW5mby9iZ1wiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvdG9wX2xlZnQvaGVhZGluZm8vZ2Vtc1wiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvdG9wX2xlZnQvaGVhZGluZm8vYnRuX2FkZF9nZW1zXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy90b3BfbGVmdC9oZWFkaW5mby9sYmxHZW1zXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9yaWdodF9ib3R0b20vYnRuX3poYW5qaVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl9zaGFyZVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZWZyZXNoSW5mbzogZnVuY3Rpb24gcmVmcmVzaEluZm8oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24gb25HZXQocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHJldC5nZW1zICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYmxHZW1zLnN0cmluZyA9IHJldC5nZW1zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnblxuICAgICAgICB9O1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF91c2VyX3N0YXR1c1wiLCBkYXRhLCBvbkdldC5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgcmVmcmVzaEdlbXNUaXA6IGZ1bmN0aW9uIHJlZnJlc2hHZW1zVGlwKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uIG9uR2V0KHJldCkge1xuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2Vtc3RpcC52ZXJzaW9uID0gcmV0LnZlcnNpb247XG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zdGlwLm1zZyA9IHJldC5tc2cucmVwbGFjZShcIjxuZXdsaW5lPlwiLCBcIlxcblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcbiAgICAgICAgICAgIHR5cGU6IFwiZmtnbVwiLFxuICAgICAgICAgICAgdmVyc2lvbjogY2MudnYudXNlck1nci5nZW1zdGlwLnZlcnNpb25cbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfbWVzc2FnZVwiLCBkYXRhLCBvbkdldC5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgcmVmcmVzaE5vdGljZTogZnVuY3Rpb24gcmVmcmVzaE5vdGljZSgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgb25HZXQgPSBmdW5jdGlvbiBvbkdldChyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm5vdGljZS52ZXJzaW9uID0gcmV0LnZlcnNpb247XG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5ub3RpY2UubXNnID0gcmV0Lm1zZztcbiAgICAgICAgICAgICAgICB0aGlzLmxibE5vdGljZS5zdHJpbmcgPSByZXQubXNnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxuICAgICAgICAgICAgdHlwZTogXCJub3RpY2VcIixcbiAgICAgICAgICAgIHZlcnNpb246IGNjLnZ2LnVzZXJNZ3Iubm90aWNlLnZlcnNpb25cbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfbWVzc2FnZVwiLCBkYXRhLCBvbkdldC5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgaW5pdEJ1dHRvbkhhbmRsZXI6IGZ1bmN0aW9uIGluaXRCdXR0b25IYW5kbGVyKGJ0blBhdGgpIHtcbiAgICAgICAgdmFyIGJ0biA9IGNjLmZpbmQoYnRuUGF0aCk7XG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuLCB0aGlzLm5vZGUsIFwiSGFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcbiAgICB9LFxuXG4gICAgaW5pdExhYmVsczogZnVuY3Rpb24gaW5pdExhYmVscygpIHtcbiAgICAgICAgdGhpcy5sYmxOYW1lLnN0cmluZyA9IGNjLnZ2LnVzZXJNZ3IudXNlck5hbWU7XG4gICAgICAgIHRoaXMubGJsTW9uZXkuc3RyaW5nID0gY2MudnYudXNlck1nci5jb2lucztcbiAgICAgICAgdGhpcy5sYmxHZW1zLnN0cmluZyA9IGNjLnZ2LnVzZXJNZ3IuZ2VtcztcbiAgICAgICAgdGhpcy5sYmxJRC5zdHJpbmcgPSBcIklEOlwiICsgY2MudnYudXNlck1nci51c2VySWQ7XG4gICAgfSxcblxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5DbGlja2VkKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bl9zaGV6aGlcIikge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1dpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2hlbHBcIikge1xuICAgICAgICAgICAgdGhpcy5oZWxwV2luLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feGlhb3hpXCIpIHtcbiAgICAgICAgICAgIHRoaXMueGlhb3hpV2luLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJoZWFkXCIpIHtcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJpbmZvU2hvdy5zaG93KGNjLnZ2LnVzZXJNZ3IudXNlck5hbWUsIGNjLnZ2LnVzZXJNZ3IudXNlcklkLCB0aGlzLnNwckhlYWRJbWcsIGNjLnZ2LnVzZXJNZ3Iuc2V4LCBjYy52di51c2VyTWdyLmlwKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkpvaW5HYW1lQ2xpY2tlZDogZnVuY3Rpb24gb25Kb2luR2FtZUNsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMuam9pbkdhbWVXaW4uYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgb25SZXR1cm5HYW1lQ2xpY2tlZDogZnVuY3Rpb24gb25SZXR1cm5HYW1lQ2xpY2tlZCgpIHtcbiAgICAgICAgdmFyIGxvYWRnYW1lID0gZnVuY3Rpb24gbG9hZGdhbWUoKSB7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJtamdhbWVcIik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmYWRlb3V0ID0gY2MuZmFkZU91dCgwLjEpO1xuICAgICAgICB2YXIgZmluaXNoID0gY2MuY2FsbEZ1bmMobG9hZGdhbWUsIHRoaXMpO1xuICAgICAgICB2YXIgc2VxID0gY2Muc2VxdWVuY2UoZmFkZW91dCwgZmluaXNoKTtcbiAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihzZXEpO1xuICAgIH0sXG5cbiAgICBvbkJ0bkFkZEdlbXNDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkFkZEdlbXNDbGlja2VkKCkge1xuICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIGNjLnZ2LnVzZXJNZ3IuZ2Vtc3RpcC5tc2cpO1xuICAgICAgICB0aGlzLnJlZnJlc2hJbmZvKCk7XG4gICAgfSxcblxuICAgIG9uQ3JlYXRlUm9vbUNsaWNrZWQ6IGZ1bmN0aW9uIG9uQ3JlYXRlUm9vbUNsaWNrZWQoKSB7XG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnJvb21JZCAhPSBudWxsKSB7XG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5oi/6Ze05bey57uP5Yib5bu6IVxcbuW/hemhu+ino+aVo+W9k+WJjeaIv+mXtOaJjeiDveWIm+W7uuaWsOeahOaIv+mXtFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uQ3JlYXRlUm9vbUNsaWNrZWRcIik7XG4gICAgICAgIHRoaXMuY3JlYXRlUm9vbVdpbi5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGR0KSB7XG4gICAgICAgIHZhciB4ID0gdGhpcy5sYmxOb3RpY2Uubm9kZS54O1xuICAgICAgICB4IC09IGR0ICogMTAwO1xuICAgICAgICBpZiAoeCArIHRoaXMubGJsTm90aWNlLm5vZGUud2lkdGggPCAtMTAwMCkge1xuICAgICAgICAgICAgeCA9IDUwMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxibE5vdGljZS5ub2RlLnggPSB4O1xuXG4gICAgICAgIGlmIChjYy52diAmJiBjYy52di51c2VyTWdyLnJvb21EYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZW50ZXJSb29tKGNjLnZ2LnVzZXJNZ3Iucm9vbURhdGEpO1xuICAgICAgICAgICAgY2MudnYudXNlck1nci5yb29tRGF0YSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzRkN2JjaTBMVXhNVDZNSktYSkRqODl3JywgJ0hpc3RvcnknKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5LmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBIaXN0b3J5SXRlbVByZWZhYjoge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcbiAgICAgICAgfSxcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9oaXN0b3J5OiBudWxsLFxuICAgICAgICBfdmlld2xpc3Q6IG51bGwsXG4gICAgICAgIF9jb250ZW50OiBudWxsLFxuICAgICAgICBfdmlld2l0ZW1UZW1wOiBudWxsLFxuICAgICAgICBfaGlzdG9yeURhdGE6IG51bGwsXG4gICAgICAgIF9jdXJSb29tSW5mbzogbnVsbCxcbiAgICAgICAgX2VtcHR5VGlwOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB0aGlzLl9oaXN0b3J5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaGlzdG9yeVwiKTtcbiAgICAgICAgdGhpcy5faGlzdG9yeS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9lbXB0eVRpcCA9IHRoaXMuX2hpc3RvcnkuZ2V0Q2hpbGRCeU5hbWUoXCJlbXB0eVRpcFwiKTtcbiAgICAgICAgdGhpcy5fZW1wdHlUaXAuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLl92aWV3bGlzdCA9IHRoaXMuX2hpc3RvcnkuZ2V0Q2hpbGRCeU5hbWUoXCJ2aWV3bGlzdFwiKTtcbiAgICAgICAgdGhpcy5fY29udGVudCA9IGNjLmZpbmQoXCJ2aWV3L2NvbnRlbnRcIiwgdGhpcy5fdmlld2xpc3QpO1xuXG4gICAgICAgIHRoaXMuX3ZpZXdpdGVtVGVtcCA9IHRoaXMuX2NvbnRlbnQuY2hpbGRyZW5bMF07XG4gICAgICAgIHRoaXMuX2NvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5fdmlld2l0ZW1UZW1wKTtcblxuICAgICAgICB2YXIgbm9kZSA9IGNjLmZpbmQoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl96aGFuamlcIik7XG4gICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudChub2RlLCB0aGlzLm5vZGUsIFwiSGlzdG9yeVwiLCBcIm9uQnRuSGlzdG9yeUNsaWNrZWRcIik7XG5cbiAgICAgICAgdmFyIG5vZGUgPSBjYy5maW5kKFwiQ2FudmFzL2hpc3RvcnkvYnRuX2JhY2tcIik7XG4gICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudChub2RlLCB0aGlzLm5vZGUsIFwiSGlzdG9yeVwiLCBcIm9uQnRuQmFja0NsaWNrZWRcIik7XG4gICAgfSxcblxuICAgIGFkZENsaWNrRXZlbnQ6IGZ1bmN0aW9uIGFkZENsaWNrRXZlbnQobm9kZSwgdGFyZ2V0LCBjb21wb25lbnQsIGhhbmRsZXIpIHtcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XG4gICAgICAgIGV2ZW50SGFuZGxlci50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBjb21wb25lbnQ7XG4gICAgICAgIGV2ZW50SGFuZGxlci5oYW5kbGVyID0gaGFuZGxlcjtcblxuICAgICAgICB2YXIgY2xpY2tFdmVudHMgPSBub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmNsaWNrRXZlbnRzO1xuICAgICAgICBjbGlja0V2ZW50cy5wdXNoKGV2ZW50SGFuZGxlcik7XG4gICAgfSxcblxuICAgIG9uQnRuQmFja0NsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuQmFja0NsaWNrZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jdXJSb29tSW5mbyA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9oaXN0b3J5RGF0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9oaXN0b3J5LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbml0Um9vbUhpc3RvcnlMaXN0KHRoaXMuX2hpc3RvcnlEYXRhKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkJ0bkhpc3RvcnlDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkhpc3RvcnlDbGlja2VkKCkge1xuICAgICAgICB0aGlzLl9oaXN0b3J5LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY2MudnYudXNlck1nci5nZXRIaXN0b3J5TGlzdChmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgZGF0YS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEudGltZSA8IGIudGltZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi5faGlzdG9yeURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA0OyArK2opIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBkYXRhW2ldLnNlYXRzW2pdO1xuICAgICAgICAgICAgICAgICAgICBzLm5hbWUgPSBuZXcgQnVmZmVyKHMubmFtZSwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5pbml0Um9vbUhpc3RvcnlMaXN0KGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgZGF0ZUZvcm1hdDogZnVuY3Rpb24gZGF0ZUZvcm1hdCh0aW1lKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUodGltZSk7XG4gICAgICAgIHZhciBkYXRldGltZSA9IFwiezB9LXsxfS17Mn0gezN9Ons0fTp7NX1cIjtcbiAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgICAgIG1vbnRoID0gbW9udGggPj0gMTAgPyBtb250aCA6IFwiMFwiICsgbW9udGg7XG4gICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcbiAgICAgICAgZGF5ID0gZGF5ID49IDEwID8gZGF5IDogXCIwXCIgKyBkYXk7XG4gICAgICAgIHZhciBoID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICBoID0gaCA+PSAxMCA/IGggOiBcIjBcIiArIGg7XG4gICAgICAgIHZhciBtID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgIG0gPSBtID49IDEwID8gbSA6IFwiMFwiICsgbTtcbiAgICAgICAgdmFyIHMgPSBkYXRlLmdldFNlY29uZHMoKTtcbiAgICAgICAgcyA9IHMgPj0gMTAgPyBzIDogXCIwXCIgKyBzO1xuICAgICAgICBkYXRldGltZSA9IGRhdGV0aW1lLmZvcm1hdCh5ZWFyLCBtb250aCwgZGF5LCBoLCBtLCBzKTtcbiAgICAgICAgcmV0dXJuIGRhdGV0aW1lO1xuICAgIH0sXG5cbiAgICBpbml0Um9vbUhpc3RvcnlMaXN0OiBmdW5jdGlvbiBpbml0Um9vbUhpc3RvcnlMaXN0KGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJpbml0Um9vbUhpc3RvcnlMaXN0XCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5nZXRWaWV3SXRlbShpKTtcbiAgICAgICAgICAgIG5vZGUuaWR4ID0gaTtcbiAgICAgICAgICAgIHZhciB0aXRsZUlkID0gXCJcIiArIChpICsgMSk7XG4gICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aXRsZUlkO1xuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21Ob1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5oi/6Ze0SUQ6XCIgKyBkYXRhW2ldLmlkO1xuICAgICAgICAgICAgdmFyIGRhdGV0aW1lID0gdGhpcy5kYXRlRm9ybWF0KGRhdGFbaV0udGltZSAqIDEwMDApO1xuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRldGltZTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coMSk7XG5cbiAgICAgICAgICAgIHZhciBidG5PcCA9IG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5PcFwiKTtcbiAgICAgICAgICAgIGJ0bk9wLmlkeCA9IGk7XG4gICAgICAgICAgICAvL2J0bk9wLmdldENoaWxkQnlOYW1lKFwiTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuivpuaDhVwiO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygyKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA0OyArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IGRhdGFbaV0uc2VhdHNbal07XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSBzLm5hbWUgKyBcIjpcIiArIHMuc2NvcmU7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhpbmZvKTtcbiAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwiaW5mb1wiICsgaikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbXB0eVRpcC5hY3RpdmUgPSBkYXRhLmxlbmd0aCA9PSAwO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9lbXB0eVRpcC5hY3RpdmUpO1xuICAgICAgICB0aGlzLnNocmlua0NvbnRlbnQoZGF0YS5sZW5ndGgpO1xuICAgICAgICB0aGlzLl9jdXJSb29tSW5mbyA9IG51bGw7XG4gICAgfSxcblxuICAgIGluaXRHYW1lSGlzdG9yeUxpc3Q6IGZ1bmN0aW9uIGluaXRHYW1lSGlzdG9yeUxpc3Qocm9vbUluZm8sIGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJpbml0R2FtZUhpc3RvcnlMaXN0XCIpO1xuICAgICAgICBkYXRhLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBhLmNyZWF0ZV90aW1lIDwgYi5jcmVhdGVfdGltZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmdldFZpZXdJdGVtKGkpO1xuICAgICAgICAgICAgdmFyIGlkeCA9IGRhdGEubGVuZ3RoIC0gaSAtIDE7XG4gICAgICAgICAgICBub2RlLmlkeCA9IGlkeDtcbiAgICAgICAgICAgIHZhciB0aXRsZUlkID0gXCJcIiArIChpZHggKyAxKTtcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXRsZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRpdGxlSWQ7XG4gICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwicm9vbU5vXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLmiL/pl7RJRDpcIiArIHJvb21JbmZvLmlkO1xuICAgICAgICAgICAgdmFyIGRhdGV0aW1lID0gdGhpcy5kYXRlRm9ybWF0KGRhdGFbaV0uY3JlYXRlX3RpbWUgKiAxMDAwKTtcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZGF0ZXRpbWU7XG5cbiAgICAgICAgICAgIHZhciBidG5PcCA9IG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5PcFwiKTtcbiAgICAgICAgICAgIGJ0bk9wLmlkeCA9IGlkeDtcbiAgICAgICAgICAgIC8vYnRuT3AuZ2V0Q2hpbGRCeU5hbWUoXCJMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5Zue5pS+XCI7XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBKU09OLnBhcnNlKGRhdGFbaV0ucmVzdWx0KTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgNDsgKytqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHMgPSByb29tSW5mby5zZWF0c1tqXTtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHMubmFtZSArIFwiOlwiICsgcmVzdWx0W2pdO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coaW5mbyk7XG4gICAgICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcImluZm9cIiArIGopLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gaW5mbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNocmlua0NvbnRlbnQoZGF0YS5sZW5ndGgpO1xuICAgICAgICB0aGlzLl9jdXJSb29tSW5mbyA9IHJvb21JbmZvO1xuICAgIH0sXG5cbiAgICBnZXRWaWV3SXRlbTogZnVuY3Rpb24gZ2V0Vmlld0l0ZW0oaW5kZXgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICBpZiAoY29udGVudC5jaGlsZHJlbkNvdW50ID4gaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50LmNoaWxkcmVuW2luZGV4XTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuX3ZpZXdpdGVtVGVtcCk7XG4gICAgICAgIGNvbnRlbnQuYWRkQ2hpbGQobm9kZSk7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG4gICAgc2hyaW5rQ29udGVudDogZnVuY3Rpb24gc2hyaW5rQ29udGVudChudW0pIHtcbiAgICAgICAgd2hpbGUgKHRoaXMuX2NvbnRlbnQuY2hpbGRyZW5Db3VudCA+IG51bSkge1xuICAgICAgICAgICAgdmFyIGxhc3RPbmUgPSB0aGlzLl9jb250ZW50LmNoaWxkcmVuW3RoaXMuX2NvbnRlbnQuY2hpbGRyZW5Db3VudCAtIDFdO1xuICAgICAgICAgICAgdGhpcy5fY29udGVudC5yZW1vdmVDaGlsZChsYXN0T25lLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRHYW1lTGlzdE9mUm9vbTogZnVuY3Rpb24gZ2V0R2FtZUxpc3RPZlJvb20oaWR4KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHJvb21JbmZvID0gdGhpcy5faGlzdG9yeURhdGFbaWR4XTtcbiAgICAgICAgY2MudnYudXNlck1nci5nZXRHYW1lc09mUm9vbShyb29tSW5mby51dWlkLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCAmJiBkYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRHYW1lSGlzdG9yeUxpc3Qocm9vbUluZm8sIGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgZ2V0RGV0YWlsT2ZHYW1lOiBmdW5jdGlvbiBnZXREZXRhaWxPZkdhbWUoaWR4KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHJvb21VVUlEID0gdGhpcy5fY3VyUm9vbUluZm8udXVpZDtcbiAgICAgICAgY2MudnYudXNlck1nci5nZXREZXRhaWxPZkdhbWUocm9vbVVVSUQsIGlkeCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGRhdGEuYmFzZV9pbmZvID0gSlNPTi5wYXJzZShkYXRhLmJhc2VfaW5mbyk7XG4gICAgICAgICAgICBkYXRhLmFjdGlvbl9yZWNvcmRzID0gSlNPTi5wYXJzZShkYXRhLmFjdGlvbl9yZWNvcmRzKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IucHJlcGFyZVJlcGxheShzZWxmLl9jdXJSb29tSW5mbywgZGF0YSk7XG4gICAgICAgICAgICBjYy52di5yZXBsYXlNZ3IuaW5pdChkYXRhKTtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm1qZ2FtZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIG9uVmlld0l0ZW1DbGlja2VkOiBmdW5jdGlvbiBvblZpZXdJdGVtQ2xpY2tlZChldmVudCkge1xuICAgICAgICAvLyB2YXIgaWR4ID0gZXZlbnQudGFyZ2V0LmlkeDtcbiAgICAgICAgLy8gY29uc29sZS5sb2coaWR4KTtcbiAgICAgICAgLy8gaWYodGhpcy5fY3VyUm9vbUluZm8gPT0gbnVsbCl7XG4gICAgICAgIC8vICAgICB0aGlzLmdldEdhbWVMaXN0T2ZSb29tKGlkeCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gZWxzZXtcbiAgICAgICAgLy8gICAgIHRoaXMuZ2V0RGV0YWlsT2ZHYW1lKGlkeCk7ICAgICBcbiAgICAgICAgLy8gfVxuICAgIH0sXG5cbiAgICBvbkJ0bk9wQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5PcENsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgLy8gdmFyIGlkeCA9IGV2ZW50LnRhcmdldC5wYXJlbnQuaWR4O1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhpZHgpO1xuICAgICAgICAvLyBpZih0aGlzLl9jdXJSb29tSW5mbyA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgIHRoaXMuZ2V0R2FtZUxpc3RPZlJvb20oaWR4KTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBlbHNle1xuICAgICAgICAvLyAgICAgdGhpcy5nZXREZXRhaWxPZkdhbWUoaWR4KTsgICAgIFxuICAgICAgICAvLyB9XG4gICAgfVxuXG59KTtcbi8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4vLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4vLyB9LFxuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnMTcxNDFFb2ROUk0vNElwc0UwNEl5Q1UnLCAnSG90VXBkYXRlJyk7XG4vLyBzY3JpcHRzL0hvdFVwZGF0ZS5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdXBkYXRlUGFuZWw6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBtYW5pZmVzdFVybDoge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLlJhd0Fzc2V0XG4gICAgICAgIH0sXG4gICAgICAgIHBlcmNlbnQ6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcbiAgICAgICAgfSxcbiAgICAgICAgbGJsRXJyOiB7XG4gICAgICAgICAgICBcImRlZmF1bHRcIjogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2hlY2tDYjogZnVuY3Rpb24gY2hlY2tDYihldmVudCkge1xuICAgICAgICBjYy5sb2coJ0NvZGU6ICcgKyBldmVudC5nZXRFdmVudENvZGUoKSk7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZ2V0RXZlbnRDb2RlKCkpIHtcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9OT19MT0NBTF9NQU5JRkVTVDpcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJObyBsb2NhbCBtYW5pZmVzdCBmaWxlIGZvdW5kLCBob3QgdXBkYXRlIHNraXBwZWQuXCIpO1xuICAgICAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLl9jaGVja0xpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9ET1dOTE9BRF9NQU5JRkVTVDpcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9QQVJTRV9NQU5JRkVTVDpcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJGYWlsIHRvIGRvd25sb2FkIG1hbmlmZXN0IGZpbGUsIGhvdCB1cGRhdGUgc2tpcHBlZC5cIik7XG4gICAgICAgICAgICAgICAgY2MuZXZlbnRNYW5hZ2VyLnJlbW92ZUxpc3RlbmVyKHRoaXMuX2NoZWNrTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkFMUkVBRFlfVVBfVE9fREFURTpcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJBbHJlYWR5IHVwIHRvIGRhdGUgd2l0aCB0aGUgbGF0ZXN0IHJlbW90ZSB2ZXJzaW9uLlwiKTtcbiAgICAgICAgICAgICAgICBjYy5ldmVudE1hbmFnZXIucmVtb3ZlTGlzdGVuZXIodGhpcy5fY2hlY2tMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy5sYmxFcnIuc3RyaW5nICs9IFwi5ri45oiP5LiN6ZyA6KaB5pu05pawXFxuXCI7XG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9hZGluZ1wiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5ORVdfVkVSU0lPTl9GT1VORDpcbiAgICAgICAgICAgICAgICB0aGlzLl9uZWVkVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJjZW50LnN0cmluZyA9ICcwMC4wMCUnO1xuICAgICAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLl9jaGVja0xpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ob3RVcGRhdGUoKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlQ2I6IGZ1bmN0aW9uIHVwZGF0ZUNiKGV2ZW50KSB7XG4gICAgICAgIHZhciBuZWVkUmVzdGFydCA9IGZhbHNlO1xuICAgICAgICB2YXIgZmFpbGVkID0gZmFsc2U7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZ2V0RXZlbnRDb2RlKCkpIHtcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9OT19MT0NBTF9NQU5JRkVTVDpcbiAgICAgICAgICAgICAgICBjYy5sb2coJ05vIGxvY2FsIG1hbmlmZXN0IGZpbGUgZm91bmQsIGhvdCB1cGRhdGUgc2tpcHBlZC4nKTtcbiAgICAgICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLlVQREFURV9QUk9HUkVTU0lPTjpcbiAgICAgICAgICAgICAgICB2YXIgcGVyY2VudCA9IGV2ZW50LmdldFBlcmNlbnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgcGVyY2VudEJ5RmlsZSA9IGV2ZW50LmdldFBlcmNlbnRCeUZpbGUoKTtcblxuICAgICAgICAgICAgICAgIHZhciBtc2cgPSBldmVudC5nZXRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgaWYgKG1zZykge1xuICAgICAgICAgICAgICAgICAgICBjYy5sb2cobXNnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2MubG9nKHBlcmNlbnQudG9GaXhlZCgyKSArICclJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJjZW50LnN0cmluZyA9IHBlcmNlbnQgKyAnJSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfRE9XTkxPQURfTUFOSUZFU1Q6XG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfUEFSU0VfTUFOSUZFU1Q6XG4gICAgICAgICAgICAgICAgY2MubG9nKCdGYWlsIHRvIGRvd25sb2FkIG1hbmlmZXN0IGZpbGUsIGhvdCB1cGRhdGUgc2tpcHBlZC4nKTtcbiAgICAgICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLkFMUkVBRFlfVVBfVE9fREFURTpcbiAgICAgICAgICAgICAgICBjYy5sb2coJ0FscmVhZHkgdXAgdG8gZGF0ZSB3aXRoIHRoZSBsYXRlc3QgcmVtb3RlIHZlcnNpb24uJyk7XG4gICAgICAgICAgICAgICAgZmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5VUERBVEVfRklOSVNIRUQ6XG4gICAgICAgICAgICAgICAgY2MubG9nKCdVcGRhdGUgZmluaXNoZWQuICcgKyBldmVudC5nZXRNZXNzYWdlKCkpO1xuXG4gICAgICAgICAgICAgICAgbmVlZFJlc3RhcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBqc2IuRXZlbnRBc3NldHNNYW5hZ2VyLlVQREFURV9GQUlMRUQ6XG4gICAgICAgICAgICAgICAgY2MubG9nKCdVcGRhdGUgZmFpbGVkLiAnICsgZXZlbnQuZ2V0TWVzc2FnZSgpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2ZhaWxDb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mYWlsQ291bnQgPCA1KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FtLmRvd25sb2FkRmFpbGVkQXNzZXRzKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2MubG9nKCdSZWFjaCBtYXhpbXVtIGZhaWwgY291bnQsIGV4aXQgdXBkYXRlIHByb2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmFpbENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGpzYi5FdmVudEFzc2V0c01hbmFnZXIuRVJST1JfVVBEQVRJTkc6XG4gICAgICAgICAgICAgICAgY2MubG9nKCdBc3NldCB1cGRhdGUgZXJyb3I6ICcgKyBldmVudC5nZXRBc3NldElkKCkgKyAnLCAnICsgZXZlbnQuZ2V0TWVzc2FnZSgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UganNiLkV2ZW50QXNzZXRzTWFuYWdlci5FUlJPUl9ERUNPTVBSRVNTOlxuICAgICAgICAgICAgICAgIGNjLmxvZyhldmVudC5nZXRNZXNzYWdlKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmYWlsZWQpIHtcbiAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLl91cGRhdGVMaXN0ZW5lcik7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBhbmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5lZWRSZXN0YXJ0KSB7XG4gICAgICAgICAgICBjYy5ldmVudE1hbmFnZXIucmVtb3ZlTGlzdGVuZXIodGhpcy5fdXBkYXRlTGlzdGVuZXIpO1xuICAgICAgICAgICAgLy8gUHJlcGVuZCB0aGUgbWFuaWZlc3QncyBzZWFyY2ggcGF0aFxuICAgICAgICAgICAgdmFyIHNlYXJjaFBhdGhzID0ganNiLmZpbGVVdGlscy5nZXRTZWFyY2hQYXRocygpO1xuICAgICAgICAgICAgdmFyIG5ld1BhdGhzID0gdGhpcy5fYW0uZ2V0TG9jYWxNYW5pZmVzdCgpLmdldFNlYXJjaFBhdGhzKCk7XG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUudW5zaGlmdChzZWFyY2hQYXRocywgbmV3UGF0aHMpO1xuICAgICAgICAgICAgLy8gVGhpcyB2YWx1ZSB3aWxsIGJlIHJldHJpZXZlZCBhbmQgYXBwZW5kZWQgdG8gdGhlIGRlZmF1bHQgc2VhcmNoIHBhdGggZHVyaW5nIGdhbWUgc3RhcnR1cCxcbiAgICAgICAgICAgIC8vIHBsZWFzZSByZWZlciB0byBzYW1wbGVzL2pzLXRlc3RzL21haW4uanMgZm9yIGRldGFpbGVkIHVzYWdlLlxuICAgICAgICAgICAgLy8gISEhIFJlLWFkZCB0aGUgc2VhcmNoIHBhdGhzIGluIG1haW4uanMgaXMgdmVyeSBpbXBvcnRhbnQsIG90aGVyd2lzZSwgbmV3IHNjcmlwdHMgd29uJ3QgdGFrZSBlZmZlY3QuXG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0hvdFVwZGF0ZVNlYXJjaFBhdGhzJywgSlNPTi5zdHJpbmdpZnkoc2VhcmNoUGF0aHMpKTtcblxuICAgICAgICAgICAganNiLmZpbGVVdGlscy5zZXRTZWFyY2hQYXRocyhzZWFyY2hQYXRocyk7XG4gICAgICAgICAgICB0aGlzLmxibEVyci5zdHJpbmcgKz0gXCLmuLjmiI/otYTmupDmm7TmlrDlrozmr5VcXG5cIjtcbiAgICAgICAgICAgIGNjLmdhbWUucmVzdGFydCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGhvdFVwZGF0ZTogZnVuY3Rpb24gaG90VXBkYXRlKCkge1xuICAgICAgICBpZiAodGhpcy5fYW0gJiYgdGhpcy5fbmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5sYmxFcnIuc3RyaW5nICs9IFwi5byA5aeL5pu05paw5ri45oiP6LWE5rqQLi4uXFxuXCI7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVMaXN0ZW5lciA9IG5ldyBqc2IuRXZlbnRMaXN0ZW5lckFzc2V0c01hbmFnZXIodGhpcy5fYW0sIHRoaXMudXBkYXRlQ2IuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjYy5ldmVudE1hbmFnZXIuYWRkTGlzdGVuZXIodGhpcy5fdXBkYXRlTGlzdGVuZXIsIDEpO1xuXG4gICAgICAgICAgICB0aGlzLl9mYWlsQ291bnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5fYW0udXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIC8vIEhvdCB1cGRhdGUgaXMgb25seSBhdmFpbGFibGUgaW4gTmF0aXZlIGJ1aWxkXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYmxFcnIuc3RyaW5nICs9IFwi5qOA5p+l5ri45oiP6LWE5rqQLi4uXFxuXCI7XG4gICAgICAgIHZhciBzdG9yYWdlUGF0aCA9IChqc2IuZmlsZVV0aWxzID8ganNiLmZpbGVVdGlscy5nZXRXcml0YWJsZVBhdGgoKSA6ICcvJykgKyAndGlhbnRpYW5xaXBhaS1hc3NldCc7XG4gICAgICAgIGNjLmxvZygnU3RvcmFnZSBwYXRoIGZvciByZW1vdGUgYXNzZXQgOiAnICsgc3RvcmFnZVBhdGgpO1xuICAgICAgICB0aGlzLmxibEVyci5zdHJpbmcgKz0gc3RvcmFnZVBhdGggKyBcIlxcblwiO1xuICAgICAgICBjYy5sb2coJ0xvY2FsIG1hbmlmZXN0IFVSTCA6ICcgKyB0aGlzLm1hbmlmZXN0VXJsKTtcbiAgICAgICAgdGhpcy5fYW0gPSBuZXcganNiLkFzc2V0c01hbmFnZXIodGhpcy5tYW5pZmVzdFVybCwgc3RvcmFnZVBhdGgpO1xuICAgICAgICB0aGlzLl9hbS5yZXRhaW4oKTtcblxuICAgICAgICB0aGlzLl9uZWVkVXBkYXRlID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLl9hbS5nZXRMb2NhbE1hbmlmZXN0KCkuaXNMb2FkZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tMaXN0ZW5lciA9IG5ldyBqc2IuRXZlbnRMaXN0ZW5lckFzc2V0c01hbmFnZXIodGhpcy5fYW0sIHRoaXMuY2hlY2tDYi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGNjLmV2ZW50TWFuYWdlci5hZGRMaXN0ZW5lcih0aGlzLl9jaGVja0xpc3RlbmVyLCAxKTtcblxuICAgICAgICAgICAgdGhpcy5fYW0uY2hlY2tVcGRhdGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uIG9uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5fYW0gJiYgdGhpcy5fYW0ucmVsZWFzZSgpO1xuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnOWEwOTZvQWdVNUh3cnhYMDVaUE5ZdFcnLCAnSHVhblNhblpoYW5nJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvSHVhblNhblpoYW5nLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBfaHVhbnBhaXRpcDogbnVsbCxcbiAgICAgICAgX2h1YW5wYWlBcnI6IFtdXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB0aGlzLl9odWFucGFpdGlwID0gY2MuZmluZChcIkNhbnZhcy9odWFuc2FuemhhbmdcIik7XG4gICAgICAgIHRoaXMuX2h1YW5wYWl0aXAuYWN0aXZlID0gY2MudnYuZ2FtZU5ldE1nci5pc0h1YW5TYW5aaGFuZztcblxuICAgICAgICBpZiAodGhpcy5faHVhbnBhaXRpcC5hY3RpdmUpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0h1YW5wYWkoY2MudnYuZ2FtZU5ldE1nci5nZXRTZWxmRGF0YSgpLmh1YW5wYWlzID09IG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdEh1YWlwYWlJbmZvKCk7XG5cbiAgICAgICAgdmFyIGJ0bk9rID0gY2MuZmluZChcIkNhbnZhcy9odWFuc2FuemhhbmcvYnRuX29rXCIpO1xuICAgICAgICBpZiAoYnRuT2spIHtcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuT2ssIHRoaXMubm9kZSwgXCJIdWFuU2FuWmhhbmdcIiwgXCJvbkh1YW5TYW5aaGFuZ1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfaHVhbnBhaScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLl9odWFucGFpdGlwLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBzZWxmLnNob3dIdWFucGFpKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2h1YW5wYWlfbm90aWZ5JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChkYXRhLmRldGFpbC5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRIdWFpcGFpSW5mbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfaHVhbnBhaV9vdmVyJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuX2h1YW5wYWl0aXAuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX2h1YW5wYWlBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9odWFucGFpQXJyW2ldLnkgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5faHVhbnBhaUFyciA9IFtdO1xuICAgICAgICAgICAgc2VsZi5pbml0SHVhaXBhaUluZm8oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2h1YW5wYWlfcmVzdWx0JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuaXNIdWFuU2FuWmhhbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHNlbGYuX2h1YW5wYWl0aXAuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX2h1YW5wYWlBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9odWFucGFpQXJyW2ldLnkgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5faHVhbnBhaUFyciA9IFtdO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ21qX2NsaWNrZWQnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgLy/lpoLmnpzlt7Lnu4/ngrnotbfmnaXvvIzliJnlj5bmtohcbiAgICAgICAgICAgIHZhciBpZHggPSBzZWxmLl9odWFucGFpQXJyLmluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgICAgIGlmIChpZHggIT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQueSA9IDA7XG4gICAgICAgICAgICAgICAgc2VsZi5faHVhbnBhaUFyci5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzmmK/mlrDnmoTvvIzliJnliqDlhaVcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5faHVhbnBhaUFyci5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2h1YW5wYWlBcnIucHVzaCh0YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQueSA9IDE1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNob3dIdWFucGFpOiBmdW5jdGlvbiBzaG93SHVhbnBhaShpbnRlcmFjdGFibGUpIHtcbiAgICAgICAgdGhpcy5faHVhbnBhaXRpcC5nZXRDaGlsZEJ5TmFtZShcImluZm9cIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuivt+mAieaLqeS4ieW8oOS4gOagt+iKseiJsueahOeJjFwiO1xuICAgICAgICB0aGlzLl9odWFucGFpdGlwLmdldENoaWxkQnlOYW1lKFwiYnRuX29rXCIpLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGludGVyYWN0YWJsZTtcbiAgICAgICAgdGhpcy5faHVhbnBhaXRpcC5nZXRDaGlsZEJ5TmFtZShcIm1hc2tcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGluaXRIdWFpcGFpSW5mbzogZnVuY3Rpb24gaW5pdEh1YWlwYWlJbmZvKCkge1xuICAgICAgICB2YXIgaHVhaXBhaWluZm8gPSBjYy5maW5kKFwiQ2FudmFzL2dhbWUvaHVhbnBhaWluZm9cIik7XG4gICAgICAgIHZhciBzZWF0ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWxmRGF0YSgpO1xuICAgICAgICBpZiAoc2VhdC5odWFucGFpcyA9PSBudWxsKSB7XG4gICAgICAgICAgICBodWFpcGFpaW5mby5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBodWFpcGFpaW5mby5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXQuaHVhbnBhaXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGh1YWlwYWlpbmZvLmdldENoaWxkQnlOYW1lKFwiaHBcIiArIChpICsgMSkpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHNlYXQuaHVhbnBhaXNbaV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGhwbSA9IGh1YWlwYWlpbmZvLmdldENoaWxkQnlOYW1lKFwiaHBtXCIpO1xuICAgICAgICBocG0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuaHVhbnBhaW1ldGhvZCA9PSAwKSB7XG4gICAgICAgICAgICBocG0ucm90YXRpb24gPSA5MDtcbiAgICAgICAgfSBlbHNlIGlmIChjYy52di5nYW1lTmV0TWdyLmh1YW5wYWltZXRob2QgPT0gMSkge1xuICAgICAgICAgICAgaHBtLnJvdGF0aW9uID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChjYy52di5nYW1lTmV0TWdyLmh1YW5wYWltZXRob2QgPT0gMikge1xuICAgICAgICAgICAgaHBtLnJvdGF0aW9uID0gMTgwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaHBtLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uSHVhblNhblpoYW5nOiBmdW5jdGlvbiBvbkh1YW5TYW5aaGFuZyhldmVudCkge1xuICAgICAgICBpZiAodGhpcy5faHVhbnBhaUFyci5sZW5ndGggIT0gMykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHR5cGUgPSBudWxsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2h1YW5wYWlBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBwYWkgPSB0aGlzLl9odWFucGFpQXJyW2ldLm1qSWQ7XG4gICAgICAgICAgICB2YXIgbnQgPSBjYy52di5tYWhqb25nbWdyLmdldE1haGpvbmdUeXBlKHBhaSk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IG50O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSAhPSBudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwMTogdGhpcy5faHVhbnBhaUFyclswXS5taklkLFxuICAgICAgICAgICAgcDI6IHRoaXMuX2h1YW5wYWlBcnJbMV0ubWpJZCxcbiAgICAgICAgICAgIHAzOiB0aGlzLl9odWFucGFpQXJyWzJdLm1qSWRcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9odWFucGFpdGlwLmdldENoaWxkQnlOYW1lKFwiaW5mb1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi562J5b6F5YW25LuW546p5a626YCJ54mMLi4uXCI7XG4gICAgICAgIHRoaXMuX2h1YW5wYWl0aXAuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fb2tcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2h1YW5wYWl0aXAuZ2V0Q2hpbGRCeU5hbWUoXCJtYXNrXCIpLmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJodWFucGFpXCIsIGRhdGEpO1xuICAgIH1cblxufSk7XG4vLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuLy8gfSxcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2VkMDU3QmdwOEZIbEpiR0krbGpBTjdkJywgJ0ltYWdlTG9hZGVyJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvSW1hZ2VMb2FkZXIuanNcblxuZnVuY3Rpb24gbG9hZEltYWdlKHVybCwgY29kZSwgY2FsbGJhY2spIHtcbiAgICAvKlxuICAgIGlmKGNjLnZ2LmltYWdlcyA9PSBudWxsKXtcbiAgICAgICAgY2MudnYuaW1hZ2VzID0ge307XG4gICAgfVxuICAgIHZhciBpbWFnZUluZm8gPSBjYy52di5pbWFnZXNbdXJsXTtcbiAgICBpZihpbWFnZUluZm8gPT0gbnVsbCl7XG4gICAgICAgIGltYWdlSW5mbyA9IHtcbiAgICAgICAgICAgIGltYWdlOm51bGwsXG4gICAgICAgICAgICBxdWV1ZTpbXSxcbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYuaW1hZ2VzW3VybF0gPSBpbWFnZUluZm87XG4gICAgfVxuICAgIFxuICAgIGNjLmxvYWRlci5sb2FkKHVybCxmdW5jdGlvbiAoZXJyLHRleCkge1xuICAgICAgICBpbWFnZUluZm8uaW1hZ2UgPSB0ZXg7XG4gICAgICAgIHZhciBzcHJpdGVGcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgsIGNjLlJlY3QoMCwgMCwgdGV4LndpZHRoLCB0ZXguaGVpZ2h0KSk7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBpbWFnZUluZm8ucXVldWUubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgdmFyIGl0bSA9IGltYWdlSW5mby5xdWV1ZVtpXTtcbiAgICAgICAgICAgIGl0bS5jYWxsYmFjayhpdG0uY29kZSxzcHJpdGVGcmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaXRtLnF1ZXVlID0gW107XG4gICAgfSk7XG4gICAgaWYoaW1hZ2VJbmZvLmltYWdlICE9IG51bGwpe1xuICAgICAgICB2YXIgdGV4ID0gaW1hZ2VJbmZvLmltYWdlO1xuICAgICAgICB2YXIgc3ByaXRlRnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4LCBjYy5SZWN0KDAsIDAsIHRleC53aWR0aCwgdGV4LmhlaWdodCkpO1xuICAgICAgICBjYWxsYmFjayhjb2RlLHNwcml0ZUZyYW1lKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgaW1hZ2VJbmZvLnF1ZXVlLnB1c2goe2NvZGU6Y29kZSxjYWxsYmFjazpjYWxsYmFja30pO1xuICAgIH0qL1xuICAgIGNjLmxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24gKGVyciwgdGV4KSB7XG4gICAgICAgIHZhciBzcHJpdGVGcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgsIGNjLlJlY3QoMCwgMCwgdGV4LndpZHRoLCB0ZXguaGVpZ2h0KSk7XG4gICAgICAgIGNhbGxiYWNrKGNvZGUsIHNwcml0ZUZyYW1lKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIGdldEJhc2VJbmZvKHVzZXJpZCwgY2FsbGJhY2spIHtcbiAgICBpZiAoY2MudnYuYmFzZUluZm9NYXAgPT0gbnVsbCkge1xuICAgICAgICBjYy52di5iYXNlSW5mb01hcCA9IHt9O1xuICAgIH1cblxuICAgIGlmIChjYy52di5iYXNlSW5mb01hcFt1c2VyaWRdICE9IG51bGwpIHtcbiAgICAgICAgY2FsbGJhY2sodXNlcmlkLCBjYy52di5iYXNlSW5mb01hcFt1c2VyaWRdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KCcvYmFzZV9pbmZvJywgeyB1c2VyaWQ6IHVzZXJpZCB9LCBmdW5jdGlvbiAocmV0KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChyZXQuaGVhZGltZ3VybCkge1xuICAgICAgICAgICAgICAgIHVybCA9IHJldC5oZWFkaW1ndXJsICsgXCIuanBnXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgICAgICBuYW1lOiByZXQubmFtZSxcbiAgICAgICAgICAgICAgICBzZXg6IHJldC5zZXgsXG4gICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYy52di5iYXNlSW5mb01hcFt1c2VyaWRdID0gaW5mbztcbiAgICAgICAgICAgIGNhbGxiYWNrKHVzZXJpZCwgaW5mbyk7XG4gICAgICAgIH0sIGNjLnZ2Lmh0dHAubWFzdGVyX3VybCk7XG4gICAgfVxufTtcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgdGhpcy5zZXR1cFNwcml0ZUZyYW1lKCk7XG4gICAgfSxcblxuICAgIHNldFVzZXJJRDogZnVuY3Rpb24gc2V0VXNlcklEKHVzZXJpZCkge1xuICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlID09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VyaWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2MudnYuaW1hZ2VzID09IG51bGwpIHtcbiAgICAgICAgICAgIGNjLnZ2LmltYWdlcyA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBnZXRCYXNlSW5mbyh1c2VyaWQsIGZ1bmN0aW9uIChjb2RlLCBpbmZvKSB7XG4gICAgICAgICAgICBpZiAoaW5mbyAmJiBpbmZvLnVybCkge1xuICAgICAgICAgICAgICAgIGxvYWRJbWFnZShpbmZvLnVybCwgdXNlcmlkLCBmdW5jdGlvbiAoZXJyLCBzcHJpdGVGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldHVwU3ByaXRlRnJhbWUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNldHVwU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIHNldHVwU3ByaXRlRnJhbWUoKSB7XG4gICAgICAgIGlmICh0aGlzLl9zcHJpdGVGcmFtZSkge1xuICAgICAgICAgICAgdmFyIHNwciA9IHRoaXMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICBpZiAoc3ByKSB7XG4gICAgICAgICAgICAgICAgc3ByLnNwcml0ZUZyYW1lID0gdGhpcy5fc3ByaXRlRnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnMTBhMWM4ano5NUp1NE5ucGtPV1VmaW4nLCAnSm9pbkdhbWVJbnB1dCcpO1xuLy8gc2NyaXB0cy9jb21wb25lbnRzL0pvaW5HYW1lSW5wdXQuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG51bXM6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5MYWJlbF1cbiAgICAgICAgfSxcbiAgICAgICAgX2lucHV0SW5kZXg6IDBcbiAgICB9LFxuXG4gICAgLy8gZm9vOiB7XG4gICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAvLyB9LFxuICAgIC8vIC4uLlxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge30sXG5cbiAgICBvbkVuYWJsZTogZnVuY3Rpb24gb25FbmFibGUoKSB7XG4gICAgICAgIHRoaXMub25SZXNldENsaWNrZWQoKTtcbiAgICB9LFxuXG4gICAgb25JbnB1dEZpbmlzaGVkOiBmdW5jdGlvbiBvbklucHV0RmluaXNoZWQocm9vbUlkKSB7XG4gICAgICAgIGNjLnZ2LnVzZXJNZ3IuZW50ZXJSb29tKHJvb21JZCwgKGZ1bmN0aW9uIChyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IFwi5oi/6Ze0W1wiICsgcm9vbUlkICsgXCJd5LiN5a2Y5Zyo77yM6K+36YeN5paw6L6T5YWlIVwiO1xuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBcIuaIv+mXtFtcIiArIHJvb21JZCArIFwiXeW3sua7oSFcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uUmVzZXRDbGlja2VkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBvbklucHV0OiBmdW5jdGlvbiBvbklucHV0KG51bSkge1xuICAgICAgICBpZiAodGhpcy5faW5wdXRJbmRleCA+PSB0aGlzLm51bXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5udW1zW3RoaXMuX2lucHV0SW5kZXhdLnN0cmluZyA9IG51bTtcbiAgICAgICAgdGhpcy5faW5wdXRJbmRleCArPSAxO1xuXG4gICAgICAgIGlmICh0aGlzLl9pbnB1dEluZGV4ID09IHRoaXMubnVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciByb29tSWQgPSB0aGlzLnBhcnNlUm9vbUlEKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm9rOlwiICsgcm9vbUlkKTtcbiAgICAgICAgICAgIHRoaXMub25JbnB1dEZpbmlzaGVkKHJvb21JZCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25OMENsaWNrZWQ6IGZ1bmN0aW9uIG9uTjBDbGlja2VkKCkge1xuICAgICAgICB0aGlzLm9uSW5wdXQoMCk7XG4gICAgfSxcbiAgICBvbk4xQ2xpY2tlZDogZnVuY3Rpb24gb25OMUNsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMub25JbnB1dCgxKTtcbiAgICB9LFxuICAgIG9uTjJDbGlja2VkOiBmdW5jdGlvbiBvbk4yQ2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5vbklucHV0KDIpO1xuICAgIH0sXG4gICAgb25OM0NsaWNrZWQ6IGZ1bmN0aW9uIG9uTjNDbGlja2VkKCkge1xuICAgICAgICB0aGlzLm9uSW5wdXQoMyk7XG4gICAgfSxcbiAgICBvbk40Q2xpY2tlZDogZnVuY3Rpb24gb25ONENsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMub25JbnB1dCg0KTtcbiAgICB9LFxuICAgIG9uTjVDbGlja2VkOiBmdW5jdGlvbiBvbk41Q2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5vbklucHV0KDUpO1xuICAgIH0sXG4gICAgb25ONkNsaWNrZWQ6IGZ1bmN0aW9uIG9uTjZDbGlja2VkKCkge1xuICAgICAgICB0aGlzLm9uSW5wdXQoNik7XG4gICAgfSxcbiAgICBvbk43Q2xpY2tlZDogZnVuY3Rpb24gb25ON0NsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMub25JbnB1dCg3KTtcbiAgICB9LFxuICAgIG9uTjhDbGlja2VkOiBmdW5jdGlvbiBvbk44Q2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5vbklucHV0KDgpO1xuICAgIH0sXG4gICAgb25OOUNsaWNrZWQ6IGZ1bmN0aW9uIG9uTjlDbGlja2VkKCkge1xuICAgICAgICB0aGlzLm9uSW5wdXQoOSk7XG4gICAgfSxcbiAgICBvblJlc2V0Q2xpY2tlZDogZnVuY3Rpb24gb25SZXNldENsaWNrZWQoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5udW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLm51bXNbaV0uc3RyaW5nID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pbnB1dEluZGV4ID0gMDtcbiAgICB9LFxuICAgIG9uRGVsQ2xpY2tlZDogZnVuY3Rpb24gb25EZWxDbGlja2VkKCkge1xuICAgICAgICBpZiAodGhpcy5faW5wdXRJbmRleCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2lucHV0SW5kZXggLT0gMTtcbiAgICAgICAgICAgIHRoaXMubnVtc1t0aGlzLl9pbnB1dEluZGV4XS5zdHJpbmcgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkNsb3NlQ2xpY2tlZDogZnVuY3Rpb24gb25DbG9zZUNsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgcGFyc2VSb29tSUQ6IGZ1bmN0aW9uIHBhcnNlUm9vbUlEKCkge1xuICAgICAgICB2YXIgc3RyID0gXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm51bXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHN0ciArPSB0aGlzLm51bXNbaV0uc3RyaW5nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnMzUwZDNSeTlhVklxSlIyN2ZQMkgvejEnLCAnTG9hZGluZ0xvZ2ljJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvTG9hZGluZ0xvZ2ljLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0aXBMYWJlbDogY2MuTGFiZWwsXG4gICAgICAgIF9zdGF0ZVN0cjogJycsXG4gICAgICAgIF9wcm9ncmVzczogMC4wLFxuICAgICAgICBfc3BsYXNoOiBudWxsLFxuICAgICAgICBfaXNMb2FkaW5nOiBmYWxzZVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICB2YXIgY3ZzID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5DYW52YXMpO1xuICAgICAgICAgICAgY3ZzLmZpdEhlaWdodCA9IHRydWU7XG4gICAgICAgICAgICBjdnMuZml0V2lkdGggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdE1ncigpO1xuICAgICAgICB0aGlzLnRpcExhYmVsLnN0cmluZyA9IHRoaXMuX3N0YXRlU3RyO1xuXG4gICAgICAgIHRoaXMuX3NwbGFzaCA9IGNjLmZpbmQoXCJDYW52YXMvc3BsYXNoXCIpO1xuICAgICAgICB0aGlzLl9zcGxhc2guYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL21qX2xvZ2luXCIsIDEsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ5b3VrZW9yd2VpeGluXCIsIGRhdGEuZGF0YS55b3VrZW9yd2VpeGluKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ5b3VrZW9yd2VpeGluXCIpID09IFwiMFwiICYmIGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL05ldyBMYWJlbFwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzdGFydDogZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIFNIT1dfVElNRSA9IDMwMDA7XG4gICAgICAgIHZhciBGQURFX1RJTUUgPSA1MDA7XG4gICAgICAgIGlmIChjYy5zeXMub3MgIT0gY2Muc3lzLk9TX0lPUyB8fCAhY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICBzZWxmLl9zcGxhc2guYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciB0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKCkge1xuICAgICAgICAgICAgICAgIHZhciBkdCA9IERhdGUubm93KCkgLSB0O1xuICAgICAgICAgICAgICAgIGlmIChkdCA8IFNIT1dfVElNRSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuLCAzMyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wID0gKDEgLSAoZHQgLSBTSE9XX1RJTUUpIC8gRkFERV9USU1FKSAqIDI1NTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3BsYXNoLm9wYWNpdHkgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGVja1ZlcnNpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NwbGFzaC5vcGFjaXR5ID0gb3A7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuLCAzMyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2V0VGltZW91dChmbiwgMzMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc3BsYXNoLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5jaGVja1ZlcnNpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0TWdyOiBmdW5jdGlvbiBpbml0TWdyKCkge1xuICAgICAgICBjYy52diA9IHt9O1xuICAgICAgICB2YXIgVXNlck1nciA9IHJlcXVpcmUoXCJVc2VyTWdyXCIpO1xuICAgICAgICBjYy52di51c2VyTWdyID0gbmV3IFVzZXJNZ3IoKTtcblxuICAgICAgICB2YXIgUmVwbGF5TWdyID0gcmVxdWlyZShcIlJlcGxheU1nclwiKTtcbiAgICAgICAgY2MudnYucmVwbGF5TWdyID0gbmV3IFJlcGxheU1ncigpO1xuXG4gICAgICAgIGNjLnZ2Lmh0dHAgPSByZXF1aXJlKFwiSFRUUFwiKTtcbiAgICAgICAgY2MudnYuZ2xvYmFsID0gcmVxdWlyZShcIkdsb2JhbFwiKTtcbiAgICAgICAgY2MudnYubmV0ID0gcmVxdWlyZShcIk5ldFwiKTtcblxuICAgICAgICB2YXIgR2FtZU5ldE1nciA9IHJlcXVpcmUoXCJHYW1lTmV0TWdyXCIpO1xuICAgICAgICBjYy52di5nYW1lTmV0TWdyID0gbmV3IEdhbWVOZXRNZ3IoKTtcbiAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5pbml0SGFuZGxlcnMoKTtcblxuICAgICAgICB2YXIgQW55c2RrTWdyID0gcmVxdWlyZShcIkFueXNka01nclwiKTtcbiAgICAgICAgY2MudnYuYW55c2RrTWdyID0gbmV3IEFueXNka01ncigpO1xuICAgICAgICBjYy52di5hbnlzZGtNZ3IuaW5pdCgpO1xuXG4gICAgICAgIHZhciBWb2ljZU1nciA9IHJlcXVpcmUoXCJWb2ljZU1nclwiKTtcbiAgICAgICAgY2MudnYudm9pY2VNZ3IgPSBuZXcgVm9pY2VNZ3IoKTtcbiAgICAgICAgY2MudnYudm9pY2VNZ3IuaW5pdCgpO1xuXG4gICAgICAgIHZhciBBdWRpb01nciA9IHJlcXVpcmUoXCJBdWRpb01nclwiKTtcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IgPSBuZXcgQXVkaW9NZ3IoKTtcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IuaW5pdCgpO1xuXG4gICAgICAgIHZhciBVdGlscyA9IHJlcXVpcmUoXCJVdGlsc1wiKTtcbiAgICAgICAgY2MudnYudXRpbHMgPSBuZXcgVXRpbHMoKTtcblxuICAgICAgICBjYy5hcmdzID0gdGhpcy51cmxQYXJzZSgpO1xuICAgIH0sXG5cbiAgICB1cmxQYXJzZTogZnVuY3Rpb24gdXJsUGFyc2UoKSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSB7fTtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYW1lLCB2YWx1ZTtcbiAgICAgICAgdmFyIHN0ciA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOyAvL+WPluW+l+aVtOS4quWcsOWdgOagj1xuICAgICAgICB2YXIgbnVtID0gc3RyLmluZGV4T2YoXCI/XCIpO1xuICAgICAgICBzdHIgPSBzdHIuc3Vic3RyKG51bSArIDEpOyAvL+WPluW+l+aJgOacieWPguaVsCAgIHN0cmluZ3Zhci5zdWJzdHIoc3RhcnQgWywgbGVuZ3RoIF1cblxuICAgICAgICB2YXIgYXJyID0gc3RyLnNwbGl0KFwiJlwiKTsgLy/lkITkuKrlj4LmlbDmlL7liLDmlbDnu4Tph4xcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG51bSA9IGFycltpXS5pbmRleE9mKFwiPVwiKTtcbiAgICAgICAgICAgIGlmIChudW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IGFycltpXS5zdWJzdHJpbmcoMCwgbnVtKTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGFycltpXS5zdWJzdHIobnVtICsgMSk7XG4gICAgICAgICAgICAgICAgcGFyYW1zW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9LFxuXG4gICAgY2hlY2tWZXJzaW9uOiBmdW5jdGlvbiBjaGVja1ZlcnNpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIG9uR2V0VmVyc2lvbiA9IGZ1bmN0aW9uIG9uR2V0VmVyc2lvbihyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQudmVyc2lvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvci5cIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLnZ2LlNJID0gcmV0O1xuICAgICAgICAgICAgICAgIGlmIChyZXQudmVyc2lvbiAhPSBjYy5WRVJTSU9OKSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvYWxlcnRcIikuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnN0YXJ0UHJlbG9hZGluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgeGhyID0gbnVsbDtcbiAgICAgICAgdmFyIGNvbXBsZXRlID0gZmFsc2U7XG4gICAgICAgIHZhciBmblJlcXVlc3QgPSBmdW5jdGlvbiBmblJlcXVlc3QoKSB7XG4gICAgICAgICAgICBzZWxmLl9zdGF0ZVN0ciA9IFwi5q2j5Zyo6L+e5o6l5pyN5Yqh5ZmoXCI7XG4gICAgICAgICAgICB4aHIgPSBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9zZXJ2ZXJpbmZvXCIsIG51bGwsIGZ1bmN0aW9uIChyZXQpIHtcbiAgICAgICAgICAgICAgICB4aHIgPSBudWxsO1xuICAgICAgICAgICAgICAgIGNvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBvbkdldFZlcnNpb24ocmV0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2V0VGltZW91dChmbiwgNTAwMCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24gZm4oKSB7XG4gICAgICAgICAgICBpZiAoIWNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhocikge1xuICAgICAgICAgICAgICAgICAgICB4aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3RhdGVTdHIgPSBcIui/nuaOpeWksei0pe+8jOWNs+WwhumHjeivlVwiO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmblJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZuKCk7XG4gICAgfSxcblxuICAgIG9uQnRuRG93bmxvYWRDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkRvd25sb2FkQ2xpY2tlZCgpIHtcbiAgICAgICAgY2Muc3lzLm9wZW5VUkwoY2MudnYuU0kuYXBwd2ViKTtcbiAgICB9LFxuXG4gICAgc3RhcnRQcmVsb2FkaW5nOiBmdW5jdGlvbiBzdGFydFByZWxvYWRpbmcoKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlU3RyID0gXCLmraPlnKjliqDovb3otYTmupDvvIzor7fnqI3lgJlcIjtcbiAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGNjLmxvYWRlci5vblByb2dyZXNzID0gZnVuY3Rpb24gKGNvbXBsZXRlZENvdW50LCB0b3RhbENvdW50LCBpdGVtKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiY29tcGxldGVkQ291bnQ6XCIgKyBjb21wbGV0ZWRDb3VudCArIFwiLHRvdGFsQ291bnQ6XCIgKyB0b3RhbENvdW50ICk7XG4gICAgICAgICAgICBpZiAoc2VsZi5faXNMb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fcHJvZ3Jlc3MgPSBjb21wbGV0ZWRDb3VudCAvIHRvdGFsQ291bnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXNBbGwoXCJ0ZXh0dXJlc1wiLCBmdW5jdGlvbiAoZXJyLCBhc3NldHMpIHtcbiAgICAgICAgICAgIHNlbGYub25Mb2FkQ29tcGxldGUoKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiBvbkxvYWRDb21wbGV0ZSgpIHtcbiAgICAgICAgdGhpcy5faXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3N0YXRlU3RyID0gXCLlh4blpIfnmbvpmYZcIjtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9naW5cIik7XG4gICAgICAgIGNjLmxvYWRlci5vbkNvbXBsZXRlID0gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkdCkge1xuICAgICAgICBpZiAodGhpcy5fc3RhdGVTdHIubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRpcExhYmVsLnN0cmluZyA9IHRoaXMuX3N0YXRlU3RyICsgJyAnO1xuICAgICAgICBpZiAodGhpcy5faXNMb2FkaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnRpcExhYmVsLnN0cmluZyArPSBNYXRoLmZsb29yKHRoaXMuX3Byb2dyZXNzICogMTAwKSArIFwiJVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAlIDQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQ7ICsraSkge1xuICAgICAgICAgICAgICAgIHRoaXMudGlwTGFiZWwuc3RyaW5nICs9ICcuJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnNTcyYTdRZmg2OU45WkxYa050aEFOZmknLCAnTG9naW4nKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9Mb2dpbi5qc1xuXG5TdHJpbmcucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxICYmIHR5cGVvZiBhcmdzID09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmdzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoe1wiICsga2V5ICsgXCJ9KVwiLCBcImdcIik7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocmVnLCBhcmdzW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzW2ldID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIih7W1wiICsgaSArIFwiXX0pXCIsIFwiZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocmVnLCBhcmd1bWVudHNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn07XG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX21pbWE6IG51bGwsXG4gICAgICAgIF9taW1hSW5kZXg6IDAsXG4gICAgICAgIG1qZGw6IDEgfSxcblxuICAgIC8v77+96b2r77+977+9wrzvv73Du++/vdCt77+96aOs1rvvv73Que+/vdGh77+977+9xaXvv73Ov82177+9wrzvv73vv73Oou+/vcW177+9wrzvv73Fv++/ve+/vdS977+9yKVcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICB2YXIgY3ZzID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5DYW52YXMpO1xuICAgICAgICAgICAgY3ZzLmZpdEhlaWdodCA9IHRydWU7XG4gICAgICAgICAgICBjdnMuZml0V2lkdGggPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjYy52dikge1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9hZGluZ1wiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYy52di5odHRwLnVybCA9IGNjLnZ2Lmh0dHAubWFzdGVyX3VybDtcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoJ3B1c2hfbmVlZF9jcmVhdGVfcm9sZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib25Mb2FkOnB1c2hfbmVlZF9jcmVhdGVfcm9sZVwiKTtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImNyZWF0ZXJvbGVcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlCR00oXCJiZ01haW4ubXAzXCIpO1xuXG4gICAgICAgIHRoaXMuX21pbWEgPSBbXCJBXCIsIFwiQVwiLCBcIkJcIiwgXCJCXCIsIFwiQVwiLCBcIkJcIiwgXCJBXCIsIFwiQlwiLCBcIkFcIiwgXCJBXCIsIFwiQVwiLCBcIkJcIiwgXCJCXCIsIFwiQlwiXTtcblxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSB8fCBjYy5zeXMub3MgPT0gY2Muc3lzLk9TX1dJTkRPV1MpIHtcbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvYnRuX3lrXCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgeW91a2VvcndlaXhpbiA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInlvdWtlb3J3ZWl4aW5cIik7XG4gICAgICAgIC8v5a6J5Y2T5Y+q5pi+56S65b6u5L+h55m76ZmGXG4gICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxhdGZvcm06XCIgKyBjYy5zeXMuT1NfQU5EUk9JRCArIFwiIE9TX0FORFJPSUQuXCIpO1xuICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9idG5feWtcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3pfd2VpeGluZGVuZ2x1XCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy9JT1PlrqHmoLjniYjmnKwg5Y+q5pi+56S65ri45a6i55m75b2VIOi/h+WuoeeJiOacrCDlj6rmmL7npLrlvq7kv6HnmbvpmYZcbiAgICAgICAgZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXRmb3JtOlwiICsgY2Muc3lzLk9TX0lPUyArIFwiIE9TX0lPUy5cIik7XG4gICAgICAgICAgICAgICAgaWYgKHlvdWtlb3J3ZWl4aW4gPT0gXCIwXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9idG5feWtcIikuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy96X3dlaXhpbmRlbmdsdVwiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy95aHh5XCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh5b3VrZW9yd2VpeGluID09IFwiMVwiIHx8IHlvdWtlb3J3ZWl4aW4gPT0gXCJudWxsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy96X3dlaXhpbmRlbmdsdVwiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2J0bl95a1wiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvYnRuX3lrXCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy96X3dlaXhpbmRlbmdsdVwiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxhdGZvcm06XCIgKyBjYy5zeXMub3MgKyBcIiBkb3NuJ3QgaW1wbGVtZW50IHNoYXJlLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgICB2YXIgYWNjb3VudCA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInd4X2FjY291bnRcIik7XG4gICAgICAgIHZhciBzaWduID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwid3hfc2lnblwiKTtcbiAgICAgICAgaWYgKGFjY291bnQgIT0gbnVsbCAmJiBzaWduICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSB7XG4gICAgICAgICAgICAgICAgZXJyY29kZTogMCxcbiAgICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LFxuICAgICAgICAgICAgICAgIHNpZ246IHNpZ25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYy52di51c2VyTWdyLm9uQXV0aChyZXQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkJ0blJldHVybjogZnVuY3Rpb24gb25CdG5SZXR1cm4oKSB7XG4gICAgICAgIHZhciB5aHh5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWh4eVwiKTtcbiAgICAgICAgeWh4eS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIGNoZWNrX21hcms6IGZ1bmN0aW9uIGNoZWNrX21hcmsoKSB7XG4gICAgICAgIHZhciB0eXloeHkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0eXloeHlcIik7XG4gICAgICAgIHZhciBidG5fY2hlY2tib3ggPSB0eXloeHkuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fY2hlY2tib3hcIik7XG4gICAgICAgIHZhciBjaGVja19tYXJrID0gYnRuX2NoZWNrYm94LmdldENoaWxkQnlOYW1lKFwiY2hlY2tfbWFya1wiKTtcbiAgICAgICAgaWYgKHRoaXMubWpkbCA9PSAxKSB7XG4gICAgICAgICAgICBjaGVja19tYXJrLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5tamRsID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoZWNrX21hcmsuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubWpkbCA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCJ0aGlzLm1qZGw6XCIgKyB0aGlzLm1qZGwpO1xuICAgIH0sXG4gICAgeW9uZ2h1eGlleWk6IGZ1bmN0aW9uIHlvbmdodXhpZXlpKCkge1xuXG4gICAgICAgIHZhciB5aHh5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWh4eVwiKTtcbiAgICAgICAgeWh4eS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG4gICAgcHJvbXB0OiBmdW5jdGlvbiBwcm9tcHQoKSB7XG4gICAgICAgIHZhciBwcm9tcHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9tcHRcIik7XG4gICAgICAgIHByb21wdC5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuICAgIG9uQnRuUXVpY2tTdGFydENsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuUXVpY2tTdGFydENsaWNrZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLm1qZGwgPT0gMCkge1xuICAgICAgICAgICAgdmFyIHByb21wdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInByb21wdFwiKTtcbiAgICAgICAgICAgIHByb21wdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKFwic3N5XCIpO1xuXG4gICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ3Vlc3RBdXRoKCk7XG4gICAgfSxcblxuICAgIG9uQnRuV2VpY2hhdENsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuV2VpY2hhdENsaWNrZWQoKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAoc2VsZi5tamRsID09IDApIHtcbiAgICAgICAgICAgIHZhciBwcm9tcHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9tcHRcIik7XG4gICAgICAgICAgICBwcm9tcHQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcInNzXCIpO1xuICAgICAgICBjYy52di5hbnlzZGtNZ3IubG9naW4oKTtcbiAgICB9LFxuXG4gICAgb25CdG5NSU1BQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5NSU1BQ2xpY2tlZChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5fbWltYVt0aGlzLl9taW1hSW5kZXhdID09IGV2ZW50LnRhcmdldC5uYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9taW1hSW5kZXgrKztcbiAgICAgICAgICAgIGlmICh0aGlzLl9taW1hSW5kZXggPT0gdGhpcy5fbWltYS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2J0bl95a1wiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJvaCBob35+flwiKTtcbiAgICAgICAgICAgIHRoaXMuX21pbWFJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc3ZmE4ZmN2cnFGT2o2bGhoNnhIemQzYycsICdNSkdhbWUnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9NSkdhbWUuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGdhbWVSb290OiB7XG4gICAgICAgICAgICBcImRlZmF1bHRcIjogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcblxuICAgICAgICBwcmVwYXJlUm9vdDoge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG5cbiAgICAgICAgX215TUpBcnI6IFtdLFxuICAgICAgICBfb3B0aW9uczogbnVsbCxcbiAgICAgICAgX3NlbGVjdGVkTUo6IG51bGwsXG4gICAgICAgIF9jaHVwYWlTcHJpdGU6IFtdLFxuICAgICAgICBfbWpjb3VudDogbnVsbCxcbiAgICAgICAgX2dhbWVjb3VudDogbnVsbCxcbiAgICAgICAgX2h1cGFpVGlwczogW10sXG4gICAgICAgIF9odXBhaUxpc3RzOiBbXSxcbiAgICAgICAgX3BsYXlFZnhzOiBbXSxcbiAgICAgICAgX29wdHM6IFtdLFxuICAgICAgICBfZ2FtZXR5cGU6IG51bGxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlICYmIGNjLnN5cy5pc01vYmlsZSkge1xuICAgICAgICAgICAgdmFyIGN2cyA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuQ2FudmFzKTtcbiAgICAgICAgICAgIGN2cy5maXRIZWlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgY3ZzLmZpdFdpZHRoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNjLnZ2KSB7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJsb2FkaW5nXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiTm90aWNlVGlwXCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIkdhbWVPdmVyXCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIkRpbmdRdWVcIik7XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiUGVuZ0dhbmdzXCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIk1KUm9vbVwiKTtcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJUaW1lUG9pbnRlclwiKTtcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJHYW1lUmVzdWx0XCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIkNoYXRcIik7XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiRm9sZHNcIik7XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiUmVwbGF5Q3RybFwiKTtcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJQb3B1cE1nclwiKTtcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJIdWFuU2FuWmhhbmdcIik7XG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiUmVDb25uZWN0XCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlZvaWNlXCIpO1xuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlVzZXJJbmZvU2hvd1wiKTtcblxuICAgICAgICB0aGlzLmluaXRWaWV3KCk7XG4gICAgICAgIHRoaXMuaW5pdEV2ZW50SGFuZGxlcnMoKTtcblxuICAgICAgICB0aGlzLmdhbWVSb290LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByZXBhcmVSb290LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuaW5pdFdhbmZhTGFiZWwoKTtcbiAgICAgICAgdGhpcy5vbkdhbWVCZWlnbigpO1xuICAgICAgICBjYy52di5hdWRpb01nci5wbGF5QkdNKFwiYmdNYWluLm1wM1wiKTtcblxuICAgICAgICAvL+a3oeWFpVxuICAgICAgICB2YXIgZmFkZWluID0gY2MuZmFkZUluKDAuMSk7XG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oZmFkZWluKTtcbiAgICB9LFxuXG4gICAgaW5pdFZpZXc6IGZ1bmN0aW9uIGluaXRWaWV3KCkge1xuXG4gICAgICAgIC8v5pCc57Si6ZyA6KaB55qE5a2Q6IqC54K5XG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xuXG4gICAgICAgIHRoaXMuX21qY291bnQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoJ21qY291bnQnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICB0aGlzLl9tamNvdW50LnN0cmluZyA9IFwi5Ymp5L2ZXCIgKyBjYy52di5nYW1lTmV0TWdyLm51bU9mTUogKyBcIuW8oFwiO1xuICAgICAgICB0aGlzLl9nYW1lY291bnQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoJ2dhbWVjb3VudCcpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgIHN3aXRjaCAoY2MudnYuZ2FtZU5ldE1nci5mZW5neGlhbmcpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1lY291bnQuc3RyaW5nID0gXCLkuJzpo47lnIhcIjticmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1lY291bnQuc3RyaW5nID0gXCLljZfpo47lnIhcIjticmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1lY291bnQuc3RyaW5nID0gXCLopb/po47lnIhcIjticmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1lY291bnQuc3RyaW5nID0gXCLljJfpo47lnIhcIjticmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2dhbWV0eXBlID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKCdnYW1ldHlwZScpO1xuICAgICAgICBzd2l0Y2ggKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwic2ptbWpcIjpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1ldHlwZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5rKI5a626Zeo6bq75bCGXCI7YnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZGhtalwiOlxuICAgICAgICAgICAgICAgIHRoaXMuX2dhbWV0eXBlLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLlrprmtbfpurvlsIZcIjticmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0ZGhcIjpcbiAgICAgICAgICAgICAgICB0aGlzLl9nYW1ldHlwZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5o6o5Yiw6IOhXCI7YnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbXlzZWxmQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJteXNlbGZcIik7XG4gICAgICAgIHZhciBteWhvbGRzID0gbXlzZWxmQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJob2xkc1wiKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG15aG9sZHMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBteWhvbGRzLmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgdGhpcy5fbXlNSkFyci5wdXNoKHNwcml0ZSk7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlYWx3aWR0aCA9IGNjLmRpcmVjdG9yLmdldFZpc2libGVTaXplKCkud2lkdGg7XG4gICAgICAgIG15aG9sZHMuc2NhbGVYICo9IHJlYWx3aWR0aCAvIDEyODA7XG4gICAgICAgIG15aG9sZHMuc2NhbGVZICo9IHJlYWx3aWR0aCAvIDEyODA7XG5cbiAgICAgICAgdmFyIHNpZGVzID0gW1wibXlzZWxmXCIsIFwicmlnaHRcIiwgXCJ1cFwiLCBcImxlZnRcIl07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2lkZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzaWRlID0gc2lkZXNbaV07XG5cbiAgICAgICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XG4gICAgICAgICAgICB0aGlzLl9odXBhaVRpcHMucHVzaChzaWRlQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJIdVBhaVwiKSk7XG4gICAgICAgICAgICB0aGlzLl9odXBhaUxpc3RzLnB1c2goc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiaHVwYWlsaXN0XCIpKTtcbiAgICAgICAgICAgIHRoaXMuX3BsYXlFZnhzLnB1c2goc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwicGxheV9lZnhcIikuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikpO1xuICAgICAgICAgICAgdGhpcy5fY2h1cGFpU3ByaXRlLnB1c2goc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiQ2h1UGFpXCIpLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpKTtcblxuICAgICAgICAgICAgdmFyIG9wdCA9IHNpZGVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm9wdFwiKTtcbiAgICAgICAgICAgIG9wdC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBvcHQuZ2V0Q2hpbGRCeU5hbWUoXCJwYWlcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBub2RlOiBvcHQsXG4gICAgICAgICAgICAgICAgc3ByaXRlOiBzcHJpdGVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLl9vcHRzLnB1c2goZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb3B0cyA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm9wc1wiKTtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdHM7XG4gICAgICAgIHRoaXMuaGlkZU9wdGlvbnMoKTtcbiAgICAgICAgdGhpcy5oaWRlQ2h1cGFpKCk7XG4gICAgfSxcblxuICAgIGhpZGVDaHVwYWk6IGZ1bmN0aW9uIGhpZGVDaHVwYWkoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2h1cGFpU3ByaXRlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLl9jaHVwYWlTcHJpdGVbaV0ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0RXZlbnRIYW5kbGVyczogZnVuY3Rpb24gaW5pdEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZGF0YUV2ZW50SGFuZGxlciA9IHRoaXMubm9kZTtcblxuICAgICAgICAvL+WIneWni+WMluS6i+S7tuebkeWQrOWZqFxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2hvbGRzJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XG4gICAgICAgICAgICBzZWxmLmNoZWNrUXVlWWlNZW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYucGxheVNoYXppKCk7XG4gICAgICAgICAgICBzZWxmLm9uR2FtZUJlaWduKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfc3luYycsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLm9uR2FtZUJlaWduKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2h1cGFpJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRldGFpbDtcbiAgICAgICAgICAgIHNlbGYuaGlkZUNodXBhaSgpO1xuICAgICAgICAgICAgc2VsZi5jaGVja1F1ZVlpTWVuKCk7XG4gICAgICAgICAgICBpZiAoZGF0YS5sYXN0ICE9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoZGF0YS5sYXN0LCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgJiYgZGF0YS50dXJuICE9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoZGF0YS50dXJuLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9tb3BhaScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRldGFpbDtcbiAgICAgICAgICAgIHZhciBwYWkgPSBkYXRhLnBhaTtcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGRhdGEuc2VhdEluZGV4KTtcbiAgICAgICAgICAgIGlmIChsb2NhbEluZGV4ID09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAxMztcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gc2VsZi5fbXlNSkFycltpbmRleF07XG4gICAgICAgICAgICAgICAgc2VsZi5zZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHNwcml0ZSwgcGFpLCBpbmRleCk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUubWpJZCA9IHBhaTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRNb3BhaShkYXRhLnNlYXRJbmRleCwgcGFpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2FjdGlvbicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLnNob3dBY3Rpb24oZGF0YS5kZXRhaWwpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJnYW1lX2FjdGlvblwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gdGhpcy5ub2RlLm9uKCdnYW1lX2ZlbmcnLGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAvLyAgICAgc2VsZi5fZ2FtZWNvdW50XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcImdhbWVfZmVuZ1wiKTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdodXBhaScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgLy/lpoLmnpzkuI3mmK/njqnlrrboh6rlt7HvvIzliJnlsIbnjqnlrrbnmoTniYzpg73mlL7lgJJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBkYXRhLnNlYXRpbmRleDtcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXRJbmRleCk7XG4gICAgICAgICAgICB2YXIgaHVwYWkgPSBzZWxmLl9odXBhaVRpcHNbbG9jYWxJbmRleF07XG4gICAgICAgICAgICBodXBhaS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAobG9jYWxJbmRleCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRlT3B0aW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0c1tzZWF0SW5kZXhdO1xuICAgICAgICAgICAgc2VhdERhdGEuaHVlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUgPT0gXCJ4bGNoXCIpIHtcbiAgICAgICAgICAgICAgICBodXBhaS5nZXRDaGlsZEJ5TmFtZShcInNwckh1XCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJaaW1vXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNlbGYuaW5pdEh1cGFpKGxvY2FsSW5kZXgsIGRhdGEuaHVwYWkpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmlzemltbykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWF0RGF0YS5ob2xkcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJIdVwiKS5hY3RpdmUgPSAhZGF0YS5pc3ppbW87XG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJaaW1vXCIpLmFjdGl2ZSA9IGRhdGEuaXN6aW1vO1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoZGF0YS5pc3ppbW8gJiYgbG9jYWxJbmRleCA9PSAwKSkge1xuICAgICAgICAgICAgICAgICAgICAvL2lmKGNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpID09IGZhbHNlICYmIGxvY2FsSW5kZXggIT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIHNlbGYuaW5pdEVtcHR5U3ByaXRlcyhzZWF0SW5kZXgpOyAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoc2VhdEluZGV4LCBkYXRhLmh1cGFpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjYy52di5yZXBsYXlNZ3IuaXNSZXBsYXkoKSA9PSB0cnVlICYmIGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlICE9IFwieGxjaFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdCA9IHNlbGYuX29wdHNbbG9jYWxJbmRleF07XG4gICAgICAgICAgICAgICAgb3B0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBvcHQuc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIGRhdGEuaHVwYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGF0YS5pc3ppbW8pIHtcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X3ppbW9cIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYucGxheUVmeChsb2NhbEluZGV4LCBcInBsYXlfaHVcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJudi9odS5tcDNcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignbWpfY291bnQnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5fbWpjb3VudC5zdHJpbmcgPSBcIuWJqeS9mVwiICsgY2MudnYuZ2FtZU5ldE1nci5udW1PZk1KICsgXCLlvKBcIjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX251bScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdnYW1lX251bSEhISEhISEhISEnK2NjLnZ2LmdhbWVOZXRNZ3IuZmVuZ3hpYW5nKTtcbiAgICAgICAgICAgIC8vIHN3aXRjaChjYy52di5nYW1lTmV0TWdyLmZlbmd4aWFuZykge1xuICAgICAgICAgICAgLy8gICAgIGNhc2UgMDpcbiAgICAgICAgICAgIC8vICAgICAgICAgc2VsZi5fZ2FtZWNvdW50LnN0cmluZyA9IFwi5Lic6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAvLyAgICAgY2FzZSAxOlxuICAgICAgICAgICAgLy8gICAgICAgICBzZWxmLl9nYW1lY291bnQuc3RyaW5nID0gXCLljZfpo47lnIhcIjticmVhaztcbiAgICAgICAgICAgIC8vICAgICBjYXNlIDI6XG4gICAgICAgICAgICAvLyAgICAgICAgIHNlbGYuX2dhbWVjb3VudC5zdHJpbmcgPSBcIuilv+mjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgLy8gICAgIGNhc2UgMzpcbiAgICAgICAgICAgIC8vICAgICAgICAgc2VsZi5fZ2FtZWNvdW50LnN0cmluZyA9IFwi5YyX6aOO5ZyIXCI7YnJlYWs7XG5cbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2ZlbmcnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbWVfbnVtISEhISEhISEhIScgKyBjYy52di5nYW1lTmV0TWdyLmZlbmd4aWFuZyk7XG4gICAgICAgICAgICBzd2l0Y2ggKGNjLnZ2LmdhbWVOZXRNZ3IuZmVuZ3hpYW5nKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9nYW1lY291bnQuc3RyaW5nID0gXCLkuJzpo47lnIhcIjticmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2dhbWVjb3VudC5zdHJpbmcgPSBcIuWNl+mjjuWciFwiO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2FtZWNvdW50LnN0cmluZyA9IFwi6KW/6aOO5ZyIXCI7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9nYW1lY291bnQuc3RyaW5nID0gXCLljJfpo47lnIhcIjticmVhaztcblxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfb3ZlcicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmdhbWVSb290LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgc2VsZi5wcmVwYXJlUm9vdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2h1cGFpX25vdGlmeScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuZGV0YWlsLnNlYXREYXRhO1xuICAgICAgICAgICAgLy/lpoLmnpzmmK/oh6rlt7HvvIzliJnliLfmlrDmiYvniYxcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRNYWhqb25ncygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuc2hvd0NodXBhaSgpO1xuICAgICAgICAgICAgdmFyIGF1ZGlvVXJsID0gY2MudnYubWFoam9uZ21nci5nZXRBdWRpb1VSTEJ5TUpJRChkYXRhLmRldGFpbC5wYWkpO1xuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChhdWRpb1VybCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ3VvX25vdGlmeScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgLy/lpoLmnpzmmK/oh6rlt7HvvIzliJnliLfmlrDmiYvniYxcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRNYWhqb25ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChcImdpdmUubXAzXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2d1b19yZXN1bHQnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5oaWRlT3B0aW9ucygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZGluZ3F1ZV9maW5pc2gnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdwZW5nX25vdGlmeScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcblxuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGVuZ19ub3RpZnknKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgaWYgKHNlYXREYXRhLnNlYXRpbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCkge1xuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE90aGVyTWFoam9uZ3Moc2VhdERhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBzZWxmLmdldExvY2FsSW5kZXgoc2VhdERhdGEuc2VhdGluZGV4KTtcbiAgICAgICAgICAgIHNlbGYucGxheUVmeChsb2NhbEluZGV4LCBcInBsYXlfcGVuZ1wiKTtcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJudi9wZW5nLm1wM1wiKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjaGlfbm90aWZ5JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGlfbm90aWZ5Jyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZUNodXBhaSgpO1xuXG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBkYXRhLmRldGFpbDtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHNlbGYuZ2V0TG9jYWxJbmRleChzZWF0RGF0YS5zZWF0aW5kZXgpO1xuICAgICAgICAgICAgc2VsZi5wbGF5RWZ4KGxvY2FsSW5kZXgsIFwicGxheV9jaGlcIik7XG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5wbGF5U0ZYKFwibnYvY2hpLm1wM1wiKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdidWh1YV9ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2J1aHVhX25vdGlmeScpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5kZXRhaWwuaG9sZHMpO1xuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FuZ19ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5oaWRlQ2h1cGFpKCk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gZGF0YS5zZWF0RGF0YTtcbiAgICAgICAgICAgIHZhciBnYW5ndHlwZSA9IGRhdGEuZ2FuZ3R5cGU7XG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gc2VsZi5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XG4gICAgICAgICAgICBpZiAoZ2FuZ3R5cGUgPT0gXCJ3YW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X2dhbmdcIik7XG4gICAgICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChcImd1YWZlbmcubXAzXCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X2dhbmdcIik7XG4gICAgICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChcInJhaW4ubXAzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oXCJoYW5nYW5nX25vdGlmeVwiLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gc2VsZi5nZXRMb2NhbEluZGV4KGRhdGEpO1xuICAgICAgICAgICAgc2VsZi5wbGF5RWZ4KGxvY2FsSW5kZXgsIFwicGxheV9nYW5nXCIpO1xuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChcIm52L2dhbmcubXAzXCIpO1xuICAgICAgICAgICAgc2VsZi5oaWRlT3B0aW9ucygpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgc2hvd0NodXBhaTogZnVuY3Rpb24gc2hvd0NodXBhaSgpIHtcbiAgICAgICAgdmFyIHBhaSA9IGNjLnZ2LmdhbWVOZXRNZ3IuY2h1cGFpO1xuICAgICAgICBpZiAocGFpID49IDApIHtcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHRoaXMuZ2V0TG9jYWxJbmRleChjYy52di5nYW1lTmV0TWdyLnR1cm4pO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX2NodXBhaVNwcml0ZVtsb2NhbEluZGV4XTtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBhZGRPcHRpb246IGZ1bmN0aW9uIGFkZE9wdGlvbihidG5OYW1lLCBwYWksIGNoaXR5cGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCLlvLnlh7rmk43kvZzmoYZcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKGJ0bk5hbWUpO1xuICAgICAgICBjb25zb2xlLmxvZyhwYWkpO1xuICAgICAgICAvL+a3u+WKoOWQg+eJjOeahOS4ieenjeaWueW8j1xuICAgICAgICAvL3ZhciBzdHIgPSBwYWkuc3BsaXQoXCJfXCIpO1xuICAgICAgICAvL3ZhciBwYWluYW1lID0gc3RyWzBdO1xuICAgICAgICAvL3ZhciBwYWludW0gPSBzdHJbMV07XG4gICAgICAgIGlmIChjaGl0eXBlICYmIGNoaXR5cGUubGVmdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICB2YXIgb3AgPSB0aGlzLl9vcHRpb25zLmdldENoaWxkQnlOYW1lKFwiY2hpb3BcIikuZ2V0Q2hpbGRCeU5hbWUoXCJsZWZ0XCIpO1xuICAgICAgICAgICAgb3AuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBvcC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSArIDEpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSArIDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoaXR5cGUgJiYgY2hpdHlwZS5taWQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIG9wID0gdGhpcy5fb3B0aW9ucy5nZXRDaGlsZEJ5TmFtZShcImNoaW9wXCIpLmdldENoaWxkQnlOYW1lKFwibWlkXCIpO1xuICAgICAgICAgICAgb3AuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBvcC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkgLSAxKTtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBvcC5jaGlsZHJlblsxXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGl0eXBlICYmIGNoaXR5cGUucmlnaHQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIG9wID0gdGhpcy5fb3B0aW9ucy5nZXRDaGlsZEJ5TmFtZShcImNoaW9wXCIpLmdldENoaWxkQnlOYW1lKFwicmlnaHRcIik7XG4gICAgICAgICAgICBvcC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSAtIDIpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSAtIDEpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG9wLmNoaWxkcmVuWzJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSk7XG4gICAgICAgIH1cbiAgICAgICAgLy/lhbbku5ZcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9vcHRpb25zLmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5fb3B0aW9ucy5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgIGlmIChjaGlsZC5uYW1lID09IFwib3BcIiAmJiBjaGlsZC5hY3RpdmUgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBjaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm9wVGFyZ2V0XCIpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBwYWkpO1xuICAgICAgICAgICAgICAgIHZhciBidG4gPSBjaGlsZC5nZXRDaGlsZEJ5TmFtZShidG5OYW1lKTtcbiAgICAgICAgICAgICAgICBidG4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBidG4ucGFpID0gcGFpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBoaWRlT3B0aW9uczogZnVuY3Rpb24gaGlkZU9wdGlvbnMoZGF0YSkge1xuICAgICAgICB0aGlzLl9vcHRpb25zLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX29wdGlvbnMuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLl9vcHRpb25zLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUgPT0gXCJvcFwiKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJidG5QZW5nXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwiYnRuR2FuZ1wiKS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjaGlsZC5nZXRDaGlsZEJ5TmFtZShcImJ0bkh1XCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwiYnRuQ2hpXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUgPT0gXCJjaGlvcFwiKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJsZWZ0XCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwibWlkXCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwicmlnaHRcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0FjdGlvbjogZnVuY3Rpb24gc2hvd0FjdGlvbihkYXRhKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2hvdyBhY3Rpb25cIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX29wdGlvbnMuYWN0aXZlKTtcbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGVPcHRpb25zKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGF0YSAmJiAoZGF0YS5odSB8fCBkYXRhLmdhbmcgfHwgZGF0YS5wZW5nIHx8IGRhdGEuY2hpKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5jaGkpO1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGRhdGEuaHUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE9wdGlvbihcImJ0bkh1XCIsIGRhdGEucGFpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLnBlbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE9wdGlvbihcImJ0blBlbmdcIiwgZGF0YS5wYWkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGF0YS5nYW5nKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmdhbmdwYWkubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdwID0gZGF0YS5nYW5ncGFpW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZE9wdGlvbihcImJ0bkdhbmdcIiwgZ3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGRhdGEuY2hpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPcHRpb24oXCJidG5DaGlcIiwgZGF0YS5wYWksIGRhdGEuY2hpdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coZGF0YS5jaGkpO1xuICAgIH0sXG5cbiAgICBpbml0V2FuZmFMYWJlbDogZnVuY3Rpb24gaW5pdFdhbmZhTGFiZWwoKSB7XG4gICAgICAgIHZhciB3YW5mYSA9IGNjLmZpbmQoXCJDYW52YXMvaW5mb2Jhci93YW5mYVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICB3YW5mYS5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLmdldFdhbmZhKCk7XG4gICAgfSxcblxuICAgIGluaXRIdXBhaTogZnVuY3Rpb24gaW5pdEh1cGFpKGxvY2FsSW5kZXgsIHBhaSkge1xuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUgPT0gXCJ4bGNoXCIpIHtcbiAgICAgICAgICAgIHZhciBodXBhaWxpc3QgPSB0aGlzLl9odXBhaUxpc3RzW2xvY2FsSW5kZXhdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBodXBhaWxpc3QuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgaHVwYWlub2RlID0gaHVwYWlsaXN0LmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgIGlmIChodXBhaW5vZGUuYWN0aXZlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmUgPSBjYy52di5tYWhqb25nbWdyLmdldEZvbGRQcmUobG9jYWxJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGh1cGFpbm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBwYWkpO1xuICAgICAgICAgICAgICAgICAgICBodXBhaW5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlFZng6IGZ1bmN0aW9uIHBsYXlFZngoaW5kZXgsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5fcGxheUVmeHNbaW5kZXhdLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcGxheUVmeHNbaW5kZXhdLnBsYXkobmFtZSk7XG4gICAgfSxcblxuICAgIHBsYXlTaGF6aTogZnVuY3Rpb24gcGxheVNoYXppKCkge1xuICAgICAgICB2YXIgYW5pbTEgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpLmdldENoaWxkQnlOYW1lKFwic2hhaXppXCIpLmdldENoaWxkQnlOYW1lKFwic2hhaXppMVwiKS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgYW5pbTEucGxheShcInNoYWl6aVwiKTtcbiAgICAgICAgdmFyIGFuaW0yID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKS5nZXRDaGlsZEJ5TmFtZShcInNoYWl6aVwiKS5nZXRDaGlsZEJ5TmFtZShcInNoYWl6aTJcIikuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGFuaW0yLnBsYXkoXCJzaGFpemkyXCIpO1xuICAgICAgICB0aGlzLm9uZmluaXNoZWQoZmFsc2UpO1xuICAgICAgICBhbmltMi5vbihcImZpbmlzaGVkXCIsIHRoaXMub25maW5pc2hlZCwgdGhpcyk7XG4gICAgfSxcblxuICAgIG9uZmluaXNoZWQ6IGZ1bmN0aW9uIG9uZmluaXNoZWQoaXNzaG93KSB7XG4gICAgICAgIHZhciBzaG93ID0gdHJ1ZTtcbiAgICAgICAgaXNzaG93ID09IGZhbHNlID8gc2hvdyA9IGZhbHNlIDoge307XG4gICAgICAgIHZhciBzaWRlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKS5nZXRDaGlsZEJ5TmFtZShcIm15c2VsZlwiKTtcbiAgICAgICAgc2lkZS5nZXRDaGlsZEJ5TmFtZShcImh1YXNcIikuYWN0aXZlID0gc2hvdztcbiAgICAgICAgc2lkZS5nZXRDaGlsZEJ5TmFtZShcImhvbGRzXCIpLmFjdGl2ZSA9IHNob3c7XG4gICAgICAgIHZhciBzaWRlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKS5nZXRDaGlsZEJ5TmFtZShcImxlZnRcIik7XG4gICAgICAgIHNpZGUuZ2V0Q2hpbGRCeU5hbWUoXCJodWFzXCIpLmFjdGl2ZSA9IHNob3c7XG4gICAgICAgIHNpZGUuZ2V0Q2hpbGRCeU5hbWUoXCJob2xkc1wiKS5hY3RpdmUgPSBzaG93O1xuICAgICAgICB2YXIgc2lkZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIikuZ2V0Q2hpbGRCeU5hbWUoXCJ1cFwiKTtcbiAgICAgICAgc2lkZS5nZXRDaGlsZEJ5TmFtZShcImh1YXNcIikuYWN0aXZlID0gc2hvdztcbiAgICAgICAgc2lkZS5nZXRDaGlsZEJ5TmFtZShcImhvbGRzXCIpLmFjdGl2ZSA9IHNob3c7XG4gICAgICAgIHZhciBzaWRlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKS5nZXRDaGlsZEJ5TmFtZShcInJpZ2h0XCIpO1xuICAgICAgICBzaWRlLmdldENoaWxkQnlOYW1lKFwiaHVhc1wiKS5hY3RpdmUgPSBzaG93O1xuICAgICAgICBzaWRlLmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIikuYWN0aXZlID0gc2hvdztcbiAgICB9LFxuXG4gICAgb25HYW1lQmVpZ246IGZ1bmN0aW9uIG9uR2FtZUJlaWduKCkge1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fcGxheUVmeHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMuX3BsYXlFZnhzW2ldLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2h1cGFpTGlzdHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5faHVwYWlMaXN0c1tpXS5jaGlsZHJlbkNvdW50OyArK2opIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9odXBhaUxpc3RzW2ldLmNoaWxkcmVuW2pdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYy52di5nYW1lTmV0TWdyLnNlYXRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW2ldO1xuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaSk7XG4gICAgICAgICAgICB2YXIgaHVwYWkgPSB0aGlzLl9odXBhaVRpcHNbbG9jYWxJbmRleF07XG4gICAgICAgICAgICBodXBhaS5hY3RpdmUgPSBzZWF0RGF0YS5odWVkO1xuICAgICAgICAgICAgaWYgKHNlYXREYXRhLmh1ZWQpIHtcbiAgICAgICAgICAgICAgICBodXBhaS5nZXRDaGlsZEJ5TmFtZShcInNwckh1XCIpLmFjdGl2ZSA9ICFzZWF0RGF0YS5pc3ppbW87XG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJaaW1vXCIpLmFjdGl2ZSA9IHNlYXREYXRhLmlzemltbztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNlYXREYXRhLmh1aW5mbykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2VhdERhdGEuaHVpbmZvLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0gc2VhdERhdGEuaHVpbmZvW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5pc2h1cGFpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRIdXBhaShsb2NhbEluZGV4LCBpbmZvLnBhaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmhpZGVDaHVwYWkoKTtcbiAgICAgICAgdGhpcy5oaWRlT3B0aW9ucygpO1xuICAgICAgICB2YXIgc2lkZXMgPSBbXCJyaWdodFwiLCBcInVwXCIsIFwibGVmdFwiXTtcbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2lkZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZXNbaV0pO1xuICAgICAgICAgICAgdmFyIGhvbGRzID0gc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGhvbGRzLmNoaWxkcmVuQ291bnQ7ICsraikge1xuICAgICAgICAgICAgICAgIHZhciBuYyA9IGhvbGRzLmNoaWxkcmVuW2pdO1xuICAgICAgICAgICAgICAgIG5jLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgbmMuc2NhbGVYID0gMS4wO1xuICAgICAgICAgICAgICAgIG5jLnNjYWxlWSA9IDEuMDtcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gbmMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5ob2xkc0VtcHR5W2kgKyAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmdhbWVzdGF0ZSA9PSBcIlwiICYmIGNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmdhbWVSb290LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucHJlcGFyZVJvb3QuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5pdE1haGpvbmdzKCk7XG4gICAgICAgIHZhciBzZWF0cyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHM7XG4gICAgICAgIGZvciAodmFyIGkgaW4gc2VhdHMpIHtcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IHNlYXRzW2ldO1xuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaSk7XG4gICAgICAgICAgICBpZiAobG9jYWxJbmRleCAhPSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKGkgPT0gY2MudnYuZ2FtZU5ldE1nci50dXJuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdE1vcGFpKGksIC0xKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRNb3BhaShpLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaG93Q2h1cGFpKCk7XG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmN1cmFjdGlvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dBY3Rpb24oY2MudnYuZ2FtZU5ldE1nci5jdXJhY3Rpb24pO1xuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jdXJhY3Rpb24gPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jaGVja1F1ZVlpTWVuKCk7XG4gICAgfSxcblxuICAgIG9uTUpDbGlja2VkOiBmdW5jdGlvbiBvbk1KQ2xpY2tlZChldmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImV2ZW50XCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhldmVudCk7XG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmlzSHVhblNhblpoYW5nKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuZW1pdChcIm1qX2NsaWNrZWRcIiwgZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5aaC5p6c5LiN5piv6Ieq5bex55qE6L2u5a2Q77yM5YiZ5b+955WlXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnR1cm4gIT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibm90IHlvdXIgdHVybi5cIiArIGNjLnZ2LmdhbWVOZXRNZ3IudHVybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX215TUpBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQgPT0gdGhpcy5fbXlNSkFycltpXS5ub2RlKSB7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzmmK/lho3mrKHngrnlh7vvvIzliJnlh7rniYxcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09IHRoaXMuX3NlbGVjdGVkTUopIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG9vdCh0aGlzLl9zZWxlY3RlZE1KLm1qSWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RlZE1KLnkgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RlZE1KID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2VsZWN0ZWRNSiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkTUoueSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC55ID0gMTU7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRNSiA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/lpoLmnpzmkbjliLDnmoTniYzmmK/oirHvvIzliJnkvJrosIPnlKjov5nkuKrlh73mlbBcbiAgICBjaHVodWE6IChmdW5jdGlvbiAoX2NodWh1YSkge1xuICAgICAgICBmdW5jdGlvbiBjaHVodWEoX3gpIHtcbiAgICAgICAgICAgIHJldHVybiBfY2h1aHVhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cblxuICAgICAgICBjaHVodWEudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2NodWh1YS50b1N0cmluZygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBjaHVodWE7XG4gICAgfSkoZnVuY3Rpb24gKG1qaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coY2h1aHVhKTtcbiAgICB9KSxcblxuICAgIC8v5Ye654mMXG4gICAgc2hvb3Q6IGZ1bmN0aW9uIHNob290KG1qSWQpIHtcbiAgICAgICAgaWYgKG1qSWQgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdjaHVwYWknLCBtaklkKTtcbiAgICB9LFxuXG4gICAgZ2V0TUpJbmRleDogZnVuY3Rpb24gZ2V0TUpJbmRleChzaWRlLCBpbmRleCkge1xuICAgICAgICBpZiAoc2lkZSA9PSBcInJpZ2h0XCIgfHwgc2lkZSA9PSBcInVwXCIpIHtcbiAgICAgICAgICAgIHJldHVybiAxMyAtIGluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9LFxuXG4gICAgaW5pdE1vcGFpOiBmdW5jdGlvbiBpbml0TW9wYWkoc2VhdEluZGV4LCBwYWkpIHtcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoc2VhdEluZGV4KTtcbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XG4gICAgICAgIHZhciBwcmUgPSBjYy52di5tYWhqb25nbWdyLmdldEZvbGRQcmUobG9jYWxJbmRleCk7XG5cbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XG4gICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XG4gICAgICAgIHZhciBob2xkcyA9IHNpZGVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcImhvbGRzXCIpO1xuXG4gICAgICAgIHZhciBsYXN0SW5kZXggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgMTMpO1xuICAgICAgICB2YXIgbmMgPSBob2xkcy5jaGlsZHJlbltsYXN0SW5kZXhdO1xuXG4gICAgICAgIG5jLnNjYWxlWCA9IDEuMDtcbiAgICAgICAgbmMuc2NhbGVZID0gMS4wO1xuXG4gICAgICAgIGlmIChwYWkgPT0gbnVsbCkge1xuICAgICAgICAgICAgbmMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSBpZiAocGFpID49IDApIHtcbiAgICAgICAgICAgIG5jLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAoc2lkZSA9PSBcInVwXCIpIHtcbiAgICAgICAgICAgICAgICBuYy5zY2FsZVggPSAwLjczO1xuICAgICAgICAgICAgICAgIG5jLnNjYWxlWSA9IDAuNzM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gbmMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgcGFpKTtcbiAgICAgICAgfSBlbHNlIGlmIChwYWkgIT0gbnVsbCkge1xuICAgICAgICAgICAgbmMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xuICAgICAgICAgICAgICAgIG5jLnNjYWxlWCA9IDEuMDtcbiAgICAgICAgICAgICAgICBuYy5zY2FsZVkgPSAxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gbmMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldEhvbGRzRW1wdHlTcHJpdGVGcmFtZShzaWRlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0RW1wdHlTcHJpdGVzOiBmdW5jdGlvbiBpbml0RW1wdHlTcHJpdGVzKHNlYXRJbmRleCkge1xuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChzZWF0SW5kZXgpO1xuICAgICAgICB2YXIgc2lkZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U2lkZShsb2NhbEluZGV4KTtcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcblxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcbiAgICAgICAgdmFyIHNpZGVDaGlsZCA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShzaWRlKTtcbiAgICAgICAgdmFyIGhvbGRzID0gc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIik7XG4gICAgICAgIHZhciBzcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0RW1wdHlTcHJpdGVGcmFtZShzaWRlKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob2xkcy5jaGlsZHJlbkNvdW50OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuYyA9IGhvbGRzLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgbmMuc2NhbGVYID0gMS4wO1xuICAgICAgICAgICAgbmMuc2NhbGVZID0gMS4wO1xuXG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gbmMuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0T3RoZXJNYWhqb25nczogZnVuY3Rpb24gaW5pdE90aGVyTWFoam9uZ3Moc2VhdERhdGEpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInNlYXQ6XCIgKyBzZWF0RGF0YS5zZWF0aW5kZXgpO1xuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHRoaXMuZ2V0TG9jYWxJbmRleChzZWF0RGF0YS5zZWF0aW5kZXgpO1xuICAgICAgICBpZiAobG9jYWxJbmRleCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XG4gICAgICAgIHZhciBnYW1lID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcbiAgICAgICAgdmFyIHNpZGVSb290ID0gZ2FtZS5nZXRDaGlsZEJ5TmFtZShzaWRlKTtcbiAgICAgICAgdmFyIHNpZGVIb2xkcyA9IHNpZGVSb290LmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIik7XG4gICAgICAgIHZhciBudW0gPSBzZWF0RGF0YS5wZW5ncy5sZW5ndGggKyBzZWF0RGF0YS5hbmdhbmdzLmxlbmd0aCArIHNlYXREYXRhLmRpYW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS53YW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS5jaGlzLmxlbmd0aDtcbiAgICAgICAgbnVtICo9IDM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgaSk7XG4gICAgICAgICAgICBzaWRlSG9sZHMuY2hpbGRyZW5baWR4XS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwcmUgPSBjYy52di5tYWhqb25nbWdyLmdldEZvbGRQcmUobG9jYWxJbmRleCk7XG4gICAgICAgIHZhciBob2xkcyA9IHRoaXMuc29ydEhvbGRzKHNlYXREYXRhKTtcbiAgICAgICAgaWYgKGhvbGRzICE9IG51bGwgJiYgaG9sZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob2xkcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgaSArIG51bSk7XG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHNpZGVIb2xkcy5jaGlsZHJlbltpZHhdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICAgICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVggPSAwLjczO1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVkgPSAwLjczO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBob2xkc1tpXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChob2xkcy5sZW5ndGggKyBudW0gPT0gMTMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGFzZXRJZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgMTMpO1xuICAgICAgICAgICAgICAgIHNpZGVIb2xkcy5jaGlsZHJlbltsYXNldElkeF0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc29ydEhvbGRzOiBmdW5jdGlvbiBzb3J0SG9sZHMoc2VhdERhdGEpIHtcbiAgICAgICAgdmFyIGhvbGRzID0gc2VhdERhdGEuaG9sZHM7XG4gICAgICAgIGlmIChob2xkcyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAvL+WmguaenOaJi+S4iueahOeJjOeahOaVsOebruaYrzIsNSw4LDExLDE077yM6KGo56S65pyA5ZCO5LiA5byg54mM5piv5Yia5pG45Yiw55qE54mMXG4gICAgICAgIHZhciBtb3BhaSA9IG51bGw7XG4gICAgICAgIHZhciBsID0gaG9sZHMubGVuZ3RoO1xuICAgICAgICBpZiAobCA9PSAyIHx8IGwgPT0gNSB8fCBsID09IDggfHwgbCA9PSAxMSB8fCBsID09IDE0KSB7XG4gICAgICAgICAgICBtb3BhaSA9IGhvbGRzLnBvcCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRpbmdxdWUgPSBzZWF0RGF0YS5kaW5ncXVlO1xuICAgICAgICBjYy52di5tYWhqb25nbWdyLnNvcnRNSihob2xkcywgZGluZ3F1ZSk7XG5cbiAgICAgICAgLy/lsIbmkbjniYzmt7vliqDliLDmnIDlkI5cbiAgICAgICAgaWYgKG1vcGFpICE9IG51bGwpIHtcbiAgICAgICAgICAgIGhvbGRzLnB1c2gobW9wYWkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBob2xkcztcbiAgICB9LFxuXG4gICAgaW5pdE1haGpvbmdzOiBmdW5jdGlvbiBpbml0TWFoam9uZ3MoKSB7XG4gICAgICAgIHZhciBzZWF0cyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHM7XG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHNlYXRzW2NjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4XTtcbiAgICAgICAgdmFyIGhvbGRzID0gdGhpcy5zb3J0SG9sZHMoc2VhdERhdGEpO1xuICAgICAgICBpZiAoaG9sZHMgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKHNlYXRzKTtcbiAgICAgICAgLy/liJ3lp4vljJbmiYvniYxcbiAgICAgICAgdmFyIGxhY2tpbmdOdW0gPSAoc2VhdERhdGEuY2hpcy5sZW5ndGggKyBzZWF0RGF0YS5wZW5ncy5sZW5ndGggKyBzZWF0RGF0YS5hbmdhbmdzLmxlbmd0aCArIHNlYXREYXRhLmRpYW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS53YW5nYW5ncy5sZW5ndGgpICogMztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob2xkcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIG1qaWQgPSBob2xkc1tpXTtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2kgKyBsYWNraW5nTnVtXTtcbiAgICAgICAgICAgIHNwcml0ZS5ub2RlLm1qSWQgPSBtamlkO1xuICAgICAgICAgICAgc3ByaXRlLm5vZGUueSA9IDA7XG4gICAgICAgICAgICB0aGlzLnNldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgc3ByaXRlLCBtamlkKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhY2tpbmdOdW07ICsraSkge1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XG4gICAgICAgICAgICBzcHJpdGUubm9kZS5taklkID0gbnVsbDtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XG4gICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gbGFja2luZ051bSArIGhvbGRzLmxlbmd0aDsgaSA8IHRoaXMuX215TUpBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xuICAgICAgICAgICAgc3ByaXRlLm5vZGUubWpJZCA9IG51bGw7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0U3ByaXRlRnJhbWVCeU1KSUQ6IGZ1bmN0aW9uIHNldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgc3ByaXRlLCBtamlkKSB7XG4gICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBtamlkKTtcbiAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLy/lpoLmnpznjqnlrrbmiYvkuIrov5jmnInnvLrnmoTniYzmsqHmnInmiZPvvIzliJnlj6rog73miZPnvLrniYxcbiAgICBjaGVja1F1ZVlpTWVuOiBmdW5jdGlvbiBjaGVja1F1ZVlpTWVuKCkge1xuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mID09IG51bGwgfHwgY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUgIT0gXCJ4bGNoXCIgfHwgIWNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VsZkRhdGEoKS5odWVkKSB7XG4gICAgICAgICAgICAvL+mBjeWOhuajgOafpeeci+aYr+WQpuacieacquaJk+e8uueahOeJjCDlpoLmnpzmnInvvIzliJnpnIDopoHlsIbkuI3mmK/lrprnvLrnmoTniYzorr7nva7kuLrkuI3lj6/nlKhcbiAgICAgICAgICAgIHZhciBkaW5ncXVlID0gY2MudnYuZ2FtZU5ldE1nci5kaW5ncXVlO1xuICAgICAgICAgICAgLy8gICAgICAgIGNvbnNvbGUubG9nKGRpbmdxdWUpXG4gICAgICAgICAgICB2YXIgaGFzUXVlID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci50dXJuKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9teU1KQXJyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNwcml0ZS5ub2RlLm1qSWQ6XCIgKyBzcHJpdGUubm9kZS5taklkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNwcml0ZS5ub2RlLm1qSWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBjYy52di5tYWhqb25nbWdyLmdldE1haGpvbmdUeXBlKHNwcml0ZS5ub2RlLm1qSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gZGluZ3F1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1F1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhcImhhc1F1ZTpcIiArIGhhc1F1ZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX215TUpBcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5fbXlNSkFycltpXTtcbiAgICAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubWpJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gY2MudnYubWFoam9uZ21nci5nZXRNYWhqb25nVHlwZShzcHJpdGUubm9kZS5taklkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhhc1F1ZSAmJiB0eXBlICE9IGRpbmdxdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnR1cm4pIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE0OyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gaSA9PSAxMztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUuYWN0aXZlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0TG9jYWxJbmRleDogZnVuY3Rpb24gZ2V0TG9jYWxJbmRleChpbmRleCkge1xuICAgICAgICB2YXIgcmV0ID0gKGluZGV4IC0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXggKyA0KSAlIDQ7XG4gICAgICAgIC8vY29uc29sZS5sb2coXCJvbGQ6XCIgKyBpbmRleCArIFwiLGJhc2U6XCIgKyBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCArIFwiLG5ldzpcIiArIHJldCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIG9uT3B0aW9uQ2xpY2tlZDogZnVuY3Rpb24gb25PcHRpb25DbGlja2VkKGV2ZW50KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5uYW1lKTtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuUGVuZ1wiKSB7XG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcInBlbmdcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5HYW5nXCIpIHtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ2FuZ1wiLCBldmVudC50YXJnZXQucGFpKTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkh1XCIpIHtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiaHVcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy/miZPlvIDlkIPoj5zljZVcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5DaGlcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuZ2V0Q2hpbGRCeU5hbWUoXCJjaGlvcFwiKS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9vcHRpb25zLmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLl9vcHRpb25zLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGQubmFtZSA9PSBcIm9wXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/lt6blkINcbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwibGVmdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiY2hpXCIsIFwibGVmdFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy/kuK3lkINcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm1pZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImNoaVwiLCBcIm1pZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL+WPs+WQg1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImNoaVwiLCBcInJpZ2h0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkd1b1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJndW9cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHt9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiBvbkRlc3Ryb3koKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwib25EZXN0cm95XCIpO1xuICAgICAgICBpZiAoY2MudnYpIHtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnOTIxZGZRSlpkZEorNUdGVVhxeG1NbVQnLCAnTUpSb29tJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvTUpSb29tLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYmxSb29tTm86IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcbiAgICAgICAgfSxcbiAgICAgICAgX3NlYXRzOiBbXSxcbiAgICAgICAgX3NlYXRzMjogW10sXG4gICAgICAgIF90aW1lTGFiZWw6IG51bGwsXG4gICAgICAgIF92b2ljZU1zZ1F1ZXVlOiBbXSxcbiAgICAgICAgX2xhc3RQbGF5aW5nU2VhdDogbnVsbCxcbiAgICAgICAgX3BsYXlpbmdTZWF0OiBudWxsLFxuICAgICAgICBfbGFzdFBsYXlUaW1lOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbml0VmlldygpO1xuICAgICAgICB0aGlzLmluaXRTZWF0cygpO1xuICAgICAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XG5cbiAgICAgICAgdmFyIHlvdWtlb3J3ZWl4aW4gPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ5b3VrZW9yd2VpeGluXCIpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MgJiYgeW91a2VvcndlaXhpbiA9PSBcIjBcIikge1xuICAgICAgICAgICAgLy/pmpDol4/mmL7npLrkuIvovrnmjInpkq5cbiAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXMvcHJlcGFyZS9idG5XZWljaGF0XCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluaXRWaWV3OiBmdW5jdGlvbiBpbml0VmlldygpIHtcbiAgICAgICAgdmFyIHByZXBhcmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwcmVwYXJlXCIpO1xuICAgICAgICB2YXIgc2VhdHMgPSBwcmVwYXJlLmdldENoaWxkQnlOYW1lKFwic2VhdHNcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdHMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzLnB1c2goc2VhdHMuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiU2VhdFwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlZnJlc2hCdG5zKCk7XG5cbiAgICAgICAgdGhpcy5sYmxSb29tTm8gPSBjYy5maW5kKFwiQ2FudmFzL2luZm9iYXIvc2hpamlhbi9aX3Jvb21fdHh0L05ldyBMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICB0aGlzLl90aW1lTGFiZWwgPSBjYy5maW5kKFwiQ2FudmFzL2luZm9iYXIvc2hpamlhbi90aW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG5cbiAgICAgICAgLy/mmL7npLrnjqnms5VcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9pbmZvYmFyL3dhbmZhXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY2MudnYuZ2FtZU5ldE1nci5nZXRXYW5mYSgpO1xuXG4gICAgICAgIHRoaXMubGJsUm9vbU5vLnN0cmluZyA9IGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkO1xuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcbiAgICAgICAgdmFyIHNpZGVzID0gW1wibXlzZWxmXCIsIFwicmlnaHRcIiwgXCJ1cFwiLCBcImxlZnRcIl07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2lkZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBzaWRlTm9kZSA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShzaWRlc1tpXSk7XG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNpZGVOb2RlLmdldENoaWxkQnlOYW1lKFwic2VhdFwiKTtcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzMi5wdXNoKHNlYXQuZ2V0Q29tcG9uZW50KFwiU2VhdFwiKSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYnRuV2VjaGF0ID0gY2MuZmluZChcIkNhbnZhcy9wcmVwYXJlL2J0bldlaWNoYXRcIik7XG4gICAgICAgIGlmIChidG5XZWNoYXQpIHtcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuV2VjaGF0LCB0aGlzLm5vZGUsIFwiTUpSb29tXCIsIFwib25CdG5XZWljaGF0Q2xpY2tlZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciB0aXRsZXMgPSBjYy5maW5kKFwiQ2FudmFzL3R5cGVUaXRsZVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aXRsZXMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHRpdGxlcy5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmNvbmYpIHtcbiAgICAgICAgICAgIC8vVE9ETzrmjaLmiJDnm7jlupTlrZfmoLdcbiAgICAgICAgICAgIC8vIHZhciB0eXBlID0gY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGU7XG4gICAgICAgICAgICAvLyBpZih0eXBlID09IG51bGwgfHwgdHlwZSA9PSBcIlwiKXtcbiAgICAgICAgICAgIC8vICAgICB0eXBlID0gXCJ4emRkXCI7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyB0aXRsZXMuZ2V0Q2hpbGRCeU5hbWUodHlwZSkuYWN0aXZlID0gdHJ1ZTsgIFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlZnJlc2hCdG5zOiBmdW5jdGlvbiByZWZyZXNoQnRucygpIHtcbiAgICAgICAgdmFyIHByZXBhcmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwcmVwYXJlXCIpO1xuICAgICAgICB2YXIgYnRuRXhpdCA9IHByZXBhcmUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5FeGl0XCIpO1xuICAgICAgICB2YXIgYnRuRGlzcHJlc3MgPSBwcmVwYXJlLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzc29sdmVcIik7XG4gICAgICAgIHZhciBidG5XZWljaGF0ID0gcHJlcGFyZS5nZXRDaGlsZEJ5TmFtZShcImJ0bldlaWNoYXRcIik7XG4gICAgICAgIHZhciBidG5CYWNrID0gcHJlcGFyZS5nZXRDaGlsZEJ5TmFtZShcImJ0bkJhY2tcIik7XG4gICAgICAgIHZhciBpc0lkbGUgPSBjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgPT0gMDtcbiAgICAgICAgY29uc29sZS5sb2coJ2lzSWRsZScgKyBpc0lkbGUpO1xuICAgICAgICBjb25zb2xlLmxvZyhjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMpO1xuICAgICAgICBidG5FeGl0LmFjdGl2ZSA9ICFjYy52di5nYW1lTmV0TWdyLmlzT3duZXIoKSAmJiBpc0lkbGU7XG4gICAgICAgIGJ0bkRpc3ByZXNzLmFjdGl2ZSA9IGNjLnZ2LmdhbWVOZXRNZ3IuaXNPd25lcigpICYmIGlzSWRsZTtcblxuICAgICAgICBidG5XZWljaGF0LmFjdGl2ZSA9IGlzSWRsZTtcbiAgICAgICAgYnRuQmFjay5hY3RpdmUgPSBpc0lkbGU7XG4gICAgfSxcblxuICAgIGluaXRFdmVudEhhbmRsZXJzOiBmdW5jdGlvbiBpbml0RXZlbnRIYW5kbGVycygpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oJ25ld191c2VyJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdFNpbmdsZVNlYXQoZGF0YS5kZXRhaWwpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ3VzZXJfc3RhdGVfY2hhbmdlZCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmluaXRTaW5nbGVTZWF0KGRhdGEuZGV0YWlsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYucmVmcmVzaEJ0bnMoKTtcbiAgICAgICAgICAgIHNlbGYuaW5pdFNlYXRzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9udW0nLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgc2VsZi5yZWZyZXNoQnRucygpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfaHVhbnBhaScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX3NlYXRzMikge1xuICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzMltpXS5yZWZyZXNoWHVhblBhaVN0YXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignaHVhbnBhaV9ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIGlkeCA9IGRhdGEuZGV0YWlsLnNlYXRpbmRleDtcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChpZHgpO1xuICAgICAgICAgICAgc2VsZi5fc2VhdHMyW2xvY2FsSWR4XS5yZWZyZXNoWHVhblBhaVN0YXRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9odWFucGFpX292ZXInLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9zZWF0czIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9zZWF0czJbaV0ucmVmcmVzaFh1YW5QYWlTdGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ3ZvaWNlX21zZycsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgc2VsZi5fdm9pY2VNc2dRdWV1ZS5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgc2VsZi5wbGF5Vm9pY2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjaGF0X3B1c2gnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZGF0YS5zZW5kZXIpO1xuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChkYXRhLmNvbnRlbnQpO1xuICAgICAgICAgICAgc2VsZi5fc2VhdHMyW2xvY2FsSWR4XS5jaGF0KGRhdGEuY29udGVudCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbigncXVpY2tfY2hhdF9wdXNoJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChpZHgpO1xuXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBkYXRhLmNvbnRlbnQ7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IGNjLnZ2LmNoYXQuZ2V0UXVpY2tDaGF0SW5mbyhpbmRleCk7XG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChpbmZvLmNvbnRlbnQpO1xuICAgICAgICAgICAgc2VsZi5fc2VhdHMyW2xvY2FsSWR4XS5jaGF0KGluZm8uY29udGVudCk7XG5cbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoaW5mby5zb3VuZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZW1vamlfcHVzaCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgdmFyIGlkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XG4gICAgICAgICAgICB2YXIgbG9jYWxJZHggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaWR4KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgc2VsZi5fc2VhdHNbbG9jYWxJZHhdLmVtb2ppKGRhdGEuY29udGVudCk7XG4gICAgICAgICAgICBzZWxmLl9zZWF0czJbbG9jYWxJZHhdLmVtb2ppKGRhdGEuY29udGVudCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBpbml0U2VhdHM6IGZ1bmN0aW9uIGluaXRTZWF0cygpIHtcbiAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5pbml0U2luZ2xlU2VhdChzZWF0c1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdFNpbmdsZVNlYXQ6IGZ1bmN0aW9uIGluaXRTaW5nbGVTZWF0KHNlYXQpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXQuc2VhdGluZGV4KTtcbiAgICAgICAgdmFyIGlzT2ZmbGluZSA9ICFzZWF0Lm9ubGluZTtcbiAgICAgICAgdmFyIGlzWmh1YW5nID0gc2VhdC5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5idXR0b247XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJpc09mZmxpbmU6XCIgKyBpc09mZmxpbmUpO1xuXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRJbmZvKHNlYXQubmFtZSwgc2VhdC5zY29yZSk7XG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRSZWFkeShzZWF0LnJlYWR5KTtcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldE9mZmxpbmUoaXNPZmZsaW5lKTtcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldElEKHNlYXQudXNlcmlkKTtcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnZvaWNlTXNnKGZhbHNlKTtcblxuICAgICAgICB0aGlzLl9zZWF0czJbaW5kZXhdLnNldEluZm8oc2VhdC5uYW1lLCBzZWF0LnNjb3JlKTtcbiAgICAgICAgdGhpcy5fc2VhdHMyW2luZGV4XS5zZXRaaHVhbmcoaXNaaHVhbmcpO1xuICAgICAgICB0aGlzLl9zZWF0czJbaW5kZXhdLnNldE9mZmxpbmUoaXNPZmZsaW5lKTtcbiAgICAgICAgdGhpcy5fc2VhdHMyW2luZGV4XS5zZXRJRChzZWF0LnVzZXJpZCk7XG4gICAgICAgIHRoaXMuX3NlYXRzMltpbmRleF0udm9pY2VNc2coZmFsc2UpO1xuICAgICAgICB0aGlzLl9zZWF0czJbaW5kZXhdLnJlZnJlc2hYdWFuUGFpU3RhdGUoKTtcbiAgICB9LFxuXG4gICAgb25CdG5TZXR0aW5nc0NsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuU2V0dGluZ3NDbGlja2VkKCkge1xuICAgICAgICBjYy52di5wb3B1cE1nci5zaG93U2V0dGluZ3MoKTtcbiAgICB9LFxuXG4gICAgb25CdG5CYWNrQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5CYWNrQ2xpY2tlZCgpIHtcbiAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIui/lOWbnuWkp+WOhVwiLCBcIui/lOWbnuWkp+WOheaIv+mXtOS7jeS8muS/neeVme+8jOW/q+WOu+mCgOivt+Wkp+S8meadpeeOqeWQp++8gVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJoYWxsXCIpO1xuICAgICAgICB9LCB0cnVlKTtcbiAgICB9LFxuXG4gICAgb25CdG5DaGF0Q2xpY2tlZDogZnVuY3Rpb24gb25CdG5DaGF0Q2xpY2tlZCgpIHt9LFxuXG4gICAgb25CdG5XZWljaGF0Q2xpY2tlZDogZnVuY3Rpb24gb25CdG5XZWljaGF0Q2xpY2tlZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlID09IFwic2ptbWpcIikge1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gXCI85rKI5a626Zeo6bq75bCGPlwiO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZi50eXBlID09IFwiZGhtalwiKSB7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBcIjzlrprmtbfpurvlsIY+XCI7XG4gICAgICAgIH0gZWxzZSBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUgPT0gXCJ0ZGhcIikge1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gXCI85o6o5YCS6IOhPlwiO1xuICAgICAgICB9XG4gICAgICAgIC8vY2MudnYuYW55c2RrTWdyLnNoYXJlKFwi5aWH5aWH6Iif5bGx6bq75bCGXCIgKyB0aXRsZSxcIuaIv+WPtzpcIiArIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkICsgXCIg546p5rOVOlwiICsgY2MudnYuZ2FtZU5ldE1nci5nZXRXYW5mYSgpKTtcbiAgICAgICAgY2MudnYuYW55c2RrTWdyLnNoYXJlKFwi5aWH5aWH6Iif5bGx6bq75bCGXCIgKyB0aXRsZSArIFwiIOaIv+WPtzrjgJBcIiArIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkICsgXCLjgJFcIiwgXCLnjqnms5U6XCIgKyBjYy52di5nYW1lTmV0TWdyLmdldFdhbmZhKCkpO1xuICAgIH0sXG5cbiAgICBvbkJ0bkRpc3NvbHZlQ2xpY2tlZDogZnVuY3Rpb24gb25CdG5EaXNzb2x2ZUNsaWNrZWQoKSB7XG4gICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLop6PmlaPmiL/pl7RcIiwgXCLop6PmlaPmiL/pl7TkuI3miaPmiL/ljaHvvIzmmK/lkKbnoa7lrprop6PmlaPvvJ9cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJkaXNwcmVzc1wiKTtcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgfSxcblxuICAgIG9uQnRuRXhpdDogZnVuY3Rpb24gb25CdG5FeGl0KCkge1xuICAgICAgICBjYy52di5uZXQuc2VuZChcImV4aXRcIik7XG4gICAgfSxcblxuICAgIHBsYXlWb2ljZTogZnVuY3Rpb24gcGxheVZvaWNlKCkge1xuICAgICAgICBpZiAodGhpcy5fcGxheWluZ1NlYXQgPT0gbnVsbCAmJiB0aGlzLl92b2ljZU1zZ1F1ZXVlLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJwbGF5Vm9pY2UyXCIpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl92b2ljZU1zZ1F1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XG4gICAgICAgICAgICB0aGlzLl9wbGF5aW5nU2VhdCA9IGxvY2FsSW5kZXg7XG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyh0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzMltsb2NhbEluZGV4XS52b2ljZU1zZyh0cnVlKTtcblxuICAgICAgICAgICAgdmFyIG1zZ0luZm8gPSBKU09OLnBhcnNlKGRhdGEuY29udGVudCk7XG5cbiAgICAgICAgICAgIHZhciBtc2dmaWxlID0gXCJ2b2ljZW1zZy5hbXJcIjtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZ0luZm8ubXNnLmxlbmd0aCk7XG4gICAgICAgICAgICBjYy52di52b2ljZU1nci53cml0ZVZvaWNlKG1zZ2ZpbGUsIG1zZ0luZm8ubXNnKTtcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLnBsYXkobXNnZmlsZSk7XG4gICAgICAgICAgICB0aGlzLl9sYXN0UGxheVRpbWUgPSBEYXRlLm5vdygpICsgbXNnSW5mby50aW1lO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHtcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwIC8gNjApO1xuICAgICAgICBpZiAodGhpcy5fbGFzdE1pbnV0ZSAhPSBtaW51dGVzKSB7XG4gICAgICAgICAgICB0aGlzLl9sYXN0TWludXRlID0gbWludXRlcztcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIHZhciBoID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgaCA9IGggPCAxMCA/IFwiMFwiICsgaCA6IGg7XG5cbiAgICAgICAgICAgIHZhciBtID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICBtID0gbSA8IDEwID8gXCIwXCIgKyBtIDogbTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBcIlwiICsgaCArIFwiOlwiICsgbTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9sYXN0UGxheVRpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgPiB0aGlzLl9sYXN0UGxheVRpbWUgKyAyMDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uUGxheWVyT3ZlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RQbGF5VGltZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBsYXlWb2ljZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uUGxheWVyT3ZlcjogZnVuY3Rpb24gb25QbGF5ZXJPdmVyKCkge1xuICAgICAgICBjYy52di5hdWRpb01nci5yZXN1bWVBbGwoKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJvblBsYXlDYWxsYmFjazpcIiArIHRoaXMuX3BsYXlpbmdTZWF0KTtcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSB0aGlzLl9wbGF5aW5nU2VhdDtcbiAgICAgICAgdGhpcy5fcGxheWluZ1NlYXQgPSBudWxsO1xuICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyhmYWxzZSk7XG4gICAgICAgIHRoaXMuX3NlYXRzMltsb2NhbEluZGV4XS52b2ljZU1zZyhmYWxzZSk7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gb25EZXN0cm95KCkge1xuICAgICAgICBjYy52di52b2ljZU1nci5zdG9wKCk7XG4gICAgICAgIC8vICAgICAgICBjYy52di52b2ljZU1nci5vblBsYXlDYWxsYmFjayA9IG51bGw7XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICcwZWNlYTZYK0lGSUs1WEZkSmUzOGhYYScsICdNYWhqb25nTWdyJyk7XG4vLyBzY3JpcHRzL01haGpvbmdNZ3IuanNcblxudmFyIG1haGpvbmdTcHJpdGVzID0gW107XG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsZWZ0QXRsYXM6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcbiAgICAgICAgfSxcblxuICAgICAgICByaWdodEF0bGFzOiB7XG4gICAgICAgICAgICBcImRlZmF1bHRcIjogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUF0bGFzXG4gICAgICAgIH0sXG5cbiAgICAgICAgYm90dG9tQXRsYXM6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcbiAgICAgICAgfSxcblxuICAgICAgICBib3R0b21Gb2xkQXRsYXM6IHtcbiAgICAgICAgICAgIFwiZGVmYXVsdFwiOiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcbiAgICAgICAgfSxcblxuICAgICAgICBwZW5nUHJlZmFiU2VsZjoge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcbiAgICAgICAgfSxcblxuICAgICAgICBwZW5nUHJlZmFiTGVmdDoge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcbiAgICAgICAgfSxcblxuICAgICAgICBlbXB0eUF0bGFzOiB7XG4gICAgICAgICAgICBcImRlZmF1bHRcIjogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUF0bGFzXG4gICAgICAgIH0sXG5cbiAgICAgICAgaG9sZHNFbXB0eToge1xuICAgICAgICAgICAgXCJkZWZhdWx0XCI6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLlNwcml0ZUZyYW1lXVxuICAgICAgICB9LFxuXG4gICAgICAgIF9zaWRlczogbnVsbCxcbiAgICAgICAgX3ByZXM6IG51bGwsXG4gICAgICAgIF9mb2xkUHJlczogbnVsbFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zaWRlcyA9IFtcIm15c2VsZlwiLCBcInJpZ2h0XCIsIFwidXBcIiwgXCJsZWZ0XCJdO1xuICAgICAgICB0aGlzLl9wcmVzID0gW1wiTV9cIiwgXCJSX1wiLCBcIkJfXCIsIFwiTF9cIl07XG4gICAgICAgIHRoaXMuX2ZvbGRQcmVzID0gW1wiQl9cIiwgXCJSX1wiLCBcIkJfXCIsIFwiTF9cIl07XG4gICAgICAgIGNjLnZ2Lm1haGpvbmdtZ3IgPSB0aGlzO1xuICAgICAgICAvL+etklxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDEwOyArK2kpIHtcbiAgICAgICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJkb3RfXCIgKyBpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5p2hXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMTA7ICsraSkge1xuICAgICAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImJhbWJvb19cIiArIGkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy/kuIdcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCAxMDsgKytpKSB7XG4gICAgICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwiY2hhcmFjdGVyX1wiICsgaSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL+S4reOAgeWPkeOAgeeZvVxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwicmVkXCIpO1xuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwiZ3JlZW5cIik7XG4gICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJ3aGl0ZVwiKTtcblxuICAgICAgICAvL+S4nOilv+WNl+WMl+mjjlxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwid2luZF9lYXN0XCIpO1xuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwid2luZF93ZXN0XCIpO1xuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwid2luZF9zb3V0aFwiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIndpbmRfbm9ydGhcIik7XG5cbiAgICAgICAgLy/mmKXlpI/np4vlhqxcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcInNwcmluZ1wiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcInN1bW1lclwiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImF1dHVtblwiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIndpbnRlclwiKTtcblxuICAgICAgICAvL+aiheWFsOerueiPilxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwicGx1bVwiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIm9yY2hpZFwiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImJhbWJvb1wiKTtcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImNocnlzYW50aGVtdW1cIik7XG4gICAgfSxcblxuICAgIGdldE1haGpvbmdTcHJpdGVCeUlEOiBmdW5jdGlvbiBnZXRNYWhqb25nU3ByaXRlQnlJRChpZCkge1xuICAgICAgICByZXR1cm4gbWFoam9uZ1Nwcml0ZXNbaWRdO1xuICAgIH0sXG5cbiAgICBnZXRNYWhqb25nVHlwZTogZnVuY3Rpb24gZ2V0TWFoam9uZ1R5cGUoaWQpIHtcbiAgICAgICAgaWYgKGlkID49IDAgJiYgaWQgPCA5KSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSBlbHNlIGlmIChpZCA+PSA5ICYmIGlkIDwgMTgpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9IGVsc2UgaWYgKGlkID49IDE4ICYmIGlkIDwgMjcpIHtcbiAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGdldFNwcml0ZUZyYW1lQnlNSklEOiBmdW5jdGlvbiBnZXRTcHJpdGVGcmFtZUJ5TUpJRChwcmUsIG1qaWQpIHtcbiAgICAgICAgdmFyIHNwcml0ZUZyYW1lTmFtZSA9IHRoaXMuZ2V0TWFoam9uZ1Nwcml0ZUJ5SUQobWppZCk7XG4gICAgICAgIHNwcml0ZUZyYW1lTmFtZSA9IHByZSArIHNwcml0ZUZyYW1lTmFtZTtcbiAgICAgICAgaWYgKHByZSA9PSBcIk1fXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvdHRvbUF0bGFzLmdldFNwcml0ZUZyYW1lKHNwcml0ZUZyYW1lTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJlID09IFwiQl9cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tRm9sZEF0bGFzLmdldFNwcml0ZUZyYW1lKHNwcml0ZUZyYW1lTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJlID09IFwiTF9cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVmdEF0bGFzLmdldFNwcml0ZUZyYW1lKHNwcml0ZUZyYW1lTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJlID09IFwiUl9cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmlnaHRBdGxhcy5nZXRTcHJpdGVGcmFtZShzcHJpdGVGcmFtZU5hbWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGdldEF1ZGlvVVJMQnlNSklEOiBmdW5jdGlvbiBnZXRBdWRpb1VSTEJ5TUpJRChpZCkge1xuICAgICAgICB2YXIgcmVhbElkID0gMDtcbiAgICAgICAgaWYgKGlkID49IDAgJiYgaWQgPCA5KSB7XG4gICAgICAgICAgICByZWFsSWQgPSBpZCArIDIxO1xuICAgICAgICB9IGVsc2UgaWYgKGlkID49IDkgJiYgaWQgPCAxOCkge1xuICAgICAgICAgICAgcmVhbElkID0gaWQgLSA4O1xuICAgICAgICB9IGVsc2UgaWYgKGlkID49IDE4ICYmIGlkIDwgMjcpIHtcbiAgICAgICAgICAgIHJlYWxJZCA9IGlkIC0gNztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaWQgPT0gMzApIHtcbiAgICAgICAgICAgIHJlYWxJZCA9IDMxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlkID09IDMxKSB7XG4gICAgICAgICAgICByZWFsSWQgPSA0MTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpZCA9PSAzMikge1xuICAgICAgICAgICAgcmVhbElkID0gNTE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaWQgPT0gMzMpIHtcbiAgICAgICAgICAgIHJlYWxJZCA9IDYxO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlkID09IDI3KSB7XG4gICAgICAgICAgICByZWFsSWQgPSA3MTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpZCA9PSAyOCkge1xuICAgICAgICAgICAgcmVhbElkID0gODE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaWQgPT0gMjkpIHtcbiAgICAgICAgICAgIHJlYWxJZCA9IDkxO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFwibnYvXCIgKyByZWFsSWQgKyBcIi5tcDNcIjtcbiAgICB9LFxuXG4gICAgZ2V0RW1wdHlTcHJpdGVGcmFtZTogZnVuY3Rpb24gZ2V0RW1wdHlTcHJpdGVGcmFtZShzaWRlKSB7XG4gICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfYl91cFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChzaWRlID09IFwibXlzZWxmXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVtcHR5QXRsYXMuZ2V0U3ByaXRlRnJhbWUoXCJlX21qX2JfYm90dG9tXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJsZWZ0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVtcHR5QXRsYXMuZ2V0U3ByaXRlRnJhbWUoXCJlX21qX2JfbGVmdFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChzaWRlID09IFwicmlnaHRcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfYl9yaWdodFwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRIb2xkc0VtcHR5U3ByaXRlRnJhbWU6IGZ1bmN0aW9uIGdldEhvbGRzRW1wdHlTcHJpdGVGcmFtZShzaWRlKSB7XG4gICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfdXBcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcIm15c2VsZlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIGlmIChzaWRlID09IFwibGVmdFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eUF0bGFzLmdldFNwcml0ZUZyYW1lKFwiZV9tal9sZWZ0XCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eUF0bGFzLmdldFNwcml0ZUZyYW1lKFwiZV9tal9yaWdodFwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzb3J0TUo6IGZ1bmN0aW9uIHNvcnRNSihtYWhqb25ncywgZGluZ3F1ZSkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIG1haGpvbmdzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIGlmIChkaW5ncXVlID49IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgdDEgPSBzZWxmLmdldE1haGpvbmdUeXBlKGEpO1xuICAgICAgICAgICAgICAgIHZhciB0MiA9IHNlbGYuZ2V0TWFoam9uZ1R5cGUoYik7XG4gICAgICAgICAgICAgICAgaWYgKHQxICE9IHQyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkaW5ncXVlID09IHQxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkaW5ncXVlID09IHQyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBnZXRTaWRlOiBmdW5jdGlvbiBnZXRTaWRlKGxvY2FsSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpZGVzW2xvY2FsSW5kZXhdO1xuICAgIH0sXG5cbiAgICBnZXRQcmU6IGZ1bmN0aW9uIGdldFByZShsb2NhbEluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcmVzW2xvY2FsSW5kZXhdO1xuICAgIH0sXG5cbiAgICBnZXRGb2xkUHJlOiBmdW5jdGlvbiBnZXRGb2xkUHJlKGxvY2FsSW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvbGRQcmVzW2xvY2FsSW5kZXhdO1xuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnYjFjYzl5UmQxNUNYcUZnMHZUR0taVWsnLCAnTmV0Jyk7XG4vLyBzY3JpcHRzL05ldC5qc1xuXG5pZiAod2luZG93LmlvID09IG51bGwpIHtcbiAgICB3aW5kb3cuaW8gPSByZXF1aXJlKFwic29ja2V0LWlvXCIpO1xufVxuXG52YXIgR2xvYmFsID0gY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG4gICAgc3RhdGljczoge1xuICAgICAgICBpcDogXCJcIixcbiAgICAgICAgc2lvOiBudWxsLFxuICAgICAgICBpc1Bpbmdpbmc6IGZhbHNlLFxuICAgICAgICBmbkRpc2Nvbm5lY3Q6IG51bGwsXG4gICAgICAgIGhhbmRsZXJzOiB7fSxcbiAgICAgICAgYWRkSGFuZGxlcjogZnVuY3Rpb24gYWRkSGFuZGxlcihldmVudCwgZm4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZXJzW2V2ZW50XSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXZlbnQ6XCIgKyBldmVudCArIFwiJyBoYW5kbGVyIGhhcyBiZWVuIHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGV2ZW50ICsgXCIoXCIgKyB0eXBlb2YoZGF0YSkgKyBcIik6XCIgKyAoZGF0YT8gZGF0YS50b1N0cmluZygpOlwibnVsbFwiKSk7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50ICE9IFwiZGlzY29ubmVjdFwiICYmIHR5cGVvZiBkYXRhID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZuKGRhdGEpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5oYW5kbGVyc1tldmVudF0gPSBoYW5kbGVyO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2lvKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlcjpmdW5jdGlvbiBcIiArIGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5vbihldmVudCwgaGFuZGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbm5lY3Q6IGZ1bmN0aW9uIGNvbm5lY3QoZm5Db25uZWN0LCBmbkVycm9yKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBvcHRzID0ge1xuICAgICAgICAgICAgICAgICdyZWNvbm5lY3Rpb24nOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAnZm9yY2UgbmV3IGNvbm5lY3Rpb24nOiB0cnVlLFxuICAgICAgICAgICAgICAgICd0cmFuc3BvcnRzJzogWyd3ZWJzb2NrZXQnLCAncG9sbGluZyddXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5zaW8gPSB3aW5kb3cuaW8uY29ubmVjdCh0aGlzLmlwLCBvcHRzKTtcbiAgICAgICAgICAgIHRoaXMuc2lvLm9uKCdyZWNvbm5lY3QnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlY29ubmVjdGlvbicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNpby5vbignY29ubmVjdCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zaW8uY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmbkNvbm5lY3QoZGF0YSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGlzY29ubmVjdFwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNpby5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Nvbm5lY3RfZmFpbGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0X2ZhaWxlZCcpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmhhbmRsZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5oYW5kbGVyc1trZXldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT0gJ2Rpc2Nvbm5lY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZuRGlzY29ubmVjdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlcjpmdW5jdGlvbiBcIiArIGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpby5vbihrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zdGFydEhlYXJiZWF0KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc3RhcnRIZWFyYmVhdDogZnVuY3Rpb24gc3RhcnRIZWFyYmVhdCgpIHtcbiAgICAgICAgICAgIHRoaXMuc2lvLm9uKCdnYW1lX3BvbmcnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbWVfcG9uZycpO1xuICAgICAgICAgICAgICAgIHNlbGYubGFzdFJlY2lldmVUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5sYXN0UmVjaWV2ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coMSk7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXNQaW5naW5nKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coMSk7XG4gICAgICAgICAgICAgICAgc2VsZi5pc1BpbmdpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coMyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnNpbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNlbGYubGFzdFJlY2lldmVUaW1lID4gMTAwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNlbmQ6IGZ1bmN0aW9uIHNlbmQoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpby5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSAhPSBudWxsICYmIHR5cGVvZiBkYXRhID09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpOyAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNpby5lbWl0KGV2ZW50LCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBwaW5nOiBmdW5jdGlvbiBwaW5nKCkge1xuICAgICAgICAgICAgdGhpcy5zZW5kKCdnYW1lX3BpbmcnKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjbG9zZTogZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2UnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbyAmJiB0aGlzLnNpby5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaW8gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZm5EaXNjb25uZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZuRGlzY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgdGVzdDogZnVuY3Rpb24gdGVzdChmblJlc3VsdCkge1xuICAgICAgICAgICAgdmFyIHhociA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbiBmbihyZXQpIHtcbiAgICAgICAgICAgICAgICBmblJlc3VsdChyZXQuaXNvbmxpbmUpO1xuICAgICAgICAgICAgICAgIHhociA9IG51bGw7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgYXJyID0gdGhpcy5pcC5zcGxpdCgnOicpO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxuICAgICAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcbiAgICAgICAgICAgICAgICBpcDogYXJyWzBdLFxuICAgICAgICAgICAgICAgIHBvcnQ6IGFyclsxXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHhociA9IGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvaXNfc2VydmVyX29ubGluZVwiLCBkYXRhLCBmbik7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoeGhyKSB7XG4gICAgICAgICAgICAgICAgICAgIHhoci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICBmblJlc3VsdChmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTUwMCk7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgdmFyIG9wdHMgPSB7XG4gICAgICAgICAgICAgICAgJ3JlY29ubmVjdGlvbic6ZmFsc2UsXG4gICAgICAgICAgICAgICAgJ2ZvcmNlIG5ldyBjb25uZWN0aW9uJzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAndHJhbnNwb3J0cyc6Wyd3ZWJzb2NrZXQnLCAncG9sbGluZyddXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnRlc3RzaW8gPSB3aW5kb3cuaW8uY29ubmVjdCh0aGlzLmlwLG9wdHMpO1xuICAgICAgICAgICAgdGhpcy50ZXN0c2lvLm9uKCdjb25uZWN0JyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0Jyk7XG4gICAgICAgICAgICAgICAgc2VsZi50ZXN0c2lvLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgc2VsZi50ZXN0c2lvID0gbnVsbDtcbiAgICAgICAgICAgICAgICBmblJlc3VsdCh0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy50ZXN0c2lvLm9uKCdjb25uZWN0X2Vycm9yJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25uZWN0X2ZhaWxlZCcpO1xuICAgICAgICAgICAgICAgIHNlbGYudGVzdHNpbyA9IG51bGw7XG4gICAgICAgICAgICAgICAgZm5SZXN1bHQoZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAqL1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICdkZjYxYjQrRnpGRHZicE81ZzhVTlZJTScsICdOb3RpY2VUaXAnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9Ob3RpY2VUaXAuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9ndW9odTogbnVsbCxcbiAgICAgICAgX2luZm86IG51bGwsXG4gICAgICAgIF9ndW9odVRpbWU6IC0xXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB0aGlzLl9ndW9odSA9IGNjLmZpbmQoXCJDYW52YXMvdGlwX25vdGljZVwiKTtcbiAgICAgICAgdGhpcy5fZ3VvaHUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5faW5mbyA9IGNjLmZpbmQoXCJDYW52YXMvdGlwX25vdGljZS9pbmZvXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oJ3B1c2hfbm90aWNlJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBzZWxmLl9ndW9odS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5fZ3VvaHVUaW1lID0gZGF0YS50aW1lO1xuICAgICAgICAgICAgc2VsZi5faW5mby5zdHJpbmcgPSBkYXRhLmluZm87XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGR0KSB7XG4gICAgICAgIGlmICh0aGlzLl9ndW9odVRpbWUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLl9ndW9odVRpbWUgLT0gZHQ7XG4gICAgICAgICAgICBpZiAodGhpcy5fZ3VvaHVUaW1lIDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2d1b2h1LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc2ZmQ5ODJUeWk1Tk9ZSld0L2ZHWThMaicsICdPbkJhY2snKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9PbkJhY2suanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB2YXIgYnRuID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuX2JhY2tcIik7XG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuLCB0aGlzLm5vZGUsIFwiT25CYWNrXCIsIFwib25CdG5DbGlja2VkXCIpO1xuICAgIH0sXG5cbiAgICBvbkJ0bkNsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuQ2xpY2tlZChldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5fYmFja1wiKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICcyNzlkOXBORkdSQjNyRC9uZ3IxTElYUScsICdQZW5nR2FuZ3MnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9QZW5nR2FuZ3MuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKCFjYy52dikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5oaWRlaHVhcygpO1xuXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xuICAgICAgICB2YXIgbXlzZWxmID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKFwibXlzZWxmXCIpO1xuICAgICAgICB2YXIgcGVuZ2FuZ3Jvb3QgPSBteXNlbGYuZ2V0Q2hpbGRCeU5hbWUoXCJwZW5nZ2FuZ3NcIik7XG4gICAgICAgIHZhciByZWFsd2lkdGggPSBjYy5kaXJlY3Rvci5nZXRWaXNpYmxlU2l6ZSgpLndpZHRoO1xuICAgICAgICB2YXIgc2NhbGUgPSByZWFsd2lkdGggLyAxMjgwO1xuICAgICAgICBwZW5nYW5ncm9vdC5zY2FsZVggKj0gc2NhbGU7XG4gICAgICAgIHBlbmdhbmdyb290LnNjYWxlWSAqPSBzY2FsZTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubm9kZS5vbigncGVuZ19ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgLy/liLfmlrDmiYDmnInnmoTniYxcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGVuZ2dhbmcgcGxhdFwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBzZWxmLm9uUGVuZ0dhbmdDaGFuZ2VkKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbmdfbm90aWZ5JywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIC8v5Yi35paw5omA5pyJ55qE54mMXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBzZWxmLm9uUGVuZ0dhbmdDaGFuZ2VkKGRhdGEuc2VhdERhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2NoaV9ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgLy/liLfmlrDmiYDmnInnmoTniYxcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGVuZ2dhbmcgcGxhdFwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuZGV0YWlsKTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XG4gICAgICAgICAgICBzZWxmLm9uUGVuZ0dhbmdDaGFuZ2VkKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oJ2dldGh1YV9ub3RpZnknLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXRodWFfbm90aWZ5IGFjY2VwdFwiKTtcbiAgICAgICAgICAgIC8v5Yi35paw5omA5pyJ55qE54mMXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xuICAgICAgICAgICAgc2VsZi5vbkh1YUNoYW5nZWQoZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9iZWdpbicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLm9uR2FtZUJlaW4oKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWF0cykge1xuICAgICAgICAgICAgdGhpcy5vblBlbmdHYW5nQ2hhbmdlZChzZWF0c1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/pmpDol4/miYDmnInoirHniYxcbiAgICBoaWRlaHVhczogZnVuY3Rpb24gaGlkZWh1YXMoKSB7XG4gICAgICAgIC8v6ZqQ6JeP5omA5pyJ6Iqx54mMXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xuICAgICAgICB2YXIgc2lkZXMgPSBuZXcgQXJyYXkoXCJyaWdodFwiLCBcImxlZnRcIiwgXCJ1cFwiLCBcIm15c2VsZlwiKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA0OyBqKyspIHtcbiAgICAgICAgICAgIHZhciBzaWRlID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKHNpZGVzW2pdKTtcbiAgICAgICAgICAgIHZhciBodWFzcm9vdCA9IHNpZGUuZ2V0Q2hpbGRCeU5hbWUoXCJodWFzXCIpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBodWFzcm9vdC5jaGlsZHJlbkNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBodWFzcm9vdC5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkdhbWVCZWluOiBmdW5jdGlvbiBvbkdhbWVCZWluKCkge1xuICAgICAgICB0aGlzLmhpZGVTaWRlKFwibXlzZWxmXCIpO1xuICAgICAgICB0aGlzLmhpZGVTaWRlKFwicmlnaHRcIik7XG4gICAgICAgIHRoaXMuaGlkZVNpZGUoXCJ1cFwiKTtcbiAgICAgICAgdGhpcy5oaWRlU2lkZShcImxlZnRcIik7XG4gICAgICAgIHRoaXMuaGlkZWh1YXMoKTtcbiAgICB9LFxuXG4gICAgaGlkZVNpZGU6IGZ1bmN0aW9uIGhpZGVTaWRlKHNpZGUpIHtcbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XG4gICAgICAgIHZhciBteXNlbGYgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XG4gICAgICAgIHZhciBwZW5nYW5ncm9vdCA9IG15c2VsZi5nZXRDaGlsZEJ5TmFtZShcInBlbmdnYW5nc1wiKTtcbiAgICAgICAgaWYgKHBlbmdhbmdyb290KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBlbmdhbmdyb290LmNoaWxkcmVuQ291bnQ7ICsraSkge1xuICAgICAgICAgICAgICAgIHBlbmdhbmdyb290LmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uUGVuZ0dhbmdDaGFuZ2VkOiBmdW5jdGlvbiBvblBlbmdHYW5nQ2hhbmdlZChzZWF0RGF0YSkge1xuXG4gICAgICAgIGlmIChzZWF0RGF0YS5hbmdhbmdzID09IG51bGwgJiYgc2VhdERhdGEuZGlhbmdhbmdzID09IG51bGwgJiYgc2VhdERhdGEud2FuZ2FuZ3MgPT0gbnVsbCAmJiBzZWF0RGF0YS5wZW5ncyA9PSBudWxsICYmIHNlYXREYXRhLmNoaXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XG4gICAgICAgIHZhciBzaWRlID0gY2MudnYubWFoam9uZ21nci5nZXRTaWRlKGxvY2FsSW5kZXgpO1xuICAgICAgICB2YXIgcHJlID0gY2MudnYubWFoam9uZ21nci5nZXRGb2xkUHJlKGxvY2FsSW5kZXgpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwibG9jYWxJbmRleCA9IFwiICsgbG9jYWxJbmRleCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2lkZSA9IFwiICsgc2lkZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJlID0gXCIgKyBwcmUpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIm9uUGVuZ0dhbmdDaGFuZ2VkXCIgKyBsb2NhbEluZGV4KTtcblxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcbiAgICAgICAgdmFyIG15c2VsZiA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShzaWRlKTtcbiAgICAgICAgdmFyIHBlbmdhbmdyb290ID0gbXlzZWxmLmdldENoaWxkQnlOYW1lKFwicGVuZ2dhbmdzXCIpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGVuZ2FuZ3Jvb3QuY2hpbGRyZW5Db3VudDsgKytpKSB7XG4gICAgICAgICAgICBwZW5nYW5ncm9vdC5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvL+WIneWni+WMluadoOeJjFxuICAgICAgICB2YXIgaW5kZXggPSAwO1xuXG4gICAgICAgIHZhciBnYW5ncyA9IHNlYXREYXRhLmFuZ2FuZ3M7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FuZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3NbaV07XG4gICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwiYW5nYW5nXCIpO1xuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ2FuZ3MgPSBzZWF0RGF0YS5kaWFuZ2FuZ3M7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FuZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3NbaV07XG4gICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwiZGlhbmdhbmdcIik7XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGdhbmdzID0gc2VhdERhdGEud2FuZ2FuZ3M7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FuZ3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3NbaV07XG4gICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwid2FuZ2FuZ1wiKTtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgIH1cblxuICAgICAgICAvL+WIneWni+WMlueisOeJjFxuICAgICAgICB2YXIgcGVuZ3MgPSBzZWF0RGF0YS5wZW5ncztcbiAgICAgICAgaWYgKHBlbmdzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBlbmdzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBwZW5nc1tpXTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwicGVuZ1wiKTtcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy/liJ3lp4vljJblkIPniYxcbiAgICAgICAgY29uc29sZS5sb2coXCLliJ3lp4vljJblkIPniYxcIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlYXREYXRhKTtcbiAgICAgICAgdmFyIGNoaXMgPSBzZWF0RGF0YS5jaGlzO1xuICAgICAgICBpZiAoY2hpcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBjaGlzW2ldO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhwZW5nYW5ncm9vdCwgc2lkZSwgcHJlLCBpbmRleCwgbWppZCwgXCJjaGlcIik7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8v5Yid5aeL5YyW6Iqx54mMXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5Yid5aeL5YyW6Iqx54mMXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWF0RGF0YSk7XG4gICAgICAgIHZhciBodWFzID0gc2VhdERhdGEuaHVhcztcbiAgICAgICAgaWYgKGh1YXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaHVhcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBtamlkID0gaHVhc1tpXTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uSHVhQ2hhbmdlZChzZWF0RGF0YSk7XG4gICAgICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0UGVuZ0FuZEdhbmdzOiBmdW5jdGlvbiBpbml0UGVuZ0FuZEdhbmdzKHBlbmdhbmdyb290LCBzaWRlLCBwcmUsIGluZGV4LCBtamlkLCBmbGFnKSB7XG4gICAgICAgIHZhciBwZ3Jvb3QgPSBudWxsO1xuICAgICAgICBpZiAocGVuZ2FuZ3Jvb3QuY2hpbGRyZW5Db3VudCA8PSBpbmRleCkge1xuICAgICAgICAgICAgaWYgKHNpZGUgPT0gXCJsZWZ0XCIgfHwgc2lkZSA9PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgICAgICBwZ3Jvb3QgPSBjYy5pbnN0YW50aWF0ZShjYy52di5tYWhqb25nbWdyLnBlbmdQcmVmYWJMZWZ0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGdyb290ID0gY2MuaW5zdGFudGlhdGUoY2MudnYubWFoam9uZ21nci5wZW5nUHJlZmFiU2VsZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBlbmdhbmdyb290LmFkZENoaWxkKHBncm9vdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZ3Jvb3QgPSBwZW5nYW5ncm9vdC5jaGlsZHJlbltpbmRleF07XG4gICAgICAgICAgICBwZ3Jvb3QuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzaWRlID09IFwibGVmdFwiKSB7XG4gICAgICAgICAgICBwZ3Jvb3QueSA9IC0oaW5kZXggKiAyNSAqIDMpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICBwZ3Jvb3QueSA9IGluZGV4ICogMjUgKiAzO1xuICAgICAgICAgICAgcGdyb290LnNldExvY2FsWk9yZGVyKC1pbmRleCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcIm15c2VsZlwiKSB7XG4gICAgICAgICAgICBwZ3Jvb3QueCA9IGluZGV4ICogNTUgKiAzICsgaW5kZXggKiAxMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBncm9vdC54ID0gLShpbmRleCAqIDU1ICogMyk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3ByaXRlcyA9IHBncm9vdC5nZXRDb21wb25lbnRzSW5DaGlsZHJlbihjYy5TcHJpdGUpO1xuICAgICAgICAvLyBpZihmbGFnID09IFwiY2hpXCIpe1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coXCLmjpLliJflkIPvvIFcIik7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhtamlkKTtcbiAgICAgICAgLy8gICAgIGZvcih2YXIgcyA9IDA7IHMgPCAzOyBzKyspe1xuICAgICAgICAvLyAgICAgICAgIHZhciBzcHJpdGUgPSBzcHJpdGVzW3NdO1xuICAgICAgICAvLyAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLG1qaWRbc10pO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICAgcmV0dXJuO1xuICAgICAgICAvLyB9XG4gICAgICAgIGlmIChmbGFnID09IFwiY2hpXCIpIHtcbiAgICAgICAgICAgIHZhciBtamlkMSA9IFtdLmNvbmNhdChtamlkKTtcbiAgICAgICAgICAgIHZhciBwYWkgPSBtamlkMS5wb3AoKTtcbiAgICAgICAgICAgIG1qaWQxLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoYSkgLSBwYXJzZUludChiKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtamlkMVsyXSA9IG1qaWQxWzFdO1xuICAgICAgICAgICAgbWppZDFbMV0gPSBtamlkMVswXTtcbiAgICAgICAgICAgIG1qaWQxWzBdID0gcGFpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgc3ByaXRlcy5sZW5ndGg7ICsrcykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbiB4dW5odWFuXCIpO1xuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHNwcml0ZXNbc107XG4gICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubmFtZSA9PSBcImdhbmdcIikge1xuICAgICAgICAgICAgICAgIHZhciBpc0dhbmcgPSBmbGFnICE9IFwicGVuZ1wiO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IGlzR2FuZztcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVggPSAxLjA7XG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuc2NhbGVZID0gMS4wO1xuICAgICAgICAgICAgICAgIGlmIChmbGFnID09IFwiYW5nYW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRFbXB0eVNwcml0ZUZyYW1lKHNpZGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2lkZSA9PSBcIm15c2VsZlwiIHx8IHNpZGUgPT0gXCJ1cFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVggPSAxLjQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVkgPSAxLjQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgbWppZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZmxhZyA9PSBcInBlbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgbWppZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmbGFnID09IFwiY2hpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChwcmUsIG1qaWQxW3NdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgbWppZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uSHVhQ2hhbmdlZDogZnVuY3Rpb24gb25IdWFDaGFuZ2VkKHNlYXREYXRhKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwib25IdWFDaGFuZ2VkISEhXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWF0RGF0YSk7XG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XG4gICAgICAgIHZhciBzaWRlID0gY2MudnYubWFoam9uZ21nci5nZXRTaWRlKGxvY2FsSW5kZXgpO1xuICAgICAgICB2YXIgcHJlID0gY2MudnYubWFoam9uZ21nci5nZXRGb2xkUHJlKGxvY2FsSW5kZXgpO1xuXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xuICAgICAgICB2YXIgc2lkZSA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShzaWRlKTtcbiAgICAgICAgdmFyIGh1YXMgPSBzaWRlLmdldENoaWxkQnlOYW1lKFwiaHVhc1wiKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhzaWRlKTtcbiAgICAgICAgY29uc29sZS5sb2coaHVhcyk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0RGF0YS5odWFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNob3cgaHVhIVwiICsgc2VhdERhdGEuaHVhc1tpXSk7XG4gICAgICAgICAgICB2YXIgbm93Y2hpbGQgPSBodWFzLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgbm93Y2hpbGQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG5vd2NoaWxkLmFjdGl2ZSk7XG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gbm93Y2hpbGQuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgc2VhdERhdGEuaHVhc1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdEh1YXM6IGZ1bmN0aW9uIGluaXRIdWFzKCkge31cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2JjMGQyVkxnTDFBdm8xNjZ0SExzakNKJywgJ1BvcHVwTWdyJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBNZ3IuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBfcG9wdXByb290OiBudWxsLFxuICAgICAgICBfc2V0dGluZ3M6IG51bGwsXG4gICAgICAgIF9kaXNzb2x2ZU5vdGljZTogbnVsbCxcblxuICAgICAgICBfZW5kVGltZTogLTEsXG4gICAgICAgIF9leHRyYUluZm86IG51bGwsXG4gICAgICAgIF9ub3RpY2VMYWJlbDogbnVsbFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNjLnZ2LnBvcHVwTWdyID0gdGhpcztcblxuICAgICAgICB0aGlzLl9wb3B1cHJvb3QgPSBjYy5maW5kKFwiQ2FudmFzL3BvcHVwc1wiKTtcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBjYy5maW5kKFwiQ2FudmFzL3BvcHVwcy9zZXR0aW5nc1wiKTtcbiAgICAgICAgdGhpcy5fZGlzc29sdmVOb3RpY2UgPSBjYy5maW5kKFwiQ2FudmFzL3BvcHVwcy9kaXNzb2x2ZV9ub3RpY2VcIik7XG4gICAgICAgIHRoaXMuX25vdGljZUxhYmVsID0gdGhpcy5fZGlzc29sdmVOb3RpY2UuZ2V0Q2hpbGRCeU5hbWUoXCJpbmZvXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG5cbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xuXG4gICAgICAgIHRoaXMuYWRkQnRuSGFuZGxlcihcInNldHRpbmdzL2J0bl9jbG9zZVwiKTtcbiAgICAgICAgdGhpcy5hZGRCdG5IYW5kbGVyKFwic2V0dGluZ3MvYnRuX3NxanNmalwiKTtcbiAgICAgICAgdGhpcy5hZGRCdG5IYW5kbGVyKFwiZGlzc29sdmVfbm90aWNlL2J0bl9hZ3JlZVwiKTtcbiAgICAgICAgdGhpcy5hZGRCdG5IYW5kbGVyKFwiZGlzc29sdmVfbm90aWNlL2J0bl9yZWplY3RcIik7XG4gICAgICAgIHRoaXMuYWRkQnRuSGFuZGxlcihcImRpc3NvbHZlX25vdGljZS9idG5fb2tcIik7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGUub24oXCJkaXNzb2x2ZV9ub3RpY2VcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGV2ZW50LmRldGFpbDtcbiAgICAgICAgICAgIHNlbGYuc2hvd0Rpc3NvbHZlTm90aWNlKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm5vZGUub24oXCJkaXNzb2x2ZV9jYW5jZWxcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBzZWxmLmNsb3NlQWxsKCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzdGFydDogZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmRpc3NvdmVEYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dEaXNzb2x2ZU5vdGljZShjYy52di5nYW1lTmV0TWdyLmRpc3NvdmVEYXRhKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBhZGRCdG5IYW5kbGVyOiBmdW5jdGlvbiBhZGRCdG5IYW5kbGVyKGJ0bk5hbWUpIHtcbiAgICAgICAgdmFyIGJ0biA9IGNjLmZpbmQoXCJDYW52YXMvcG9wdXBzL1wiICsgYnRuTmFtZSk7XG4gICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudChidG4sIHRoaXMubm9kZSwgXCJQb3B1cE1nclwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcbiAgICB9LFxuXG4gICAgYWRkQ2xpY2tFdmVudDogZnVuY3Rpb24gYWRkQ2xpY2tFdmVudChub2RlLCB0YXJnZXQsIGNvbXBvbmVudCwgaGFuZGxlcikge1xuICAgICAgICB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgZXZlbnRIYW5kbGVyLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgZXZlbnRIYW5kbGVyLmNvbXBvbmVudCA9IGNvbXBvbmVudDtcbiAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBoYW5kbGVyO1xuXG4gICAgICAgIHZhciBjbGlja0V2ZW50cyA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHM7XG4gICAgICAgIGNsaWNrRXZlbnRzLnB1c2goZXZlbnRIYW5kbGVyKTtcbiAgICB9LFxuXG4gICAgb25CdG5DbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkNsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xuICAgICAgICB2YXIgYnRuTmFtZSA9IGV2ZW50LnRhcmdldC5uYW1lO1xuICAgICAgICBpZiAoYnRuTmFtZSA9PSBcImJ0bl9hZ3JlZVwiKSB7XG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImRpc3NvbHZlX2FncmVlXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGJ0bk5hbWUgPT0gXCJidG5fcmVqZWN0XCIpIHtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGlzc29sdmVfcmVqZWN0XCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGJ0bk5hbWUgPT0gXCJidG5fc3Fqc2ZqXCIpIHtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGlzc29sdmVfcmVxdWVzdFwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjbG9zZUFsbDogZnVuY3Rpb24gY2xvc2VBbGwoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwcm9vdC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2Rpc3NvbHZlTm90aWNlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBzaG93U2V0dGluZ3M6IGZ1bmN0aW9uIHNob3dTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xuICAgICAgICB0aGlzLl9wb3B1cHJvb3QuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc2hvd0Rpc3NvbHZlUmVxdWVzdDogZnVuY3Rpb24gc2hvd0Rpc3NvbHZlUmVxdWVzdCgpIHtcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xuICAgICAgICB0aGlzLl9wb3B1cHJvb3QuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc2hvd0Rpc3NvbHZlTm90aWNlOiBmdW5jdGlvbiBzaG93RGlzc29sdmVOb3RpY2UoZGF0YSkge1xuICAgICAgICB0aGlzLl9lbmRUaW1lID0gRGF0ZS5ub3coKSAvIDEwMDAgKyBkYXRhLnRpbWU7XG4gICAgICAgIHRoaXMuX2V4dHJhSW5mbyA9IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5zdGF0ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBiID0gZGF0YS5zdGF0ZXNbaV07XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHNbaV0ubmFtZTtcbiAgICAgICAgICAgIGlmIChiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXh0cmFJbmZvICs9IFwiXFxuW+W3suWQjOaEj10gXCIgKyBuYW1lO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9leHRyYUluZm8gKz0gXCJcXG5b5b6F56Gu6K6kXSBcIiArIG5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xuICAgICAgICB0aGlzLl9wb3B1cHJvb3QuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fZGlzc29sdmVOb3RpY2UuYWN0aXZlID0gdHJ1ZTs7XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2VuZFRpbWUgPiAwKSB7XG4gICAgICAgICAgICB2YXIgbGFzdFRpbWUgPSB0aGlzLl9lbmRUaW1lIC0gRGF0ZS5ub3coKSAvIDEwMDA7XG4gICAgICAgICAgICBpZiAobGFzdFRpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5kVGltZSA9IC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbSA9IE1hdGguZmxvb3IobGFzdFRpbWUgLyA2MCk7XG4gICAgICAgICAgICB2YXIgcyA9IE1hdGguY2VpbChsYXN0VGltZSAtIG0gKiA2MCk7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKG0gPiAwKSB7XG4gICAgICAgICAgICAgICAgc3RyICs9IG0gKyBcIuWIhlwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9ub3RpY2VMYWJlbC5zdHJpbmcgPSBzdHIgKyBzICsgXCLnp5LlkI7miL/pl7TlsIboh6rliqjop6PmlaNcIiArIHRoaXMuX2V4dHJhSW5mbztcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnOGQ1NzF5MlUrOUFpS250TytUU2YwRmInLCAnUmFkaW9CdXR0b24nKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9SYWRpb0J1dHRvbi5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHRhcmdldDogY2MuTm9kZSxcbiAgICAgICAgc3ByaXRlOiBjYy5TcHJpdGVGcmFtZSxcbiAgICAgICAgY2hlY2tlZFNwcml0ZTogY2MuU3ByaXRlRnJhbWUsXG4gICAgICAgIGNoZWNrZWQ6IGZhbHNlLFxuICAgICAgICBncm91cElkOiAtMVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2MudnYucmFkaW9ncm91cG1nciA9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgUmFkaW9Hcm91cE1nciA9IHJlcXVpcmUoXCJSYWRpb0dyb3VwTWdyXCIpO1xuICAgICAgICAgICAgY2MudnYucmFkaW9ncm91cG1nciA9IG5ldyBSYWRpb0dyb3VwTWdyKCk7XG4gICAgICAgICAgICBjYy52di5yYWRpb2dyb3VwbWdyLmluaXQoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyh0eXBlb2YgY2MudnYucmFkaW9ncm91cG1nci5hZGQpO1xuICAgICAgICBjYy52di5yYWRpb2dyb3VwbWdyLmFkZCh0aGlzKTtcblxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9LFxuXG4gICAgcmVmcmVzaDogZnVuY3Rpb24gcmVmcmVzaCgpIHtcbiAgICAgICAgdmFyIHRhcmdldFNwcml0ZSA9IHRoaXMudGFyZ2V0LmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICBpZiAodGhpcy5jaGVja2VkKSB7XG4gICAgICAgICAgICB0YXJnZXRTcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLmNoZWNrZWRTcHJpdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXRTcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLnNwcml0ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjaGVjazogZnVuY3Rpb24gY2hlY2sodmFsdWUpIHtcbiAgICAgICAgdGhpcy5jaGVja2VkID0gdmFsdWU7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICBvbkNsaWNrZWQ6IGZ1bmN0aW9uIG9uQ2xpY2tlZCgpIHtcbiAgICAgICAgY2MudnYucmFkaW9ncm91cG1nci5jaGVjayh0aGlzKTtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gb25EZXN0cm95KCkge1xuICAgICAgICBpZiAoY2MudnYgJiYgY2MudnYucmFkaW9ncm91cG1ncikge1xuICAgICAgICAgICAgY2MudnYucmFkaW9ncm91cG1nci5kZWwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzgyNGVhcGVSWU5LWTRSSnpnMlo0WUEyJywgJ1JhZGlvR3JvdXBNZ3InKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9SYWRpb0dyb3VwTWdyLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX2dyb3VwczogbnVsbFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB0aGlzLl9ncm91cHMgPSB7fTtcbiAgICB9LFxuXG4gICAgYWRkOiBmdW5jdGlvbiBhZGQocmFkaW9CdXR0b24pIHtcbiAgICAgICAgdmFyIGdyb3VwSWQgPSByYWRpb0J1dHRvbi5ncm91cElkO1xuICAgICAgICB2YXIgYnV0dG9ucyA9IHRoaXMuX2dyb3Vwc1tncm91cElkXTtcbiAgICAgICAgaWYgKGJ1dHRvbnMgPT0gbnVsbCkge1xuICAgICAgICAgICAgYnV0dG9ucyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fZ3JvdXBzW2dyb3VwSWRdID0gYnV0dG9ucztcbiAgICAgICAgfVxuICAgICAgICBidXR0b25zLnB1c2gocmFkaW9CdXR0b24pO1xuICAgIH0sXG5cbiAgICBkZWw6IGZ1bmN0aW9uIGRlbChyYWRpb0J1dHRvbikge1xuICAgICAgICB2YXIgZ3JvdXBJZCA9IHJhZGlvQnV0dG9uLmdyb3VwSWQ7XG4gICAgICAgIHZhciBidXR0b25zID0gdGhpcy5fZ3JvdXBzW2dyb3VwSWRdO1xuICAgICAgICBpZiAoYnV0dG9ucyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkeCA9IGJ1dHRvbnMuaW5kZXhPZihyYWRpb0J1dHRvbik7XG4gICAgICAgIGlmIChpZHggIT0gLTEpIHtcbiAgICAgICAgICAgIGJ1dHRvbnMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJ1dHRvbnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9ncm91cHNbZ3JvdXBJZF07XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2hlY2s6IGZ1bmN0aW9uIGNoZWNrKHJhZGlvQnV0dG9uKSB7XG4gICAgICAgIHZhciBncm91cElkID0gcmFkaW9CdXR0b24uZ3JvdXBJZDtcbiAgICAgICAgdmFyIGJ1dHRvbnMgPSB0aGlzLl9ncm91cHNbZ3JvdXBJZF07XG4gICAgICAgIGlmIChidXR0b25zID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBidG4gPSBidXR0b25zW2ldO1xuICAgICAgICAgICAgaWYgKGJ0biA9PSByYWRpb0J1dHRvbikge1xuICAgICAgICAgICAgICAgIGJ0bi5jaGVjayh0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnRuLmNoZWNrKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzdmNTUzRzBib1JINktyVEU3d0FDYVh4JywgJ1JlQ29ubmVjdCcpO1xuLy8gc2NyaXB0cy9jb21wb25lbnRzL1JlQ29ubmVjdC5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX3JlY29ubmVjdDogbnVsbCxcbiAgICAgICAgX2xibFRpcDogbnVsbCxcbiAgICAgICAgX2xhc3RQaW5nOiAwXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICB0aGlzLl9yZWNvbm5lY3QgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29ubmVjdFwiKTtcbiAgICAgICAgdGhpcy5fbGJsVGlwID0gY2MuZmluZChcIkNhbnZhcy9yZWNvbm5lY3QvdGlwXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICB2YXIgZm5UZXN0U2VydmVyT24gPSBmdW5jdGlvbiBmblRlc3RTZXJ2ZXJPbigpIHtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC50ZXN0KGZ1bmN0aW9uIChyZXQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm5UZXN0U2VydmVyT24sIDMwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYubm9kZS5vZmYoJ2Rpc2Nvbm5lY3QnLCBmbik7XG4gICAgICAgICAgICBzZWxmLl9yZWNvbm5lY3QuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGZuVGVzdFNlcnZlck9uKCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWRhc2ZkYXNkZnNkZlwiKTtcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdkaXNjb25uZWN0JywgZm4pO1xuICAgIH0sXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkdCkge1xuICAgICAgICBpZiAodGhpcy5fcmVjb25uZWN0LmFjdGl2ZSkge1xuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAlIDQ7XG4gICAgICAgICAgICB0aGlzLl9sYmxUaXAuc3RyaW5nID0gXCLkuI7mnI3liqHlmajmlq3lvIDov57mjqXvvIzmraPlnKjlsJ3or5Xph43ov55cIjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGJsVGlwLnN0cmluZyArPSAnLic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzIxZTZhK2FqR05EVEp3REhiVjNBNzJtJywgJ1JlcGxheUN0cmwnKTtcbi8vIHNjcmlwdHMvY29tcG9uZW50cy9SZXBsYXlDdHJsLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX25leHRQbGF5VGltZTogMSxcbiAgICAgICAgX3JlcGxheTogbnVsbCxcbiAgICAgICAgX2lzUGxheWluZzogdHJ1ZVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3JlcGxheSA9IGNjLmZpbmQoXCJDYW52YXMvcmVwbGF5XCIpO1xuICAgICAgICB0aGlzLl9yZXBsYXkuYWN0aXZlID0gY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCk7XG4gICAgfSxcblxuICAgIG9uQnRuUGF1c2VDbGlja2VkOiBmdW5jdGlvbiBvbkJ0blBhdXNlQ2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uQnRuUGxheUNsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuUGxheUNsaWNrZWQoKSB7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIG9uQnRuQmFja0NsaWNrZWQ6IGZ1bmN0aW9uIG9uQnRuQmFja0NsaWNrZWQoKSB7XG4gICAgICAgIGNjLnZ2LnJlcGxheU1nci5jbGVhcigpO1xuICAgICAgICBjYy52di5nYW1lTmV0TWdyLnJlc2V0KCk7XG4gICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkID0gbnVsbDtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkdCkge1xuICAgICAgICBpZiAoY2MudnYpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1BsYXlpbmcgJiYgY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gdHJ1ZSAmJiB0aGlzLl9uZXh0UGxheVRpbWUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbmV4dFBsYXlUaW1lIC09IGR0O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uZXh0UGxheVRpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25leHRQbGF5VGltZSA9IGNjLnZ2LnJlcGxheU1nci50YWtlQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICcxYTZhMXA4Nk5GTDZLWkVaQ25idTd0dCcsICdSZXBsYXlNZ3InKTtcbi8vIHNjcmlwdHMvUmVwbGF5TWdyLmpzXG5cbnZhciBBQ1RJT05fQ0hVUEFJID0gMTtcbnZhciBBQ1RJT05fTU9QQUkgPSAyO1xudmFyIEFDVElPTl9QRU5HID0gMztcbnZhciBBQ1RJT05fR0FORyA9IDQ7XG52YXIgQUNUSU9OX0hVID0gNTtcblxuY2MuQ2xhc3Moe1xuICAgICdleHRlbmRzJzogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX2xhc3RBY3Rpb246IG51bGwsXG4gICAgICAgIF9hY3Rpb25SZWNvcmRzOiBudWxsLFxuICAgICAgICBfY3VycmVudEluZGV4OiAwXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge30sXG5cbiAgICBjbGVhcjogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuX2xhc3RBY3Rpb24gPSBudWxsO1xuICAgICAgICB0aGlzLl9hY3Rpb25SZWNvcmRzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gMDtcbiAgICB9LFxuXG4gICAgaW5pdDogZnVuY3Rpb24gaW5pdChkYXRhKSB7XG4gICAgICAgIHRoaXMuX2FjdGlvblJlY29yZHMgPSBkYXRhLmFjdGlvbl9yZWNvcmRzO1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uUmVjb3JkcyA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9hY3Rpb25SZWNvcmRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fbGFzdEFjdGlvbiA9IG51bGw7XG4gICAgfSxcblxuICAgIGlzUmVwbGF5OiBmdW5jdGlvbiBpc1JlcGxheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvblJlY29yZHMgIT0gbnVsbDtcbiAgICB9LFxuXG4gICAgZ2V0TmV4dEFjdGlvbjogZnVuY3Rpb24gZ2V0TmV4dEFjdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRJbmRleCA+PSB0aGlzLl9hY3Rpb25SZWNvcmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2kgPSB0aGlzLl9hY3Rpb25SZWNvcmRzW3RoaXMuX2N1cnJlbnRJbmRleCsrXTtcbiAgICAgICAgdmFyIGFjdGlvbiA9IHRoaXMuX2FjdGlvblJlY29yZHNbdGhpcy5fY3VycmVudEluZGV4KytdO1xuICAgICAgICB2YXIgcGFpID0gdGhpcy5fYWN0aW9uUmVjb3Jkc1t0aGlzLl9jdXJyZW50SW5kZXgrK107XG4gICAgICAgIHJldHVybiB7IHNpOiBzaSwgdHlwZTogYWN0aW9uLCBwYWk6IHBhaSB9O1xuICAgIH0sXG5cbiAgICB0YWtlQWN0aW9uOiBmdW5jdGlvbiB0YWtlQWN0aW9uKCkge1xuICAgICAgICB2YXIgYWN0aW9uID0gdGhpcy5nZXROZXh0QWN0aW9uKCk7XG4gICAgICAgIGlmICh0aGlzLl9sYXN0QWN0aW9uICE9IG51bGwgJiYgdGhpcy5fbGFzdEFjdGlvbi50eXBlID09IEFDVElPTl9DSFVQQUkpIHtcbiAgICAgICAgICAgIGlmIChhY3Rpb24gIT0gbnVsbCAmJiBhY3Rpb24udHlwZSAhPSBBQ1RJT05fUEVORyAmJiBhY3Rpb24udHlwZSAhPSBBQ1RJT05fR0FORyAmJiBhY3Rpb24udHlwZSAhPSBBQ1RJT05fSFUpIHtcbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvR3VvKHRoaXMuX2xhc3RBY3Rpb24uc2ksIHRoaXMuX2xhc3RBY3Rpb24ucGFpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sYXN0QWN0aW9uID0gYWN0aW9uO1xuICAgICAgICBpZiAoYWN0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV4dEFjdGlvbkRlbGF5ID0gMS4wO1xuICAgICAgICBpZiAoYWN0aW9uLnR5cGUgPT0gQUNUSU9OX0NIVVBBSSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImNodXBhaVwiKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9DaHVwYWkoYWN0aW9uLnNpLCBhY3Rpb24ucGFpKTtcbiAgICAgICAgICAgIHJldHVybiAxLjA7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLnR5cGUgPT0gQUNUSU9OX01PUEFJKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibW9wYWlcIik7XG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvTW9wYWkoYWN0aW9uLnNpLCBhY3Rpb24ucGFpKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9UdXJuQ2hhbmdlKGFjdGlvbi5zaSk7XG4gICAgICAgICAgICByZXR1cm4gMC41O1xuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi50eXBlID09IEFDVElPTl9QRU5HKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicGVuZ1wiKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9QZW5nKGFjdGlvbi5zaSwgYWN0aW9uLnBhaSk7XG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvVHVybkNoYW5nZShhY3Rpb24uc2kpO1xuICAgICAgICAgICAgcmV0dXJuIDEuMDtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fR0FORykge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImdhbmdcIik7XG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRpc3BhdGNoRXZlbnQoJ2hhbmdhbmdfbm90aWZ5JywgYWN0aW9uLnNpKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9HYW5nKGFjdGlvbi5zaSwgYWN0aW9uLnBhaSk7XG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvVHVybkNoYW5nZShhY3Rpb24uc2kpO1xuICAgICAgICAgICAgcmV0dXJuIDEuMDtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fSFUpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJodVwiKTtcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9IdSh7IHNlYXRpbmRleDogYWN0aW9uLnNpLCBodXBhaTogYWN0aW9uLnBhaSwgaXN6aW1vOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIHJldHVybiAxLjU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc4MjA4NzBsdE1aTkRZbHZ6citxQ0RFSicsICdTZWF0Jyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvU2VhdC5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgX3Nwckljb246IG51bGwsXG4gICAgICAgIF96aHVhbmc6IG51bGwsXG4gICAgICAgIF9yZWFkeTogbnVsbCxcbiAgICAgICAgX29mZmxpbmU6IG51bGwsXG4gICAgICAgIF9sYmxOYW1lOiBudWxsLFxuICAgICAgICBfbGJsU2NvcmU6IG51bGwsXG4gICAgICAgIF9zY29yZUJnOiBudWxsLFxuICAgICAgICBfbmRkYXlpbmdqaWE6IG51bGwsXG4gICAgICAgIF92b2ljZW1zZzogbnVsbCxcblxuICAgICAgICBfY2hhdEJ1YmJsZTogbnVsbCxcbiAgICAgICAgX2Vtb2ppOiBudWxsLFxuICAgICAgICBfbGFzdENoYXRUaW1lOiAtMSxcblxuICAgICAgICBfdXNlck5hbWU6IFwiXCIsXG4gICAgICAgIF9zY29yZTogMCxcbiAgICAgICAgX2RheWluZ2ppYTogZmFsc2UsXG4gICAgICAgIF9pc09mZmxpbmU6IGZhbHNlLFxuICAgICAgICBfaXNSZWFkeTogZmFsc2UsXG4gICAgICAgIF9pc1podWFuZzogZmFsc2UsXG4gICAgICAgIF91c2VySWQ6IG51bGxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zcHJJY29uID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaWNvblwiKS5nZXRDb21wb25lbnQoXCJJbWFnZUxvYWRlclwiKTtcbiAgICAgICAgdGhpcy5fbGJsTmFtZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm5hbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgdGhpcy5fbGJsU2NvcmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzY29yZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICB0aGlzLl92b2ljZW1zZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInZvaWNlbXNnXCIpO1xuICAgICAgICB0aGlzLl94dWFucGFpID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieHVhbnBhaVwiKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoWHVhblBhaVN0YXRlKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX3ZvaWNlbXNnKSB7XG4gICAgICAgICAgICB0aGlzLl92b2ljZW1zZy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9zcHJJY29uICYmIHRoaXMuX3Nwckljb24uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikpIHtcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fc3BySWNvbiwgdGhpcy5ub2RlLCBcIlNlYXRcIiwgXCJvbkljb25DbGlja2VkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fb2ZmbGluZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm9mZmxpbmVcIik7XG5cbiAgICAgICAgdGhpcy5fcmVhZHkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJyZWFkeVwiKTtcblxuICAgICAgICB0aGlzLl96aHVhbmcgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6aHVhbmdcIik7XG5cbiAgICAgICAgdGhpcy5fc2NvcmVCZyA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIlpfbW9uZXlfZnJhbWVcIik7XG4gICAgICAgIHRoaXMuX25kZGF5aW5namlhID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZGF5aW5namlhXCIpO1xuXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJDaGF0QnViYmxlXCIpO1xuICAgICAgICBpZiAodGhpcy5fY2hhdEJ1YmJsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fZW1vamkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaVwiKTtcbiAgICAgICAgaWYgKHRoaXMuX2Vtb2ppICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2Vtb2ppLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24gJiYgdGhpcy5fdXNlcklkKSB7XG4gICAgICAgICAgICB0aGlzLl9zcHJJY29uLnNldFVzZXJJRCh0aGlzLl91c2VySWQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uSWNvbkNsaWNrZWQ6IGZ1bmN0aW9uIG9uSWNvbkNsaWNrZWQoKSB7XG4gICAgICAgIHZhciBpY29uU3ByaXRlID0gdGhpcy5fc3BySWNvbi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgICBpZiAodGhpcy5fdXNlcklkICE9IG51bGwgJiYgdGhpcy5fdXNlcklkID4gMCkge1xuICAgICAgICAgICAgdmFyIHNlYXQgPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRCeUlEKHRoaXMuX3VzZXJJZCk7XG4gICAgICAgICAgICB2YXIgc2V4ID0gMDtcbiAgICAgICAgICAgIGlmIChjYy52di5iYXNlSW5mb01hcCkge1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gY2MudnYuYmFzZUluZm9NYXBbdGhpcy5fdXNlcklkXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICBzZXggPSBpbmZvLnNleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYy52di51c2VyaW5mb1Nob3cuc2hvdyhzZWF0Lm5hbWUsIHNlYXQudXNlcmlkLCBpY29uU3ByaXRlLCBzZXgsIHNlYXQuaXApO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlZnJlc2g6IGZ1bmN0aW9uIHJlZnJlc2goKSB7XG4gICAgICAgIGlmICh0aGlzLl9sYmxOYW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2xibE5hbWUuc3RyaW5nID0gdGhpcy5fdXNlck5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fbGJsU2NvcmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUuc3RyaW5nID0gdGhpcy5fc2NvcmU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fbmRkYXlpbmdqaWEgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fbmRkYXlpbmdqaWEuYWN0aXZlID0gdGhpcy5fZGF5aW5namlhID09IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fb2ZmbGluZSkge1xuICAgICAgICAgICAgdGhpcy5fb2ZmbGluZS5hY3RpdmUgPSB0aGlzLl9pc09mZmxpbmUgJiYgdGhpcy5fdXNlck5hbWUgIT0gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9yZWFkeSkge1xuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiBjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgPiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX3podWFuZykge1xuICAgICAgICAgICAgdGhpcy5femh1YW5nLmFjdGl2ZSA9IHRoaXMuX2lzWmh1YW5nO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRoaXMuX3VzZXJOYW1lICE9IG51bGwgJiYgdGhpcy5fdXNlck5hbWUgIT0gXCJcIjtcbiAgICB9LFxuXG4gICAgc2V0SW5mbzogZnVuY3Rpb24gc2V0SW5mbyhuYW1lLCBzY29yZSwgZGF5aW5namlhKSB7XG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5fc2NvcmUgPSBzY29yZTtcbiAgICAgICAgaWYgKHRoaXMuX3Njb3JlID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kYXlpbmdqaWEgPSBkYXlpbmdqaWE7XG5cbiAgICAgICAgaWYgKHRoaXMuX3Njb3JlQmcgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5fc2NvcmVCZy5hY3RpdmUgPSB0aGlzLl9zY29yZSAhPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2xibFNjb3JlLm5vZGUuYWN0aXZlID0gdGhpcy5fc2NvcmUgIT0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICBzZXRaaHVhbmc6IGZ1bmN0aW9uIHNldFpodWFuZyh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5femh1YW5nKSB7XG4gICAgICAgICAgICB0aGlzLl96aHVhbmcuYWN0aXZlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0UmVhZHk6IGZ1bmN0aW9uIHNldFJlYWR5KGlzUmVhZHkpIHtcbiAgICAgICAgdGhpcy5faXNSZWFkeSA9IGlzUmVhZHk7XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeSkge1xuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiBjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgPiAwO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNldElEOiBmdW5jdGlvbiBzZXRJRChpZCkge1xuICAgICAgICB2YXIgaWROb2RlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaWRcIik7XG4gICAgICAgIGlmIChpZE5vZGUpIHtcbiAgICAgICAgICAgIHZhciBsYmwgPSBpZE5vZGUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgICAgIGxibC5zdHJpbmcgPSBcIklEOlwiICsgaWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl91c2VySWQgPSBpZDtcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24pIHtcbiAgICAgICAgICAgIHRoaXMuX3Nwckljb24uc2V0VXNlcklEKGlkKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRPZmZsaW5lOiBmdW5jdGlvbiBzZXRPZmZsaW5lKGlzT2ZmbGluZSkge1xuICAgICAgICB0aGlzLl9pc09mZmxpbmUgPSBpc09mZmxpbmU7XG4gICAgICAgIGlmICh0aGlzLl9vZmZsaW5lKSB7XG4gICAgICAgICAgICB0aGlzLl9vZmZsaW5lLmFjdGl2ZSA9IHRoaXMuX2lzT2ZmbGluZSAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNoYXQ6IGZ1bmN0aW9uIGNoYXQoY29udGVudCkge1xuICAgICAgICBpZiAodGhpcy5fY2hhdEJ1YmJsZSA9PSBudWxsIHx8IHRoaXMuX2Vtb2ppID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY29udGVudDtcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5nZXRDaGlsZEJ5TmFtZShcIk5ldyBMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGNvbnRlbnQ7XG4gICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSA9IDM7XG4gICAgfSxcblxuICAgIGVtb2ppOiBmdW5jdGlvbiBlbW9qaShfZW1vamkpIHtcbiAgICAgICAgLy9lbW9qaSA9IEpTT04ucGFyc2UoZW1vamkpO1xuICAgICAgICBpZiAodGhpcy5fZW1vamkgPT0gbnVsbCB8fCB0aGlzLl9lbW9qaSA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coX2Vtb2ppKTtcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fZW1vamkuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikucGxheShfZW1vamkpO1xuICAgICAgICB0aGlzLl9sYXN0Q2hhdFRpbWUgPSAzO1xuICAgIH0sXG5cbiAgICB2b2ljZU1zZzogZnVuY3Rpb24gdm9pY2VNc2coc2hvdykge1xuICAgICAgICBpZiAodGhpcy5fdm9pY2Vtc2cpIHtcbiAgICAgICAgICAgIHRoaXMuX3ZvaWNlbXNnLmFjdGl2ZSA9IHNob3c7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVmcmVzaFh1YW5QYWlTdGF0ZTogZnVuY3Rpb24gcmVmcmVzaFh1YW5QYWlTdGF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3h1YW5wYWkgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5feHVhbnBhaS5hY3RpdmUgPSBjYy52di5nYW1lTmV0TWdyLmlzSHVhblNhblpoYW5nO1xuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5pc0h1YW5TYW5aaGFuZyA9PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5feHVhbnBhaS5nZXRDaGlsZEJ5TmFtZShcInh6XCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl94dWFucGFpLmdldENoaWxkQnlOYW1lKFwieGRcIikuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHNlYXQgPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRCeUlEKHRoaXMuX3VzZXJJZCk7XG4gICAgICAgIGlmIChzZWF0KSB7XG4gICAgICAgICAgICBpZiAoc2VhdC5odWFucGFpcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feHVhbnBhaS5nZXRDaGlsZEJ5TmFtZShcInh6XCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3h1YW5wYWkuZ2V0Q2hpbGRCeU5hbWUoXCJ4ZFwiKS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RDaGF0VGltZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSAtPSBkdDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sYXN0Q2hhdFRpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbW9qaS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKS5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzRjMDRmeWQ4OUpBWlk3cUdqdnViaStmJywgJ1NldHRpbmdzJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvU2V0dGluZ3MuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9idG5ZWE9wZW46IG51bGwsXG4gICAgICAgIF9idG5ZWENsb3NlOiBudWxsLFxuICAgICAgICBfYnRuWVlPcGVuOiBudWxsLFxuICAgICAgICBfYnRuWVlDbG9zZTogbnVsbFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2J0bllYT3BlbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnhpYW9cIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXhfb3BlblwiKTtcbiAgICAgICAgdGhpcy5fYnRuWVhDbG9zZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnhpYW9cIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXhfY2xvc2VcIik7XG5cbiAgICAgICAgdGhpcy5fYnRuWVlPcGVuID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueXVlXCIpLmdldENoaWxkQnlOYW1lKFwiYnRuX3l5X29wZW5cIik7XG4gICAgICAgIHRoaXMuX2J0bllZQ2xvc2UgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW55dWVcIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXlfY2xvc2VcIik7XG5cbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fY2xvc2VcIikpO1xuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bl9leGl0XCIpKTtcblxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuX2J0bllYT3Blbik7XG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5fYnRuWVhDbG9zZSk7XG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5fYnRuWVlPcGVuKTtcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLl9idG5ZWUNsb3NlKTtcblxuICAgICAgICB2YXIgc2xpZGVyID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueGlhb1wiKS5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpO1xuICAgICAgICBjYy52di51dGlscy5hZGRTbGlkZUV2ZW50KHNsaWRlciwgdGhpcy5ub2RlLCBcIlNldHRpbmdzXCIsIFwib25TbGlkZWRcIik7XG5cbiAgICAgICAgdmFyIHNsaWRlciA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnl1ZVwiKS5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpO1xuICAgICAgICBjYy52di51dGlscy5hZGRTbGlkZUV2ZW50KHNsaWRlciwgdGhpcy5ub2RlLCBcIlNldHRpbmdzXCIsIFwib25TbGlkZWRcIik7XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XG4gICAgfSxcblxuICAgIG9uU2xpZGVkOiBmdW5jdGlvbiBvblNsaWRlZChzbGlkZXIpIHtcbiAgICAgICAgaWYgKHNsaWRlci5ub2RlLnBhcmVudC5uYW1lID09IFwieWlueGlhb1wiKSB7XG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5zZXRTRlhWb2x1bWUoc2xpZGVyLnByb2dyZXNzKTtcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIubm9kZS5wYXJlbnQubmFtZSA9PSBcInlpbnl1ZVwiKSB7XG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5zZXRCR01Wb2x1bWUoc2xpZGVyLnByb2dyZXNzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcbiAgICB9LFxuXG4gICAgaW5pdEJ1dHRvbkhhbmRsZXI6IGZ1bmN0aW9uIGluaXRCdXR0b25IYW5kbGVyKGJ0bikge1xuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0biwgdGhpcy5ub2RlLCBcIlNldHRpbmdzXCIsIFwib25CdG5DbGlja2VkXCIpO1xuICAgIH0sXG5cbiAgICByZWZyZXNoVm9sdW1lOiBmdW5jdGlvbiByZWZyZXNoVm9sdW1lKCkge1xuXG4gICAgICAgIHRoaXMuX2J0bllYQ2xvc2UuYWN0aXZlID0gY2MudnYuYXVkaW9NZ3Iuc2Z4Vm9sdW1lID4gMDtcbiAgICAgICAgdGhpcy5fYnRuWVhPcGVuLmFjdGl2ZSA9ICF0aGlzLl9idG5ZWENsb3NlLmFjdGl2ZTtcblxuICAgICAgICB2YXIgeXggPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW54aWFvXCIpO1xuICAgICAgICB2YXIgd2lkdGggPSAzNjggKiBjYy52di5hdWRpb01nci5zZnhWb2x1bWU7XG4gICAgICAgIHZhciBwcm9ncmVzcyA9IHl4LmdldENoaWxkQnlOYW1lKFwicHJvZ3Jlc3NcIik7XG4gICAgICAgIHByb2dyZXNzLmdldENvbXBvbmVudChjYy5TbGlkZXIpLnByb2dyZXNzID0gY2MudnYuYXVkaW9NZ3Iuc2Z4Vm9sdW1lO1xuICAgICAgICBwcm9ncmVzcy5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpLndpZHRoID0gd2lkdGg7XG4gICAgICAgIC8veXguZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcblxuICAgICAgICB0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZSA9IGNjLnZ2LmF1ZGlvTWdyLmJnbVZvbHVtZSA+IDA7XG4gICAgICAgIHRoaXMuX2J0bllZT3Blbi5hY3RpdmUgPSAhdGhpcy5fYnRuWVlDbG9zZS5hY3RpdmU7XG4gICAgICAgIHZhciB5eSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnl1ZVwiKTtcbiAgICAgICAgdmFyIHdpZHRoID0gMzY4ICogY2MudnYuYXVkaW9NZ3IuYmdtVm9sdW1lO1xuICAgICAgICB2YXIgcHJvZ3Jlc3MgPSB5eS5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpO1xuICAgICAgICBwcm9ncmVzcy5nZXRDb21wb25lbnQoY2MuU2xpZGVyKS5wcm9ncmVzcyA9IGNjLnZ2LmF1ZGlvTWdyLmJnbVZvbHVtZTtcblxuICAgICAgICBwcm9ncmVzcy5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpLndpZHRoID0gd2lkdGg7XG4gICAgICAgIC8veXkuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcbiAgICB9LFxuXG4gICAgb25CdG5DbGlja2VkOiBmdW5jdGlvbiBvbkJ0bkNsaWNrZWQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2Nsb3NlXCIpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bl9leGl0XCIpIHtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInd4X2FjY291bnRcIik7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJ3eF9zaWduXCIpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9naW5cIik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXhfb3BlblwiKSB7XG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5zZXRTRlhWb2x1bWUoMS4wKTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l4X2Nsb3NlXCIpIHtcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnNldFNGWFZvbHVtZSgwKTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l5X29wZW5cIikge1xuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0QkdNVm9sdW1lKDEpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXlfY2xvc2VcIikge1xuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0QkdNVm9sdW1lKDApO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICc1YjU4NmVyUEsxSDViRmZyTUtXcytZNicsICdUaW1lUG9pbnRlcicpO1xuLy8gc2NyaXB0cy9jb21wb25lbnRzL1RpbWVQb2ludGVyLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBfYXJyb3c6IG51bGwsXG4gICAgICAgIF9wb2ludGVyOiBudWxsLFxuICAgICAgICBfdGltZUxhYmVsOiBudWxsLFxuICAgICAgICBfdGltZTogLTEsXG4gICAgICAgIF9hbGVydFRpbWU6IC0xXG4gICAgfSxcblxuICAgIC8vIGZvbzoge1xuICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgLy8gfSxcbiAgICAvLyAuLi5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XG4gICAgICAgIHRoaXMuX2Fycm93ID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiYXJyb3dcIik7XG4gICAgICAgIHRoaXMuX3BvaW50ZXIgPSB0aGlzLl9hcnJvdy5nZXRDaGlsZEJ5TmFtZShcInBvaW50ZXJcIik7XG4gICAgICAgIHRoaXMuaW5pdFBvaW50ZXIoKTtcblxuICAgICAgICB0aGlzLl90aW1lTGFiZWwgPSB0aGlzLl9hcnJvdy5nZXRDaGlsZEJ5TmFtZShcImxibFRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgdGhpcy5fdGltZUxhYmVsLnN0cmluZyA9IFwiMDBcIjtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdFBvaW50ZXIoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2NodXBhaScsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBzZWxmLmluaXRQb2ludGVyKCk7XG4gICAgICAgICAgICBzZWxmLl90aW1lID0gMTA7XG4gICAgICAgICAgICBzZWxmLl9hbGVydFRpbWUgPSAzO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgaW5pdFBvaW50ZXI6IGZ1bmN0aW9uIGluaXRQb2ludGVyKCkge1xuXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9hcnJvdy5hY3RpdmUgPSBjYy52di5nYW1lTmV0TWdyLmdhbWVzdGF0ZSA9PSBcInBsYXlpbmdcIjtcbiAgICAgICAgaWYgKCF0aGlzLl9hcnJvdy5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdHVybiA9IGNjLnZ2LmdhbWVOZXRNZ3IudHVybjtcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgodHVybik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fcG9pbnRlci5jaGlsZHJlbi5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdGhpcy5fcG9pbnRlci5jaGlsZHJlbltpXS5hY3RpdmUgPSBpID09IGxvY2FsSW5kZXg7XG4gICAgICAgIH1cblxuICAgICAgICAvL+aXi+i9rOmjjuWQkVxuICAgICAgICB2YXIgYnV0dG9uID0gY2MudnYuZ2FtZU5ldE1nci5idXR0b247XG4gICAgICAgIHZhciBzZWF0aW5kZXggPSBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleDtcbiAgICAgICAgdmFyIGFycm93X2ZyYW1lID0gdGhpcy5fYXJyb3cuZ2V0Q2hpbGRCeU5hbWUoXCJaX2Fycm93X2ZyYW1lXCIpO1xuICAgICAgICB2YXIgZGlzID0gc2VhdGluZGV4IC0gYnV0dG9uO1xuICAgICAgICBhcnJvd19mcmFtZS5yb3RhdGlvbiA9IGRpcyAqIDkwO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKGR0KSB7XG4gICAgICAgIGlmICh0aGlzLl90aW1lID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fdGltZSAtPSBkdDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hbGVydFRpbWUgPiAwICYmIHRoaXMuX3RpbWUgPCB0aGlzLl9hbGVydFRpbWUpIHtcbiAgICAgICAgICAgICAgICBjYy52di5hdWRpb01nci5wbGF5U0ZYKFwidGltZXVwX2FsYXJtLm1wM1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hbGVydFRpbWUgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwcmUgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0ID0gTWF0aC5jZWlsKHRoaXMuX3RpbWUpO1xuICAgICAgICAgICAgaWYgKHQgPCAxMCkge1xuICAgICAgICAgICAgICAgIHByZSA9IFwiMFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdGltZUxhYmVsLnN0cmluZyA9IHByZSArIHQ7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2ZlNGYxNkNBbXBCbFpwaG5wc0gxRVR2JywgJ1VzZXJJbmZvU2hvdycpO1xuLy8gc2NyaXB0cy9jb21wb25lbnRzL1VzZXJJbmZvU2hvdy5qc1xuXG5jYy5DbGFzcyh7XG4gICAgXCJleHRlbmRzXCI6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgX3VzZXJpbmZvOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge1xuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdXNlcmluZm8gPSBjYy5maW5kKFwiQ2FudmFzL3VzZXJpbmZvXCIpO1xuICAgICAgICB0aGlzLl91c2VyaW5mby5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl91c2VyaW5mbywgdGhpcy5ub2RlLCBcIlVzZXJJbmZvU2hvd1wiLCBcIm9uQ2xpY2tlZFwiKTtcblxuICAgICAgICBjYy52di51c2VyaW5mb1Nob3cgPSB0aGlzO1xuICAgIH0sXG5cbiAgICBzaG93OiBmdW5jdGlvbiBzaG93KG5hbWUsIHVzZXJJZCwgaWNvblNwcml0ZSwgc2V4LCBpcCkge1xuICAgICAgICBpZiAodXNlcklkICE9IG51bGwgJiYgdXNlcklkID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fdXNlcmluZm8uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3VzZXJpbmZvLmdldENoaWxkQnlOYW1lKFwiaWNvblwiKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGljb25TcHJpdGUuc3ByaXRlRnJhbWU7XG4gICAgICAgICAgICB0aGlzLl91c2VyaW5mby5nZXRDaGlsZEJ5TmFtZShcIm5hbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy5fdXNlcmluZm8uZ2V0Q2hpbGRCeU5hbWUoXCJpcFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiSVA6IFwiICsgaXAucmVwbGFjZShcIjo6ZmZmZjpcIiwgXCJcIik7XG4gICAgICAgICAgICB0aGlzLl91c2VyaW5mby5nZXRDaGlsZEJ5TmFtZShcImlkXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCJJRDogXCIgKyB1c2VySWQ7XG5cbiAgICAgICAgICAgIHZhciBzZXhfZmVtYWxlID0gdGhpcy5fdXNlcmluZm8uZ2V0Q2hpbGRCeU5hbWUoXCJzZXhfZmVtYWxlXCIpO1xuICAgICAgICAgICAgc2V4X2ZlbWFsZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgdmFyIHNleF9tYWxlID0gdGhpcy5fdXNlcmluZm8uZ2V0Q2hpbGRCeU5hbWUoXCJzZXhfbWFsZVwiKTtcbiAgICAgICAgICAgIHNleF9tYWxlLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAoc2V4ID09IDEpIHtcbiAgICAgICAgICAgICAgICBzZXhfbWFsZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzZXggPT0gMikge1xuICAgICAgICAgICAgICAgIHNleF9mZW1hbGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkNsaWNrZWQ6IGZ1bmN0aW9uIG9uQ2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5fdXNlcmluZm8uYWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5jYy5fUkZwb3AoKTsiLCJcInVzZSBzdHJpY3RcIjtcbmNjLl9SRnB1c2gobW9kdWxlLCAnNzRkNzhKQnFIZERLWTZoY2tZMll1TCsnLCAnVXNlck1ncicpO1xuLy8gc2NyaXB0cy9Vc2VyTWdyLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYWNjb3VudDogbnVsbCxcbiAgICAgICAgdXNlcklkOiBudWxsLFxuICAgICAgICB1c2VyTmFtZTogbnVsbCxcbiAgICAgICAgbHY6IDAsXG4gICAgICAgIGV4cDogMCxcbiAgICAgICAgY29pbnM6IDAsXG4gICAgICAgIGdlbXM6IDAsXG4gICAgICAgIHNpZ246IDAsXG4gICAgICAgIGlwOiBcIlwiLFxuICAgICAgICBzZXg6IDAsXG4gICAgICAgIHJvb21EYXRhOiBudWxsLFxuICAgICAgICBvbGRSb29tSWQ6IG51bGxcbiAgICB9LFxuXG4gICAgZ3Vlc3RBdXRoOiBmdW5jdGlvbiBndWVzdEF1dGgoKSB7XG4gICAgICAgIHZhciBhY2NvdW50ID0gY2MuYXJnc1tcImFjY291bnRcIl07XG4gICAgICAgIGlmIChhY2NvdW50ID09IG51bGwpIHtcbiAgICAgICAgICAgIGFjY291bnQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhY2NvdW50XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFjY291bnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgYWNjb3VudCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhY2NvdW50XCIsIGFjY291bnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9ndWVzdFwiLCB7IGFjY291bnQ6IGFjY291bnQgfSwgdGhpcy5vbkF1dGgpO1xuICAgIH0sXG5cbiAgICBvbkF1dGg6IGZ1bmN0aW9uIG9uQXV0aChyZXQpIHtcbiAgICAgICAgdmFyIHNlbGYgPSBjYy52di51c2VyTWdyO1xuICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5hY2NvdW50ID0gcmV0LmFjY291bnQ7XG4gICAgICAgICAgICBzZWxmLnNpZ24gPSByZXQuc2lnbjtcbiAgICAgICAgICAgIGNjLnZ2Lmh0dHAudXJsID0gXCJodHRwOi8vXCIgKyBjYy52di5TSS5oYWxsO1xuICAgICAgICAgICAgc2VsZi5sb2dpbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGxvZ2luOiBmdW5jdGlvbiBsb2dpbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgb25Mb2dpbiA9IGZ1bmN0aW9uIG9uTG9naW4ocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXQudXNlcmlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vanVtcCB0byByZWdpc3RlciB1c2VyIGluZm8uXG4gICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImNyZWF0ZXJvbGVcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0KTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hY2NvdW50ID0gcmV0LmFjY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudXNlcklkID0gcmV0LnVzZXJpZDtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi51c2VyTmFtZSA9IHJldC5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmx2ID0gcmV0Lmx2O1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmV4cCA9IHJldC5leHA7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29pbnMgPSByZXQuY29pbnM7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ2VtcyA9IHJldC5nZW1zO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21EYXRhID0gcmV0LnJvb21pZDtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXggPSByZXQuc2V4O1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmlwID0gcmV0LmlwO1xuICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJoYWxsXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOeZu+W9lea4uOaIj1wiKTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9sb2dpblwiLCB7IGFjY291bnQ6IHRoaXMuYWNjb3VudCwgc2lnbjogdGhpcy5zaWduIH0sIG9uTG9naW4pO1xuICAgIH0sXG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZShuYW1lKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIG9uQ3JlYXRlID0gZnVuY3Rpb24gb25DcmVhdGUocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sb2dpbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgYWNjb3VudDogdGhpcy5hY2NvdW50LFxuICAgICAgICAgICAgc2lnbjogdGhpcy5zaWduLFxuICAgICAgICAgICAgbmFtZTogbmFtZVxuICAgICAgICB9O1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2NyZWF0ZV91c2VyXCIsIGRhdGEsIG9uQ3JlYXRlKTtcbiAgICB9LFxuXG4gICAgZW50ZXJSb29tOiBmdW5jdGlvbiBlbnRlclJvb20ocm9vbUlkLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvbkVudGVyID0gZnVuY3Rpb24gb25FbnRlcihyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZW50ZXJSb29tKHJvb21JZCwgY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmNvbm5lY3RHYW1lU2VydmVyKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXG4gICAgICAgICAgICByb29taWQ6IHJvb21JZFxuICAgICAgICB9O1xuICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo6L+b5YWl5oi/6Ze0IFwiICsgcm9vbUlkKTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9lbnRlcl9wcml2YXRlX3Jvb21cIiwgZGF0YSwgb25FbnRlcik7XG4gICAgfSxcbiAgICBnZXRIaXN0b3J5TGlzdDogZnVuY3Rpb24gZ2V0SGlzdG9yeUxpc3QoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgb25HZXQgPSBmdW5jdGlvbiBvbkdldChyZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuaGlzdG9yeSk7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2socmV0Lmhpc3RvcnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnblxuICAgICAgICB9O1xuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9oaXN0b3J5X2xpc3RcIiwgZGF0YSwgb25HZXQpO1xuICAgIH0sXG4gICAgZ2V0R2FtZXNPZlJvb206IGZ1bmN0aW9uIGdldEdhbWVzT2ZSb29tKHV1aWQsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24gb25HZXQocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmRhdGEpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJldC5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcbiAgICAgICAgICAgIHV1aWQ6IHV1aWRcbiAgICAgICAgfTtcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfZ2FtZXNfb2Zfcm9vbVwiLCBkYXRhLCBvbkdldCk7XG4gICAgfSxcblxuICAgIGdldERldGFpbE9mR2FtZTogZnVuY3Rpb24gZ2V0RGV0YWlsT2ZHYW1lKHV1aWQsIGluZGV4LCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uIG9uR2V0KHJldCkge1xuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5kYXRhKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQuZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXG4gICAgICAgICAgICB1dWlkOiB1dWlkLFxuICAgICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgIH07XG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvZ2V0X2RldGFpbF9vZl9nYW1lXCIsIGRhdGEsIG9uR2V0KTtcbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2I3MTdmend3MGhOeklxdk5iYjF0OXd4JywgJ1V0aWxzJyk7XG4vLyBzY3JpcHRzL1V0aWxzLmpzXG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICBhZGRDbGlja0V2ZW50OiBmdW5jdGlvbiBhZGRDbGlja0V2ZW50KG5vZGUsIHRhcmdldCwgY29tcG9uZW50LCBoYW5kbGVyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGNvbXBvbmVudCArIFwiOlwiICsgaGFuZGxlcik7XG4gICAgICAgIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gY29tcG9uZW50O1xuICAgICAgICBldmVudEhhbmRsZXIuaGFuZGxlciA9IGhhbmRsZXI7XG5cbiAgICAgICAgdmFyIGNsaWNrRXZlbnRzID0gbm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5jbGlja0V2ZW50cztcbiAgICAgICAgY2xpY2tFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xuICAgIH0sXG5cbiAgICBhZGRTbGlkZUV2ZW50OiBmdW5jdGlvbiBhZGRTbGlkZUV2ZW50KG5vZGUsIHRhcmdldCwgY29tcG9uZW50LCBoYW5kbGVyKSB7XG4gICAgICAgIHZhciBldmVudEhhbmRsZXIgPSBuZXcgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlcigpO1xuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gY29tcG9uZW50O1xuICAgICAgICBldmVudEhhbmRsZXIuaGFuZGxlciA9IGhhbmRsZXI7XG5cbiAgICAgICAgdmFyIHNsaWRlRXZlbnRzID0gbm9kZS5nZXRDb21wb25lbnQoY2MuU2xpZGVyKS5zbGlkZUV2ZW50cztcbiAgICAgICAgc2xpZGVFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xuICAgIH1cblxufSk7XG4vLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuLy8gfSxcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzFmMDY2UmJMQXhLR0padGtERk8ya3EvJywgJ1ZvaWNlTWdyJyk7XG4vLyBzY3JpcHRzL1ZvaWNlTWdyLmpzXG5cbnZhciByYWRpeCA9IDEyO1xudmFyIGJhc2UgPSAxMjggLSByYWRpeDtcbmZ1bmN0aW9uIGNyeXB0byh2YWx1ZSkge1xuICAgIHZhbHVlIC09IGJhc2U7XG4gICAgdmFyIGggPSBNYXRoLmZsb29yKHZhbHVlIC8gcmFkaXgpICsgYmFzZTtcbiAgICB2YXIgbCA9IHZhbHVlICUgcmFkaXggKyBiYXNlO1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGgpICsgU3RyaW5nLmZyb21DaGFyQ29kZShsKTtcbn1cblxudmFyIGVuY29kZXJtYXAgPSB7fTtcbnZhciBkZWNvZGVybWFwID0ge307XG5mb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gICAgdmFyIGNvZGUgPSBudWxsO1xuICAgIHZhciB2ID0gaSArIDE7XG4gICAgaWYgKHYgPj0gYmFzZSkge1xuICAgICAgICBjb2RlID0gY3J5cHRvKHYpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHYpO1xuICAgIH1cblxuICAgIGVuY29kZXJtYXBbaV0gPSBjb2RlO1xuICAgIGRlY29kZXJtYXBbY29kZV0gPSBpO1xufVxuXG5mdW5jdGlvbiBlbmNvZGUoZGF0YSkge1xuICAgIHZhciBjb250ZW50ID0gXCJcIjtcbiAgICB2YXIgbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgdmFyIGEgPSBsZW4gPj4gMjQgJiAweGZmO1xuICAgIHZhciBiID0gbGVuID4+IDE2ICYgMHhmZjtcbiAgICB2YXIgYyA9IGxlbiA+PiA4ICYgMHhmZjtcbiAgICB2YXIgZCA9IGxlbiAmIDB4ZmY7XG4gICAgY29udGVudCArPSBlbmNvZGVybWFwW2FdO1xuICAgIGNvbnRlbnQgKz0gZW5jb2Rlcm1hcFtiXTtcbiAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbY107XG4gICAgY29udGVudCArPSBlbmNvZGVybWFwW2RdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7ICsraSkge1xuICAgICAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbZGF0YVtpXV07XG4gICAgfVxuICAgIHJldHVybiBjb250ZW50O1xufVxuXG5mdW5jdGlvbiBnZXRDb2RlKGNvbnRlbnQsIGluZGV4KSB7XG4gICAgdmFyIGMgPSBjb250ZW50LmNoYXJDb2RlQXQoaW5kZXgpO1xuICAgIGlmIChjID49IGJhc2UpIHtcbiAgICAgICAgYyA9IGNvbnRlbnQuY2hhckF0KGluZGV4KSArIGNvbnRlbnQuY2hhckF0KGluZGV4ICsgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYyA9IGNvbnRlbnQuY2hhckF0KGluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIGM7XG59XG5mdW5jdGlvbiBkZWNvZGUoY29udGVudCkge1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIGxlbiA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyArK2kpIHtcbiAgICAgICAgdmFyIGMgPSBnZXRDb2RlKGNvbnRlbnQsIGluZGV4KTtcbiAgICAgICAgaW5kZXggKz0gYy5sZW5ndGg7XG4gICAgICAgIHZhciB2ID0gZGVjb2Rlcm1hcFtjXTtcbiAgICAgICAgbGVuIHw9IHYgPDwgKDMgLSBpKSAqIDg7XG4gICAgfVxuXG4gICAgdmFyIG5ld0RhdGEgPSBuZXcgVWludDhBcnJheShsZW4pO1xuICAgIHZhciBjbnQgPSAwO1xuICAgIHdoaWxlIChpbmRleCA8IGNvbnRlbnQubGVuZ3RoKSB7XG4gICAgICAgIHZhciBjID0gZ2V0Q29kZShjb250ZW50LCBpbmRleCk7XG4gICAgICAgIGluZGV4ICs9IGMubGVuZ3RoO1xuICAgICAgICBuZXdEYXRhW2NudF0gPSBkZWNvZGVybWFwW2NdO1xuICAgICAgICBjbnQrKztcbiAgICB9XG4gICAgcmV0dXJuIG5ld0RhdGE7XG59XG5cbmNjLkNsYXNzKHtcbiAgICBcImV4dGVuZHNcIjogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBvblBsYXlDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX3ZvaWNlTWVkaWFQYXRoOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIC8qXG4gICAgICAgIHZhciB1cmwgPSBjYy51cmwucmF3KFwicmVzb3VyY2VzL3Rlc3QuYW1yXCIpO1xuICAgICAgICB2YXIgZmlsZURhdGEgPSBqc2IuZmlsZVV0aWxzLmdldERhdGFGcm9tRmlsZSh1cmwpO1xuICAgICAgICB2YXIgY29udGVudCA9IFwiXCI7XG4gICAgICAgIHZhciBzZXAgPSBcIlwiO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZmlsZURhdGEubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgY29udGVudCArPSBzZXAgKyBmaWxlRGF0YVtpXTtcbiAgICAgICAgICAgIHNlcCA9IFwiLFwiO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgdXJsID0gY2MudXJsLnJhdyhcInJlc291cmNlcy90ZXN0LnR4dFwiKTtcbiAgICAgICAganNiLmZpbGVVdGlscy53cml0ZVN0cmluZ1RvRmlsZShjb250ZW50LHVybCk7XG4gICAgICAgIFxuICAgICAgICB2YXIgdXJsID0gY2MudXJsLnJhdyhcInJlc291cmNlcy90ZXN0Mi5hbXJzXCIpO1xuICAgICAgICB2YXIgY29udGVudCA9IGVuY29kZShmaWxlRGF0YSk7XG4gICAgICAgIGpzYi5maWxlVXRpbHMud3JpdGVTdHJpbmdUb0ZpbGUoY29udGVudCx1cmwpO1xuICAgICAgICBcbiAgICAgICAgdmFyIHVybCA9IGNjLnVybC5yYXcoXCJyZXNvdXJjZXMvdGVzdDIuYW1yXCIpO1xuICAgICAgICBqc2IuZmlsZVV0aWxzLndyaXRlRGF0YVRvRmlsZShkZWNvZGUoY29udGVudCksdXJsKTtcbiAgICAgICAgKi9cblxuICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLl92b2ljZU1lZGlhUGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKCkgKyBcIi92b2ljZW1zZ3MvXCI7XG4gICAgICAgICAgICB0aGlzLnNldFN0b3JhZ2VEaXIodGhpcy5fdm9pY2VNZWRpYVBhdGgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHByZXBhcmU6IGZ1bmN0aW9uIHByZXBhcmUoZmlsZW5hbWUpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYy52di5hdWRpb01nci5wYXVzZUFsbCgpO1xuICAgICAgICB0aGlzLmNsZWFyQ2FjaGUoZmlsZW5hbWUpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwicHJlcGFyZVwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBmaWxlbmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJWb2ljZVNES1wiLCBcInByZXBhcmVSZWNvcmQ6XCIsIGZpbGVuYW1lKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZWxlYXNlOiBmdW5jdGlvbiByZWxlYXNlKCkge1xuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwicmVsZWFzZVwiLCBcIigpVlwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0lPUykge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIlZvaWNlU0RLXCIsIFwiZmluaXNoUmVjb3JkXCIpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNhbmNlbDogZnVuY3Rpb24gY2FuY2VsKCkge1xuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwiY2FuY2VsXCIsIFwiKClWXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiVm9pY2VTREtcIiwgXCJjYW5jZWxSZWNvcmRcIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgd3JpdGVWb2ljZTogZnVuY3Rpb24gd3JpdGVWb2ljZShmaWxlbmFtZSwgdm9pY2VEYXRhKSB7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZvaWNlRGF0YSAmJiB2b2ljZURhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGZpbGVEYXRhID0gZGVjb2RlKHZvaWNlRGF0YSk7XG4gICAgICAgICAgICB2YXIgdXJsID0gdGhpcy5fdm9pY2VNZWRpYVBhdGggKyBmaWxlbmFtZTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDYWNoZShmaWxlbmFtZSk7XG4gICAgICAgICAgICBqc2IuZmlsZVV0aWxzLndyaXRlRGF0YVRvRmlsZShmaWxlRGF0YSwgdXJsKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGVhckNhY2hlOiBmdW5jdGlvbiBjbGVhckNhY2hlKGZpbGVuYW1lKSB7XG4gICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSB0aGlzLl92b2ljZU1lZGlhUGF0aCArIGZpbGVuYW1lO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImNoZWNrIGZpbGU6XCIgKyB1cmwpO1xuICAgICAgICAgICAgaWYgKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QodXJsKSkge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJyZW1vdmU6XCIgKyB1cmwpO1xuICAgICAgICAgICAgICAgIGpzYi5maWxlVXRpbHMucmVtb3ZlRmlsZSh1cmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QodXJsICsgXCIud2F2XCIpKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJlbW92ZTpcIiArIHVybCArIFwiLndhdlwiKTtcbiAgICAgICAgICAgICAgICBqc2IuZmlsZVV0aWxzLnJlbW92ZUZpbGUodXJsICsgXCIud2F2XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkoZmlsZW5hbWUpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjYy52di5hdWRpb01nci5wYXVzZUFsbCgpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVBsYXllclwiLCBcInBsYXlcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgZmlsZW5hbWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiVm9pY2VTREtcIiwgXCJwbGF5OlwiLCBmaWxlbmFtZSk7XG4gICAgICAgIH0gZWxzZSB7fVxuICAgIH0sXG5cbiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVBsYXllclwiLCBcInN0b3BcIiwgXCIoKVZcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJWb2ljZVNES1wiLCBcInN0b3BQbGF5XCIpO1xuICAgICAgICB9IGVsc2Uge31cbiAgICB9LFxuXG4gICAgZ2V0Vm9pY2VMZXZlbDogZnVuY3Rpb24gZ2V0Vm9pY2VMZXZlbChtYXhMZXZlbCkge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4TGV2ZWwgKyAxKTtcbiAgICAgICAgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCkge1xuICAgICAgICAgICAgcmV0dXJuIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJjb20vdml2aWdhbWVzL3ZvaWNlc2RrL1ZvaWNlUmVjb3JkZXJcIiwgXCJnZXRWb2ljZUxldmVsXCIsIFwiKEkpSVwiLCBtYXhMZXZlbCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHt9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heExldmVsICsgMSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0Vm9pY2VEYXRhOiBmdW5jdGlvbiBnZXRWb2ljZURhdGEoZmlsZW5hbWUpIHtcbiAgICAgICAgaWYgKGNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgdmFyIHVybCA9IHRoaXMuX3ZvaWNlTWVkaWFQYXRoICsgZmlsZW5hbWU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImdldFZvaWNlRGF0YTpcIiArIHVybCk7XG4gICAgICAgICAgICB2YXIgZmlsZURhdGEgPSBqc2IuZmlsZVV0aWxzLmdldERhdGFGcm9tRmlsZSh1cmwpO1xuICAgICAgICAgICAgaWYgKGZpbGVEYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBlbmNvZGUoZmlsZURhdGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH0sXG5cbiAgICBkb3dubG9hZDogZnVuY3Rpb24gZG93bmxvYWQoKSB7fSxcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxuXG4gICAgc2V0U3RvcmFnZURpcjogZnVuY3Rpb24gc2V0U3RvcmFnZURpcihkaXIpIHtcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwic2V0U3RvcmFnZURpclwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBkaXIpO1xuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiVm9pY2VTREtcIiwgXCJzZXRTdG9yYWdlRGlyOlwiLCBkaXIpO1xuICAgICAgICAgICAgaWYgKCFqc2IuZmlsZVV0aWxzLmlzRGlyZWN0b3J5RXhpc3QoZGlyKSkge1xuICAgICAgICAgICAgICAgIGpzYi5maWxlVXRpbHMuY3JlYXRlRGlyZWN0b3J5KGRpcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJ2Y2ZGI5ejBDeGRFenBSVmdVNTY5ZER1JywgJ1ZvaWNlJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvVm9pY2UuanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIF9sYXN0VG91Y2hUaW1lOiBudWxsLFxuICAgICAgICBfdm9pY2U6IG51bGwsXG4gICAgICAgIF92b2x1bWU6IG51bGwsXG4gICAgICAgIF92b2ljZV9mYWlsZWQ6IG51bGwsXG4gICAgICAgIF9sYXN0Q2hlY2tUaW1lOiAtMSxcbiAgICAgICAgX3RpbWVCYXI6IG51bGwsXG4gICAgICAgIE1BWF9USU1FOiAxNTAwMFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHtcblxuICAgICAgICB0aGlzLl92b2ljZSA9IGNjLmZpbmQoXCJDYW52YXMvdm9pY2VcIik7XG4gICAgICAgIHRoaXMuX3ZvaWNlLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3ZvaWNlX2ZhaWxlZCA9IGNjLmZpbmQoXCJDYW52YXMvdm9pY2Uvdm9pY2VfZmFpbGVkXCIpO1xuICAgICAgICB0aGlzLl92b2ljZV9mYWlsZWQuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fdGltZUJhciA9IGNjLmZpbmQoXCJDYW52YXMvdm9pY2UvdGltZVwiKTtcbiAgICAgICAgdGhpcy5fdGltZUJhci5zY2FsZVggPSAwLjA7XG5cbiAgICAgICAgdGhpcy5fdm9sdW1lID0gY2MuZmluZChcIkNhbnZhcy92b2ljZS92b2x1bWVcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5fdm9sdW1lLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB0aGlzLl92b2x1bWUuY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYnRuVm9pY2UgPSBjYy5maW5kKFwiQ2FudmFzL3ZvaWNlL3ZvaWNlX2ZhaWxlZC9idG5fb2tcIik7XG4gICAgICAgIGlmIChidG5Wb2ljZSkge1xuICAgICAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChidG5Wb2ljZSwgdGhpcy5ub2RlLCBcIlZvaWNlXCIsIFwib25CdG5PS0NsaWNrZWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBidG5Wb2ljZSA9IGNjLmZpbmQoXCJDYW52YXMvYnRuX3ZvaWNlXCIpO1xuICAgICAgICBpZiAoYnRuVm9pY2UpIHtcbiAgICAgICAgICAgIGJ0blZvaWNlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVFwiKTtcbiAgICAgICAgICAgICAgICBjYy52di52b2ljZU1nci5wcmVwYXJlKFwicmVjb3JkLmFtclwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9sYXN0VG91Y2hUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgICAgICBzZWxmLl92b2ljZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNlbGYuX3ZvaWNlX2ZhaWxlZC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBidG5Wb2ljZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFXCIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJ0blZvaWNlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5EXCIpO1xuICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5fbGFzdFRvdWNoVGltZSA8IDEwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fdm9pY2VfZmFpbGVkLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25Wb2ljZU9LKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuX2xhc3RUb3VjaFRpbWUgPSBudWxsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJ0blZvaWNlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMXCIpO1xuICAgICAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX2xhc3RUb3VjaFRpbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNlbGYuX3ZvaWNlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25Wb2ljZU9LOiBmdW5jdGlvbiBvblZvaWNlT0soKSB7XG4gICAgICAgIGlmICh0aGlzLl9sYXN0VG91Y2hUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLnJlbGVhc2UoKTtcbiAgICAgICAgICAgIHZhciB0aW1lID0gRGF0ZS5ub3coKSAtIHRoaXMuX2xhc3RUb3VjaFRpbWU7XG4gICAgICAgICAgICB2YXIgbXNnID0gY2MudnYudm9pY2VNZ3IuZ2V0Vm9pY2VEYXRhKFwicmVjb3JkLmFtclwiKTtcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwidm9pY2VfbXNnXCIsIHsgbXNnOiBtc2csIHRpbWU6IHRpbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdm9pY2UuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIG9uQnRuT0tDbGlja2VkOiBmdW5jdGlvbiBvbkJ0bk9LQ2xpY2tlZCgpIHtcbiAgICAgICAgdGhpcy5fdm9pY2UuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX3ZvaWNlLmFjdGl2ZSA9PSB0cnVlICYmIHRoaXMuX3ZvaWNlX2ZhaWxlZC5hY3RpdmUgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5fbGFzdENoZWNrVGltZSA+IDMwMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fdm9sdW1lLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZvbHVtZS5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHYgPSBjYy52di52b2ljZU1nci5nZXRWb2ljZUxldmVsKDcpO1xuICAgICAgICAgICAgICAgIGlmICh2ID49IDEgJiYgdiA8PSA3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZvbHVtZS5jaGlsZHJlblt2IC0gMV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdENoZWNrVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fbGFzdFRvdWNoVGltZSkge1xuICAgICAgICAgICAgdmFyIHRpbWUgPSBEYXRlLm5vdygpIC0gdGhpcy5fbGFzdFRvdWNoVGltZTtcbiAgICAgICAgICAgIGlmICh0aW1lID49IHRoaXMuTUFYX1RJTUUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uVm9pY2VPSygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RUb3VjaFRpbWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVyY2VudCA9IHRpbWUgLyB0aGlzLk1BWF9USU1FO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVCYXIuc2NhbGVYID0gMSAtIHBlcmNlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY2MuX1JGcG9wKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5jYy5fUkZwdXNoKG1vZHVsZSwgJzEwZTMyakRzdHBMaElHSFdyUUVxMnZOJywgJ1dhaXRpbmdDb25uZWN0aW9uJyk7XG4vLyBzY3JpcHRzL2NvbXBvbmVudHMvV2FpdGluZ0Nvbm5lY3Rpb24uanNcblxuY2MuQ2xhc3Moe1xuICAgIFwiZXh0ZW5kc1wiOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0YXJnZXQ6IGNjLk5vZGUsXG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBfaXNTaG93OiBmYWxzZSxcbiAgICAgICAgbGJsQ29udGVudDogY2MuTGFiZWxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNjLnZ2LndjID0gdGhpcztcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRoaXMuX2lzU2hvdztcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShkdCkge1xuICAgICAgICB0aGlzLnRhcmdldC5yb3RhdGlvbiA9IHRoaXMudGFyZ2V0LnJvdGF0aW9uIC0gZHQgKiA0NTtcbiAgICB9LFxuXG4gICAgc2hvdzogZnVuY3Rpb24gc2hvdyhjb250ZW50KSB7XG4gICAgICAgIHRoaXMuX2lzU2hvdyA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLm5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0aGlzLl9pc1Nob3c7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGJsQ29udGVudCkge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sYmxDb250ZW50LnN0cmluZyA9IGNvbnRlbnQ7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7XG4gICAgICAgIHRoaXMuX2lzU2hvdyA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5ub2RlKSB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdGhpcy5faXNTaG93O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmNjLl9SRnBvcCgpOyIsIlwidXNlIHN0cmljdFwiO1xuY2MuX1JGcHVzaChtb2R1bGUsICczOTMyOTB2UGMxSUlZZmg4RnJteGNOWicsICdzb2NrZXQtaW8nKTtcbi8vIHNjcmlwdHMvM3JkcGFydHkvc29ja2V0LWlvLmpzXG5cbmlmICghQ0NfSlNCICYmICFjYy5zeXMuaXNOYXRpdmUpIHtcblx0KGZ1bmN0aW9uIChmKSB7XG5cdFx0aWYgKHR5cGVvZiBleHBvcnRzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdG1vZHVsZS5leHBvcnRzID0gZigpO1xuXHRcdH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcblx0XHRcdGRlZmluZShbXSwgZik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBnO2lmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGcgPSB3aW5kb3c7XG5cdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0ZyA9IGdsb2JhbDtcblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0ZyA9IHNlbGY7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRnID0gdGhpcztcblx0XHRcdH1nLmlvID0gZigpO1xuXHRcdH1cblx0fSkoZnVuY3Rpb24gKCkge1xuXHRcdHZhciBkZWZpbmUsIG1vZHVsZSwgZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCwgbiwgcikge1xuXHRcdFx0ZnVuY3Rpb24gcyhvLCB1KSB7XG5cdFx0XHRcdGlmICghbltvXSkge1xuXHRcdFx0XHRcdGlmICghdFtvXSkge1xuXHRcdFx0XHRcdFx0dmFyIGEgPSB0eXBlb2YgcmVxdWlyZSA9PSBcImZ1bmN0aW9uXCIgJiYgcmVxdWlyZTtpZiAoIXUgJiYgYSkgcmV0dXJuIGEobywgITApO2lmIChpKSByZXR1cm4gaShvLCAhMCk7dmFyIGYgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgbyArIFwiJ1wiKTt0aHJvdyAoZi5jb2RlID0gXCJNT0RVTEVfTk9UX0ZPVU5EXCIsIGYpO1xuXHRcdFx0XHRcdH12YXIgbCA9IG5bb10gPSB7IGV4cG9ydHM6IHt9IH07dFtvXVswXS5jYWxsKGwuZXhwb3J0cywgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdHZhciBuID0gdFtvXVsxXVtlXTtyZXR1cm4gcyhuID8gbiA6IGUpO1xuXHRcdFx0XHRcdH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgbiwgcik7XG5cdFx0XHRcdH1yZXR1cm4gbltvXS5leHBvcnRzO1xuXHRcdFx0fXZhciBpID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7Zm9yICh2YXIgbyA9IDA7IG8gPCByLmxlbmd0aDsgbysrKSBzKHJbb10pO3JldHVybiBzO1xuXHRcdH0pKHsgMTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IF9kZXJlcV8oJy4vbGliLycpO1xuXHRcdFx0fSwgeyBcIi4vbGliL1wiOiAyIH1dLCAyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gX2RlcmVxXygnLi9zb2NrZXQnKTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFeHBvcnRzIHBhcnNlclxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKlxuICAgICAqL1xuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cy5wYXJzZXIgPSBfZGVyZXFfKCdlbmdpbmUuaW8tcGFyc2VyJyk7XG5cdFx0XHR9LCB7IFwiLi9zb2NrZXRcIjogMywgXCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5IH1dLCAzOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciB0cmFuc3BvcnRzID0gX2RlcmVxXygnLi90cmFuc3BvcnRzJyk7XG5cdFx0XHRcdFx0dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKCdjb21wb25lbnQtZW1pdHRlcicpO1xuXHRcdFx0XHRcdHZhciBkZWJ1ZyA9IF9kZXJlcV8oJ2RlYnVnJykoJ2VuZ2luZS5pby1jbGllbnQ6c29ja2V0Jyk7XG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gX2RlcmVxXygnaW5kZXhvZicpO1xuXHRcdFx0XHRcdHZhciBwYXJzZXIgPSBfZGVyZXFfKCdlbmdpbmUuaW8tcGFyc2VyJyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNldXJpID0gX2RlcmVxXygncGFyc2V1cmknKTtcblx0XHRcdFx0XHR2YXIgcGFyc2Vqc29uID0gX2RlcmVxXygncGFyc2Vqc29uJyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNlcXMgPSBfZGVyZXFfKCdwYXJzZXFzJyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBTb2NrZXQ7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTm9vcCBmdW5jdGlvbi5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gbm9vcCgpIHt9XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogU29ja2V0IGNvbnN0cnVjdG9yLlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IHVyaSBvciBvcHRpb25zXG4gICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gU29ja2V0KHVyaSwgb3B0cykge1xuXHRcdFx0XHRcdFx0aWYgKCEodGhpcyBpbnN0YW5jZW9mIFNvY2tldCkpIHJldHVybiBuZXcgU29ja2V0KHVyaSwgb3B0cyk7XG5cblx0XHRcdFx0XHRcdG9wdHMgPSBvcHRzIHx8IHt9O1xuXG5cdFx0XHRcdFx0XHRpZiAodXJpICYmICdvYmplY3QnID09IHR5cGVvZiB1cmkpIHtcblx0XHRcdFx0XHRcdFx0b3B0cyA9IHVyaTtcblx0XHRcdFx0XHRcdFx0dXJpID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHVyaSkge1xuXHRcdFx0XHRcdFx0XHR1cmkgPSBwYXJzZXVyaSh1cmkpO1xuXHRcdFx0XHRcdFx0XHRvcHRzLmhvc3RuYW1lID0gdXJpLmhvc3Q7XG5cdFx0XHRcdFx0XHRcdG9wdHMuc2VjdXJlID0gdXJpLnByb3RvY29sID09ICdodHRwcycgfHwgdXJpLnByb3RvY29sID09ICd3c3MnO1xuXHRcdFx0XHRcdFx0XHRvcHRzLnBvcnQgPSB1cmkucG9ydDtcblx0XHRcdFx0XHRcdFx0aWYgKHVyaS5xdWVyeSkgb3B0cy5xdWVyeSA9IHVyaS5xdWVyeTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAob3B0cy5ob3N0KSB7XG5cdFx0XHRcdFx0XHRcdG9wdHMuaG9zdG5hbWUgPSBwYXJzZXVyaShvcHRzLmhvc3QpLmhvc3Q7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuc2VjdXJlID0gbnVsbCAhPSBvcHRzLnNlY3VyZSA/IG9wdHMuc2VjdXJlIDogZ2xvYmFsLmxvY2F0aW9uICYmICdodHRwczonID09IGxvY2F0aW9uLnByb3RvY29sO1xuXG5cdFx0XHRcdFx0XHRpZiAob3B0cy5ob3N0bmFtZSAmJiAhb3B0cy5wb3J0KSB7XG5cdFx0XHRcdFx0XHRcdC8vIGlmIG5vIHBvcnQgaXMgc3BlY2lmaWVkIG1hbnVhbGx5LCB1c2UgdGhlIHByb3RvY29sIGRlZmF1bHRcblx0XHRcdFx0XHRcdFx0b3B0cy5wb3J0ID0gdGhpcy5zZWN1cmUgPyAnNDQzJyA6ICc4MCc7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuYWdlbnQgPSBvcHRzLmFnZW50IHx8IGZhbHNlO1xuXHRcdFx0XHRcdFx0dGhpcy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWUgfHwgKGdsb2JhbC5sb2NhdGlvbiA/IGxvY2F0aW9uLmhvc3RuYW1lIDogJ2xvY2FsaG9zdCcpO1xuXHRcdFx0XHRcdFx0dGhpcy5wb3J0ID0gb3B0cy5wb3J0IHx8IChnbG9iYWwubG9jYXRpb24gJiYgbG9jYXRpb24ucG9ydCA/IGxvY2F0aW9uLnBvcnQgOiB0aGlzLnNlY3VyZSA/IDQ0MyA6IDgwKTtcblx0XHRcdFx0XHRcdHRoaXMucXVlcnkgPSBvcHRzLnF1ZXJ5IHx8IHt9O1xuXHRcdFx0XHRcdFx0aWYgKCdzdHJpbmcnID09IHR5cGVvZiB0aGlzLnF1ZXJ5KSB0aGlzLnF1ZXJ5ID0gcGFyc2Vxcy5kZWNvZGUodGhpcy5xdWVyeSk7XG5cdFx0XHRcdFx0XHR0aGlzLnVwZ3JhZGUgPSBmYWxzZSAhPT0gb3B0cy51cGdyYWRlO1xuXHRcdFx0XHRcdFx0dGhpcy5wYXRoID0gKG9wdHMucGF0aCB8fCAnL2VuZ2luZS5pbycpLnJlcGxhY2UoL1xcLyQvLCAnJykgKyAnLyc7XG5cdFx0XHRcdFx0XHR0aGlzLmZvcmNlSlNPTlAgPSAhIW9wdHMuZm9yY2VKU09OUDtcblx0XHRcdFx0XHRcdHRoaXMuanNvbnAgPSBmYWxzZSAhPT0gb3B0cy5qc29ucDtcblx0XHRcdFx0XHRcdHRoaXMuZm9yY2VCYXNlNjQgPSAhIW9wdHMuZm9yY2VCYXNlNjQ7XG5cdFx0XHRcdFx0XHR0aGlzLmVuYWJsZXNYRFIgPSAhIW9wdHMuZW5hYmxlc1hEUjtcblx0XHRcdFx0XHRcdHRoaXMudGltZXN0YW1wUGFyYW0gPSBvcHRzLnRpbWVzdGFtcFBhcmFtIHx8ICd0Jztcblx0XHRcdFx0XHRcdHRoaXMudGltZXN0YW1wUmVxdWVzdHMgPSBvcHRzLnRpbWVzdGFtcFJlcXVlc3RzO1xuXHRcdFx0XHRcdFx0dGhpcy50cmFuc3BvcnRzID0gb3B0cy50cmFuc3BvcnRzIHx8IFsncG9sbGluZycsICd3ZWJzb2NrZXQnXTtcblx0XHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICcnO1xuXHRcdFx0XHRcdFx0dGhpcy53cml0ZUJ1ZmZlciA9IFtdO1xuXHRcdFx0XHRcdFx0dGhpcy5wb2xpY3lQb3J0ID0gb3B0cy5wb2xpY3lQb3J0IHx8IDg0Mztcblx0XHRcdFx0XHRcdHRoaXMucmVtZW1iZXJVcGdyYWRlID0gb3B0cy5yZW1lbWJlclVwZ3JhZGUgfHwgZmFsc2U7XG5cdFx0XHRcdFx0XHR0aGlzLmJpbmFyeVR5cGUgPSBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5vbmx5QmluYXJ5VXBncmFkZXMgPSBvcHRzLm9ubHlCaW5hcnlVcGdyYWRlcztcblx0XHRcdFx0XHRcdHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSBmYWxzZSAhPT0gb3B0cy5wZXJNZXNzYWdlRGVmbGF0ZSA/IG9wdHMucGVyTWVzc2FnZURlZmxhdGUgfHwge30gOiBmYWxzZTtcblxuXHRcdFx0XHRcdFx0aWYgKHRydWUgPT09IHRoaXMucGVyTWVzc2FnZURlZmxhdGUpIHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSB7fTtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnBlck1lc3NhZ2VEZWZsYXRlICYmIG51bGwgPT0gdGhpcy5wZXJNZXNzYWdlRGVmbGF0ZS50aHJlc2hvbGQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wZXJNZXNzYWdlRGVmbGF0ZS50aHJlc2hvbGQgPSAxMDI0O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTU0wgb3B0aW9ucyBmb3IgTm9kZS5qcyBjbGllbnRcblx0XHRcdFx0XHRcdHRoaXMucGZ4ID0gb3B0cy5wZnggfHwgbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMua2V5ID0gb3B0cy5rZXkgfHwgbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMucGFzc3BocmFzZSA9IG9wdHMucGFzc3BocmFzZSB8fCBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5jZXJ0ID0gb3B0cy5jZXJ0IHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLmNhID0gb3B0cy5jYSB8fCBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5jaXBoZXJzID0gb3B0cy5jaXBoZXJzIHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLnJlamVjdFVuYXV0aG9yaXplZCA9IG9wdHMucmVqZWN0VW5hdXRob3JpemVkID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cblx0XHRcdFx0XHRcdC8vIG90aGVyIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0XHR2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsO1xuXHRcdFx0XHRcdFx0aWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChvcHRzLmV4dHJhSGVhZGVycyAmJiBPYmplY3Qua2V5cyhvcHRzLmV4dHJhSGVhZGVycykubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dGhpcy5vcGVuKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1peCBpbiBgRW1pdHRlcmAuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0RW1pdHRlcihTb2NrZXQucHJvdG90eXBlKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBQcm90b2NvbCB2ZXJzaW9uLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b2NvbCA9IHBhcnNlci5wcm90b2NvbDsgLy8gdGhpcyBpcyBhbiBpbnRcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFeHBvc2UgZGVwcyBmb3IgbGVnYWN5IGNvbXBhdGliaWxpdHlcbiAgICAgICogYW5kIHN0YW5kYWxvbmUgYnJvd3NlciBhY2Nlc3MuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LlNvY2tldCA9IFNvY2tldDtcblx0XHRcdFx0XHRTb2NrZXQuVHJhbnNwb3J0ID0gX2RlcmVxXygnLi90cmFuc3BvcnQnKTtcblx0XHRcdFx0XHRTb2NrZXQudHJhbnNwb3J0cyA9IF9kZXJlcV8oJy4vdHJhbnNwb3J0cycpO1xuXHRcdFx0XHRcdFNvY2tldC5wYXJzZXIgPSBfZGVyZXFfKCdlbmdpbmUuaW8tcGFyc2VyJyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ3JlYXRlcyB0cmFuc3BvcnQgb2YgdGhlIGdpdmVuIHR5cGUuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0cmFuc3BvcnQgbmFtZVxuICAgICAgKiBAcmV0dXJuIHtUcmFuc3BvcnR9XG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuY3JlYXRlVHJhbnNwb3J0ID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdjcmVhdGluZyB0cmFuc3BvcnQgXCIlc1wiJywgbmFtZSk7XG5cdFx0XHRcdFx0XHR2YXIgcXVlcnkgPSBjbG9uZSh0aGlzLnF1ZXJ5KTtcblxuXHRcdFx0XHRcdFx0Ly8gYXBwZW5kIGVuZ2luZS5pbyBwcm90b2NvbCBpZGVudGlmaWVyXG5cdFx0XHRcdFx0XHRxdWVyeS5FSU8gPSBwYXJzZXIucHJvdG9jb2w7XG5cblx0XHRcdFx0XHRcdC8vIHRyYW5zcG9ydCBuYW1lXG5cdFx0XHRcdFx0XHRxdWVyeS50cmFuc3BvcnQgPSBuYW1lO1xuXG5cdFx0XHRcdFx0XHQvLyBzZXNzaW9uIGlkIGlmIHdlIGFscmVhZHkgaGF2ZSBvbmVcblx0XHRcdFx0XHRcdGlmICh0aGlzLmlkKSBxdWVyeS5zaWQgPSB0aGlzLmlkO1xuXG5cdFx0XHRcdFx0XHR2YXIgdHJhbnNwb3J0ID0gbmV3IHRyYW5zcG9ydHNbbmFtZV0oe1xuXHRcdFx0XHRcdFx0XHRhZ2VudDogdGhpcy5hZ2VudCxcblx0XHRcdFx0XHRcdFx0aG9zdG5hbWU6IHRoaXMuaG9zdG5hbWUsXG5cdFx0XHRcdFx0XHRcdHBvcnQ6IHRoaXMucG9ydCxcblx0XHRcdFx0XHRcdFx0c2VjdXJlOiB0aGlzLnNlY3VyZSxcblx0XHRcdFx0XHRcdFx0cGF0aDogdGhpcy5wYXRoLFxuXHRcdFx0XHRcdFx0XHRxdWVyeTogcXVlcnksXG5cdFx0XHRcdFx0XHRcdGZvcmNlSlNPTlA6IHRoaXMuZm9yY2VKU09OUCxcblx0XHRcdFx0XHRcdFx0anNvbnA6IHRoaXMuanNvbnAsXG5cdFx0XHRcdFx0XHRcdGZvcmNlQmFzZTY0OiB0aGlzLmZvcmNlQmFzZTY0LFxuXHRcdFx0XHRcdFx0XHRlbmFibGVzWERSOiB0aGlzLmVuYWJsZXNYRFIsXG5cdFx0XHRcdFx0XHRcdHRpbWVzdGFtcFJlcXVlc3RzOiB0aGlzLnRpbWVzdGFtcFJlcXVlc3RzLFxuXHRcdFx0XHRcdFx0XHR0aW1lc3RhbXBQYXJhbTogdGhpcy50aW1lc3RhbXBQYXJhbSxcblx0XHRcdFx0XHRcdFx0cG9saWN5UG9ydDogdGhpcy5wb2xpY3lQb3J0LFxuXHRcdFx0XHRcdFx0XHRzb2NrZXQ6IHRoaXMsXG5cdFx0XHRcdFx0XHRcdHBmeDogdGhpcy5wZngsXG5cdFx0XHRcdFx0XHRcdGtleTogdGhpcy5rZXksXG5cdFx0XHRcdFx0XHRcdHBhc3NwaHJhc2U6IHRoaXMucGFzc3BocmFzZSxcblx0XHRcdFx0XHRcdFx0Y2VydDogdGhpcy5jZXJ0LFxuXHRcdFx0XHRcdFx0XHRjYTogdGhpcy5jYSxcblx0XHRcdFx0XHRcdFx0Y2lwaGVyczogdGhpcy5jaXBoZXJzLFxuXHRcdFx0XHRcdFx0XHRyZWplY3RVbmF1dGhvcml6ZWQ6IHRoaXMucmVqZWN0VW5hdXRob3JpemVkLFxuXHRcdFx0XHRcdFx0XHRwZXJNZXNzYWdlRGVmbGF0ZTogdGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSxcblx0XHRcdFx0XHRcdFx0ZXh0cmFIZWFkZXJzOiB0aGlzLmV4dHJhSGVhZGVyc1xuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiB0cmFuc3BvcnQ7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGNsb25lKG9iaikge1xuXHRcdFx0XHRcdFx0dmFyIG8gPSB7fTtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChvYmouaGFzT3duUHJvcGVydHkoaSkpIHtcblx0XHRcdFx0XHRcdFx0XHRvW2ldID0gb2JqW2ldO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogSW5pdGlhbGl6ZXMgdHJhbnNwb3J0IHRvIHVzZSBhbmQgc3RhcnRzIHByb2JlLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHRyYW5zcG9ydDtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnJlbWVtYmVyVXBncmFkZSAmJiBTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmIHRoaXMudHJhbnNwb3J0cy5pbmRleE9mKCd3ZWJzb2NrZXQnKSAhPSAtMSkge1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSAnd2Vic29ja2V0Jztcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoMCA9PT0gdGhpcy50cmFuc3BvcnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHQvLyBFbWl0IGVycm9yIG9uIG5leHQgdGljayBzbyBpdCBjYW4gYmUgbGlzdGVuZWQgdG9cblx0XHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ2Vycm9yJywgJ05vIHRyYW5zcG9ydHMgYXZhaWxhYmxlJyk7XG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSB0aGlzLnRyYW5zcG9ydHNbMF07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3BlbmluZyc7XG5cblx0XHRcdFx0XHRcdC8vIFJldHJ5IHdpdGggdGhlIG5leHQgdHJhbnNwb3J0IGlmIHRoZSB0cmFuc3BvcnQgaXMgZGlzYWJsZWQgKGpzb25wOiBmYWxzZSlcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydCA9IHRoaXMuY3JlYXRlVHJhbnNwb3J0KHRyYW5zcG9ydCk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0cy5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLm9wZW4oKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub3BlbigpO1xuXHRcdFx0XHRcdFx0dGhpcy5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFNldHMgdGhlIGN1cnJlbnQgdHJhbnNwb3J0LiBEaXNhYmxlcyB0aGUgZXhpc3Rpbmcgb25lIChpZiBhbnkpLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnNldFRyYW5zcG9ydCA9IGZ1bmN0aW9uICh0cmFuc3BvcnQpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdzZXR0aW5nIHRyYW5zcG9ydCAlcycsIHRyYW5zcG9ydC5uYW1lKTtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMudHJhbnNwb3J0KSB7XG5cdFx0XHRcdFx0XHRcdGRlYnVnKCdjbGVhcmluZyBleGlzdGluZyB0cmFuc3BvcnQgJXMnLCB0aGlzLnRyYW5zcG9ydC5uYW1lKTtcblx0XHRcdFx0XHRcdFx0dGhpcy50cmFuc3BvcnQucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIHNldCB1cCB0cmFuc3BvcnRcblx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuXG5cdFx0XHRcdFx0XHQvLyBzZXQgdXAgdHJhbnNwb3J0IGxpc3RlbmVyc1xuXHRcdFx0XHRcdFx0dHJhbnNwb3J0Lm9uKCdkcmFpbicsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkRyYWluKCk7XG5cdFx0XHRcdFx0XHR9KS5vbigncGFja2V0JywgZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uUGFja2V0KHBhY2tldCk7XG5cdFx0XHRcdFx0XHR9KS5vbignZXJyb3InLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoZSk7XG5cdFx0XHRcdFx0XHR9KS5vbignY2xvc2UnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgndHJhbnNwb3J0IGNsb3NlJyk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFByb2JlcyBhIHRyYW5zcG9ydC5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtTdHJpbmd9IHRyYW5zcG9ydCBuYW1lXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUucHJvYmUgPSBmdW5jdGlvbiAobmFtZSkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3Byb2JpbmcgdHJhbnNwb3J0IFwiJXNcIicsIG5hbWUpO1xuXHRcdFx0XHRcdFx0dmFyIHRyYW5zcG9ydCA9IHRoaXMuY3JlYXRlVHJhbnNwb3J0KG5hbWUsIHsgcHJvYmU6IDEgfSksXG5cdFx0XHRcdFx0XHQgICAgZmFpbGVkID0gZmFsc2UsXG5cdFx0XHRcdFx0XHQgICAgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdFNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSBmYWxzZTtcblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gb25UcmFuc3BvcnRPcGVuKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5vbmx5QmluYXJ5VXBncmFkZXMpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgdXBncmFkZUxvc2VzQmluYXJ5ID0gIXRoaXMuc3VwcG9ydHNCaW5hcnkgJiYgc2VsZi50cmFuc3BvcnQuc3VwcG9ydHNCaW5hcnk7XG5cdFx0XHRcdFx0XHRcdFx0ZmFpbGVkID0gZmFpbGVkIHx8IHVwZ3JhZGVMb3Nlc0JpbmFyeTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoZmFpbGVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3Byb2JlIHRyYW5zcG9ydCBcIiVzXCIgb3BlbmVkJywgbmFtZSk7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5zZW5kKFt7IHR5cGU6ICdwaW5nJywgZGF0YTogJ3Byb2JlJyB9XSk7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5vbmNlKCdwYWNrZXQnLCBmdW5jdGlvbiAobXNnKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGZhaWxlZCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0XHRcdGlmICgncG9uZycgPT0gbXNnLnR5cGUgJiYgJ3Byb2JlJyA9PSBtc2cuZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ3Byb2JlIHRyYW5zcG9ydCBcIiVzXCIgcG9uZycsIG5hbWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi51cGdyYWRpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5lbWl0KCd1cGdyYWRpbmcnLCB0cmFuc3BvcnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCF0cmFuc3BvcnQpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHRcdFNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSAnd2Vic29ja2V0JyA9PSB0cmFuc3BvcnQubmFtZTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ3BhdXNpbmcgY3VycmVudCB0cmFuc3BvcnQgXCIlc1wiJywgc2VsZi50cmFuc3BvcnQubmFtZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLnRyYW5zcG9ydC5wYXVzZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChmYWlsZWQpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCdjbG9zZWQnID09IHNlbGYucmVhZHlTdGF0ZSkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygnY2hhbmdpbmcgdHJhbnNwb3J0IGFuZCBzZW5kaW5nIHVwZ3JhZGUgcGFja2V0Jyk7XG5cblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2xlYW51cCgpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuc2V0VHJhbnNwb3J0KHRyYW5zcG9ydCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5zZW5kKFt7IHR5cGU6ICd1cGdyYWRlJyB9XSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgndXBncmFkZScsIHRyYW5zcG9ydCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyYW5zcG9ydCA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYudXBncmFkaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZmx1c2goKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQnLCBuYW1lKTtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoJ3Byb2JlIGVycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnIudHJhbnNwb3J0ID0gdHJhbnNwb3J0Lm5hbWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ3VwZ3JhZGVFcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZnJlZXplVHJhbnNwb3J0KCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZmFpbGVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0Ly8gQW55IGNhbGxiYWNrIGNhbGxlZCBieSB0cmFuc3BvcnQgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2Ugbm93XG5cdFx0XHRcdFx0XHRcdGZhaWxlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0Y2xlYW51cCgpO1xuXG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL0hhbmRsZSBhbnkgZXJyb3IgdGhhdCBoYXBwZW5zIHdoaWxlIHByb2Jpbmdcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIG9uZXJyb3IoZXJyKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigncHJvYmUgZXJyb3I6ICcgKyBlcnIpO1xuXHRcdFx0XHRcdFx0XHRlcnJvci50cmFuc3BvcnQgPSB0cmFuc3BvcnQubmFtZTtcblxuXHRcdFx0XHRcdFx0XHRmcmVlemVUcmFuc3BvcnQoKTtcblxuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQgYmVjYXVzZSBvZiBlcnJvcjogJXMnLCBuYW1lLCBlcnIpO1xuXG5cdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgndXBncmFkZUVycm9yJywgZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBvblRyYW5zcG9ydENsb3NlKCkge1xuXHRcdFx0XHRcdFx0XHRvbmVycm9yKFwidHJhbnNwb3J0IGNsb3NlZFwiKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly9XaGVuIHRoZSBzb2NrZXQgaXMgY2xvc2VkIHdoaWxlIHdlJ3JlIHByb2Jpbmdcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIG9uY2xvc2UoKSB7XG5cdFx0XHRcdFx0XHRcdG9uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL1doZW4gdGhlIHNvY2tldCBpcyB1cGdyYWRlZCB3aGlsZSB3ZSdyZSBwcm9iaW5nXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBvbnVwZ3JhZGUodG8pIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9IHRyYW5zcG9ydC5uYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ1wiJXNcIiB3b3JrcyAtIGFib3J0aW5nIFwiJXNcIicsIHRvLm5hbWUsIHRyYW5zcG9ydC5uYW1lKTtcblx0XHRcdFx0XHRcdFx0XHRmcmVlemVUcmFuc3BvcnQoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL1JlbW92ZSBhbGwgbGlzdGVuZXJzIG9uIHRoZSB0cmFuc3BvcnQgYW5kIG9uIHNlbGZcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNsZWFudXAoKSB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcignb3BlbicsIG9uVHJhbnNwb3J0T3Blbik7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTtcblx0XHRcdFx0XHRcdFx0dHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uVHJhbnNwb3J0Q2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uY2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnJlbW92ZUxpc3RlbmVyKCd1cGdyYWRpbmcnLCBvbnVwZ3JhZGUpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub25jZSgnb3BlbicsIG9uVHJhbnNwb3J0T3Blbik7XG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub25jZSgnZXJyb3InLCBvbmVycm9yKTtcblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5vbmNlKCdjbG9zZScsIG9uVHJhbnNwb3J0Q2xvc2UpO1xuXG5cdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ2Nsb3NlJywgb25jbG9zZSk7XG5cdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ3VwZ3JhZGluZycsIG9udXBncmFkZSk7XG5cblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5vcGVuKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDYWxsZWQgd2hlbiBjb25uZWN0aW9uIGlzIGRlZW1lZCBvcGVuLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3NvY2tldCBvcGVuJyk7XG5cdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3Blbic7XG5cdFx0XHRcdFx0XHRTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gJ3dlYnNvY2tldCcgPT0gdGhpcy50cmFuc3BvcnQubmFtZTtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnb3BlbicpO1xuXHRcdFx0XHRcdFx0dGhpcy5mbHVzaCgpO1xuXG5cdFx0XHRcdFx0XHQvLyB3ZSBjaGVjayBmb3IgYHJlYWR5U3RhdGVgIGluIGNhc2UgYW4gYG9wZW5gXG5cdFx0XHRcdFx0XHQvLyBsaXN0ZW5lciBhbHJlYWR5IGNsb3NlZCB0aGUgc29ja2V0XG5cdFx0XHRcdFx0XHRpZiAoJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSAmJiB0aGlzLnVwZ3JhZGUgJiYgdGhpcy50cmFuc3BvcnQucGF1c2UpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3N0YXJ0aW5nIHVwZ3JhZGUgcHJvYmVzJyk7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy51cGdyYWRlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnByb2JlKHRoaXMudXBncmFkZXNbaV0pO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBIYW5kbGVzIGEgcGFja2V0LlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uUGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0aWYgKCdvcGVuaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1Zygnc29ja2V0IHJlY2VpdmU6IHR5cGUgXCIlc1wiLCBkYXRhIFwiJXNcIicsIHBhY2tldC50eXBlLCBwYWNrZXQuZGF0YSk7XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdwYWNrZXQnLCBwYWNrZXQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIFNvY2tldCBpcyBsaXZlIC0gYW55IHBhY2tldCBjb3VudHNcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdoZWFydGJlYXQnKTtcblxuXHRcdFx0XHRcdFx0XHRzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAnb3Blbic6XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9uSGFuZHNoYWtlKHBhcnNlanNvbihwYWNrZXQuZGF0YSkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0XHRjYXNlICdwb25nJzpcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2V0UGluZygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdwb25nJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ2Vycm9yJzpcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoJ3NlcnZlciBlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyLmNvZGUgPSBwYWNrZXQuZGF0YTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub25FcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0XHRjYXNlICdtZXNzYWdlJzpcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZGF0YScsIHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnbWVzc2FnZScsIHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncGFja2V0IHJlY2VpdmVkIHdpdGggc29ja2V0IHJlYWR5U3RhdGUgXCIlc1wiJywgdGhpcy5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENhbGxlZCB1cG9uIGhhbmRzaGFrZSBjb21wbGV0aW9uLlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge09iamVjdH0gaGFuZHNoYWtlIG9ialxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uSGFuZHNoYWtlID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnaGFuZHNoYWtlJywgZGF0YSk7XG5cdFx0XHRcdFx0XHR0aGlzLmlkID0gZGF0YS5zaWQ7XG5cdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5xdWVyeS5zaWQgPSBkYXRhLnNpZDtcblx0XHRcdFx0XHRcdHRoaXMudXBncmFkZXMgPSB0aGlzLmZpbHRlclVwZ3JhZGVzKGRhdGEudXBncmFkZXMpO1xuXHRcdFx0XHRcdFx0dGhpcy5waW5nSW50ZXJ2YWwgPSBkYXRhLnBpbmdJbnRlcnZhbDtcblx0XHRcdFx0XHRcdHRoaXMucGluZ1RpbWVvdXQgPSBkYXRhLnBpbmdUaW1lb3V0O1xuXHRcdFx0XHRcdFx0dGhpcy5vbk9wZW4oKTtcblx0XHRcdFx0XHRcdC8vIEluIGNhc2Ugb3BlbiBoYW5kbGVyIGNsb3NlcyBzb2NrZXRcblx0XHRcdFx0XHRcdGlmICgnY2xvc2VkJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHJldHVybjtcblx0XHRcdFx0XHRcdHRoaXMuc2V0UGluZygpO1xuXG5cdFx0XHRcdFx0XHQvLyBQcm9sb25nIGxpdmVuZXNzIG9mIHNvY2tldCBvbiBoZWFydGJlYXRcblx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlTGlzdGVuZXIoJ2hlYXJ0YmVhdCcsIHRoaXMub25IZWFydGJlYXQpO1xuXHRcdFx0XHRcdFx0dGhpcy5vbignaGVhcnRiZWF0JywgdGhpcy5vbkhlYXJ0YmVhdCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBSZXNldHMgcGluZyB0aW1lb3V0LlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uSGVhcnRiZWF0ID0gZnVuY3Rpb24gKHRpbWVvdXQpIHtcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnBpbmdUaW1lb3V0VGltZXIpO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0c2VsZi5waW5nVGltZW91dFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdGlmICgnY2xvc2VkJyA9PSBzZWxmLnJlYWR5U3RhdGUpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkNsb3NlKCdwaW5nIHRpbWVvdXQnKTtcblx0XHRcdFx0XHRcdH0sIHRpbWVvdXQgfHwgc2VsZi5waW5nSW50ZXJ2YWwgKyBzZWxmLnBpbmdUaW1lb3V0KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFBpbmdzIHNlcnZlciBldmVyeSBgdGhpcy5waW5nSW50ZXJ2YWxgIGFuZCBleHBlY3RzIHJlc3BvbnNlXG4gICAgICAqIHdpdGhpbiBgdGhpcy5waW5nVGltZW91dGAgb3IgY2xvc2VzIGNvbm5lY3Rpb24uXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuc2V0UGluZyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dChzZWxmLnBpbmdJbnRlcnZhbFRpbWVyKTtcblx0XHRcdFx0XHRcdHNlbGYucGluZ0ludGVydmFsVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3dyaXRpbmcgcGluZyBwYWNrZXQgLSBleHBlY3RpbmcgcG9uZyB3aXRoaW4gJXNtcycsIHNlbGYucGluZ1RpbWVvdXQpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnBpbmcoKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkhlYXJ0YmVhdChzZWxmLnBpbmdUaW1lb3V0KTtcblx0XHRcdFx0XHRcdH0sIHNlbGYucGluZ0ludGVydmFsKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICogU2VuZHMgYSBwaW5nIHBhY2tldC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5waW5nID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dGhpcy5zZW5kUGFja2V0KCdwaW5nJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ3BpbmcnKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FsbGVkIG9uIGBkcmFpbmAgZXZlbnRcbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbkRyYWluID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dGhpcy53cml0ZUJ1ZmZlci5zcGxpY2UoMCwgdGhpcy5wcmV2QnVmZmVyTGVuKTtcblxuXHRcdFx0XHRcdFx0Ly8gc2V0dGluZyBwcmV2QnVmZmVyTGVuID0gMCBpcyB2ZXJ5IGltcG9ydGFudFxuXHRcdFx0XHRcdFx0Ly8gZm9yIGV4YW1wbGUsIHdoZW4gdXBncmFkaW5nLCB1cGdyYWRlIHBhY2tldCBpcyBzZW50IG92ZXIsXG5cdFx0XHRcdFx0XHQvLyBhbmQgYSBub256ZXJvIHByZXZCdWZmZXJMZW4gY291bGQgY2F1c2UgcHJvYmxlbXMgb24gYGRyYWluYFxuXHRcdFx0XHRcdFx0dGhpcy5wcmV2QnVmZmVyTGVuID0gMDtcblxuXHRcdFx0XHRcdFx0aWYgKDAgPT09IHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZHJhaW4nKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZmx1c2goKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEZsdXNoIHdyaXRlIGJ1ZmZlcnMuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRpZiAoJ2Nsb3NlZCcgIT0gdGhpcy5yZWFkeVN0YXRlICYmIHRoaXMudHJhbnNwb3J0LndyaXRhYmxlICYmICF0aGlzLnVwZ3JhZGluZyAmJiB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygnZmx1c2hpbmcgJWQgcGFja2V0cyBpbiBzb2NrZXQnLCB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0LnNlbmQodGhpcy53cml0ZUJ1ZmZlcik7XG5cdFx0XHRcdFx0XHRcdC8vIGtlZXAgdHJhY2sgb2YgY3VycmVudCBsZW5ndGggb2Ygd3JpdGVCdWZmZXJcblx0XHRcdFx0XHRcdFx0Ly8gc3BsaWNlIHdyaXRlQnVmZmVyIGFuZCBjYWxsYmFja0J1ZmZlciBvbiBgZHJhaW5gXG5cdFx0XHRcdFx0XHRcdHRoaXMucHJldkJ1ZmZlckxlbiA9IHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2ZsdXNoJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBTZW5kcyBhIG1lc3NhZ2UuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlLlxuICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuXG4gICAgICAqIEByZXR1cm4ge1NvY2tldH0gZm9yIGNoYWluaW5nLlxuICAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUud3JpdGUgPSBTb2NrZXQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAobXNnLCBvcHRpb25zLCBmbikge1xuXHRcdFx0XHRcdFx0dGhpcy5zZW5kUGFja2V0KCdtZXNzYWdlJywgbXNnLCBvcHRpb25zLCBmbik7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFja2V0IHR5cGUuXG4gICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLlxuICAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cbiAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuc2VuZFBhY2tldCA9IGZ1bmN0aW9uICh0eXBlLCBkYXRhLCBvcHRpb25zLCBmbikge1xuXHRcdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0Zm4gPSBkYXRhO1xuXHRcdFx0XHRcdFx0XHRkYXRhID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyA9PSB0eXBlb2Ygb3B0aW9ucykge1xuXHRcdFx0XHRcdFx0XHRmbiA9IG9wdGlvbnM7XG5cdFx0XHRcdFx0XHRcdG9wdGlvbnMgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoJ2Nsb3NpbmcnID09IHRoaXMucmVhZHlTdGF0ZSB8fCAnY2xvc2VkJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHRcdFx0XHRcdG9wdGlvbnMuY29tcHJlc3MgPSBmYWxzZSAhPT0gb3B0aW9ucy5jb21wcmVzcztcblxuXHRcdFx0XHRcdFx0dmFyIHBhY2tldCA9IHtcblx0XHRcdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdFx0XHRcdFx0b3B0aW9uczogb3B0aW9uc1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgncGFja2V0Q3JlYXRlJywgcGFja2V0KTtcblx0XHRcdFx0XHRcdHRoaXMud3JpdGVCdWZmZXIucHVzaChwYWNrZXQpO1xuXHRcdFx0XHRcdFx0aWYgKGZuKSB0aGlzLm9uY2UoJ2ZsdXNoJywgZm4pO1xuXHRcdFx0XHRcdFx0dGhpcy5mbHVzaCgpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2xvc2VzIHRoZSBjb25uZWN0aW9uLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKCdvcGVuaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnY2xvc2luZyc7XG5cblx0XHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMub25jZSgnZHJhaW4nLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy51cGdyYWRpbmcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2FpdEZvclVwZ3JhZGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAodGhpcy51cGdyYWRpbmcpIHtcblx0XHRcdFx0XHRcdFx0XHR3YWl0Rm9yVXBncmFkZSgpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gY2xvc2UoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgnZm9yY2VkIGNsb3NlJyk7XG5cdFx0XHRcdFx0XHRcdGRlYnVnKCdzb2NrZXQgY2xvc2luZyAtIHRlbGxpbmcgdHJhbnNwb3J0IHRvIGNsb3NlJyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYudHJhbnNwb3J0LmNsb3NlKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNsZWFudXBBbmRDbG9zZSgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVMaXN0ZW5lcigndXBncmFkZScsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHRcdHNlbGYucmVtb3ZlTGlzdGVuZXIoJ3VwZ3JhZGVFcnJvcicsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHdhaXRGb3JVcGdyYWRlKCkge1xuXHRcdFx0XHRcdFx0XHQvLyB3YWl0IGZvciB1cGdyYWRlIHRvIGZpbmlzaCBzaW5jZSB3ZSBjYW4ndCBzZW5kIHBhY2tldHMgd2hpbGUgcGF1c2luZyBhIHRyYW5zcG9ydFxuXHRcdFx0XHRcdFx0XHRzZWxmLm9uY2UoJ3VwZ3JhZGUnLCBjbGVhbnVwQW5kQ2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uY2UoJ3VwZ3JhZGVFcnJvcicsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FsbGVkIHVwb24gdHJhbnNwb3J0IGVycm9yXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdzb2NrZXQgZXJyb3IgJWonLCBlcnIpO1xuXHRcdFx0XHRcdFx0U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHR0aGlzLm9uQ2xvc2UoJ3RyYW5zcG9ydCBlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgY2xvc2UuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uIChyZWFzb24sIGRlc2MpIHtcblx0XHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gdGhpcy5yZWFkeVN0YXRlIHx8ICdvcGVuJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ2Nsb3NpbmcnID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1Zygnc29ja2V0IGNsb3NlIHdpdGggcmVhc29uOiBcIiVzXCInLCByZWFzb24pO1xuXHRcdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY2xlYXIgdGltZXJzXG5cdFx0XHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnBpbmdJbnRlcnZhbFRpbWVyKTtcblx0XHRcdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMucGluZ1RpbWVvdXRUaW1lcik7XG5cblx0XHRcdFx0XHRcdFx0Ly8gc3RvcCBldmVudCBmcm9tIGZpcmluZyBhZ2FpbiBmb3IgdHJhbnNwb3J0XG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygnY2xvc2UnKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBlbnN1cmUgdHJhbnNwb3J0IHdvbid0IHN0YXkgb3BlblxuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGlnbm9yZSBmdXJ0aGVyIHRyYW5zcG9ydCBjb21tdW5pY2F0aW9uXG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHNldCByZWFkeSBzdGF0ZVxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnY2xvc2VkJztcblxuXHRcdFx0XHRcdFx0XHQvLyBjbGVhciBzZXNzaW9uIGlkXG5cdFx0XHRcdFx0XHRcdHRoaXMuaWQgPSBudWxsO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGVtaXQgY2xvc2UgZXZlbnRcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdjbG9zZScsIHJlYXNvbiwgZGVzYyk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY2xlYW4gYnVmZmVycyBhZnRlciwgc28gdXNlcnMgY2FuIHN0aWxsXG5cdFx0XHRcdFx0XHRcdC8vIGdyYWIgdGhlIGJ1ZmZlcnMgb24gYGNsb3NlYCBldmVudFxuXHRcdFx0XHRcdFx0XHRzZWxmLndyaXRlQnVmZmVyID0gW107XG5cdFx0XHRcdFx0XHRcdHNlbGYucHJldkJ1ZmZlckxlbiA9IDA7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBGaWx0ZXJzIHVwZ3JhZGVzLCByZXR1cm5pbmcgb25seSB0aG9zZSBtYXRjaGluZyBjbGllbnQgdHJhbnNwb3J0cy5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtBcnJheX0gc2VydmVyIHVwZ3JhZGVzXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKlxuICAgICAgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuZmlsdGVyVXBncmFkZXMgPSBmdW5jdGlvbiAodXBncmFkZXMpIHtcblx0XHRcdFx0XHRcdHZhciBmaWx0ZXJlZFVwZ3JhZGVzID0gW107XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMCwgaiA9IHVwZ3JhZGVzLmxlbmd0aDsgaSA8IGo7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRpZiAofmluZGV4KHRoaXMudHJhbnNwb3J0cywgdXBncmFkZXNbaV0pKSBmaWx0ZXJlZFVwZ3JhZGVzLnB1c2godXBncmFkZXNbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIGZpbHRlcmVkVXBncmFkZXM7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHsgXCIuL3RyYW5zcG9ydFwiOiA0LCBcIi4vdHJhbnNwb3J0c1wiOiA1LCBcImNvbXBvbmVudC1lbWl0dGVyXCI6IDE1LCBcImRlYnVnXCI6IDE3LCBcImVuZ2luZS5pby1wYXJzZXJcIjogMTksIFwiaW5kZXhvZlwiOiAyMywgXCJwYXJzZWpzb25cIjogMjYsIFwicGFyc2Vxc1wiOiAyNywgXCJwYXJzZXVyaVwiOiAyOCB9XSwgNDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogTW9kdWxlIGRlcGVuZGVuY2llcy5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIgRW1pdHRlciA9IF9kZXJlcV8oJ2NvbXBvbmVudC1lbWl0dGVyJyk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAgICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBUcmFuc3BvcnQ7XG5cblx0XHRcdFx0LyoqXG4gICAgICogVHJhbnNwb3J0IGFic3RyYWN0IGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gVHJhbnNwb3J0KG9wdHMpIHtcblx0XHRcdFx0XHR0aGlzLnBhdGggPSBvcHRzLnBhdGg7XG5cdFx0XHRcdFx0dGhpcy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWU7XG5cdFx0XHRcdFx0dGhpcy5wb3J0ID0gb3B0cy5wb3J0O1xuXHRcdFx0XHRcdHRoaXMuc2VjdXJlID0gb3B0cy5zZWN1cmU7XG5cdFx0XHRcdFx0dGhpcy5xdWVyeSA9IG9wdHMucXVlcnk7XG5cdFx0XHRcdFx0dGhpcy50aW1lc3RhbXBQYXJhbSA9IG9wdHMudGltZXN0YW1wUGFyYW07XG5cdFx0XHRcdFx0dGhpcy50aW1lc3RhbXBSZXF1ZXN0cyA9IG9wdHMudGltZXN0YW1wUmVxdWVzdHM7XG5cdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJyc7XG5cdFx0XHRcdFx0dGhpcy5hZ2VudCA9IG9wdHMuYWdlbnQgfHwgZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5zb2NrZXQgPSBvcHRzLnNvY2tldDtcblx0XHRcdFx0XHR0aGlzLmVuYWJsZXNYRFIgPSBvcHRzLmVuYWJsZXNYRFI7XG5cblx0XHRcdFx0XHQvLyBTU0wgb3B0aW9ucyBmb3IgTm9kZS5qcyBjbGllbnRcblx0XHRcdFx0XHR0aGlzLnBmeCA9IG9wdHMucGZ4O1xuXHRcdFx0XHRcdHRoaXMua2V5ID0gb3B0cy5rZXk7XG5cdFx0XHRcdFx0dGhpcy5wYXNzcGhyYXNlID0gb3B0cy5wYXNzcGhyYXNlO1xuXHRcdFx0XHRcdHRoaXMuY2VydCA9IG9wdHMuY2VydDtcblx0XHRcdFx0XHR0aGlzLmNhID0gb3B0cy5jYTtcblx0XHRcdFx0XHR0aGlzLmNpcGhlcnMgPSBvcHRzLmNpcGhlcnM7XG5cdFx0XHRcdFx0dGhpcy5yZWplY3RVbmF1dGhvcml6ZWQgPSBvcHRzLnJlamVjdFVuYXV0aG9yaXplZDtcblxuXHRcdFx0XHRcdC8vIG90aGVyIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0dGhpcy5leHRyYUhlYWRlcnMgPSBvcHRzLmV4dHJhSGVhZGVycztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1peCBpbiBgRW1pdHRlcmAuXG4gICAgICovXG5cblx0XHRcdFx0RW1pdHRlcihUcmFuc3BvcnQucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFbWl0cyBhbiBlcnJvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtUcmFuc3BvcnR9IGZvciBjaGFpbmluZ1xuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKG1zZywgZGVzYykge1xuXHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IobXNnKTtcblx0XHRcdFx0XHRlcnIudHlwZSA9ICdUcmFuc3BvcnRFcnJvcic7XG5cdFx0XHRcdFx0ZXJyLmRlc2NyaXB0aW9uID0gZGVzYztcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBPcGVucyB0aGUgdHJhbnNwb3J0LlxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRUcmFuc3BvcnQucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0aWYgKCdjbG9zZWQnID09IHRoaXMucmVhZHlTdGF0ZSB8fCAnJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdvcGVuaW5nJztcblx0XHRcdFx0XHRcdHRoaXMuZG9PcGVuKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ2xvc2VzIHRoZSB0cmFuc3BvcnQuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRUcmFuc3BvcnQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gdGhpcy5yZWFkeVN0YXRlIHx8ICdvcGVuJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdHRoaXMuZG9DbG9zZSgpO1xuXHRcdFx0XHRcdFx0dGhpcy5vbkNsb3NlKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2VuZHMgbXVsdGlwbGUgcGFja2V0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRUcmFuc3BvcnQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAocGFja2V0cykge1xuXHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHR0aGlzLndyaXRlKHBhY2tldHMpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1RyYW5zcG9ydCBub3Qgb3BlbicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBvcGVuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRUcmFuc3BvcnQucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3Blbic7XG5cdFx0XHRcdFx0dGhpcy53cml0YWJsZSA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdvcGVuJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ2FsbGVkIHdpdGggZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHZhciBwYWNrZXQgPSBwYXJzZXIuZGVjb2RlUGFja2V0KGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuXHRcdFx0XHRcdHRoaXMub25QYWNrZXQocGFja2V0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBhIGRlY29kZWQgcGFja2V0LlxuICAgICAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25QYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdwYWNrZXQnLCBwYWNrZXQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGNsb3NlLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdjbG9zZWQnO1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgnY2xvc2UnKTtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHsgXCJjb21wb25lbnQtZW1pdHRlclwiOiAxNSwgXCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5IH1dLCA1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgZGVwZW5kZW5jaWVzXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXygneG1saHR0cHJlcXVlc3Qtc3NsJyk7XG5cdFx0XHRcdFx0dmFyIFhIUiA9IF9kZXJlcV8oJy4vcG9sbGluZy14aHInKTtcblx0XHRcdFx0XHR2YXIgSlNPTlAgPSBfZGVyZXFfKCcuL3BvbGxpbmctanNvbnAnKTtcblx0XHRcdFx0XHR2YXIgd2Vic29ja2V0ID0gX2RlcmVxXygnLi93ZWJzb2NrZXQnKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFeHBvcnQgdHJhbnNwb3J0cy5cbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLnBvbGxpbmcgPSBwb2xsaW5nO1xuXHRcdFx0XHRcdGV4cG9ydHMud2Vic29ja2V0ID0gd2Vic29ja2V0O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFBvbGxpbmcgdHJhbnNwb3J0IHBvbHltb3JwaGljIGNvbnN0cnVjdG9yLlxuICAgICAgKiBEZWNpZGVzIG9uIHhociB2cyBqc29ucCBiYXNlZCBvbiBmZWF0dXJlIGRldGVjdGlvbi5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gcG9sbGluZyhvcHRzKSB7XG5cdFx0XHRcdFx0XHR2YXIgeGhyO1xuXHRcdFx0XHRcdFx0dmFyIHhkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR2YXIgeHMgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHZhciBqc29ucCA9IGZhbHNlICE9PSBvcHRzLmpzb25wO1xuXG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLmxvY2F0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBpc1NTTCA9ICdodHRwczonID09IGxvY2F0aW9uLnByb3RvY29sO1xuXHRcdFx0XHRcdFx0XHR2YXIgcG9ydCA9IGxvY2F0aW9uLnBvcnQ7XG5cblx0XHRcdFx0XHRcdFx0Ly8gc29tZSB1c2VyIGFnZW50cyBoYXZlIGVtcHR5IGBsb2NhdGlvbi5wb3J0YFxuXHRcdFx0XHRcdFx0XHRpZiAoIXBvcnQpIHtcblx0XHRcdFx0XHRcdFx0XHRwb3J0ID0gaXNTU0wgPyA0NDMgOiA4MDtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHhkID0gb3B0cy5ob3N0bmFtZSAhPSBsb2NhdGlvbi5ob3N0bmFtZSB8fCBwb3J0ICE9IG9wdHMucG9ydDtcblx0XHRcdFx0XHRcdFx0eHMgPSBvcHRzLnNlY3VyZSAhPSBpc1NTTDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0b3B0cy54ZG9tYWluID0geGQ7XG5cdFx0XHRcdFx0XHRvcHRzLnhzY2hlbWUgPSB4cztcblx0XHRcdFx0XHRcdHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdChvcHRzKTtcblxuXHRcdFx0XHRcdFx0aWYgKCdvcGVuJyBpbiB4aHIgJiYgIW9wdHMuZm9yY2VKU09OUCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbmV3IFhIUihvcHRzKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGlmICghanNvbnApIHRocm93IG5ldyBFcnJvcignSlNPTlAgZGlzYWJsZWQnKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBKU09OUChvcHRzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG5cdFx0XHR9LCB7IFwiLi9wb2xsaW5nLWpzb25wXCI6IDYsIFwiLi9wb2xsaW5nLXhoclwiOiA3LCBcIi4vd2Vic29ja2V0XCI6IDksIFwieG1saHR0cHJlcXVlc3Qtc3NsXCI6IDEwIH1dLCA2OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1vZHVsZSByZXF1aXJlbWVudHMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIFBvbGxpbmcgPSBfZGVyZXFfKCcuL3BvbGxpbmcnKTtcblx0XHRcdFx0XHR2YXIgaW5oZXJpdCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1pbmhlcml0Jyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBKU09OUFBvbGxpbmc7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FjaGVkIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIHJOZXdsaW5lID0gL1xcbi9nO1xuXHRcdFx0XHRcdHZhciByRXNjYXBlZE5ld2xpbmUgPSAvXFxcXG4vZztcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBHbG9iYWwgSlNPTlAgY2FsbGJhY2tzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBjYWxsYmFja3M7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FsbGJhY2tzIGNvdW50LlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBpbmRleCA9IDA7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTm9vcC5cbiAgICAgICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBlbXB0eSgpIHt9XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogSlNPTlAgUG9sbGluZyBjb25zdHJ1Y3Rvci5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtPYmplY3R9IG9wdHMuXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gSlNPTlBQb2xsaW5nKG9wdHMpIHtcblx0XHRcdFx0XHRcdFBvbGxpbmcuY2FsbCh0aGlzLCBvcHRzKTtcblxuXHRcdFx0XHRcdFx0dGhpcy5xdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG5cblx0XHRcdFx0XHRcdC8vIGRlZmluZSBnbG9iYWwgY2FsbGJhY2tzIGFycmF5IGlmIG5vdCBwcmVzZW50XG5cdFx0XHRcdFx0XHQvLyB3ZSBkbyB0aGlzIGhlcmUgKGxhemlseSkgdG8gYXZvaWQgdW5uZWVkZWQgZ2xvYmFsIHBvbGx1dGlvblxuXHRcdFx0XHRcdFx0aWYgKCFjYWxsYmFja3MpIHtcblx0XHRcdFx0XHRcdFx0Ly8gd2UgbmVlZCB0byBjb25zaWRlciBtdWx0aXBsZSBlbmdpbmVzIGluIHRoZSBzYW1lIHBhZ2Vcblx0XHRcdFx0XHRcdFx0aWYgKCFnbG9iYWwuX19fZWlvKSBnbG9iYWwuX19fZWlvID0gW107XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrcyA9IGdsb2JhbC5fX19laW87XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGNhbGxiYWNrIGlkZW50aWZpZXJcblx0XHRcdFx0XHRcdHRoaXMuaW5kZXggPSBjYWxsYmFja3MubGVuZ3RoO1xuXG5cdFx0XHRcdFx0XHQvLyBhZGQgY2FsbGJhY2sgdG8ganNvbnAgZ2xvYmFsXG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHRjYWxsYmFja3MucHVzaChmdW5jdGlvbiAobXNnKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25EYXRhKG1zZyk7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0Ly8gYXBwZW5kIHRvIHF1ZXJ5IHN0cmluZ1xuXHRcdFx0XHRcdFx0dGhpcy5xdWVyeS5qID0gdGhpcy5pbmRleDtcblxuXHRcdFx0XHRcdFx0Ly8gcHJldmVudCBzcHVyaW91cyBlcnJvcnMgZnJvbSBiZWluZyBlbWl0dGVkIHdoZW4gdGhlIHdpbmRvdyBpcyB1bmxvYWRlZFxuXHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kb2N1bWVudCAmJiBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHRcdFx0XHRnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzZWxmLnNjcmlwdCkgc2VsZi5zY3JpcHQub25lcnJvciA9IGVtcHR5O1xuXHRcdFx0XHRcdFx0XHR9LCBmYWxzZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEluaGVyaXRzIGZyb20gUG9sbGluZy5cbiAgICAgICovXG5cblx0XHRcdFx0XHRpbmhlcml0KEpTT05QUG9sbGluZywgUG9sbGluZyk7XG5cblx0XHRcdFx0XHQvKlxuICAgICAgKiBKU09OUCBvbmx5IHN1cHBvcnRzIGJpbmFyeSBhcyBiYXNlNjQgZW5jb2RlZCBzdHJpbmdzXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5zdXBwb3J0c0JpbmFyeSA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENsb3NlcyB0aGUgc29ja2V0LlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRKU09OUFBvbGxpbmcucHJvdG90eXBlLmRvQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5zY3JpcHQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2NyaXB0ID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMuZm9ybSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmZvcm0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZvcm0pO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmZvcm0gPSBudWxsO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmlmcmFtZSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFBvbGxpbmcucHJvdG90eXBlLmRvQ2xvc2UuY2FsbCh0aGlzKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFN0YXJ0cyBhIHBvbGwgY3ljbGUuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdEpTT05QUG9sbGluZy5wcm90b3R5cGUuZG9Qb2xsID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5zY3JpcHQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2NyaXB0ID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c2NyaXB0LmFzeW5jID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHNjcmlwdC5zcmMgPSB0aGlzLnVyaSgpO1xuXHRcdFx0XHRcdFx0c2NyaXB0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoJ2pzb25wIHBvbGwgZXJyb3InLCBlKTtcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdHZhciBpbnNlcnRBdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcblx0XHRcdFx0XHRcdGlmIChpbnNlcnRBdCkge1xuXHRcdFx0XHRcdFx0XHRpbnNlcnRBdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzY3JpcHQsIGluc2VydEF0KTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdChkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnNjcmlwdCA9IHNjcmlwdDtcblxuXHRcdFx0XHRcdFx0dmFyIGlzVUFnZWNrbyA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgL2dlY2tvL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcblxuXHRcdFx0XHRcdFx0aWYgKGlzVUFnZWNrbykge1xuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG5cdFx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuXHRcdFx0XHRcdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaWZyYW1lKTtcblx0XHRcdFx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFdyaXRlcyB3aXRoIGEgaGlkZGVuIGlmcmFtZS5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEgdG8gc2VuZFxuICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsZWQgdXBvbiBmbHVzaC5cbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5kb1dyaXRlID0gZnVuY3Rpb24gKGRhdGEsIGZuKSB7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdGlmICghdGhpcy5mb3JtKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuXHRcdFx0XHRcdFx0XHR2YXIgYXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG5cdFx0XHRcdFx0XHRcdHZhciBpZCA9IHRoaXMuaWZyYW1lSWQgPSAnZWlvX2lmcmFtZV8nICsgdGhpcy5pbmRleDtcblx0XHRcdFx0XHRcdFx0dmFyIGlmcmFtZTtcblxuXHRcdFx0XHRcdFx0XHRmb3JtLmNsYXNzTmFtZSA9ICdzb2NrZXRpbyc7XG5cdFx0XHRcdFx0XHRcdGZvcm0uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuXHRcdFx0XHRcdFx0XHRmb3JtLnN0eWxlLnRvcCA9ICctMTAwMHB4Jztcblx0XHRcdFx0XHRcdFx0Zm9ybS5zdHlsZS5sZWZ0ID0gJy0xMDAwcHgnO1xuXHRcdFx0XHRcdFx0XHRmb3JtLnRhcmdldCA9IGlkO1xuXHRcdFx0XHRcdFx0XHRmb3JtLm1ldGhvZCA9ICdQT1NUJztcblx0XHRcdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2FjY2VwdC1jaGFyc2V0JywgJ3V0Zi04Jyk7XG5cdFx0XHRcdFx0XHRcdGFyZWEubmFtZSA9ICdkJztcblx0XHRcdFx0XHRcdFx0Zm9ybS5hcHBlbmRDaGlsZChhcmVhKTtcblx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb3JtKTtcblxuXHRcdFx0XHRcdFx0XHR0aGlzLmZvcm0gPSBmb3JtO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmFyZWEgPSBhcmVhO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0aGlzLmZvcm0uYWN0aW9uID0gdGhpcy51cmkoKTtcblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gY29tcGxldGUoKSB7XG5cdFx0XHRcdFx0XHRcdGluaXRJZnJhbWUoKTtcblx0XHRcdFx0XHRcdFx0Zm4oKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gaW5pdElmcmFtZSgpIHtcblx0XHRcdFx0XHRcdFx0aWYgKHNlbGYuaWZyYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZm9ybS5yZW1vdmVDaGlsZChzZWxmLmlmcmFtZSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCdqc29ucCBwb2xsaW5nIGlmcmFtZSByZW1vdmFsIGVycm9yJywgZSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHQvLyBpZTYgZHluYW1pYyBpZnJhbWVzIHdpdGggdGFyZ2V0PVwiXCIgc3VwcG9ydCAodGhhbmtzIENocmlzIExhbWJhY2hlcilcblx0XHRcdFx0XHRcdFx0XHR2YXIgaHRtbCA9ICc8aWZyYW1lIHNyYz1cImphdmFzY3JpcHQ6MFwiIG5hbWU9XCInICsgc2VsZi5pZnJhbWVJZCArICdcIj4nO1xuXHRcdFx0XHRcdFx0XHRcdGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaHRtbCk7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcblx0XHRcdFx0XHRcdFx0XHRpZnJhbWUubmFtZSA9IHNlbGYuaWZyYW1lSWQ7XG5cdFx0XHRcdFx0XHRcdFx0aWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0OjAnO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWZyYW1lLmlkID0gc2VsZi5pZnJhbWVJZDtcblxuXHRcdFx0XHRcdFx0XHRzZWxmLmZvcm0uYXBwZW5kQ2hpbGQoaWZyYW1lKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5pZnJhbWUgPSBpZnJhbWU7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGluaXRJZnJhbWUoKTtcblxuXHRcdFx0XHRcdFx0Ly8gZXNjYXBlIFxcbiB0byBwcmV2ZW50IGl0IGZyb20gYmVpbmcgY29udmVydGVkIGludG8gXFxyXFxuIGJ5IHNvbWUgVUFzXG5cdFx0XHRcdFx0XHQvLyBkb3VibGUgZXNjYXBpbmcgaXMgcmVxdWlyZWQgZm9yIGVzY2FwZWQgbmV3IGxpbmVzIGJlY2F1c2UgdW5lc2NhcGluZyBvZiBuZXcgbGluZXMgY2FuIGJlIGRvbmUgc2FmZWx5IG9uIHNlcnZlci1zaWRlXG5cdFx0XHRcdFx0XHRkYXRhID0gZGF0YS5yZXBsYWNlKHJFc2NhcGVkTmV3bGluZSwgJ1xcXFxcXG4nKTtcblx0XHRcdFx0XHRcdHRoaXMuYXJlYS52YWx1ZSA9IGRhdGEucmVwbGFjZShyTmV3bGluZSwgJ1xcXFxuJyk7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZm9ybS5zdWJtaXQoKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLmlmcmFtZS5hdHRhY2hFdmVudCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmlmcmFtZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHNlbGYuaWZyYW1lLnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29tcGxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmlmcmFtZS5vbmxvYWQgPSBjb21wbGV0ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwgeyBcIi4vcG9sbGluZ1wiOiA4LCBcImNvbXBvbmVudC1pbmhlcml0XCI6IDE2IH1dLCA3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgcmVxdWlyZW1lbnRzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBYTUxIdHRwUmVxdWVzdCA9IF9kZXJlcV8oJ3htbGh0dHByZXF1ZXN0LXNzbCcpO1xuXHRcdFx0XHRcdHZhciBQb2xsaW5nID0gX2RlcmVxXygnLi9wb2xsaW5nJyk7XG5cdFx0XHRcdFx0dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKCdjb21wb25lbnQtZW1pdHRlcicpO1xuXHRcdFx0XHRcdHZhciBpbmhlcml0ID0gX2RlcmVxXygnY29tcG9uZW50LWluaGVyaXQnKTtcblx0XHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdlbmdpbmUuaW8tY2xpZW50OnBvbGxpbmcteGhyJyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBYSFI7XG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMuUmVxdWVzdCA9IFJlcXVlc3Q7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogRW1wdHkgZnVuY3Rpb25cbiAgICAgICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBlbXB0eSgpIHt9XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogWEhSIFBvbGxpbmcgY29uc3RydWN0b3IuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gWEhSKG9wdHMpIHtcblx0XHRcdFx0XHRcdFBvbGxpbmcuY2FsbCh0aGlzLCBvcHRzKTtcblxuXHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5sb2NhdGlvbikge1xuXHRcdFx0XHRcdFx0XHR2YXIgaXNTU0wgPSAnaHR0cHM6JyA9PSBsb2NhdGlvbi5wcm90b2NvbDtcblx0XHRcdFx0XHRcdFx0dmFyIHBvcnQgPSBsb2NhdGlvbi5wb3J0O1xuXG5cdFx0XHRcdFx0XHRcdC8vIHNvbWUgdXNlciBhZ2VudHMgaGF2ZSBlbXB0eSBgbG9jYXRpb24ucG9ydGBcblx0XHRcdFx0XHRcdFx0aWYgKCFwb3J0KSB7XG5cdFx0XHRcdFx0XHRcdFx0cG9ydCA9IGlzU1NMID8gNDQzIDogODA7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHR0aGlzLnhkID0gb3B0cy5ob3N0bmFtZSAhPSBnbG9iYWwubG9jYXRpb24uaG9zdG5hbWUgfHwgcG9ydCAhPSBvcHRzLnBvcnQ7XG5cdFx0XHRcdFx0XHRcdHRoaXMueHMgPSBvcHRzLnNlY3VyZSAhPSBpc1NTTDtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEluaGVyaXRzIGZyb20gUG9sbGluZy5cbiAgICAgICovXG5cblx0XHRcdFx0XHRpbmhlcml0KFhIUiwgUG9sbGluZyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogWEhSIHN1cHBvcnRzIGJpbmFyeVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUuc3VwcG9ydHNCaW5hcnkgPSB0cnVlO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENyZWF0ZXMgYSByZXF1ZXN0LlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChvcHRzKSB7XG5cdFx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblx0XHRcdFx0XHRcdG9wdHMudXJpID0gdGhpcy51cmkoKTtcblx0XHRcdFx0XHRcdG9wdHMueGQgPSB0aGlzLnhkO1xuXHRcdFx0XHRcdFx0b3B0cy54cyA9IHRoaXMueHM7XG5cdFx0XHRcdFx0XHRvcHRzLmFnZW50ID0gdGhpcy5hZ2VudCB8fCBmYWxzZTtcblx0XHRcdFx0XHRcdG9wdHMuc3VwcG9ydHNCaW5hcnkgPSB0aGlzLnN1cHBvcnRzQmluYXJ5O1xuXHRcdFx0XHRcdFx0b3B0cy5lbmFibGVzWERSID0gdGhpcy5lbmFibGVzWERSO1xuXG5cdFx0XHRcdFx0XHQvLyBTU0wgb3B0aW9ucyBmb3IgTm9kZS5qcyBjbGllbnRcblx0XHRcdFx0XHRcdG9wdHMucGZ4ID0gdGhpcy5wZng7XG5cdFx0XHRcdFx0XHRvcHRzLmtleSA9IHRoaXMua2V5O1xuXHRcdFx0XHRcdFx0b3B0cy5wYXNzcGhyYXNlID0gdGhpcy5wYXNzcGhyYXNlO1xuXHRcdFx0XHRcdFx0b3B0cy5jZXJ0ID0gdGhpcy5jZXJ0O1xuXHRcdFx0XHRcdFx0b3B0cy5jYSA9IHRoaXMuY2E7XG5cdFx0XHRcdFx0XHRvcHRzLmNpcGhlcnMgPSB0aGlzLmNpcGhlcnM7XG5cdFx0XHRcdFx0XHRvcHRzLnJlamVjdFVuYXV0aG9yaXplZCA9IHRoaXMucmVqZWN0VW5hdXRob3JpemVkO1xuXG5cdFx0XHRcdFx0XHQvLyBvdGhlciBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0b3B0cy5leHRyYUhlYWRlcnMgPSB0aGlzLmV4dHJhSGVhZGVycztcblxuXHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBSZXF1ZXN0KG9wdHMpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogU2VuZHMgZGF0YS5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEgdG8gc2VuZC5cbiAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGVkIHVwb24gZmx1c2guXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUuZG9Xcml0ZSA9IGZ1bmN0aW9uIChkYXRhLCBmbikge1xuXHRcdFx0XHRcdFx0dmFyIGlzQmluYXJ5ID0gdHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnICYmIGRhdGEgIT09IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdHZhciByZXEgPSB0aGlzLnJlcXVlc3QoeyBtZXRob2Q6ICdQT1NUJywgZGF0YTogZGF0YSwgaXNCaW5hcnk6IGlzQmluYXJ5IH0pO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0cmVxLm9uKCdzdWNjZXNzJywgZm4pO1xuXHRcdFx0XHRcdFx0cmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCd4aHIgcG9zdCBlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHRoaXMuc2VuZFhociA9IHJlcTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFN0YXJ0cyBhIHBvbGwgY3ljbGUuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUuZG9Qb2xsID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3hociBwb2xsJyk7XG5cdFx0XHRcdFx0XHR2YXIgcmVxID0gdGhpcy5yZXF1ZXN0KCk7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHRyZXEub24oJ2RhdGEnLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uRGF0YShkYXRhKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0cmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCd4aHIgcG9sbCBlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHRoaXMucG9sbFhociA9IHJlcTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFJlcXVlc3QgY29uc3RydWN0b3JcbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBSZXF1ZXN0KG9wdHMpIHtcblx0XHRcdFx0XHRcdHRoaXMubWV0aG9kID0gb3B0cy5tZXRob2QgfHwgJ0dFVCc7XG5cdFx0XHRcdFx0XHR0aGlzLnVyaSA9IG9wdHMudXJpO1xuXHRcdFx0XHRcdFx0dGhpcy54ZCA9ICEhb3B0cy54ZDtcblx0XHRcdFx0XHRcdHRoaXMueHMgPSAhIW9wdHMueHM7XG5cdFx0XHRcdFx0XHR0aGlzLmFzeW5jID0gZmFsc2UgIT09IG9wdHMuYXN5bmM7XG5cdFx0XHRcdFx0XHR0aGlzLmRhdGEgPSB1bmRlZmluZWQgIT0gb3B0cy5kYXRhID8gb3B0cy5kYXRhIDogbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMuYWdlbnQgPSBvcHRzLmFnZW50O1xuXHRcdFx0XHRcdFx0dGhpcy5pc0JpbmFyeSA9IG9wdHMuaXNCaW5hcnk7XG5cdFx0XHRcdFx0XHR0aGlzLnN1cHBvcnRzQmluYXJ5ID0gb3B0cy5zdXBwb3J0c0JpbmFyeTtcblx0XHRcdFx0XHRcdHRoaXMuZW5hYmxlc1hEUiA9IG9wdHMuZW5hYmxlc1hEUjtcblxuXHRcdFx0XHRcdFx0Ly8gU1NMIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0XHR0aGlzLnBmeCA9IG9wdHMucGZ4O1xuXHRcdFx0XHRcdFx0dGhpcy5rZXkgPSBvcHRzLmtleTtcblx0XHRcdFx0XHRcdHRoaXMucGFzc3BocmFzZSA9IG9wdHMucGFzc3BocmFzZTtcblx0XHRcdFx0XHRcdHRoaXMuY2VydCA9IG9wdHMuY2VydDtcblx0XHRcdFx0XHRcdHRoaXMuY2EgPSBvcHRzLmNhO1xuXHRcdFx0XHRcdFx0dGhpcy5jaXBoZXJzID0gb3B0cy5jaXBoZXJzO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWplY3RVbmF1dGhvcml6ZWQgPSBvcHRzLnJlamVjdFVuYXV0aG9yaXplZDtcblxuXHRcdFx0XHRcdFx0Ly8gb3RoZXIgb3B0aW9ucyBmb3IgTm9kZS5qcyBjbGllbnRcblx0XHRcdFx0XHRcdHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG5cblx0XHRcdFx0XHRcdHRoaXMuY3JlYXRlKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1peCBpbiBgRW1pdHRlcmAuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0RW1pdHRlcihSZXF1ZXN0LnByb3RvdHlwZSk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ3JlYXRlcyB0aGUgWEhSIG9iamVjdCBhbmQgc2VuZHMgdGhlIHJlcXVlc3QuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHZhciBvcHRzID0geyBhZ2VudDogdGhpcy5hZ2VudCwgeGRvbWFpbjogdGhpcy54ZCwgeHNjaGVtZTogdGhpcy54cywgZW5hYmxlc1hEUjogdGhpcy5lbmFibGVzWERSIH07XG5cblx0XHRcdFx0XHRcdC8vIFNTTCBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0b3B0cy5wZnggPSB0aGlzLnBmeDtcblx0XHRcdFx0XHRcdG9wdHMua2V5ID0gdGhpcy5rZXk7XG5cdFx0XHRcdFx0XHRvcHRzLnBhc3NwaHJhc2UgPSB0aGlzLnBhc3NwaHJhc2U7XG5cdFx0XHRcdFx0XHRvcHRzLmNlcnQgPSB0aGlzLmNlcnQ7XG5cdFx0XHRcdFx0XHRvcHRzLmNhID0gdGhpcy5jYTtcblx0XHRcdFx0XHRcdG9wdHMuY2lwaGVycyA9IHRoaXMuY2lwaGVycztcblx0XHRcdFx0XHRcdG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gdGhpcy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cblx0XHRcdFx0XHRcdHZhciB4aHIgPSB0aGlzLnhociA9IG5ldyBYTUxIdHRwUmVxdWVzdChvcHRzKTtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3hociBvcGVuICVzOiAlcycsIHRoaXMubWV0aG9kLCB0aGlzLnVyaSk7XG5cdFx0XHRcdFx0XHRcdHhoci5vcGVuKHRoaXMubWV0aG9kLCB0aGlzLnVyaSwgdGhpcy5hc3luYyk7XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuZXh0cmFIZWFkZXJzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR4aHIuc2V0RGlzYWJsZUhlYWRlckNoZWNrKHRydWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiB0aGlzLmV4dHJhSGVhZGVycykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5leHRyYUhlYWRlcnMuaGFzT3duUHJvcGVydHkoaSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR4aHIuc2V0UmVxdWVzdEhlYWRlcihpLCB0aGlzLmV4dHJhSGVhZGVyc1tpXSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBoYXMgdG8gYmUgZG9uZSBhZnRlciBvcGVuIGJlY2F1c2UgRmlyZWZveCBpcyBzdHVwaWRcblx0XHRcdFx0XHRcdFx0XHQvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEzMjE2OTAzL2dldC1iaW5hcnktZGF0YS13aXRoLXhtbGh0dHByZXF1ZXN0LWluLWEtZmlyZWZveC1leHRlbnNpb25cblx0XHRcdFx0XHRcdFx0XHR4aHIucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJztcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmICgnUE9TVCcgPT0gdGhpcy5tZXRob2QpIHtcblx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuaXNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCAndGV4dC9wbGFpbjtjaGFyc2V0PVVURi04Jyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIGllNiBjaGVja1xuXHRcdFx0XHRcdFx0XHRpZiAoJ3dpdGhDcmVkZW50aWFscycgaW4geGhyKSB7XG5cdFx0XHRcdFx0XHRcdFx0eGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5oYXNYRFIoKSkge1xuXHRcdFx0XHRcdFx0XHRcdHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uTG9hZCgpO1xuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0eGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoeGhyLnJlc3BvbnNlVGV4dCk7XG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHR4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKDQgIT0geGhyLnJlYWR5U3RhdGUpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICgyMDAgPT0geGhyLnN0YXR1cyB8fCAxMjIzID09IHhoci5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5vbkxvYWQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB0aGUgYGVycm9yYCBldmVudCBoYW5kbGVyIHRoYXQncyB1c2VyLXNldFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBkb2VzIG5vdCB0aHJvdyBpbiB0aGUgc2FtZSB0aWNrIGFuZCBnZXRzIGNhdWdodCBoZXJlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYub25FcnJvcih4aHIuc3RhdHVzKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSwgMCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGRlYnVnKCd4aHIgZGF0YSAlcycsIHRoaXMuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHhoci5zZW5kKHRoaXMuZGF0YSk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIE5lZWQgdG8gZGVmZXIgc2luY2UgLmNyZWF0ZSgpIGlzIGNhbGxlZCBkaXJlY3RseSBmaHJvbSB0aGUgY29uc3RydWN0b3Jcblx0XHRcdFx0XHRcdFx0Ly8gYW5kIHRodXMgdGhlICdlcnJvcicgZXZlbnQgY2FuIG9ubHkgYmUgb25seSBib3VuZCAqYWZ0ZXIqIHRoaXMgZXhjZXB0aW9uXG5cdFx0XHRcdFx0XHRcdC8vIG9jY3Vycy4gIFRoZXJlZm9yZSwgYWxzbywgd2UgY2Fubm90IHRocm93IGhlcmUgYXQgYWxsLlxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoZSk7XG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChnbG9iYWwuZG9jdW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5pbmRleCA9IFJlcXVlc3QucmVxdWVzdHNDb3VudCsrO1xuXHRcdFx0XHRcdFx0XHRSZXF1ZXN0LnJlcXVlc3RzW3RoaXMuaW5kZXhdID0gdGhpcztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENhbGxlZCB1cG9uIHN1Y2Nlc3NmdWwgcmVzcG9uc2UuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLm9uU3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnc3VjY2VzcycpO1xuXHRcdFx0XHRcdFx0dGhpcy5jbGVhbnVwKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDYWxsZWQgaWYgd2UgaGF2ZSBkYXRhLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRSZXF1ZXN0LnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdkYXRhJywgZGF0YSk7XG5cdFx0XHRcdFx0XHR0aGlzLm9uU3VjY2VzcygpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FsbGVkIHVwb24gZXJyb3IuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblx0XHRcdFx0XHRcdHRoaXMuY2xlYW51cCh0cnVlKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENsZWFucyB1cCBob3VzZS5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUuY2xlYW51cCA9IGZ1bmN0aW9uIChmcm9tRXJyb3IpIHtcblx0XHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyA9PSB0eXBlb2YgdGhpcy54aHIgfHwgbnVsbCA9PT0gdGhpcy54aHIpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly8geG1saHR0cHJlcXVlc3Rcblx0XHRcdFx0XHRcdGlmICh0aGlzLmhhc1hEUigpKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMueGhyLm9ubG9hZCA9IHRoaXMueGhyLm9uZXJyb3IgPSBlbXB0eTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMueGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGVtcHR5O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoZnJvbUVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy54aHIuYWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kb2N1bWVudCkge1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLmluZGV4XTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dGhpcy54aHIgPSBudWxsO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2FsbGVkIHVwb24gbG9hZC5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIGRhdGE7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHR2YXIgY29udGVudFR5cGU7XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudFR5cGUgPSB0aGlzLnhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1UeXBlJykuc3BsaXQoJzsnKVswXTtcblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlID09PSAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJykge1xuXHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnhoci5yZXNwb25zZTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoIXRoaXMuc3VwcG9ydHNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnhoci5yZXNwb25zZVRleHQ7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KHRoaXMueGhyLnJlc3BvbnNlKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciB1aThBcnIgPSBuZXcgVWludDhBcnJheSh0aGlzLnhoci5yZXNwb25zZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBkYXRhQXJyYXkgPSBbXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaWR4ID0gMCwgbGVuZ3RoID0gdWk4QXJyLmxlbmd0aDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGFBcnJheS5wdXNoKHVpOEFycltpZHhdKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGRhdGFBcnJheSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMub25FcnJvcihlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChudWxsICE9IGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5vbkRhdGEoZGF0YSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVjayBpZiBpdCBoYXMgWERvbWFpblJlcXVlc3QuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLmhhc1hEUiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHJldHVybiAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIGdsb2JhbC5YRG9tYWluUmVxdWVzdCAmJiAhdGhpcy54cyAmJiB0aGlzLmVuYWJsZXNYRFI7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBBYm9ydHMgdGhlIHJlcXVlc3QuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNsZWFudXAoKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEFib3J0cyBwZW5kaW5nIHJlcXVlc3RzIHdoZW4gdW5sb2FkaW5nIHRoZSB3aW5kb3cuIFRoaXMgaXMgbmVlZGVkIHRvIHByZXZlbnRcbiAgICAgICogbWVtb3J5IGxlYWtzIChlLmcuIHdoZW4gdXNpbmcgSUUpIGFuZCB0byBlbnN1cmUgdGhhdCBubyBzcHVyaW91cyBlcnJvciBpc1xuICAgICAgKiBlbWl0dGVkLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdGlmIChnbG9iYWwuZG9jdW1lbnQpIHtcblx0XHRcdFx0XHRcdFJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7XG5cdFx0XHRcdFx0XHRSZXF1ZXN0LnJlcXVlc3RzID0ge307XG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLmF0dGFjaEV2ZW50KSB7XG5cdFx0XHRcdFx0XHRcdGdsb2JhbC5hdHRhY2hFdmVudCgnb251bmxvYWQnLCB1bmxvYWRIYW5kbGVyKTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0XHRcdFx0XHRcdFx0Z2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHVubG9hZEhhbmRsZXIsIGZhbHNlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRmdW5jdGlvbiB1bmxvYWRIYW5kbGVyKCkge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0UmVxdWVzdC5yZXF1ZXN0c1tpXS5hYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwgeyBcIi4vcG9sbGluZ1wiOiA4LCBcImNvbXBvbmVudC1lbWl0dGVyXCI6IDE1LCBcImNvbXBvbmVudC1pbmhlcml0XCI6IDE2LCBcImRlYnVnXCI6IDE3LCBcInhtbGh0dHByZXF1ZXN0LXNzbFwiOiAxMCB9XSwgODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogTW9kdWxlIGRlcGVuZGVuY2llcy5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgVHJhbnNwb3J0ID0gX2RlcmVxXygnLi4vdHJhbnNwb3J0Jyk7XG5cdFx0XHRcdHZhciBwYXJzZXFzID0gX2RlcmVxXygncGFyc2VxcycpO1xuXHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIgaW5oZXJpdCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1pbmhlcml0Jyk7XG5cdFx0XHRcdHZhciB5ZWFzdCA9IF9kZXJlcV8oJ3llYXN0Jyk7XG5cdFx0XHRcdHZhciBkZWJ1ZyA9IF9kZXJlcV8oJ2RlYnVnJykoJ2VuZ2luZS5pby1jbGllbnQ6cG9sbGluZycpO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBleHBvcnRzLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gUG9sbGluZztcblxuXHRcdFx0XHQvKipcbiAgICAgKiBJcyBYSFIyIHN1cHBvcnRlZD9cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgaGFzWEhSMiA9IChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXygneG1saHR0cHJlcXVlc3Qtc3NsJyk7XG5cdFx0XHRcdFx0dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCh7IHhkb21haW46IGZhbHNlIH0pO1xuXHRcdFx0XHRcdHJldHVybiBudWxsICE9IHhoci5yZXNwb25zZVR5cGU7XG5cdFx0XHRcdH0pKCk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUG9sbGluZyBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIFBvbGxpbmcob3B0cykge1xuXHRcdFx0XHRcdHZhciBmb3JjZUJhc2U2NCA9IG9wdHMgJiYgb3B0cy5mb3JjZUJhc2U2NDtcblx0XHRcdFx0XHRpZiAoIWhhc1hIUjIgfHwgZm9yY2VCYXNlNjQpIHtcblx0XHRcdFx0XHRcdHRoaXMuc3VwcG9ydHNCaW5hcnkgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0VHJhbnNwb3J0LmNhbGwodGhpcywgb3B0cyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBJbmhlcml0cyBmcm9tIFRyYW5zcG9ydC5cbiAgICAgKi9cblxuXHRcdFx0XHRpbmhlcml0KFBvbGxpbmcsIFRyYW5zcG9ydCk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogVHJhbnNwb3J0IG5hbWUuXG4gICAgICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUubmFtZSA9ICdwb2xsaW5nJztcblxuXHRcdFx0XHQvKipcbiAgICAgKiBPcGVucyB0aGUgc29ja2V0ICh0cmlnZ2VycyBwb2xsaW5nKS4gV2Ugd3JpdGUgYSBQSU5HIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lXG4gICAgICogd2hlbiB0aGUgdHJhbnNwb3J0IGlzIG9wZW4uXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5kb09wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dGhpcy5wb2xsKCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGF1c2VzIHBvbGxpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayB1cG9uIGJ1ZmZlcnMgYXJlIGZsdXNoZWQgYW5kIHRyYW5zcG9ydCBpcyBwYXVzZWRcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIChvblBhdXNlKSB7XG5cdFx0XHRcdFx0dmFyIHBlbmRpbmcgPSAwO1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdwYXVzaW5nJztcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHBhdXNlKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3BhdXNlZCcpO1xuXHRcdFx0XHRcdFx0c2VsZi5yZWFkeVN0YXRlID0gJ3BhdXNlZCc7XG5cdFx0XHRcdFx0XHRvblBhdXNlKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRoaXMucG9sbGluZyB8fCAhdGhpcy53cml0YWJsZSkge1xuXHRcdFx0XHRcdFx0dmFyIHRvdGFsID0gMDtcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucG9sbGluZykge1xuXHRcdFx0XHRcdFx0XHRkZWJ1Zygnd2UgYXJlIGN1cnJlbnRseSBwb2xsaW5nIC0gd2FpdGluZyB0byBwYXVzZScpO1xuXHRcdFx0XHRcdFx0XHR0b3RhbCsrO1xuXHRcdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ3BvbGxDb21wbGV0ZScsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJlLXBhdXNlIHBvbGxpbmcgY29tcGxldGUnKTtcblx0XHRcdFx0XHRcdFx0XHQtLXRvdGFsIHx8IHBhdXNlKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMud3JpdGFibGUpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3dlIGFyZSBjdXJyZW50bHkgd3JpdGluZyAtIHdhaXRpbmcgdG8gcGF1c2UnKTtcblx0XHRcdFx0XHRcdFx0dG90YWwrKztcblx0XHRcdFx0XHRcdFx0dGhpcy5vbmNlKCdkcmFpbicsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJlLXBhdXNlIHdyaXRpbmcgY29tcGxldGUnKTtcblx0XHRcdFx0XHRcdFx0XHQtLXRvdGFsIHx8IHBhdXNlKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRwYXVzZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTdGFydHMgcG9sbGluZyBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUucG9sbCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1ZygncG9sbGluZycpO1xuXHRcdFx0XHRcdHRoaXMucG9sbGluZyA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5kb1BvbGwoKTtcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ3BvbGwnKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBPdmVybG9hZHMgb25EYXRhIHRvIGRldGVjdCBwYXlsb2Fkcy5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFBvbGxpbmcucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdGRlYnVnKCdwb2xsaW5nIGdvdCBkYXRhICVzJywgZGF0YSk7XG5cdFx0XHRcdFx0dmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gY2FsbGJhY2socGFja2V0LCBpbmRleCwgdG90YWwpIHtcblx0XHRcdFx0XHRcdC8vIGlmIGl0cyB0aGUgZmlyc3QgbWVzc2FnZSB3ZSBjb25zaWRlciB0aGUgdHJhbnNwb3J0IG9wZW5cblx0XHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gc2VsZi5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25PcGVuKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGlmIGl0cyBhIGNsb3NlIHBhY2tldCwgd2UgY2xvc2UgdGhlIG9uZ29pbmcgcmVxdWVzdHNcblx0XHRcdFx0XHRcdGlmICgnY2xvc2UnID09IHBhY2tldC50eXBlKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIG90aGVyd2lzZSBieXBhc3Mgb25EYXRhIGFuZCBoYW5kbGUgdGhlIG1lc3NhZ2Vcblx0XHRcdFx0XHRcdHNlbGYub25QYWNrZXQocGFja2V0KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0Ly8gZGVjb2RlIHBheWxvYWRcblx0XHRcdFx0XHRwYXJzZXIuZGVjb2RlUGF5bG9hZChkYXRhLCB0aGlzLnNvY2tldC5iaW5hcnlUeXBlLCBjYWxsYmFjayk7XG5cblx0XHRcdFx0XHQvLyBpZiBhbiBldmVudCBkaWQgbm90IHRyaWdnZXIgY2xvc2luZ1xuXHRcdFx0XHRcdGlmICgnY2xvc2VkJyAhPSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdC8vIGlmIHdlIGdvdCBkYXRhIHdlJ3JlIG5vdCBwb2xsaW5nXG5cdFx0XHRcdFx0XHR0aGlzLnBvbGxpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgncG9sbENvbXBsZXRlJyk7XG5cblx0XHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucG9sbCgpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2lnbm9yaW5nIHBvbGwgLSB0cmFuc3BvcnQgc3RhdGUgXCIlc1wiJywgdGhpcy5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogRm9yIHBvbGxpbmcsIHNlbmQgYSBjbG9zZSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGNsb3NlKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3dyaXRpbmcgY2xvc2UgcGFja2V0Jyk7XG5cdFx0XHRcdFx0XHRzZWxmLndyaXRlKFt7IHR5cGU6ICdjbG9zZScgfV0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygndHJhbnNwb3J0IG9wZW4gLSBjbG9zaW5nJyk7XG5cdFx0XHRcdFx0XHRjbG9zZSgpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBpbiBjYXNlIHdlJ3JlIHRyeWluZyB0byBjbG9zZSB3aGlsZVxuXHRcdFx0XHRcdFx0Ly8gaGFuZHNoYWtpbmcgaXMgaW4gcHJvZ3Jlc3MgKEdILTE2NClcblx0XHRcdFx0XHRcdGRlYnVnKCd0cmFuc3BvcnQgbm90IG9wZW4gLSBkZWZlcnJpbmcgY2xvc2UnKTtcblx0XHRcdFx0XHRcdHRoaXMub25jZSgnb3BlbicsIGNsb3NlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogV3JpdGVzIGEgcGFja2V0cyBwYXlsb2FkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gZGF0YSBwYWNrZXRzXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZHJhaW4gY2FsbGJhY2tcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChwYWNrZXRzKSB7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdHRoaXMud3JpdGFibGUgPSBmYWxzZTtcblx0XHRcdFx0XHR2YXIgY2FsbGJhY2tmbiA9IGZ1bmN0aW9uIGNhbGxiYWNrZm4oKSB7XG5cdFx0XHRcdFx0XHRzZWxmLndyaXRhYmxlID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHNlbGYuZW1pdCgnZHJhaW4nKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdHBhcnNlci5lbmNvZGVQYXlsb2FkKHBhY2tldHMsIHRoaXMuc3VwcG9ydHNCaW5hcnksIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHRzZWxmLmRvV3JpdGUoZGF0YSwgY2FsbGJhY2tmbik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogR2VuZXJhdGVzIHVyaSBmb3IgY29ubmVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFBvbGxpbmcucHJvdG90eXBlLnVyaSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR2YXIgcXVlcnkgPSB0aGlzLnF1ZXJ5IHx8IHt9O1xuXHRcdFx0XHRcdHZhciBzY2hlbWEgPSB0aGlzLnNlY3VyZSA/ICdodHRwcycgOiAnaHR0cCc7XG5cdFx0XHRcdFx0dmFyIHBvcnQgPSAnJztcblxuXHRcdFx0XHRcdC8vIGNhY2hlIGJ1c3RpbmcgaXMgZm9yY2VkXG5cdFx0XHRcdFx0aWYgKGZhbHNlICE9PSB0aGlzLnRpbWVzdGFtcFJlcXVlc3RzKSB7XG5cdFx0XHRcdFx0XHRxdWVyeVt0aGlzLnRpbWVzdGFtcFBhcmFtXSA9IHllYXN0KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5ICYmICFxdWVyeS5zaWQpIHtcblx0XHRcdFx0XHRcdHF1ZXJ5LmI2NCA9IDE7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cXVlcnkgPSBwYXJzZXFzLmVuY29kZShxdWVyeSk7XG5cblx0XHRcdFx0XHQvLyBhdm9pZCBwb3J0IGlmIGRlZmF1bHQgZm9yIHNjaGVtYVxuXHRcdFx0XHRcdGlmICh0aGlzLnBvcnQgJiYgKCdodHRwcycgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA0NDMgfHwgJ2h0dHAnID09IHNjaGVtYSAmJiB0aGlzLnBvcnQgIT0gODApKSB7XG5cdFx0XHRcdFx0XHRwb3J0ID0gJzonICsgdGhpcy5wb3J0O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIHByZXBlbmQgPyB0byBxdWVyeVxuXHRcdFx0XHRcdGlmIChxdWVyeS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdHF1ZXJ5ID0gJz8nICsgcXVlcnk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGlwdjYgPSB0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSAhPT0gLTE7XG5cdFx0XHRcdFx0cmV0dXJuIHNjaGVtYSArICc6Ly8nICsgKGlwdjYgPyAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nIDogdGhpcy5ob3N0bmFtZSkgKyBwb3J0ICsgdGhpcy5wYXRoICsgcXVlcnk7XG5cdFx0XHRcdH07XG5cdFx0XHR9LCB7IFwiLi4vdHJhbnNwb3J0XCI6IDQsIFwiY29tcG9uZW50LWluaGVyaXRcIjogMTYsIFwiZGVidWdcIjogMTcsIFwiZW5naW5lLmlvLXBhcnNlclwiOiAxOSwgXCJwYXJzZXFzXCI6IDI3LCBcInhtbGh0dHByZXF1ZXN0LXNzbFwiOiAxMCwgXCJ5ZWFzdFwiOiAzMCB9XSwgOTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcblx0XHRcdFx0XHQvKipcbiAgICAgICogTW9kdWxlIGRlcGVuZGVuY2llcy5cbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgVHJhbnNwb3J0ID0gX2RlcmVxXygnLi4vdHJhbnNwb3J0Jyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNlciA9IF9kZXJlcV8oJ2VuZ2luZS5pby1wYXJzZXInKTtcblx0XHRcdFx0XHR2YXIgcGFyc2VxcyA9IF9kZXJlcV8oJ3BhcnNlcXMnKTtcblx0XHRcdFx0XHR2YXIgaW5oZXJpdCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1pbmhlcml0Jyk7XG5cdFx0XHRcdFx0dmFyIHllYXN0ID0gX2RlcmVxXygneWVhc3QnKTtcblx0XHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdlbmdpbmUuaW8tY2xpZW50OndlYnNvY2tldCcpO1xuXHRcdFx0XHRcdHZhciBCcm93c2VyV2ViU29ja2V0ID0gZ2xvYmFsLldlYlNvY2tldCB8fCBnbG9iYWwuTW96V2ViU29ja2V0O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEdldCBlaXRoZXIgdGhlIGBXZWJTb2NrZXRgIG9yIGBNb3pXZWJTb2NrZXRgIGdsb2JhbHNcbiAgICAgICogaW4gdGhlIGJyb3dzZXIgb3IgdHJ5IHRvIHJlc29sdmUgV2ViU29ja2V0LWNvbXBhdGlibGVcbiAgICAgICogaW50ZXJmYWNlIGV4cG9zZWQgYnkgYHdzYCBmb3IgTm9kZS1saWtlIGVudmlyb25tZW50LlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBXZWJTb2NrZXQgPSBCcm93c2VyV2ViU29ja2V0O1xuXHRcdFx0XHRcdGlmICghV2ViU29ja2V0ICYmIHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRXZWJTb2NrZXQgPSBfZGVyZXFfKCd3cycpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogTW9kdWxlIGV4cG9ydHMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBXUztcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBXZWJTb2NrZXQgdHJhbnNwb3J0IGNvbnN0cnVjdG9yLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHtPYmplY3R9IGNvbm5lY3Rpb24gb3B0aW9uc1xuICAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIFdTKG9wdHMpIHtcblx0XHRcdFx0XHRcdHZhciBmb3JjZUJhc2U2NCA9IG9wdHMgJiYgb3B0cy5mb3JjZUJhc2U2NDtcblx0XHRcdFx0XHRcdGlmIChmb3JjZUJhc2U2NCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnBlck1lc3NhZ2VEZWZsYXRlID0gb3B0cy5wZXJNZXNzYWdlRGVmbGF0ZTtcblx0XHRcdFx0XHRcdFRyYW5zcG9ydC5jYWxsKHRoaXMsIG9wdHMpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBJbmhlcml0cyBmcm9tIFRyYW5zcG9ydC5cbiAgICAgICovXG5cblx0XHRcdFx0XHRpbmhlcml0KFdTLCBUcmFuc3BvcnQpO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFRyYW5zcG9ydCBuYW1lLlxuICAgICAgKlxuICAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAgKi9cblxuXHRcdFx0XHRcdFdTLnByb3RvdHlwZS5uYW1lID0gJ3dlYnNvY2tldCc7XG5cblx0XHRcdFx0XHQvKlxuICAgICAgKiBXZWJTb2NrZXRzIHN1cHBvcnQgYmluYXJ5XG4gICAgICAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5ID0gdHJ1ZTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBPcGVucyBzb2NrZXQuXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFdTLnByb3RvdHlwZS5kb09wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuY2hlY2soKSkge1xuXHRcdFx0XHRcdFx0XHQvLyBsZXQgcHJvYmUgdGltZW91dFxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdHZhciB1cmkgPSB0aGlzLnVyaSgpO1xuXHRcdFx0XHRcdFx0dmFyIHByb3RvY29scyA9IHZvaWQgMDtcblx0XHRcdFx0XHRcdHZhciBvcHRzID0ge1xuXHRcdFx0XHRcdFx0XHRhZ2VudDogdGhpcy5hZ2VudCxcblx0XHRcdFx0XHRcdFx0cGVyTWVzc2FnZURlZmxhdGU6IHRoaXMucGVyTWVzc2FnZURlZmxhdGVcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdC8vIFNTTCBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0b3B0cy5wZnggPSB0aGlzLnBmeDtcblx0XHRcdFx0XHRcdG9wdHMua2V5ID0gdGhpcy5rZXk7XG5cdFx0XHRcdFx0XHRvcHRzLnBhc3NwaHJhc2UgPSB0aGlzLnBhc3NwaHJhc2U7XG5cdFx0XHRcdFx0XHRvcHRzLmNlcnQgPSB0aGlzLmNlcnQ7XG5cdFx0XHRcdFx0XHRvcHRzLmNhID0gdGhpcy5jYTtcblx0XHRcdFx0XHRcdG9wdHMuY2lwaGVycyA9IHRoaXMuY2lwaGVycztcblx0XHRcdFx0XHRcdG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gdGhpcy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5leHRyYUhlYWRlcnMpIHtcblx0XHRcdFx0XHRcdFx0b3B0cy5oZWFkZXJzID0gdGhpcy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMud3MgPSBCcm93c2VyV2ViU29ja2V0ID8gbmV3IFdlYlNvY2tldCh1cmkpIDogbmV3IFdlYlNvY2tldCh1cmksIHByb3RvY29scywgb3B0cyk7XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLndzLmJpbmFyeVR5cGUgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLndzLnN1cHBvcnRzICYmIHRoaXMud3Muc3VwcG9ydHMuYmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc3VwcG9ydHNCaW5hcnkgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHR0aGlzLndzLmJpbmFyeVR5cGUgPSAnYnVmZmVyJztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMud3MuYmluYXJ5VHlwZSA9ICdhcnJheWJ1ZmZlcic7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEFkZHMgZXZlbnQgbGlzdGVuZXJzIHRvIHRoZSBzb2NrZXRcbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHR0aGlzLndzLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbk9wZW4oKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR0aGlzLndzLm9uY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdHRoaXMud3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2KSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25EYXRhKGV2LmRhdGEpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdHRoaXMud3Mub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25FcnJvcignd2Vic29ja2V0IGVycm9yJywgZSk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogT3ZlcnJpZGUgYG9uRGF0YWAgdG8gdXNlIGEgdGltZXIgb24gaU9TLlxuICAgICAgKiBTZWU6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL21sb3VnaHJhbi8yMDUyMDA2XG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2YgbmF2aWdhdG9yICYmIC9pUGFkfGlQaG9uZXxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuXHRcdFx0XHRcdFx0V1MucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkRhdGEuY2FsbChzZWxmLCBkYXRhKTtcblx0XHRcdFx0XHRcdFx0fSwgMCk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBXcml0ZXMgZGF0YSB0byBzb2NrZXQuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IG9mIHBhY2tldHMuXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFdTLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChwYWNrZXRzKSB7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHR0aGlzLndyaXRhYmxlID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdC8vIGVuY29kZVBhY2tldCBlZmZpY2llbnQgYXMgaXQgdXNlcyBXUyBmcmFtaW5nXG5cdFx0XHRcdFx0XHQvLyBubyBuZWVkIGZvciBlbmNvZGVQYXlsb2FkXG5cdFx0XHRcdFx0XHR2YXIgdG90YWwgPSBwYWNrZXRzLmxlbmd0aDtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsID0gdG90YWw7IGkgPCBsOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0KGZ1bmN0aW9uIChwYWNrZXQpIHtcblx0XHRcdFx0XHRcdFx0XHRwYXJzZXIuZW5jb2RlUGFja2V0KHBhY2tldCwgc2VsZi5zdXBwb3J0c0JpbmFyeSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICghQnJvd3NlcldlYlNvY2tldCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBhbHdheXMgY3JlYXRlIGEgbmV3IG9iamVjdCAoR0gtNDM3KVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgb3B0cyA9IHt9O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocGFja2V0Lm9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRvcHRzLmNvbXByZXNzID0gcGFja2V0Lm9wdGlvbnMuY29tcHJlc3M7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5wZXJNZXNzYWdlRGVmbGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBsZW4gPSAnc3RyaW5nJyA9PSB0eXBlb2YgZGF0YSA/IGdsb2JhbC5CdWZmZXIuYnl0ZUxlbmd0aChkYXRhKSA6IGRhdGEubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChsZW4gPCBzZWxmLnBlck1lc3NhZ2VEZWZsYXRlLnRocmVzaG9sZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0b3B0cy5jb21wcmVzcyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHQvL1NvbWV0aW1lcyB0aGUgd2Vic29ja2V0IGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ1dCB0aGUgYnJvd3NlciBkaWRuJ3Rcblx0XHRcdFx0XHRcdFx0XHRcdC8vaGF2ZSBhIGNoYW5jZSBvZiBpbmZvcm1pbmcgdXMgYWJvdXQgaXQgeWV0LCBpbiB0aGF0IGNhc2Ugc2VuZCB3aWxsXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3Rocm93IGFuIGVycm9yXG5cdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoQnJvd3NlcldlYlNvY2tldCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFR5cGVFcnJvciBpcyB0aHJvd24gd2hlbiBwYXNzaW5nIHRoZSBzZWNvbmQgYXJndW1lbnQgb24gU2FmYXJpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi53cy5zZW5kKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYud3Muc2VuZChkYXRhLCBvcHRzKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRkZWJ1Zygnd2Vic29ja2V0IGNsb3NlZCBiZWZvcmUgb25jbG9zZSBldmVudCcpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHQtLXRvdGFsIHx8IGRvbmUoKTtcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fSkocGFja2V0c1tpXSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGRvbmUoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgnZmx1c2gnKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBmYWtlIGRyYWluXG5cdFx0XHRcdFx0XHRcdC8vIGRlZmVyIHRvIG5leHQgdGljayB0byBhbGxvdyBTb2NrZXQgdG8gY2xlYXIgd3JpdGVCdWZmZXJcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi53cml0YWJsZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5lbWl0KCdkcmFpbicpO1xuXHRcdFx0XHRcdFx0XHR9LCAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENhbGxlZCB1cG9uIGNsb3NlXG4gICAgICAqXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdFdTLnByb3RvdHlwZS5vbkNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkNsb3NlLmNhbGwodGhpcyk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDbG9zZXMgc29ja2V0LlxuICAgICAgKlxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUuZG9DbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdGhpcy53cyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy53cy5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogR2VuZXJhdGVzIHVyaSBmb3IgY29ubmVjdGlvbi5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLnVyaSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHZhciBxdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG5cdFx0XHRcdFx0XHR2YXIgc2NoZW1hID0gdGhpcy5zZWN1cmUgPyAnd3NzJyA6ICd3cyc7XG5cdFx0XHRcdFx0XHR2YXIgcG9ydCA9ICcnO1xuXG5cdFx0XHRcdFx0XHQvLyBhdm9pZCBwb3J0IGlmIGRlZmF1bHQgZm9yIHNjaGVtYVxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucG9ydCAmJiAoJ3dzcycgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA0NDMgfHwgJ3dzJyA9PSBzY2hlbWEgJiYgdGhpcy5wb3J0ICE9IDgwKSkge1xuXHRcdFx0XHRcdFx0XHRwb3J0ID0gJzonICsgdGhpcy5wb3J0O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBhcHBlbmQgdGltZXN0YW1wIHRvIFVSSVxuXHRcdFx0XHRcdFx0aWYgKHRoaXMudGltZXN0YW1wUmVxdWVzdHMpIHtcblx0XHRcdFx0XHRcdFx0cXVlcnlbdGhpcy50aW1lc3RhbXBQYXJhbV0gPSB5ZWFzdCgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBjb21tdW5pY2F0ZSBiaW5hcnkgc3VwcG9ydCBjYXBhYmlsaXRpZXNcblx0XHRcdFx0XHRcdGlmICghdGhpcy5zdXBwb3J0c0JpbmFyeSkge1xuXHRcdFx0XHRcdFx0XHRxdWVyeS5iNjQgPSAxO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRxdWVyeSA9IHBhcnNlcXMuZW5jb2RlKHF1ZXJ5KTtcblxuXHRcdFx0XHRcdFx0Ly8gcHJlcGVuZCA/IHRvIHF1ZXJ5XG5cdFx0XHRcdFx0XHRpZiAocXVlcnkubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdHF1ZXJ5ID0gJz8nICsgcXVlcnk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBpcHY2ID0gdGhpcy5ob3N0bmFtZS5pbmRleE9mKCc6JykgIT09IC0xO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHNjaGVtYSArICc6Ly8nICsgKGlwdjYgPyAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nIDogdGhpcy5ob3N0bmFtZSkgKyBwb3J0ICsgdGhpcy5wYXRoICsgcXVlcnk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBGZWF0dXJlIGRldGVjdGlvbiBmb3IgV2ViU29ja2V0LlxuICAgICAgKlxuICAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB3aGV0aGVyIHRoaXMgdHJhbnNwb3J0IGlzIGF2YWlsYWJsZS5cbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gISFXZWJTb2NrZXQgJiYgISgnX19pbml0aWFsaXplJyBpbiBXZWJTb2NrZXQgJiYgdGhpcy5uYW1lID09PSBXUy5wcm90b3R5cGUubmFtZSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHsgXCIuLi90cmFuc3BvcnRcIjogNCwgXCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNiwgXCJkZWJ1Z1wiOiAxNywgXCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5LCBcInBhcnNlcXNcIjogMjcsIFwid3NcIjogdW5kZWZpbmVkLCBcInllYXN0XCI6IDMwIH1dLCAxMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0Ly8gYnJvd3NlciBzaGltIGZvciB4bWxodHRwcmVxdWVzdCBtb2R1bGVcblx0XHRcdFx0dmFyIGhhc0NPUlMgPSBfZGVyZXFfKCdoYXMtY29ycycpO1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9wdHMpIHtcblx0XHRcdFx0XHR2YXIgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjtcblxuXHRcdFx0XHRcdC8vIHNjaGVtZSBtdXN0IGJlIHNhbWUgd2hlbiB1c2lnbiBYRG9tYWluUmVxdWVzdFxuXHRcdFx0XHRcdC8vIGh0dHA6Ly9ibG9ncy5tc2RuLmNvbS9iL2llaW50ZXJuYWxzL2FyY2hpdmUvMjAxMC8wNS8xMy94ZG9tYWlucmVxdWVzdC1yZXN0cmljdGlvbnMtbGltaXRhdGlvbnMtYW5kLXdvcmthcm91bmRzLmFzcHhcblx0XHRcdFx0XHR2YXIgeHNjaGVtZSA9IG9wdHMueHNjaGVtZTtcblxuXHRcdFx0XHRcdC8vIFhEb21haW5SZXF1ZXN0IGhhcyBhIGZsb3cgb2Ygbm90IHNlbmRpbmcgY29va2llLCB0aGVyZWZvcmUgaXQgc2hvdWxkIGJlIGRpc2FibGVkIGFzIGEgZGVmYXVsdC5cblx0XHRcdFx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vQXV0b21hdHRpYy9lbmdpbmUuaW8tY2xpZW50L3B1bGwvMjE3XG5cdFx0XHRcdFx0dmFyIGVuYWJsZXNYRFIgPSBvcHRzLmVuYWJsZXNYRFI7XG5cblx0XHRcdFx0XHQvLyBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgb24gSUVcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAmJiAoIXhkb21haW4gfHwgaGFzQ09SUykpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHQvLyBVc2UgWERvbWFpblJlcXVlc3QgZm9yIElFOCBpZiBlbmFibGVzWERSIGlzIHRydWVcblx0XHRcdFx0XHQvLyBiZWNhdXNlIGxvYWRpbmcgYmFyIGtlZXBzIGZsYXNoaW5nIHdoZW4gdXNpbmcganNvbnAtcG9sbGluZ1xuXHRcdFx0XHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS95dWppb3Nha2Evc29ja2UuaW8taWU4LWxvYWRpbmctZXhhbXBsZVxuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIFhEb21haW5SZXF1ZXN0ICYmICF4c2NoZW1lICYmIGVuYWJsZXNYRFIpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBYRG9tYWluUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHRpZiAoIXhkb21haW4pIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTEhUVFAnKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0fSwgeyBcImhhcy1jb3JzXCI6IDIyIH1dLCAxMTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBhZnRlcjtcblxuXHRcdFx0XHRmdW5jdGlvbiBhZnRlcihjb3VudCwgY2FsbGJhY2ssIGVycl9jYikge1xuXHRcdFx0XHRcdHZhciBiYWlsID0gZmFsc2U7XG5cdFx0XHRcdFx0ZXJyX2NiID0gZXJyX2NiIHx8IG5vb3A7XG5cdFx0XHRcdFx0cHJveHkuY291bnQgPSBjb3VudDtcblxuXHRcdFx0XHRcdHJldHVybiBjb3VudCA9PT0gMCA/IGNhbGxiYWNrKCkgOiBwcm94eTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHByb3h5KGVyciwgcmVzdWx0KSB7XG5cdFx0XHRcdFx0XHRpZiAocHJveHkuY291bnQgPD0gMCkge1xuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ2FmdGVyIGNhbGxlZCB0b28gbWFueSB0aW1lcycpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0LS1wcm94eS5jb3VudDtcblxuXHRcdFx0XHRcdFx0Ly8gYWZ0ZXIgZmlyc3QgZXJyb3IsIHJlc3QgYXJlIHBhc3NlZCB0byBlcnJfY2Jcblx0XHRcdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0YmFpbCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrKGVycik7XG5cdFx0XHRcdFx0XHRcdC8vIGZ1dHVyZSBlcnJvciBjYWxsYmFja3Mgd2lsbCBnbyB0byBlcnJvciBoYW5kbGVyXG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gZXJyX2NiO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChwcm94eS5jb3VudCA9PT0gMCAmJiAhYmFpbCkge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZ1bmN0aW9uIG5vb3AoKSB7fVxuXHRcdFx0fSwge31dLCAxMjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG4gICAgICogQW4gYWJzdHJhY3Rpb24gZm9yIHNsaWNpbmcgYW4gYXJyYXlidWZmZXIgZXZlbiB3aGVuXG4gICAgICogQXJyYXlCdWZmZXIucHJvdG90eXBlLnNsaWNlIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJyYXlidWZmZXIsIHN0YXJ0LCBlbmQpIHtcblx0XHRcdFx0XHR2YXIgYnl0ZXMgPSBhcnJheWJ1ZmZlci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdHN0YXJ0ID0gc3RhcnQgfHwgMDtcblx0XHRcdFx0XHRlbmQgPSBlbmQgfHwgYnl0ZXM7XG5cblx0XHRcdFx0XHRpZiAoYXJyYXlidWZmZXIuc2xpY2UpIHtcblx0XHRcdFx0XHRcdHJldHVybiBhcnJheWJ1ZmZlci5zbGljZShzdGFydCwgZW5kKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc3RhcnQgPCAwKSB7XG5cdFx0XHRcdFx0XHRzdGFydCArPSBieXRlcztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGVuZCA8IDApIHtcblx0XHRcdFx0XHRcdGVuZCArPSBieXRlcztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGVuZCA+IGJ5dGVzKSB7XG5cdFx0XHRcdFx0XHRlbmQgPSBieXRlcztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc3RhcnQgPj0gYnl0ZXMgfHwgc3RhcnQgPj0gZW5kIHx8IGJ5dGVzID09PSAwKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbmV3IEFycmF5QnVmZmVyKDApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBhYnYgPSBuZXcgVWludDhBcnJheShhcnJheWJ1ZmZlcik7XG5cdFx0XHRcdFx0dmFyIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGVuZCAtIHN0YXJ0KTtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gc3RhcnQsIGlpID0gMDsgaSA8IGVuZDsgaSsrLCBpaSsrKSB7XG5cdFx0XHRcdFx0XHRyZXN1bHRbaWldID0gYWJ2W2ldO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0LmJ1ZmZlcjtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSwgMTM6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qXG4gICAgICogYmFzZTY0LWFycmF5YnVmZmVyXG4gICAgICogaHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlclxuICAgICAqXG4gICAgICogQ29weXJpZ2h0IChjKSAyMDEyIE5pa2xhcyB2b24gSGVydHplblxuICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiAgICAgKi9cblx0XHRcdFx0KGZ1bmN0aW9uIChjaGFycykge1xuXHRcdFx0XHRcdFwidXNlIHN0cmljdFwiO1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGUgPSBmdW5jdGlvbiAoYXJyYXlidWZmZXIpIHtcblx0XHRcdFx0XHRcdHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSxcblx0XHRcdFx0XHRcdCAgICBpLFxuXHRcdFx0XHRcdFx0ICAgIGxlbiA9IGJ5dGVzLmxlbmd0aCxcblx0XHRcdFx0XHRcdCAgICBiYXNlNjQgPSBcIlwiO1xuXG5cdFx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdO1xuXHRcdFx0XHRcdFx0XHRiYXNlNjQgKz0gY2hhcnNbKGJ5dGVzW2ldICYgMykgPDwgNCB8IGJ5dGVzW2kgKyAxXSA+PiA0XTtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpICsgMV0gJiAxNSkgPDwgMiB8IGJ5dGVzW2kgKyAyXSA+PiA2XTtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kgKyAyXSAmIDYzXTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKGxlbiAlIDMgPT09IDIpIHtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ID0gYmFzZTY0LnN1YnN0cmluZygwLCBiYXNlNjQubGVuZ3RoIC0gMSkgKyBcIj1cIjtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobGVuICUgMyA9PT0gMSkge1xuXHRcdFx0XHRcdFx0XHRiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArIFwiPT1cIjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIGJhc2U2NDtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5kZWNvZGUgPSBmdW5jdGlvbiAoYmFzZTY0KSB7XG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIDAuNzUsXG5cdFx0XHRcdFx0XHQgICAgbGVuID0gYmFzZTY0Lmxlbmd0aCxcblx0XHRcdFx0XHRcdCAgICBpLFxuXHRcdFx0XHRcdFx0ICAgIHAgPSAwLFxuXHRcdFx0XHRcdFx0ICAgIGVuY29kZWQxLFxuXHRcdFx0XHRcdFx0ICAgIGVuY29kZWQyLFxuXHRcdFx0XHRcdFx0ICAgIGVuY29kZWQzLFxuXHRcdFx0XHRcdFx0ICAgIGVuY29kZWQ0O1xuXG5cdFx0XHRcdFx0XHRpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAxXSA9PT0gXCI9XCIpIHtcblx0XHRcdFx0XHRcdFx0YnVmZmVyTGVuZ3RoLS07XG5cdFx0XHRcdFx0XHRcdGlmIChiYXNlNjRbYmFzZTY0Lmxlbmd0aCAtIDJdID09PSBcIj1cIikge1xuXHRcdFx0XHRcdFx0XHRcdGJ1ZmZlckxlbmd0aC0tO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBhcnJheWJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihidWZmZXJMZW5ndGgpLFxuXHRcdFx0XHRcdFx0ICAgIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpO1xuXG5cdFx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcblx0XHRcdFx0XHRcdFx0ZW5jb2RlZDEgPSBjaGFycy5pbmRleE9mKGJhc2U2NFtpXSk7XG5cdFx0XHRcdFx0XHRcdGVuY29kZWQyID0gY2hhcnMuaW5kZXhPZihiYXNlNjRbaSArIDFdKTtcblx0XHRcdFx0XHRcdFx0ZW5jb2RlZDMgPSBjaGFycy5pbmRleE9mKGJhc2U2NFtpICsgMl0pO1xuXHRcdFx0XHRcdFx0XHRlbmNvZGVkNCA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2kgKyAzXSk7XG5cblx0XHRcdFx0XHRcdFx0Ynl0ZXNbcCsrXSA9IGVuY29kZWQxIDw8IDIgfCBlbmNvZGVkMiA+PiA0O1xuXHRcdFx0XHRcdFx0XHRieXRlc1twKytdID0gKGVuY29kZWQyICYgMTUpIDw8IDQgfCBlbmNvZGVkMyA+PiAyO1xuXHRcdFx0XHRcdFx0XHRieXRlc1twKytdID0gKGVuY29kZWQzICYgMykgPDwgNiB8IGVuY29kZWQ0ICYgNjM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBhcnJheWJ1ZmZlcjtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KShcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIik7XG5cdFx0XHR9LCB7fV0sIDE0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDcmVhdGUgYSBibG9iIGJ1aWxkZXIgZXZlbiB3aGVuIHZlbmRvciBwcmVmaXhlcyBleGlzdFxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBCbG9iQnVpbGRlciA9IGdsb2JhbC5CbG9iQnVpbGRlciB8fCBnbG9iYWwuV2ViS2l0QmxvYkJ1aWxkZXIgfHwgZ2xvYmFsLk1TQmxvYkJ1aWxkZXIgfHwgZ2xvYmFsLk1vekJsb2JCdWlsZGVyO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIENoZWNrIGlmIEJsb2IgY29uc3RydWN0b3IgaXMgc3VwcG9ydGVkXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIGJsb2JTdXBwb3J0ZWQgPSAoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0dmFyIGEgPSBuZXcgQmxvYihbJ2hpJ10pO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYS5zaXplID09PSAyO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkoKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVjayBpZiBCbG9iIGNvbnN0cnVjdG9yIHN1cHBvcnRzIEFycmF5QnVmZmVyVmlld3NcbiAgICAgICogRmFpbHMgaW4gU2FmYXJpIDYsIHNvIHdlIG5lZWQgdG8gbWFwIHRvIEFycmF5QnVmZmVycyB0aGVyZS5cbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgYmxvYlN1cHBvcnRzQXJyYXlCdWZmZXJWaWV3ID0gYmxvYlN1cHBvcnRlZCAmJiAoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0dmFyIGIgPSBuZXcgQmxvYihbbmV3IFVpbnQ4QXJyYXkoWzEsIDJdKV0pO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYi5zaXplID09PSAyO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkoKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVjayBpZiBCbG9iQnVpbGRlciBpcyBzdXBwb3J0ZWRcbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgYmxvYkJ1aWxkZXJTdXBwb3J0ZWQgPSBCbG9iQnVpbGRlciAmJiBCbG9iQnVpbGRlci5wcm90b3R5cGUuYXBwZW5kICYmIEJsb2JCdWlsZGVyLnByb3RvdHlwZS5nZXRCbG9iO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEhlbHBlciBmdW5jdGlvbiB0aGF0IG1hcHMgQXJyYXlCdWZmZXJWaWV3cyB0byBBcnJheUJ1ZmZlcnNcbiAgICAgICogVXNlZCBieSBCbG9iQnVpbGRlciBjb25zdHJ1Y3RvciBhbmQgb2xkIGJyb3dzZXJzIHRoYXQgZGlkbid0XG4gICAgICAqIHN1cHBvcnQgaXQgaW4gdGhlIEJsb2IgY29uc3RydWN0b3IuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gbWFwQXJyYXlCdWZmZXJWaWV3cyhhcnkpIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBjaHVuayA9IGFyeVtpXTtcblx0XHRcdFx0XHRcdFx0aWYgKGNodW5rLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGJ1ZiA9IGNodW5rLmJ1ZmZlcjtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIGlmIHRoaXMgaXMgYSBzdWJhcnJheSwgbWFrZSBhIGNvcHkgc28gd2Ugb25seVxuXHRcdFx0XHRcdFx0XHRcdC8vIGluY2x1ZGUgdGhlIHN1YmFycmF5IHJlZ2lvbiBmcm9tIHRoZSB1bmRlcmx5aW5nIGJ1ZmZlclxuXHRcdFx0XHRcdFx0XHRcdGlmIChjaHVuay5ieXRlTGVuZ3RoICE9PSBidWYuYnl0ZUxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNvcHkgPSBuZXcgVWludDhBcnJheShjaHVuay5ieXRlTGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGNvcHkuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZiwgY2h1bmsuYnl0ZU9mZnNldCwgY2h1bmsuYnl0ZUxlbmd0aCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnVmID0gY29weS5idWZmZXI7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0YXJ5W2ldID0gYnVmO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gQmxvYkJ1aWxkZXJDb25zdHJ1Y3RvcihhcnksIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdFx0XHRcdFx0XHR2YXIgYmIgPSBuZXcgQmxvYkJ1aWxkZXIoKTtcblx0XHRcdFx0XHRcdG1hcEFycmF5QnVmZmVyVmlld3MoYXJ5KTtcblxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnkubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0YmIuYXBwZW5kKGFyeVtpXSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBvcHRpb25zLnR5cGUgPyBiYi5nZXRCbG9iKG9wdGlvbnMudHlwZSkgOiBiYi5nZXRCbG9iKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIEJsb2JDb25zdHJ1Y3RvcihhcnksIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdG1hcEFycmF5QnVmZmVyVmlld3MoYXJ5KTtcblx0XHRcdFx0XHRcdHJldHVybiBuZXcgQmxvYihhcnksIG9wdGlvbnMgfHwge30pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRpZiAoYmxvYlN1cHBvcnRlZCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYmxvYlN1cHBvcnRzQXJyYXlCdWZmZXJWaWV3ID8gZ2xvYmFsLkJsb2IgOiBCbG9iQ29uc3RydWN0b3I7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGJsb2JCdWlsZGVyU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBCbG9iQnVpbGRlckNvbnN0cnVjdG9yO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KSgpO1xuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwge31dLCAxNTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFeHBvc2UgYEVtaXR0ZXJgLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBJbml0aWFsaXplIGEgbmV3IGBFbWl0dGVyYC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gRW1pdHRlcihvYmopIHtcblx0XHRcdFx0XHRpZiAob2JqKSByZXR1cm4gbWl4aW4ob2JqKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBNaXhpbiB0aGUgZW1pdHRlciBwcm9wZXJ0aWVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9ialxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBtaXhpbihvYmopIHtcblx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcblx0XHRcdFx0XHRcdG9ialtrZXldID0gRW1pdHRlci5wcm90b3R5cGVba2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIG9iajtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIExpc3RlbiBvbiB0aGUgZ2l2ZW4gYGV2ZW50YCB3aXRoIGBmbmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdCh0aGlzLl9jYWxsYmFja3NbZXZlbnRdID0gdGhpcy5fY2FsbGJhY2tzW2V2ZW50XSB8fCBbXSkucHVzaChmbik7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQWRkcyBhbiBgZXZlbnRgIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBpbnZva2VkIGEgc2luZ2xlXG4gICAgICogdGltZSB0aGVuIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHJldHVybiB7RW1pdHRlcn1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIG9uKCkge1xuXHRcdFx0XHRcdFx0c2VsZi5vZmYoZXZlbnQsIG9uKTtcblx0XHRcdFx0XHRcdGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0b24uZm4gPSBmbjtcblx0XHRcdFx0XHR0aGlzLm9uKGV2ZW50LCBvbik7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmVtb3ZlIHRoZSBnaXZlbiBjYWxsYmFjayBmb3IgYGV2ZW50YCBvciBhbGxcbiAgICAgKiByZWdpc3RlcmVkIGNhbGxiYWNrcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHJldHVybiB7RW1pdHRlcn1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcblx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cblx0XHRcdFx0XHQvLyBhbGxcblx0XHRcdFx0XHRpZiAoMCA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB7fTtcblx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIHNwZWNpZmljIGV2ZW50XG5cdFx0XHRcdFx0dmFyIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrc1tldmVudF07XG5cdFx0XHRcdFx0aWYgKCFjYWxsYmFja3MpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0Ly8gcmVtb3ZlIGFsbCBoYW5kbGVyc1xuXHRcdFx0XHRcdGlmICgxID09IGFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gcmVtb3ZlIHNwZWNpZmljIGhhbmRsZXJcblx0XHRcdFx0XHR2YXIgY2I7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGNiID0gY2FsbGJhY2tzW2ldO1xuXHRcdFx0XHRcdFx0aWYgKGNiID09PSBmbiB8fCBjYi5mbiA9PT0gZm4pIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2tzLnNwbGljZShpLCAxKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEVtaXQgYGV2ZW50YCB3aXRoIHRoZSBnaXZlbiBhcmdzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG4gICAgICogQHBhcmFtIHtNaXhlZH0gLi4uXG4gICAgICogQHJldHVybiB7RW1pdHRlcn1cbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLFxuXHRcdFx0XHRcdCAgICBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xuXG5cdFx0XHRcdFx0aWYgKGNhbGxiYWNrcykge1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2tzID0gY2FsbGJhY2tzLnNsaWNlKDApO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFja3NbaV0uYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJuIGFycmF5IG9mIGNhbGxiYWNrcyBmb3IgYGV2ZW50YC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9jYWxsYmFja3NbZXZlbnRdIHx8IFtdO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENoZWNrIGlmIHRoaXMgZW1pdHRlciBoYXMgYGV2ZW50YCBoYW5kbGVycy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5oYXNMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0XHRyZXR1cm4gISF0aGlzLmxpc3RlbmVycyhldmVudCkubGVuZ3RoO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwge31dLCAxNjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cdFx0XHRcdFx0dmFyIGZuID0gZnVuY3Rpb24gZm4oKSB7fTtcblx0XHRcdFx0XHRmbi5wcm90b3R5cGUgPSBiLnByb3RvdHlwZTtcblx0XHRcdFx0XHRhLnByb3RvdHlwZSA9IG5ldyBmbigpO1xuXHRcdFx0XHRcdGEucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gYTtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSwgMTc6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG4gICAgICogVGhpcyBpcyB0aGUgd2ViIGJyb3dzZXIgaW1wbGVtZW50YXRpb24gb2YgYGRlYnVnKClgLlxuICAgICAqXG4gICAgICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF9kZXJlcV8oJy4vZGVidWcnKTtcblx0XHRcdFx0ZXhwb3J0cy5sb2cgPSBsb2c7XG5cdFx0XHRcdGV4cG9ydHMuZm9ybWF0QXJncyA9IGZvcm1hdEFyZ3M7XG5cdFx0XHRcdGV4cG9ydHMuc2F2ZSA9IHNhdmU7XG5cdFx0XHRcdGV4cG9ydHMubG9hZCA9IGxvYWQ7XG5cdFx0XHRcdGV4cG9ydHMudXNlQ29sb3JzID0gdXNlQ29sb3JzO1xuXHRcdFx0XHRleHBvcnRzLnN0b3JhZ2UgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiBjaHJvbWUuc3RvcmFnZSA/IGNocm9tZS5zdG9yYWdlLmxvY2FsIDogbG9jYWxzdG9yYWdlKCk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ29sb3JzLlxuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuY29sb3JzID0gWydsaWdodHNlYWdyZWVuJywgJ2ZvcmVzdGdyZWVuJywgJ2dvbGRlbnJvZCcsICdkb2RnZXJibHVlJywgJ2RhcmtvcmNoaWQnLCAnY3JpbXNvbiddO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG4gICAgICogYW5kIHRoZSBGaXJlYnVnIGV4dGVuc2lvbiAoYW55IEZpcmVmb3ggdmVyc2lvbikgYXJlIGtub3duXG4gICAgICogdG8gc3VwcG9ydCBcIiVjXCIgQ1NTIGN1c3RvbWl6YXRpb25zLlxuICAgICAqXG4gICAgICogVE9ETzogYWRkIGEgYGxvY2FsU3RvcmFnZWAgdmFyaWFibGUgdG8gZXhwbGljaXRseSBlbmFibGUvZGlzYWJsZSBjb2xvcnNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiB1c2VDb2xvcnMoKSB7XG5cdFx0XHRcdFx0Ly8gaXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcblx0XHRcdFx0XHRyZXR1cm4gJ1dlYmtpdEFwcGVhcmFuY2UnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSB8fFxuXHRcdFx0XHRcdC8vIGlzIGZpcmVidWc/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5ODEyMC8zNzY3NzNcblx0XHRcdFx0XHR3aW5kb3cuY29uc29sZSAmJiAoY29uc29sZS5maXJlYnVnIHx8IGNvbnNvbGUuZXhjZXB0aW9uICYmIGNvbnNvbGUudGFibGUpIHx8XG5cdFx0XHRcdFx0Ly8gaXMgZmlyZWZveCA+PSB2MzE/XG5cdFx0XHRcdFx0Ly8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9Ub29scy9XZWJfQ29uc29sZSNTdHlsaW5nX21lc3NhZ2VzXG5cdFx0XHRcdFx0bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9maXJlZm94XFwvKFxcZCspLykgJiYgcGFyc2VJbnQoUmVnRXhwLiQxLCAxMCkgPj0gMzE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBNYXAgJWogdG8gYEpTT04uc3RyaW5naWZ5KClgLCBzaW5jZSBubyBXZWIgSW5zcGVjdG9ycyBkbyB0aGF0IGJ5IGRlZmF1bHQuXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5mb3JtYXR0ZXJzLmogPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdHJldHVybiBKU09OLnN0cmluZ2lmeSh2KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDb2xvcml6ZSBsb2cgYXJndW1lbnRzIGlmIGVuYWJsZWQuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGZvcm1hdEFyZ3MoKSB7XG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSBhcmd1bWVudHM7XG5cdFx0XHRcdFx0dmFyIHVzZUNvbG9ycyA9IHRoaXMudXNlQ29sb3JzO1xuXG5cdFx0XHRcdFx0YXJnc1swXSA9ICh1c2VDb2xvcnMgPyAnJWMnIDogJycpICsgdGhpcy5uYW1lc3BhY2UgKyAodXNlQ29sb3JzID8gJyAlYycgOiAnICcpICsgYXJnc1swXSArICh1c2VDb2xvcnMgPyAnJWMgJyA6ICcgJykgKyAnKycgKyBleHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7XG5cblx0XHRcdFx0XHRpZiAoIXVzZUNvbG9ycykgcmV0dXJuIGFyZ3M7XG5cblx0XHRcdFx0XHR2YXIgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7XG5cdFx0XHRcdFx0YXJncyA9IFthcmdzWzBdLCBjLCAnY29sb3I6IGluaGVyaXQnXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncywgMSkpO1xuXG5cdFx0XHRcdFx0Ly8gdGhlIGZpbmFsIFwiJWNcIiBpcyBzb21ld2hhdCB0cmlja3ksIGJlY2F1c2UgdGhlcmUgY291bGQgYmUgb3RoZXJcblx0XHRcdFx0XHQvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvXG5cdFx0XHRcdFx0Ly8gZmlndXJlIG91dCB0aGUgY29ycmVjdCBpbmRleCB0byBpbnNlcnQgdGhlIENTUyBpbnRvXG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gMDtcblx0XHRcdFx0XHR2YXIgbGFzdEMgPSAwO1xuXHRcdFx0XHRcdGFyZ3NbMF0ucmVwbGFjZSgvJVthLXolXS9nLCBmdW5jdGlvbiAobWF0Y2gpIHtcblx0XHRcdFx0XHRcdGlmICgnJSUnID09PSBtYXRjaCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdGlmICgnJWMnID09PSBtYXRjaCkge1xuXHRcdFx0XHRcdFx0XHQvLyB3ZSBvbmx5IGFyZSBpbnRlcmVzdGVkIGluIHRoZSAqbGFzdCogJWNcblx0XHRcdFx0XHRcdFx0Ly8gKHRoZSB1c2VyIG1heSBoYXZlIHByb3ZpZGVkIHRoZWlyIG93bilcblx0XHRcdFx0XHRcdFx0bGFzdEMgPSBpbmRleDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcblx0XHRcdFx0XHRyZXR1cm4gYXJncztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIEludm9rZXMgYGNvbnNvbGUubG9nKClgIHdoZW4gYXZhaWxhYmxlLlxuICAgICAqIE5vLW9wIHdoZW4gYGNvbnNvbGUubG9nYCBpcyBub3QgYSBcImZ1bmN0aW9uXCIuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvZygpIHtcblx0XHRcdFx0XHQvLyB0aGlzIGhhY2tlcnkgaXMgcmVxdWlyZWQgZm9yIElFOC85LCB3aGVyZVxuXHRcdFx0XHRcdC8vIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uIGRvZXNuJ3QgaGF2ZSAnYXBwbHknXG5cdFx0XHRcdFx0cmV0dXJuICdvYmplY3QnID09PSB0eXBlb2YgY29uc29sZSAmJiBjb25zb2xlLmxvZyAmJiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChjb25zb2xlLmxvZywgY29uc29sZSwgYXJndW1lbnRzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIFNhdmUgYG5hbWVzcGFjZXNgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0aWYgKG51bGwgPT0gbmFtZXNwYWNlcykge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnZGVidWcnKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZyA9IG5hbWVzcGFjZXM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIExvYWQgYG5hbWVzcGFjZXNgLlxuICAgICAqXG4gICAgICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2Rlc1xuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvYWQoKSB7XG5cdFx0XHRcdFx0dmFyIHI7XG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdHIgPSBleHBvcnRzLnN0b3JhZ2UuZGVidWc7XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRyZXR1cm4gcjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIEVuYWJsZSBuYW1lc3BhY2VzIGxpc3RlZCBpbiBgbG9jYWxTdG9yYWdlLmRlYnVnYCBpbml0aWFsbHkuXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5lbmFibGUobG9hZCgpKTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBMb2NhbHN0b3JhZ2UgYXR0ZW1wdHMgdG8gcmV0dXJuIHRoZSBsb2NhbHN0b3JhZ2UuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHNhZmFyaSB0aHJvd3NcbiAgICAgKiB3aGVuIGEgdXNlciBkaXNhYmxlcyBjb29raWVzL2xvY2Fsc3RvcmFnZVxuICAgICAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtMb2NhbFN0b3JhZ2V9XG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gbG9jYWxzdG9yYWdlKCkge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZTtcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxuXHRcdFx0XHR9XG5cdFx0XHR9LCB7IFwiLi9kZWJ1Z1wiOiAxOCB9XSwgMTg6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG4gICAgICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlclxuICAgICAqIGltcGxlbWVudGF0aW9ucyBvZiBgZGVidWcoKWAuXG4gICAgICpcbiAgICAgKiBFeHBvc2UgYGRlYnVnKClgIGFzIHRoZSBtb2R1bGUuXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZGVidWc7XG5cdFx0XHRcdGV4cG9ydHMuY29lcmNlID0gY29lcmNlO1xuXHRcdFx0XHRleHBvcnRzLmRpc2FibGUgPSBkaXNhYmxlO1xuXHRcdFx0XHRleHBvcnRzLmVuYWJsZSA9IGVuYWJsZTtcblx0XHRcdFx0ZXhwb3J0cy5lbmFibGVkID0gZW5hYmxlZDtcblx0XHRcdFx0ZXhwb3J0cy5odW1hbml6ZSA9IF9kZXJlcV8oJ21zJyk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogVGhlIGN1cnJlbnRseSBhY3RpdmUgZGVidWcgbW9kZSBuYW1lcywgYW5kIG5hbWVzIHRvIHNraXAuXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5uYW1lcyA9IFtdO1xuXHRcdFx0XHRleHBvcnRzLnNraXBzID0gW107XG5cblx0XHRcdFx0LyoqXG4gICAgICogTWFwIG9mIHNwZWNpYWwgXCIlblwiIGhhbmRsaW5nIGZ1bmN0aW9ucywgZm9yIHRoZSBkZWJ1ZyBcImZvcm1hdFwiIGFyZ3VtZW50LlxuICAgICAqXG4gICAgICogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXJjYXNlZCBsZXR0ZXIsIGkuZS4gXCJuXCIuXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5mb3JtYXR0ZXJzID0ge307XG5cblx0XHRcdFx0LyoqXG4gICAgICogUHJldmlvdXNseSBhc3NpZ25lZCBjb2xvci5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgcHJldkNvbG9yID0gMDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBQcmV2aW91cyBsb2cgdGltZXN0YW1wLlxuICAgICAqL1xuXG5cdFx0XHRcdHZhciBwcmV2VGltZTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTZWxlY3QgYSBjb2xvci5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBzZWxlY3RDb2xvcigpIHtcblx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5jb2xvcnNbcHJldkNvbG9yKysgJSBleHBvcnRzLmNvbG9ycy5sZW5ndGhdO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ3JlYXRlIGEgZGVidWdnZXIgd2l0aCB0aGUgZ2l2ZW4gYG5hbWVzcGFjZWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBkZWJ1ZyhuYW1lc3BhY2UpIHtcblxuXHRcdFx0XHRcdC8vIGRlZmluZSB0aGUgYGRpc2FibGVkYCB2ZXJzaW9uXG5cdFx0XHRcdFx0ZnVuY3Rpb24gZGlzYWJsZWQoKSB7fVxuXHRcdFx0XHRcdGRpc2FibGVkLmVuYWJsZWQgPSBmYWxzZTtcblxuXHRcdFx0XHRcdC8vIGRlZmluZSB0aGUgYGVuYWJsZWRgIHZlcnNpb25cblx0XHRcdFx0XHRmdW5jdGlvbiBlbmFibGVkKCkge1xuXG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IGVuYWJsZWQ7XG5cblx0XHRcdFx0XHRcdC8vIHNldCBgZGlmZmAgdGltZXN0YW1wXG5cdFx0XHRcdFx0XHR2YXIgY3VyciA9ICtuZXcgRGF0ZSgpO1xuXHRcdFx0XHRcdFx0dmFyIG1zID0gY3VyciAtIChwcmV2VGltZSB8fCBjdXJyKTtcblx0XHRcdFx0XHRcdHNlbGYuZGlmZiA9IG1zO1xuXHRcdFx0XHRcdFx0c2VsZi5wcmV2ID0gcHJldlRpbWU7XG5cdFx0XHRcdFx0XHRzZWxmLmN1cnIgPSBjdXJyO1xuXHRcdFx0XHRcdFx0cHJldlRpbWUgPSBjdXJyO1xuXG5cdFx0XHRcdFx0XHQvLyBhZGQgdGhlIGBjb2xvcmAgaWYgbm90IHNldFxuXHRcdFx0XHRcdFx0aWYgKG51bGwgPT0gc2VsZi51c2VDb2xvcnMpIHNlbGYudXNlQ29sb3JzID0gZXhwb3J0cy51c2VDb2xvcnMoKTtcblx0XHRcdFx0XHRcdGlmIChudWxsID09IHNlbGYuY29sb3IgJiYgc2VsZi51c2VDb2xvcnMpIHNlbGYuY29sb3IgPSBzZWxlY3RDb2xvcigpO1xuXG5cdFx0XHRcdFx0XHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0XHRcdGFyZ3NbMF0gPSBleHBvcnRzLmNvZXJjZShhcmdzWzBdKTtcblxuXHRcdFx0XHRcdFx0aWYgKCdzdHJpbmcnICE9PSB0eXBlb2YgYXJnc1swXSkge1xuXHRcdFx0XHRcdFx0XHQvLyBhbnl0aGluZyBlbHNlIGxldCdzIGluc3BlY3Qgd2l0aCAlb1xuXHRcdFx0XHRcdFx0XHRhcmdzID0gWyclbyddLmNvbmNhdChhcmdzKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gYXBwbHkgYW55IGBmb3JtYXR0ZXJzYCB0cmFuc2Zvcm1hdGlvbnNcblx0XHRcdFx0XHRcdHZhciBpbmRleCA9IDA7XG5cdFx0XHRcdFx0XHRhcmdzWzBdID0gYXJnc1swXS5yZXBsYWNlKC8lKFthLXolXSkvZywgZnVuY3Rpb24gKG1hdGNoLCBmb3JtYXQpIHtcblx0XHRcdFx0XHRcdFx0Ly8gaWYgd2UgZW5jb3VudGVyIGFuIGVzY2FwZWQgJSB0aGVuIGRvbid0IGluY3JlYXNlIHRoZSBhcnJheSBpbmRleFxuXHRcdFx0XHRcdFx0XHRpZiAobWF0Y2ggPT09ICclJScpIHJldHVybiBtYXRjaDtcblx0XHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdFx0dmFyIGZvcm1hdHRlciA9IGV4cG9ydHMuZm9ybWF0dGVyc1tmb3JtYXRdO1xuXHRcdFx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGZvcm1hdHRlcikge1xuXHRcdFx0XHRcdFx0XHRcdHZhciB2YWwgPSBhcmdzW2luZGV4XTtcblx0XHRcdFx0XHRcdFx0XHRtYXRjaCA9IGZvcm1hdHRlci5jYWxsKHNlbGYsIHZhbCk7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBub3cgd2UgbmVlZCB0byByZW1vdmUgYGFyZ3NbaW5kZXhdYCBzaW5jZSBpdCdzIGlubGluZWQgaW4gdGhlIGBmb3JtYXRgXG5cdFx0XHRcdFx0XHRcdFx0YXJncy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdFx0XHRcdGluZGV4LS07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIG1hdGNoO1xuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZXhwb3J0cy5mb3JtYXRBcmdzKSB7XG5cdFx0XHRcdFx0XHRcdGFyZ3MgPSBleHBvcnRzLmZvcm1hdEFyZ3MuYXBwbHkoc2VsZiwgYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgbG9nRm4gPSBlbmFibGVkLmxvZyB8fCBleHBvcnRzLmxvZyB8fCBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpO1xuXHRcdFx0XHRcdFx0bG9nRm4uYXBwbHkoc2VsZiwgYXJncyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVuYWJsZWQuZW5hYmxlZCA9IHRydWU7XG5cblx0XHRcdFx0XHR2YXIgZm4gPSBleHBvcnRzLmVuYWJsZWQobmFtZXNwYWNlKSA/IGVuYWJsZWQgOiBkaXNhYmxlZDtcblxuXHRcdFx0XHRcdGZuLm5hbWVzcGFjZSA9IG5hbWVzcGFjZTtcblxuXHRcdFx0XHRcdHJldHVybiBmbjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIEVuYWJsZXMgYSBkZWJ1ZyBtb2RlIGJ5IG5hbWVzcGFjZXMuIFRoaXMgY2FuIGluY2x1ZGUgbW9kZXNcbiAgICAgKiBzZXBhcmF0ZWQgYnkgYSBjb2xvbiBhbmQgd2lsZGNhcmRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGVuYWJsZShuYW1lc3BhY2VzKSB7XG5cdFx0XHRcdFx0ZXhwb3J0cy5zYXZlKG5hbWVzcGFjZXMpO1xuXG5cdFx0XHRcdFx0dmFyIHNwbGl0ID0gKG5hbWVzcGFjZXMgfHwgJycpLnNwbGl0KC9bXFxzLF0rLyk7XG5cdFx0XHRcdFx0dmFyIGxlbiA9IHNwbGl0Lmxlbmd0aDtcblxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHRcdGlmICghc3BsaXRbaV0pIGNvbnRpbnVlOyAvLyBpZ25vcmUgZW1wdHkgc3RyaW5nc1xuXHRcdFx0XHRcdFx0bmFtZXNwYWNlcyA9IHNwbGl0W2ldLnJlcGxhY2UoL1xcKi9nLCAnLio/Jyk7XG5cdFx0XHRcdFx0XHRpZiAobmFtZXNwYWNlc1swXSA9PT0gJy0nKSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuc2tpcHMucHVzaChuZXcgUmVnRXhwKCdeJyArIG5hbWVzcGFjZXMuc3Vic3RyKDEpICsgJyQnKSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLm5hbWVzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzICsgJyQnKSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogRGlzYWJsZSBkZWJ1ZyBvdXRwdXQuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGRpc2FibGUoKSB7XG5cdFx0XHRcdFx0ZXhwb3J0cy5lbmFibGUoJycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gZW5hYmxlZChuYW1lKSB7XG5cdFx0XHRcdFx0dmFyIGksIGxlbjtcblx0XHRcdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBleHBvcnRzLnNraXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoZXhwb3J0cy5za2lwc1tpXS50ZXN0KG5hbWUpKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Zm9yIChpID0gMCwgbGVuID0gZXhwb3J0cy5uYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKGV4cG9ydHMubmFtZXNbaV0udGVzdChuYW1lKSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ29lcmNlIGB2YWxgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gICAgICogQHJldHVybiB7TWl4ZWR9XG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gY29lcmNlKHZhbCkge1xuXHRcdFx0XHRcdGlmICh2YWwgaW5zdGFuY2VvZiBFcnJvcikgcmV0dXJuIHZhbC5zdGFjayB8fCB2YWwubWVzc2FnZTtcblx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCB7IFwibXNcIjogMjUgfV0sIDE5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBrZXlzID0gX2RlcmVxXygnLi9rZXlzJyk7XG5cdFx0XHRcdFx0dmFyIGhhc0JpbmFyeSA9IF9kZXJlcV8oJ2hhcy1iaW5hcnknKTtcblx0XHRcdFx0XHR2YXIgc2xpY2VCdWZmZXIgPSBfZGVyZXFfKCdhcnJheWJ1ZmZlci5zbGljZScpO1xuXHRcdFx0XHRcdHZhciBiYXNlNjRlbmNvZGVyID0gX2RlcmVxXygnYmFzZTY0LWFycmF5YnVmZmVyJyk7XG5cdFx0XHRcdFx0dmFyIGFmdGVyID0gX2RlcmVxXygnYWZ0ZXInKTtcblx0XHRcdFx0XHR2YXIgdXRmOCA9IF9kZXJlcV8oJ3V0ZjgnKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVjayBpZiB3ZSBhcmUgcnVubmluZyBhbiBhbmRyb2lkIGJyb3dzZXIuIFRoYXQgcmVxdWlyZXMgdXMgdG8gdXNlXG4gICAgICAqIEFycmF5QnVmZmVyIHdpdGggcG9sbGluZyB0cmFuc3BvcnRzLi4uXG4gICAgICAqXG4gICAgICAqIGh0dHA6Ly9naGluZGEubmV0L2pwZWctYmxvYi1hamF4LWFuZHJvaWQvXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIGlzQW5kcm9pZCA9IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ2hlY2sgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gUGhhbnRvbUpTLlxuICAgICAgKiBVcGxvYWRpbmcgYSBCbG9iIHdpdGggUGhhbnRvbUpTIGRvZXMgbm90IHdvcmsgY29ycmVjdGx5LCBhcyByZXBvcnRlZCBoZXJlOlxuICAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vYXJpeWEvcGhhbnRvbWpzL2lzc3Vlcy8xMTM5NVxuICAgICAgKiBAdHlwZSBib29sZWFuXG4gICAgICAqL1xuXHRcdFx0XHRcdHZhciBpc1BoYW50b21KUyA9IC9QaGFudG9tSlMvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFdoZW4gdHJ1ZSwgYXZvaWRzIHVzaW5nIEJsb2JzIHRvIGVuY29kZSBwYXlsb2Fkcy5cbiAgICAgICogQHR5cGUgYm9vbGVhblxuICAgICAgKi9cblx0XHRcdFx0XHR2YXIgZG9udFNlbmRCbG9icyA9IGlzQW5kcm9pZCB8fCBpc1BoYW50b21KUztcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDdXJyZW50IHByb3RvY29sIHZlcnNpb24uXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5wcm90b2NvbCA9IDM7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogUGFja2V0IHR5cGVzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBwYWNrZXRzID0gZXhwb3J0cy5wYWNrZXRzID0ge1xuXHRcdFx0XHRcdFx0b3BlbjogMCwgLy8gbm9uLXdzXG5cdFx0XHRcdFx0XHRjbG9zZTogMSwgLy8gbm9uLXdzXG5cdFx0XHRcdFx0XHRwaW5nOiAyLFxuXHRcdFx0XHRcdFx0cG9uZzogMyxcblx0XHRcdFx0XHRcdG1lc3NhZ2U6IDQsXG5cdFx0XHRcdFx0XHR1cGdyYWRlOiA1LFxuXHRcdFx0XHRcdFx0bm9vcDogNlxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHR2YXIgcGFja2V0c2xpc3QgPSBrZXlzKHBhY2tldHMpO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFByZW1hZGUgZXJyb3IgcGFja2V0LlxuICAgICAgKi9cblxuXHRcdFx0XHRcdHZhciBlcnIgPSB7IHR5cGU6ICdlcnJvcicsIGRhdGE6ICdwYXJzZXIgZXJyb3InIH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQ3JlYXRlIGEgYmxvYiBhcGkgZXZlbiBmb3IgYmxvYiBidWlsZGVyIHdoZW4gdmVuZG9yIHByZWZpeGVzIGV4aXN0XG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIEJsb2IgPSBfZGVyZXFfKCdibG9iJyk7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogRW5jb2RlcyBhIHBhY2tldC5cbiAgICAgICpcbiAgICAgICogICAgIDxwYWNrZXQgdHlwZSBpZD4gWyA8ZGF0YT4gXVxuICAgICAgKlxuICAgICAgKiBFeGFtcGxlOlxuICAgICAgKlxuICAgICAgKiAgICAgNWhlbGxvIHdvcmxkXG4gICAgICAqICAgICAzXG4gICAgICAqICAgICA0XG4gICAgICAqXG4gICAgICAqIEJpbmFyeSBpcyBlbmNvZGVkIGluIGFuIGlkZW50aWNhbCBwcmluY2lwbGVcbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGVQYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgdXRmOGVuY29kZSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09IHR5cGVvZiBzdXBwb3J0c0JpbmFyeSkge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IHN1cHBvcnRzQmluYXJ5O1xuXHRcdFx0XHRcdFx0XHRzdXBwb3J0c0JpbmFyeSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyA9PSB0eXBlb2YgdXRmOGVuY29kZSkge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IHV0ZjhlbmNvZGU7XG5cdFx0XHRcdFx0XHRcdHV0ZjhlbmNvZGUgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgZGF0YSA9IHBhY2tldC5kYXRhID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBwYWNrZXQuZGF0YS5idWZmZXIgfHwgcGFja2V0LmRhdGE7XG5cblx0XHRcdFx0XHRcdGlmIChnbG9iYWwuQXJyYXlCdWZmZXIgJiYgZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbmNvZGVBcnJheUJ1ZmZlcihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKEJsb2IgJiYgZGF0YSBpbnN0YW5jZW9mIGdsb2JhbC5CbG9iKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbmNvZGVCbG9iKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gbWlnaHQgYmUgYW4gb2JqZWN0IHdpdGggeyBiYXNlNjQ6IHRydWUsIGRhdGE6IGRhdGFBc0Jhc2U2NFN0cmluZyB9XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSAmJiBkYXRhLmJhc2U2NCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZW5jb2RlQmFzZTY0T2JqZWN0KHBhY2tldCwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBTZW5kaW5nIGRhdGEgYXMgYSB1dGYtOCBzdHJpbmdcblx0XHRcdFx0XHRcdHZhciBlbmNvZGVkID0gcGFja2V0c1twYWNrZXQudHlwZV07XG5cblx0XHRcdFx0XHRcdC8vIGRhdGEgZnJhZ21lbnQgaXMgb3B0aW9uYWxcblx0XHRcdFx0XHRcdGlmICh1bmRlZmluZWQgIT09IHBhY2tldC5kYXRhKSB7XG5cdFx0XHRcdFx0XHRcdGVuY29kZWQgKz0gdXRmOGVuY29kZSA/IHV0ZjguZW5jb2RlKFN0cmluZyhwYWNrZXQuZGF0YSkpIDogU3RyaW5nKHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKCcnICsgZW5jb2RlZCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUJhc2U2NE9iamVjdChwYWNrZXQsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHQvLyBwYWNrZXQgZGF0YSBpcyBhbiBvYmplY3QgeyBiYXNlNjQ6IHRydWUsIGRhdGE6IGRhdGFBc0Jhc2U2NFN0cmluZyB9XG5cdFx0XHRcdFx0XHR2YXIgbWVzc2FnZSA9ICdiJyArIGV4cG9ydHMucGFja2V0c1twYWNrZXQudHlwZV0gKyBwYWNrZXQuZGF0YS5kYXRhO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKG1lc3NhZ2UpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFbmNvZGUgcGFja2V0IGhlbHBlcnMgZm9yIGJpbmFyeSB0eXBlc1xuICAgICAgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUFycmF5QnVmZmVyKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXN1cHBvcnRzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBleHBvcnRzLmVuY29kZUJhc2U2NFBhY2tldChwYWNrZXQsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGRhdGEgPSBwYWNrZXQuZGF0YTtcblx0XHRcdFx0XHRcdHZhciBjb250ZW50QXJyYXkgPSBuZXcgVWludDhBcnJheShkYXRhKTtcblx0XHRcdFx0XHRcdHZhciByZXN1bHRCdWZmZXIgPSBuZXcgVWludDhBcnJheSgxICsgZGF0YS5ieXRlTGVuZ3RoKTtcblxuXHRcdFx0XHRcdFx0cmVzdWx0QnVmZmVyWzBdID0gcGFja2V0c1twYWNrZXQudHlwZV07XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNvbnRlbnRBcnJheS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHRCdWZmZXJbaSArIDFdID0gY29udGVudEFycmF5W2ldO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2socmVzdWx0QnVmZmVyLmJ1ZmZlcik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlQmxvYkFzQXJyYXlCdWZmZXIocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICghc3VwcG9ydHNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0KHBhY2tldCwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgZnIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXHRcdFx0XHRcdFx0ZnIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRwYWNrZXQuZGF0YSA9IGZyLnJlc3VsdDtcblx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGVQYWNrZXQocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgdHJ1ZSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdHJldHVybiBmci5yZWFkQXNBcnJheUJ1ZmZlcihwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlQmxvYihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0aWYgKCFzdXBwb3J0c0JpbmFyeSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQocGFja2V0LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChkb250U2VuZEJsb2JzKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbmNvZGVCbG9iQXNBcnJheUJ1ZmZlcihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBsZW5ndGggPSBuZXcgVWludDhBcnJheSgxKTtcblx0XHRcdFx0XHRcdGxlbmd0aFswXSA9IHBhY2tldHNbcGFja2V0LnR5cGVdO1xuXHRcdFx0XHRcdFx0dmFyIGJsb2IgPSBuZXcgQmxvYihbbGVuZ3RoLmJ1ZmZlciwgcGFja2V0LmRhdGFdKTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGJsb2IpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFbmNvZGVzIGEgcGFja2V0IHdpdGggYmluYXJ5IGRhdGEgaW4gYSBiYXNlNjQgc3RyaW5nXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXQsIGhhcyBgdHlwZWAgYW5kIGBkYXRhYFxuICAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IGJhc2U2NCBlbmNvZGVkIG1lc3NhZ2VcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmVuY29kZUJhc2U2NFBhY2tldCA9IGZ1bmN0aW9uIChwYWNrZXQsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHR2YXIgbWVzc2FnZSA9ICdiJyArIGV4cG9ydHMucGFja2V0c1twYWNrZXQudHlwZV07XG5cdFx0XHRcdFx0XHRpZiAoQmxvYiAmJiBwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIGdsb2JhbC5CbG9iKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBmciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRcdFx0XHRcdGZyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYjY0ID0gZnIucmVzdWx0LnNwbGl0KCcsJylbMV07XG5cdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sobWVzc2FnZSArIGI2NCk7XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmci5yZWFkQXNEYXRhVVJMKHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGI2NGRhdGE7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRiNjRkYXRhID0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBuZXcgVWludDhBcnJheShwYWNrZXQuZGF0YSkpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBpUGhvbmUgU2FmYXJpIGRvZXNuJ3QgbGV0IHlvdSBhcHBseSB3aXRoIHR5cGVkIGFycmF5c1xuXHRcdFx0XHRcdFx0XHR2YXIgdHlwZWQgPSBuZXcgVWludDhBcnJheShwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHZhciBiYXNpYyA9IG5ldyBBcnJheSh0eXBlZC5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHR5cGVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0YmFzaWNbaV0gPSB0eXBlZFtpXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRiNjRkYXRhID0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBiYXNpYyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRtZXNzYWdlICs9IGdsb2JhbC5idG9hKGI2NGRhdGEpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKG1lc3NhZ2UpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogRGVjb2RlcyBhIHBhY2tldC4gQ2hhbmdlcyBmb3JtYXQgdG8gQmxvYiBpZiByZXF1ZXN0ZWQuXG4gICAgICAqXG4gICAgICAqIEByZXR1cm4ge09iamVjdH0gd2l0aCBgdHlwZWAgYW5kIGBkYXRhYCAoaWYgYW55KVxuICAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29kZVBhY2tldCA9IGZ1bmN0aW9uIChkYXRhLCBiaW5hcnlUeXBlLCB1dGY4ZGVjb2RlKSB7XG5cdFx0XHRcdFx0XHQvLyBTdHJpbmcgZGF0YVxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnIHx8IGRhdGEgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZGF0YS5jaGFyQXQoMCkgPT0gJ2InKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZGVjb2RlQmFzZTY0UGFja2V0KGRhdGEuc3Vic3RyKDEpLCBiaW5hcnlUeXBlKTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmICh1dGY4ZGVjb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB1dGY4LmRlY29kZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGRhdGEuY2hhckF0KDApO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChOdW1iZXIodHlwZSkgIT0gdHlwZSB8fCAhcGFja2V0c2xpc3RbdHlwZV0pIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGRhdGEubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB7IHR5cGU6IHBhY2tldHNsaXN0W3R5cGVdLCBkYXRhOiBkYXRhLnN1YnN0cmluZygxKSB9O1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB7IHR5cGU6IHBhY2tldHNsaXN0W3R5cGVdIH07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGFzQXJyYXkgPSBuZXcgVWludDhBcnJheShkYXRhKTtcblx0XHRcdFx0XHRcdHZhciB0eXBlID0gYXNBcnJheVswXTtcblx0XHRcdFx0XHRcdHZhciByZXN0ID0gc2xpY2VCdWZmZXIoZGF0YSwgMSk7XG5cdFx0XHRcdFx0XHRpZiAoQmxvYiAmJiBiaW5hcnlUeXBlID09PSAnYmxvYicpIHtcblx0XHRcdFx0XHRcdFx0cmVzdCA9IG5ldyBCbG9iKFtyZXN0XSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4geyB0eXBlOiBwYWNrZXRzbGlzdFt0eXBlXSwgZGF0YTogcmVzdCB9O1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogRGVjb2RlcyBhIHBhY2tldCBlbmNvZGVkIGluIGEgYmFzZTY0IHN0cmluZ1xuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge1N0cmluZ30gYmFzZTY0IGVuY29kZWQgbWVzc2FnZVxuICAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggYHR5cGVgIGFuZCBgZGF0YWAgKGlmIGFueSlcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29kZUJhc2U2NFBhY2tldCA9IGZ1bmN0aW9uIChtc2csIGJpbmFyeVR5cGUpIHtcblx0XHRcdFx0XHRcdHZhciB0eXBlID0gcGFja2V0c2xpc3RbbXNnLmNoYXJBdCgwKV07XG5cdFx0XHRcdFx0XHRpZiAoIWdsb2JhbC5BcnJheUJ1ZmZlcikge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4geyB0eXBlOiB0eXBlLCBkYXRhOiB7IGJhc2U2NDogdHJ1ZSwgZGF0YTogbXNnLnN1YnN0cigxKSB9IH07XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gYmFzZTY0ZW5jb2Rlci5kZWNvZGUobXNnLnN1YnN0cigxKSk7XG5cblx0XHRcdFx0XHRcdGlmIChiaW5hcnlUeXBlID09PSAnYmxvYicgJiYgQmxvYikge1xuXHRcdFx0XHRcdFx0XHRkYXRhID0gbmV3IEJsb2IoW2RhdGFdKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIHsgdHlwZTogdHlwZSwgZGF0YTogZGF0YSB9O1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogRW5jb2RlcyBtdWx0aXBsZSBtZXNzYWdlcyAocGF5bG9hZCkuXG4gICAgICAqXG4gICAgICAqICAgICA8bGVuZ3RoPjpkYXRhXG4gICAgICAqXG4gICAgICAqIEV4YW1wbGU6XG4gICAgICAqXG4gICAgICAqICAgICAxMTpoZWxsbyB3b3JsZDI6aGlcbiAgICAgICpcbiAgICAgICogSWYgYW55IGNvbnRlbnRzIGFyZSBiaW5hcnksIHRoZXkgd2lsbCBiZSBlbmNvZGVkIGFzIGJhc2U2NCBzdHJpbmdzLiBCYXNlNjRcbiAgICAgICogZW5jb2RlZCBzdHJpbmdzIGFyZSBtYXJrZWQgd2l0aCBhIGIgYmVmb3JlIHRoZSBsZW5ndGggc3BlY2lmaWVyXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGVQYXlsb2FkID0gZnVuY3Rpb24gKHBhY2tldHMsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBzdXBwb3J0c0JpbmFyeSA9PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gc3VwcG9ydHNCaW5hcnk7XG5cdFx0XHRcdFx0XHRcdHN1cHBvcnRzQmluYXJ5ID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGlzQmluYXJ5ID0gaGFzQmluYXJ5KHBhY2tldHMpO1xuXG5cdFx0XHRcdFx0XHRpZiAoc3VwcG9ydHNCaW5hcnkgJiYgaXNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0aWYgKEJsb2IgJiYgIWRvbnRTZW5kQmxvYnMpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5lbmNvZGVQYXlsb2FkQXNCbG9iKHBhY2tldHMsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBleHBvcnRzLmVuY29kZVBheWxvYWRBc0FycmF5QnVmZmVyKHBhY2tldHMsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKCFwYWNrZXRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2soJzA6Jyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHNldExlbmd0aEhlYWRlcihtZXNzYWdlKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBtZXNzYWdlLmxlbmd0aCArICc6JyArIG1lc3NhZ2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZU9uZShwYWNrZXQsIGRvbmVDYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLmVuY29kZVBhY2tldChwYWNrZXQsICFpc0JpbmFyeSA/IGZhbHNlIDogc3VwcG9ydHNCaW5hcnksIHRydWUsIGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZG9uZUNhbGxiYWNrKG51bGwsIHNldExlbmd0aEhlYWRlcihtZXNzYWdlKSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRtYXAocGFja2V0cywgZW5jb2RlT25lLCBmdW5jdGlvbiAoZXJyLCByZXN1bHRzKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhyZXN1bHRzLmpvaW4oJycpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogQXN5bmMgYXJyYXkgbWFwIHVzaW5nIGFmdGVyXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gbWFwKGFyeSwgZWFjaCwgZG9uZSkge1xuXHRcdFx0XHRcdFx0dmFyIHJlc3VsdCA9IG5ldyBBcnJheShhcnkubGVuZ3RoKTtcblx0XHRcdFx0XHRcdHZhciBuZXh0ID0gYWZ0ZXIoYXJ5Lmxlbmd0aCwgZG9uZSk7XG5cblx0XHRcdFx0XHRcdHZhciBlYWNoV2l0aEluZGV4ID0gZnVuY3Rpb24gZWFjaFdpdGhJbmRleChpLCBlbCwgY2IpIHtcblx0XHRcdFx0XHRcdFx0ZWFjaChlbCwgZnVuY3Rpb24gKGVycm9yLCBtc2cpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXN1bHRbaV0gPSBtc2c7XG5cdFx0XHRcdFx0XHRcdFx0Y2IoZXJyb3IsIHJlc3VsdCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnkubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0ZWFjaFdpdGhJbmRleChpLCBhcnlbaV0sIG5leHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qXG4gICAgICAqIERlY29kZXMgZGF0YSB3aGVuIGEgcGF5bG9hZCBpcyBtYXliZSBleHBlY3RlZC4gUG9zc2libGUgYmluYXJ5IGNvbnRlbnRzIGFyZVxuICAgICAgKiBkZWNvZGVkIGZyb20gdGhlaXIgYmFzZTY0IHJlcHJlc2VudGF0aW9uXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLCBjYWxsYmFjayBtZXRob2RcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29kZVBheWxvYWQgPSBmdW5jdGlvbiAoZGF0YSwgYmluYXJ5VHlwZSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgZGF0YSAhPSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5kZWNvZGVQYXlsb2FkQXNCaW5hcnkoZGF0YSwgYmluYXJ5VHlwZSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAodHlwZW9mIGJpbmFyeVR5cGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSBiaW5hcnlUeXBlO1xuXHRcdFx0XHRcdFx0XHRiaW5hcnlUeXBlID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHBhY2tldDtcblx0XHRcdFx0XHRcdGlmIChkYXRhID09ICcnKSB7XG5cdFx0XHRcdFx0XHRcdC8vIHBhcnNlciBlcnJvciAtIGlnbm9yaW5nIHBheWxvYWRcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBsZW5ndGggPSAnJyxcblx0XHRcdFx0XHRcdCAgICBuLFxuXHRcdFx0XHRcdFx0ICAgIG1zZztcblxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBkYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR2YXIgY2hyID0gZGF0YS5jaGFyQXQoaSk7XG5cblx0XHRcdFx0XHRcdFx0aWYgKCc6JyAhPSBjaHIpIHtcblx0XHRcdFx0XHRcdFx0XHRsZW5ndGggKz0gY2hyO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGlmICgnJyA9PSBsZW5ndGggfHwgbGVuZ3RoICE9IChuID0gTnVtYmVyKGxlbmd0aCkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBwYXJzZXIgZXJyb3IgLSBpZ25vcmluZyBwYXlsb2FkXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2soZXJyLCAwLCAxKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRtc2cgPSBkYXRhLnN1YnN0cihpICsgMSwgbik7XG5cblx0XHRcdFx0XHRcdFx0XHRpZiAobGVuZ3RoICE9IG1zZy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHBhcnNlciBlcnJvciAtIGlnbm9yaW5nIHBheWxvYWRcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdGlmIChtc2cubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRwYWNrZXQgPSBleHBvcnRzLmRlY29kZVBhY2tldChtc2csIGJpbmFyeVR5cGUsIHRydWUpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoZXJyLnR5cGUgPT0gcGFja2V0LnR5cGUgJiYgZXJyLmRhdGEgPT0gcGFja2V0LmRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gcGFyc2VyIGVycm9yIGluIGluZGl2aWR1YWwgcGFja2V0IC0gaWdub3JpbmcgcGF5bG9hZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2soZXJyLCAwLCAxKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHJldCA9IGNhbGxiYWNrKHBhY2tldCwgaSArIG4sIGwpO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGZhbHNlID09PSByZXQpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBhZHZhbmNlIGN1cnNvclxuXHRcdFx0XHRcdFx0XHRcdGkgKz0gbjtcblx0XHRcdFx0XHRcdFx0XHRsZW5ndGggPSAnJztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAobGVuZ3RoICE9ICcnKSB7XG5cdFx0XHRcdFx0XHRcdC8vIHBhcnNlciBlcnJvciAtIGlnbm9yaW5nIHBheWxvYWRcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFbmNvZGVzIG11bHRpcGxlIG1lc3NhZ2VzIChwYXlsb2FkKSBhcyBiaW5hcnkuXG4gICAgICAqXG4gICAgICAqIDwxID0gYmluYXJ5LCAwID0gc3RyaW5nPjxudW1iZXIgZnJvbSAwLTk+PG51bWJlciBmcm9tIDAtOT5bLi4uXTxudW1iZXJcbiAgICAgICogMjU1PjxkYXRhPlxuICAgICAgKlxuICAgICAgKiBFeGFtcGxlOlxuICAgICAgKiAxIDMgMjU1IDEgMiAzLCBpZiB0aGUgYmluYXJ5IGNvbnRlbnRzIGFyZSBpbnRlcnByZXRlZCBhcyA4IGJpdCBpbnRlZ2Vyc1xuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge0FycmF5fSBwYWNrZXRzXG4gICAgICAqIEByZXR1cm4ge0FycmF5QnVmZmVyfSBlbmNvZGVkIHBheWxvYWRcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGVQYXlsb2FkQXNBcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIChwYWNrZXRzLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0aWYgKCFwYWNrZXRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2sobmV3IEFycmF5QnVmZmVyKDApKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlT25lKHBhY2tldCwgZG9uZUNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgdHJ1ZSwgdHJ1ZSwgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZG9uZUNhbGxiYWNrKG51bGwsIGRhdGEpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0bWFwKHBhY2tldHMsIGVuY29kZU9uZSwgZnVuY3Rpb24gKGVyciwgZW5jb2RlZFBhY2tldHMpIHtcblx0XHRcdFx0XHRcdFx0dmFyIHRvdGFsTGVuZ3RoID0gZW5jb2RlZFBhY2tldHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHApIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgbGVuO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgcCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxlbiA9IHAubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZW4gPSBwLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBhY2MgKyBsZW4udG9TdHJpbmcoKS5sZW5ndGggKyBsZW4gKyAyOyAvLyBzdHJpbmcvYmluYXJ5IGlkZW50aWZpZXIgKyBzZXBhcmF0b3IgPSAyXG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXG5cdFx0XHRcdFx0XHRcdHZhciByZXN1bHRBcnJheSA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgYnVmZmVySW5kZXggPSAwO1xuXHRcdFx0XHRcdFx0XHRlbmNvZGVkUGFja2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGlzU3RyaW5nID0gdHlwZW9mIHAgPT09ICdzdHJpbmcnO1xuXHRcdFx0XHRcdFx0XHRcdHZhciBhYiA9IHA7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzU3RyaW5nKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KHAubGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3W2ldID0gcC5jaGFyQ29kZUF0KGkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0YWIgPSB2aWV3LmJ1ZmZlcjtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRpZiAoaXNTdHJpbmcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIG5vdCB0cnVlIGJpbmFyeVxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSAwO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyB0cnVlIGJpbmFyeVxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSAxO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdHZhciBsZW5TdHIgPSBhYi5ieXRlTGVuZ3RoLnRvU3RyaW5nKCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5TdHIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdEFycmF5W2J1ZmZlckluZGV4KytdID0gcGFyc2VJbnQobGVuU3RyW2ldKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSAyNTU7XG5cblx0XHRcdFx0XHRcdFx0XHR2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGFiKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHZpZXcubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdEFycmF5W2J1ZmZlckluZGV4KytdID0gdmlld1tpXTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhyZXN1bHRBcnJheS5idWZmZXIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBFbmNvZGUgYXMgQmxvYlxuICAgICAgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQmxvYiA9IGZ1bmN0aW9uIChwYWNrZXRzLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlT25lKHBhY2tldCwgZG9uZUNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgdHJ1ZSwgdHJ1ZSwgZnVuY3Rpb24gKGVuY29kZWQpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYmluYXJ5SWRlbnRpZmllciA9IG5ldyBVaW50OEFycmF5KDEpO1xuXHRcdFx0XHRcdFx0XHRcdGJpbmFyeUlkZW50aWZpZXJbMF0gPSAxO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgZW5jb2RlZCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoZW5jb2RlZC5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbmNvZGVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdbaV0gPSBlbmNvZGVkLmNoYXJDb2RlQXQoaSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRlbmNvZGVkID0gdmlldy5idWZmZXI7XG5cdFx0XHRcdFx0XHRcdFx0XHRiaW5hcnlJZGVudGlmaWVyWzBdID0gMDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHR2YXIgbGVuID0gZW5jb2RlZCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyID8gZW5jb2RlZC5ieXRlTGVuZ3RoIDogZW5jb2RlZC5zaXplO1xuXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGxlblN0ciA9IGxlbi50b1N0cmluZygpO1xuXHRcdFx0XHRcdFx0XHRcdHZhciBsZW5ndGhBcnkgPSBuZXcgVWludDhBcnJheShsZW5TdHIubGVuZ3RoICsgMSk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5TdHIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxlbmd0aEFyeVtpXSA9IHBhcnNlSW50KGxlblN0cltpXSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGxlbmd0aEFyeVtsZW5TdHIubGVuZ3RoXSA9IDI1NTtcblxuXHRcdFx0XHRcdFx0XHRcdGlmIChCbG9iKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtiaW5hcnlJZGVudGlmaWVyLmJ1ZmZlciwgbGVuZ3RoQXJ5LmJ1ZmZlciwgZW5jb2RlZF0pO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZG9uZUNhbGxiYWNrKG51bGwsIGJsb2IpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdG1hcChwYWNrZXRzLCBlbmNvZGVPbmUsIGZ1bmN0aW9uIChlcnIsIHJlc3VsdHMpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBCbG9iKHJlc3VsdHMpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKlxuICAgICAgKiBEZWNvZGVzIGRhdGEgd2hlbiBhIHBheWxvYWQgaXMgbWF5YmUgZXhwZWN0ZWQuIFN0cmluZ3MgYXJlIGRlY29kZWQgYnlcbiAgICAgICogaW50ZXJwcmV0aW5nIGVhY2ggYnl0ZSBhcyBhIGtleSBjb2RlIGZvciBlbnRyaWVzIG1hcmtlZCB0byBzdGFydCB3aXRoIDAuIFNlZVxuICAgICAgKiBkZXNjcmlwdGlvbiBvZiBlbmNvZGVQYXlsb2FkQXNCaW5hcnlcbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gZGF0YSwgY2FsbGJhY2sgbWV0aG9kXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5kZWNvZGVQYXlsb2FkQXNCaW5hcnkgPSBmdW5jdGlvbiAoZGF0YSwgYmluYXJ5VHlwZSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgYmluYXJ5VHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IGJpbmFyeVR5cGU7XG5cdFx0XHRcdFx0XHRcdGJpbmFyeVR5cGUgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVyVGFpbCA9IGRhdGE7XG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVycyA9IFtdO1xuXG5cdFx0XHRcdFx0XHR2YXIgbnVtYmVyVG9vTG9uZyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0d2hpbGUgKGJ1ZmZlclRhaWwuYnl0ZUxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0dmFyIHRhaWxBcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlclRhaWwpO1xuXHRcdFx0XHRcdFx0XHR2YXIgaXNTdHJpbmcgPSB0YWlsQXJyYXlbMF0gPT09IDA7XG5cdFx0XHRcdFx0XHRcdHZhciBtc2dMZW5ndGggPSAnJztcblxuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMTs7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0YWlsQXJyYXlbaV0gPT0gMjU1KSBicmVhaztcblxuXHRcdFx0XHRcdFx0XHRcdGlmIChtc2dMZW5ndGgubGVuZ3RoID4gMzEwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRudW1iZXJUb29Mb25nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdG1zZ0xlbmd0aCArPSB0YWlsQXJyYXlbaV07XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAobnVtYmVyVG9vTG9uZykgcmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG5cblx0XHRcdFx0XHRcdFx0YnVmZmVyVGFpbCA9IHNsaWNlQnVmZmVyKGJ1ZmZlclRhaWwsIDIgKyBtc2dMZW5ndGgubGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0bXNnTGVuZ3RoID0gcGFyc2VJbnQobXNnTGVuZ3RoKTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgbXNnID0gc2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwgMCwgbXNnTGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0aWYgKGlzU3RyaW5nKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdG1zZyA9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkobXNnKSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gaVBob25lIFNhZmFyaSBkb2Vzbid0IGxldCB5b3UgYXBwbHkgdG8gdHlwZWQgYXJyYXlzXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdHlwZWQgPSBuZXcgVWludDhBcnJheShtc2cpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bXNnID0gJyc7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHR5cGVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG1zZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHR5cGVkW2ldKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRidWZmZXJzLnB1c2gobXNnKTtcblx0XHRcdFx0XHRcdFx0YnVmZmVyVGFpbCA9IHNsaWNlQnVmZmVyKGJ1ZmZlclRhaWwsIG1zZ0xlbmd0aCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciB0b3RhbCA9IGJ1ZmZlcnMubGVuZ3RoO1xuXHRcdFx0XHRcdFx0YnVmZmVycy5mb3JFYWNoKGZ1bmN0aW9uIChidWZmZXIsIGkpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2soZXhwb3J0cy5kZWNvZGVQYWNrZXQoYnVmZmVyLCBiaW5hcnlUeXBlLCB0cnVlKSwgaSwgdG90YWwpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHsgXCIuL2tleXNcIjogMjAsIFwiYWZ0ZXJcIjogMTEsIFwiYXJyYXlidWZmZXIuc2xpY2VcIjogMTIsIFwiYmFzZTY0LWFycmF5YnVmZmVyXCI6IDEzLCBcImJsb2JcIjogMTQsIFwiaGFzLWJpbmFyeVwiOiAyMSwgXCJ1dGY4XCI6IDI5IH1dLCAyMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBHZXRzIHRoZSBrZXlzIGZvciBhbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0ga2V5c1xuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhvYmopIHtcblx0XHRcdFx0XHR2YXIgYXJyID0gW107XG5cdFx0XHRcdFx0dmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cblx0XHRcdFx0XHRmb3IgKHZhciBpIGluIG9iaikge1xuXHRcdFx0XHRcdFx0aWYgKGhhcy5jYWxsKG9iaiwgaSkpIHtcblx0XHRcdFx0XHRcdFx0YXJyLnB1c2goaSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBhcnI7XG5cdFx0XHRcdH07XG5cdFx0XHR9LCB7fV0sIDIxOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0LypcbiAgICAgICogTW9kdWxlIHJlcXVpcmVtZW50cy5cbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgaXNBcnJheSA9IF9kZXJlcV8oJ2lzYXJyYXknKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgZXhwb3J0cy5cbiAgICAgICovXG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGhhc0JpbmFyeTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVja3MgZm9yIGJpbmFyeSBkYXRhLlxuICAgICAgKlxuICAgICAgKiBSaWdodCBub3cgb25seSBCdWZmZXIgYW5kIEFycmF5QnVmZmVyIGFyZSBzdXBwb3J0ZWQuLlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge09iamVjdH0gYW55dGhpbmdcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBoYXNCaW5hcnkoZGF0YSkge1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuXHRcdFx0XHRcdFx0XHRpZiAoIW9iaikgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChnbG9iYWwuQnVmZmVyICYmIGdsb2JhbC5CdWZmZXIuaXNCdWZmZXIob2JqKSB8fCBnbG9iYWwuQXJyYXlCdWZmZXIgJiYgb2JqIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgZ2xvYmFsLkJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYiB8fCBnbG9iYWwuRmlsZSAmJiBvYmogaW5zdGFuY2VvZiBGaWxlKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAoaXNBcnJheShvYmopKSB7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChfaGFzQmluYXJ5KG9ialtpXSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG9iaiAmJiAnb2JqZWN0JyA9PSB0eXBlb2Ygb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9iai50b0pTT04pIHtcblx0XHRcdFx0XHRcdFx0XHRcdG9iaiA9IG9iai50b0pTT04oKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSAmJiBfaGFzQmluYXJ5KG9ialtrZXldKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBfaGFzQmluYXJ5KGRhdGEpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHsgXCJpc2FycmF5XCI6IDI0IH1dLCAyMjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBNb2R1bGUgZXhwb3J0cy5cbiAgICAgKlxuICAgICAqIExvZ2ljIGJvcnJvd2VkIGZyb20gTW9kZXJuaXpyOlxuICAgICAqXG4gICAgICogICAtIGh0dHBzOi8vZ2l0aHViLmNvbS9Nb2Rlcm5penIvTW9kZXJuaXpyL2Jsb2IvbWFzdGVyL2ZlYXR1cmUtZGV0ZWN0cy9jb3JzLmpzXG4gICAgICovXG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcgJiYgJ3dpdGhDcmVkZW50aWFscycgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0XHRcdC8vIGlmIFhNTEh0dHAgc3VwcG9ydCBpcyBkaXNhYmxlZCBpbiBJRSB0aGVuIGl0IHdpbGwgdGhyb3dcblx0XHRcdFx0XHQvLyB3aGVuIHRyeWluZyB0byBjcmVhdGVcblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCB7fV0sIDIzOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdHZhciBpbmRleE9mID0gW10uaW5kZXhPZjtcblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcnIsIG9iaikge1xuXHRcdFx0XHRcdGlmIChpbmRleE9mKSByZXR1cm4gYXJyLmluZGV4T2Yob2JqKTtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7ICsraSkge1xuXHRcdFx0XHRcdFx0aWYgKGFycltpXSA9PT0gb2JqKSByZXR1cm4gaTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIC0xO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwge31dLCAyNDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChhcnIpIHtcblx0XHRcdFx0XHRyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSwgMjU6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIEhlbHBlcnMuXG4gICAgICovXG5cblx0XHRcdFx0dmFyIHMgPSAxMDAwO1xuXHRcdFx0XHR2YXIgbSA9IHMgKiA2MDtcblx0XHRcdFx0dmFyIGggPSBtICogNjA7XG5cdFx0XHRcdHZhciBkID0gaCAqIDI0O1xuXHRcdFx0XHR2YXIgeSA9IGQgKiAzNjUuMjU7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGFyc2Ugb3IgZm9ybWF0IHRoZSBnaXZlbiBgdmFsYC5cbiAgICAgKlxuICAgICAqIE9wdGlvbnM6XG4gICAgICpcbiAgICAgKiAgLSBgbG9uZ2AgdmVyYm9zZSBmb3JtYXR0aW5nIFtmYWxzZV1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfE51bWJlcn0gdmFsXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd8TnVtYmVyfVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodmFsLCBvcHRpb25zKSB7XG5cdFx0XHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0XHRcdFx0aWYgKCdzdHJpbmcnID09IHR5cGVvZiB2YWwpIHJldHVybiBwYXJzZSh2YWwpO1xuXHRcdFx0XHRcdHJldHVybiBvcHRpb25zLmxvbmcgPyBsb25nKHZhbCkgOiBzaG9ydCh2YWwpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFBhcnNlIHRoZSBnaXZlbiBgc3RyYCBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gcGFyc2Uoc3RyKSB7XG5cdFx0XHRcdFx0c3RyID0gJycgKyBzdHI7XG5cdFx0XHRcdFx0aWYgKHN0ci5sZW5ndGggPiAxMDAwMCkgcmV0dXJuO1xuXHRcdFx0XHRcdHZhciBtYXRjaCA9IC9eKCg/OlxcZCspP1xcLj9cXGQrKSAqKG1pbGxpc2Vjb25kcz98bXNlY3M/fG1zfHNlY29uZHM/fHNlY3M/fHN8bWludXRlcz98bWlucz98bXxob3Vycz98aHJzP3xofGRheXM/fGR8eWVhcnM/fHlycz98eSk/JC9pLmV4ZWMoc3RyKTtcblx0XHRcdFx0XHRpZiAoIW1hdGNoKSByZXR1cm47XG5cdFx0XHRcdFx0dmFyIG4gPSBwYXJzZUZsb2F0KG1hdGNoWzFdKTtcblx0XHRcdFx0XHR2YXIgdHlwZSA9IChtYXRjaFsyXSB8fCAnbXMnKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdHN3aXRjaCAodHlwZSkge1xuXHRcdFx0XHRcdFx0Y2FzZSAneWVhcnMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAneWVhcic6XG5cdFx0XHRcdFx0XHRjYXNlICd5cnMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAneXInOlxuXHRcdFx0XHRcdFx0Y2FzZSAneSc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuICogeTtcblx0XHRcdFx0XHRcdGNhc2UgJ2RheXMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnZGF5Jzpcblx0XHRcdFx0XHRcdGNhc2UgJ2QnOlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbiAqIGQ7XG5cdFx0XHRcdFx0XHRjYXNlICdob3Vycyc6XG5cdFx0XHRcdFx0XHRjYXNlICdob3VyJzpcblx0XHRcdFx0XHRcdGNhc2UgJ2hycyc6XG5cdFx0XHRcdFx0XHRjYXNlICdocic6XG5cdFx0XHRcdFx0XHRjYXNlICdoJzpcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG4gKiBoO1xuXHRcdFx0XHRcdFx0Y2FzZSAnbWludXRlcyc6XG5cdFx0XHRcdFx0XHRjYXNlICdtaW51dGUnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnbWlucyc6XG5cdFx0XHRcdFx0XHRjYXNlICdtaW4nOlxuXHRcdFx0XHRcdFx0Y2FzZSAnbSc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuICogbTtcblx0XHRcdFx0XHRcdGNhc2UgJ3NlY29uZHMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnc2Vjb25kJzpcblx0XHRcdFx0XHRcdGNhc2UgJ3NlY3MnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnc2VjJzpcblx0XHRcdFx0XHRcdGNhc2UgJ3MnOlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbiAqIHM7XG5cdFx0XHRcdFx0XHRjYXNlICdtaWxsaXNlY29uZHMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnbWlsbGlzZWNvbmQnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnbXNlY3MnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnbXNlYyc6XG5cdFx0XHRcdFx0XHRjYXNlICdtcyc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIFNob3J0IGZvcm1hdCBmb3IgYG1zYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBzaG9ydChtcykge1xuXHRcdFx0XHRcdGlmIChtcyA+PSBkKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIGQpICsgJ2QnO1xuXHRcdFx0XHRcdGlmIChtcyA+PSBoKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIGgpICsgJ2gnO1xuXHRcdFx0XHRcdGlmIChtcyA+PSBtKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIG0pICsgJ20nO1xuXHRcdFx0XHRcdGlmIChtcyA+PSBzKSByZXR1cm4gTWF0aC5yb3VuZChtcyAvIHMpICsgJ3MnO1xuXHRcdFx0XHRcdHJldHVybiBtcyArICdtcyc7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBMb25nIGZvcm1hdCBmb3IgYG1zYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBtc1xuICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBsb25nKG1zKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHBsdXJhbChtcywgZCwgJ2RheScpIHx8IHBsdXJhbChtcywgaCwgJ2hvdXInKSB8fCBwbHVyYWwobXMsIG0sICdtaW51dGUnKSB8fCBwbHVyYWwobXMsIHMsICdzZWNvbmQnKSB8fCBtcyArICcgbXMnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGx1cmFsaXphdGlvbiBoZWxwZXIuXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gcGx1cmFsKG1zLCBuLCBuYW1lKSB7XG5cdFx0XHRcdFx0aWYgKG1zIDwgbikgcmV0dXJuO1xuXHRcdFx0XHRcdGlmIChtcyA8IG4gKiAxLjUpIHJldHVybiBNYXRoLmZsb29yKG1zIC8gbikgKyAnICcgKyBuYW1lO1xuXHRcdFx0XHRcdHJldHVybiBNYXRoLmNlaWwobXMgLyBuKSArICcgJyArIG5hbWUgKyAncyc7XG5cdFx0XHRcdH1cblx0XHRcdH0sIHt9XSwgMjY6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEpTT04gcGFyc2UuXG4gICAgICAqXG4gICAgICAqIEBzZWUgQmFzZWQgb24galF1ZXJ5I3BhcnNlSlNPTiAoTUlUKSBhbmQgSlNPTjJcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIHJ2YWxpZGNoYXJzID0gL15bXFxdLDp7fVxcc10qJC87XG5cdFx0XHRcdFx0dmFyIHJ2YWxpZGVzY2FwZSA9IC9cXFxcKD86W1wiXFxcXFxcL2JmbnJ0XXx1WzAtOWEtZkEtRl17NH0pL2c7XG5cdFx0XHRcdFx0dmFyIHJ2YWxpZHRva2VucyA9IC9cIlteXCJcXFxcXFxuXFxyXSpcInx0cnVlfGZhbHNlfG51bGx8LT9cXGQrKD86XFwuXFxkKik/KD86W2VFXVsrXFwtXT9cXGQrKT8vZztcblx0XHRcdFx0XHR2YXIgcnZhbGlkYnJhY2VzID0gLyg/Ol58OnwsKSg/OlxccypcXFspKy9nO1xuXHRcdFx0XHRcdHZhciBydHJpbUxlZnQgPSAvXlxccysvO1xuXHRcdFx0XHRcdHZhciBydHJpbVJpZ2h0ID0gL1xccyskLztcblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcGFyc2Vqc29uKGRhdGEpIHtcblx0XHRcdFx0XHRcdGlmICgnc3RyaW5nJyAhPSB0eXBlb2YgZGF0YSB8fCAhZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZGF0YSA9IGRhdGEucmVwbGFjZShydHJpbUxlZnQsICcnKS5yZXBsYWNlKHJ0cmltUmlnaHQsICcnKTtcblxuXHRcdFx0XHRcdFx0Ly8gQXR0ZW1wdCB0byBwYXJzZSB1c2luZyB0aGUgbmF0aXZlIEpTT04gcGFyc2VyIGZpcnN0XG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLkpTT04gJiYgSlNPTi5wYXJzZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHJ2YWxpZGNoYXJzLnRlc3QoZGF0YS5yZXBsYWNlKHJ2YWxpZGVzY2FwZSwgJ0AnKS5yZXBsYWNlKHJ2YWxpZHRva2VucywgJ10nKS5yZXBsYWNlKHJ2YWxpZGJyYWNlcywgJycpKSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gJyArIGRhdGEpKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHt9XSwgMjc6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIENvbXBpbGVzIGEgcXVlcnlzdHJpbmdcbiAgICAgKiBSZXR1cm5zIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH1cbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLmVuY29kZSA9IGZ1bmN0aW9uIChvYmopIHtcblx0XHRcdFx0XHR2YXIgc3RyID0gJyc7XG5cblx0XHRcdFx0XHRmb3IgKHZhciBpIGluIG9iaikge1xuXHRcdFx0XHRcdFx0aWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc3RyLmxlbmd0aCkgc3RyICs9ICcmJztcblx0XHRcdFx0XHRcdFx0c3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChpKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChvYmpbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBzdHI7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGFyc2VzIGEgc2ltcGxlIHF1ZXJ5c3RyaW5nIGludG8gYW4gb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcXNcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLmRlY29kZSA9IGZ1bmN0aW9uIChxcykge1xuXHRcdFx0XHRcdHZhciBxcnkgPSB7fTtcblx0XHRcdFx0XHR2YXIgcGFpcnMgPSBxcy5zcGxpdCgnJicpO1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsID0gcGFpcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdFx0XHRcdFx0XHR2YXIgcGFpciA9IHBhaXJzW2ldLnNwbGl0KCc9Jyk7XG5cdFx0XHRcdFx0XHRxcnlbZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHFyeTtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSwgMjg6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qKlxuICAgICAqIFBhcnNlcyBhbiBVUklcbiAgICAgKlxuICAgICAqIEBhdXRob3IgU3RldmVuIExldml0aGFuIDxzdGV2ZW5sZXZpdGhhbi5jb20+IChNSVQgbGljZW5zZSlcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgcmUgPSAvXig/Oig/IVteOkBdKzpbXjpAXFwvXSpAKShodHRwfGh0dHBzfHdzfHdzcyk6XFwvXFwvKT8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcblxuXHRcdFx0XHR2YXIgcGFydHMgPSBbJ3NvdXJjZScsICdwcm90b2NvbCcsICdhdXRob3JpdHknLCAndXNlckluZm8nLCAndXNlcicsICdwYXNzd29yZCcsICdob3N0JywgJ3BvcnQnLCAncmVsYXRpdmUnLCAncGF0aCcsICdkaXJlY3RvcnknLCAnZmlsZScsICdxdWVyeScsICdhbmNob3InXTtcblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhcnNldXJpKHN0cikge1xuXHRcdFx0XHRcdHZhciBzcmMgPSBzdHIsXG5cdFx0XHRcdFx0ICAgIGIgPSBzdHIuaW5kZXhPZignWycpLFxuXHRcdFx0XHRcdCAgICBlID0gc3RyLmluZGV4T2YoJ10nKTtcblxuXHRcdFx0XHRcdGlmIChiICE9IC0xICYmIGUgIT0gLTEpIHtcblx0XHRcdFx0XHRcdHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgYikgKyBzdHIuc3Vic3RyaW5nKGIsIGUpLnJlcGxhY2UoLzovZywgJzsnKSArIHN0ci5zdWJzdHJpbmcoZSwgc3RyLmxlbmd0aCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIG0gPSByZS5leGVjKHN0ciB8fCAnJyksXG5cdFx0XHRcdFx0ICAgIHVyaSA9IHt9LFxuXHRcdFx0XHRcdCAgICBpID0gMTQ7XG5cblx0XHRcdFx0XHR3aGlsZSAoaS0tKSB7XG5cdFx0XHRcdFx0XHR1cmlbcGFydHNbaV1dID0gbVtpXSB8fCAnJztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoYiAhPSAtMSAmJiBlICE9IC0xKSB7XG5cdFx0XHRcdFx0XHR1cmkuc291cmNlID0gc3JjO1xuXHRcdFx0XHRcdFx0dXJpLmhvc3QgPSB1cmkuaG9zdC5zdWJzdHJpbmcoMSwgdXJpLmhvc3QubGVuZ3RoIC0gMSkucmVwbGFjZSgvOy9nLCAnOicpO1xuXHRcdFx0XHRcdFx0dXJpLmF1dGhvcml0eSA9IHVyaS5hdXRob3JpdHkucmVwbGFjZSgnWycsICcnKS5yZXBsYWNlKCddJywgJycpLnJlcGxhY2UoLzsvZywgJzonKTtcblx0XHRcdFx0XHRcdHVyaS5pcHY2dXJpID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gdXJpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwge31dLCAyOTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcblx0XHRcdFx0XHQvKiEgaHR0cHM6Ly9tdGhzLmJlL3V0ZjhqcyB2Mi4wLjAgYnkgQG1hdGhpYXMgKi9cblx0XHRcdFx0XHQ7KGZ1bmN0aW9uIChyb290KSB7XG5cblx0XHRcdFx0XHRcdC8vIERldGVjdCBmcmVlIHZhcmlhYmxlcyBgZXhwb3J0c2Bcblx0XHRcdFx0XHRcdHZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHM7XG5cblx0XHRcdFx0XHRcdC8vIERldGVjdCBmcmVlIHZhcmlhYmxlIGBtb2R1bGVgXG5cdFx0XHRcdFx0XHR2YXIgZnJlZU1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzICYmIG1vZHVsZTtcblxuXHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGdsb2JhbGAsIGZyb20gTm9kZS5qcyBvciBCcm93c2VyaWZpZWQgY29kZSxcblx0XHRcdFx0XHRcdC8vIGFuZCB1c2UgaXQgYXMgYHJvb3RgXG5cdFx0XHRcdFx0XHR2YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsO1xuXHRcdFx0XHRcdFx0aWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsKSB7XG5cdFx0XHRcdFx0XHRcdHJvb3QgPSBmcmVlR2xvYmFsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdFx0XHRcdFx0dmFyIHN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGU7XG5cblx0XHRcdFx0XHRcdC8vIFRha2VuIGZyb20gaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiB1Y3MyZGVjb2RlKHN0cmluZykge1xuXHRcdFx0XHRcdFx0XHR2YXIgb3V0cHV0ID0gW107XG5cdFx0XHRcdFx0XHRcdHZhciBjb3VudGVyID0gMDtcblx0XHRcdFx0XHRcdFx0dmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG5cdFx0XHRcdFx0XHRcdHZhciB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dmFyIGV4dHJhO1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXJcblx0XHRcdFx0XHRcdFx0XHRcdGV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBsb3cgc3Vycm9nYXRlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB1bm1hdGNoZWQgc3Vycm9nYXRlOyBvbmx5IGFwcGVuZCB0aGlzIGNvZGUgdW5pdCwgaW4gY2FzZSB0aGUgbmV4dFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXJcblx0XHRcdFx0XHRcdFx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb3VudGVyLS07XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIG91dHB1dDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gVGFrZW4gZnJvbSBodHRwczovL210aHMuYmUvcHVueWNvZGVcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHVjczJlbmNvZGUoYXJyYXkpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHRcdFx0XHRcdHZhciB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0dmFyIG91dHB1dCA9ICcnO1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA+IDB4RkZGRikge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgLT0gMHgxMDAwMDtcblx0XHRcdFx0XHRcdFx0XHRcdG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApO1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSAweERDMDAgfCB2YWx1ZSAmIDB4M0ZGO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gb3V0cHV0O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBjaGVja1NjYWxhclZhbHVlKGNvZGVQb2ludCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoY29kZVBvaW50ID49IDB4RDgwMCAmJiBjb2RlUG9pbnQgPD0gMHhERkZGKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0xvbmUgc3Vycm9nYXRlIFUrJyArIGNvZGVQb2ludC50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSArICcgaXMgbm90IGEgc2NhbGFyIHZhbHVlJyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBjcmVhdGVCeXRlKGNvZGVQb2ludCwgc2hpZnQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQgPj4gc2hpZnQgJiAweDNGIHwgMHg4MCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUNvZGVQb2ludChjb2RlUG9pbnQpIHtcblx0XHRcdFx0XHRcdFx0aWYgKChjb2RlUG9pbnQgJiAweEZGRkZGRjgwKSA9PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gMS1ieXRlIHNlcXVlbmNlXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHZhciBzeW1ib2wgPSAnJztcblx0XHRcdFx0XHRcdFx0aWYgKChjb2RlUG9pbnQgJiAweEZGRkZGODAwKSA9PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gMi1ieXRlIHNlcXVlbmNlXG5cdFx0XHRcdFx0XHRcdFx0c3ltYm9sID0gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCA+PiA2ICYgMHgxRiB8IDB4QzApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKChjb2RlUG9pbnQgJiAweEZGRkYwMDAwKSA9PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gMy1ieXRlIHNlcXVlbmNlXG5cdFx0XHRcdFx0XHRcdFx0Y2hlY2tTY2FsYXJWYWx1ZShjb2RlUG9pbnQpO1xuXHRcdFx0XHRcdFx0XHRcdHN5bWJvbCA9IHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQgPj4gMTIgJiAweDBGIHwgMHhFMCk7XG5cdFx0XHRcdFx0XHRcdFx0c3ltYm9sICs9IGNyZWF0ZUJ5dGUoY29kZVBvaW50LCA2KTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICgoY29kZVBvaW50ICYgMHhGRkUwMDAwMCkgPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIDQtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRcdHN5bWJvbCA9IHN0cmluZ0Zyb21DaGFyQ29kZShjb2RlUG9pbnQgPj4gMTggJiAweDA3IHwgMHhGMCk7XG5cdFx0XHRcdFx0XHRcdFx0c3ltYm9sICs9IGNyZWF0ZUJ5dGUoY29kZVBvaW50LCAxMik7XG5cdFx0XHRcdFx0XHRcdFx0c3ltYm9sICs9IGNyZWF0ZUJ5dGUoY29kZVBvaW50LCA2KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRzeW1ib2wgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKGNvZGVQb2ludCAmIDB4M0YgfCAweDgwKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHN5bWJvbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gdXRmOGVuY29kZShzdHJpbmcpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludHMgPSB1Y3MyZGVjb2RlKHN0cmluZyk7XG5cdFx0XHRcdFx0XHRcdHZhciBsZW5ndGggPSBjb2RlUG9pbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHRcdFx0XHRcdHZhciBjb2RlUG9pbnQ7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlU3RyaW5nID0gJyc7XG5cdFx0XHRcdFx0XHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50ID0gY29kZVBvaW50c1tpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZVN0cmluZyArPSBlbmNvZGVDb2RlUG9pbnQoY29kZVBvaW50KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYnl0ZVN0cmluZztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHJlYWRDb250aW51YXRpb25CeXRlKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoYnl0ZUluZGV4ID49IGJ5dGVDb3VudCkge1xuXHRcdFx0XHRcdFx0XHRcdHRocm93IEVycm9yKCdJbnZhbGlkIGJ5dGUgaW5kZXgnKTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHZhciBjb250aW51YXRpb25CeXRlID0gYnl0ZUFycmF5W2J5dGVJbmRleF0gJiAweEZGO1xuXHRcdFx0XHRcdFx0XHRieXRlSW5kZXgrKztcblxuXHRcdFx0XHRcdFx0XHRpZiAoKGNvbnRpbnVhdGlvbkJ5dGUgJiAweEMwKSA9PSAweDgwKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbnRpbnVhdGlvbkJ5dGUgJiAweDNGO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gSWYgd2UgZW5kIHVwIGhlcmUsIGl04oCZcyBub3QgYSBjb250aW51YXRpb24gYnl0ZVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBjb250aW51YXRpb24gYnl0ZScpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBkZWNvZGVTeW1ib2woKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlMTtcblx0XHRcdFx0XHRcdFx0dmFyIGJ5dGUyO1xuXHRcdFx0XHRcdFx0XHR2YXIgYnl0ZTM7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlNDtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludDtcblxuXHRcdFx0XHRcdFx0XHRpZiAoYnl0ZUluZGV4ID4gYnl0ZUNvdW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgYnl0ZSBpbmRleCcpO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGJ5dGVJbmRleCA9PSBieXRlQ291bnQpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyBSZWFkIGZpcnN0IGJ5dGVcblx0XHRcdFx0XHRcdFx0Ynl0ZTEgPSBieXRlQXJyYXlbYnl0ZUluZGV4XSAmIDB4RkY7XG5cdFx0XHRcdFx0XHRcdGJ5dGVJbmRleCsrO1xuXG5cdFx0XHRcdFx0XHRcdC8vIDEtYnl0ZSBzZXF1ZW5jZSAobm8gY29udGludWF0aW9uIGJ5dGVzKVxuXHRcdFx0XHRcdFx0XHRpZiAoKGJ5dGUxICYgMHg4MCkgPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBieXRlMTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIDItYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRpZiAoKGJ5dGUxICYgMHhFMCkgPT0gMHhDMCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50ID0gKGJ5dGUxICYgMHgxRikgPDwgNiB8IGJ5dGUyO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjb2RlUG9pbnQgPj0gMHg4MCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgY29udGludWF0aW9uIGJ5dGUnKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyAzLWJ5dGUgc2VxdWVuY2UgKG1heSBpbmNsdWRlIHVucGFpcmVkIHN1cnJvZ2F0ZXMpXG5cdFx0XHRcdFx0XHRcdGlmICgoYnl0ZTEgJiAweEYwKSA9PSAweEUwKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZTIgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdGJ5dGUzID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdFx0XHRcdFx0XHRjb2RlUG9pbnQgPSAoYnl0ZTEgJiAweDBGKSA8PCAxMiB8IGJ5dGUyIDw8IDYgfCBieXRlMztcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29kZVBvaW50ID49IDB4MDgwMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2hlY2tTY2FsYXJWYWx1ZShjb2RlUG9pbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgY29udGludWF0aW9uIGJ5dGUnKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyA0LWJ5dGUgc2VxdWVuY2Vcblx0XHRcdFx0XHRcdFx0aWYgKChieXRlMSAmIDB4RjgpID09IDB4RjApIHtcblx0XHRcdFx0XHRcdFx0XHRieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZTMgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdGJ5dGU0ID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdFx0XHRcdFx0XHRjb2RlUG9pbnQgPSAoYnl0ZTEgJiAweDBGKSA8PCAweDEyIHwgYnl0ZTIgPDwgMHgwQyB8IGJ5dGUzIDw8IDB4MDYgfCBieXRlNDtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29kZVBvaW50ID49IDB4MDEwMDAwICYmIGNvZGVQb2ludCA8PSAweDEwRkZGRikge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBVVEYtOCBkZXRlY3RlZCcpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgYnl0ZUFycmF5O1xuXHRcdFx0XHRcdFx0dmFyIGJ5dGVDb3VudDtcblx0XHRcdFx0XHRcdHZhciBieXRlSW5kZXg7XG5cdFx0XHRcdFx0XHRmdW5jdGlvbiB1dGY4ZGVjb2RlKGJ5dGVTdHJpbmcpIHtcblx0XHRcdFx0XHRcdFx0Ynl0ZUFycmF5ID0gdWNzMmRlY29kZShieXRlU3RyaW5nKTtcblx0XHRcdFx0XHRcdFx0Ynl0ZUNvdW50ID0gYnl0ZUFycmF5Lmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0Ynl0ZUluZGV4ID0gMDtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludHMgPSBbXTtcblx0XHRcdFx0XHRcdFx0dmFyIHRtcDtcblx0XHRcdFx0XHRcdFx0d2hpbGUgKCh0bXAgPSBkZWNvZGVTeW1ib2woKSkgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50cy5wdXNoKHRtcCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIHVjczJlbmNvZGUoY29kZVBvaW50cyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0XHR2YXIgdXRmOCA9IHtcblx0XHRcdFx0XHRcdFx0J3ZlcnNpb24nOiAnMi4wLjAnLFxuXHRcdFx0XHRcdFx0XHQnZW5jb2RlJzogdXRmOGVuY29kZSxcblx0XHRcdFx0XHRcdFx0J2RlY29kZSc6IHV0ZjhkZWNvZGVcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdC8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJuc1xuXHRcdFx0XHRcdFx0Ly8gbGlrZSB0aGUgZm9sbG93aW5nOlxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZGVmaW5lLmFtZCA9PSAnb2JqZWN0JyAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0XHRcdFx0XHRcdGRlZmluZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHV0Zjg7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiAhZnJlZUV4cG9ydHMubm9kZVR5cGUpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGZyZWVNb2R1bGUpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBpbiBOb2RlLmpzIG9yIFJpbmdvSlMgdjAuOC4wK1xuXHRcdFx0XHRcdFx0XHRcdGZyZWVNb2R1bGUuZXhwb3J0cyA9IHV0Zjg7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaW4gTmFyd2hhbCBvciBSaW5nb0pTIHYwLjcuMC1cblx0XHRcdFx0XHRcdFx0XHR2YXIgb2JqZWN0ID0ge307XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0Lmhhc093blByb3BlcnR5O1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiB1dGY4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRoYXNPd25Qcm9wZXJ0eS5jYWxsKHV0ZjgsIGtleSkgJiYgKGZyZWVFeHBvcnRzW2tleV0gPSB1dGY4W2tleV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gaW4gUmhpbm8gb3IgYSB3ZWIgYnJvd3NlclxuXHRcdFx0XHRcdFx0XHRyb290LnV0ZjggPSB1dGY4O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pKHRoaXMpO1xuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwge31dLCAzMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0J3VzZSBzdHJpY3QnO1xuXG5cdFx0XHRcdHZhciBhbHBoYWJldCA9ICcwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ei1fJy5zcGxpdCgnJyksXG5cdFx0XHRcdCAgICBsZW5ndGggPSA2NCxcblx0XHRcdFx0ICAgIG1hcCA9IHt9LFxuXHRcdFx0XHQgICAgc2VlZCA9IDAsXG5cdFx0XHRcdCAgICBpID0gMCxcblx0XHRcdFx0ICAgIHByZXY7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgc3BlY2lmaWVkIG51bWJlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBudW0gVGhlIG51bWJlciB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG51bWJlci5cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBlbmNvZGUobnVtKSB7XG5cdFx0XHRcdFx0dmFyIGVuY29kZWQgPSAnJztcblxuXHRcdFx0XHRcdGRvIHtcblx0XHRcdFx0XHRcdGVuY29kZWQgPSBhbHBoYWJldFtudW0gJSBsZW5ndGhdICsgZW5jb2RlZDtcblx0XHRcdFx0XHRcdG51bSA9IE1hdGguZmxvb3IobnVtIC8gbGVuZ3RoKTtcblx0XHRcdFx0XHR9IHdoaWxlIChudW0gPiAwKTtcblxuXHRcdFx0XHRcdHJldHVybiBlbmNvZGVkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJuIHRoZSBpbnRlZ2VyIHZhbHVlIHNwZWNpZmllZCBieSB0aGUgZ2l2ZW4gc3RyaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhlIGludGVnZXIgdmFsdWUgcmVwcmVzZW50ZWQgYnkgdGhlIHN0cmluZy5cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXHRcdFx0XHRmdW5jdGlvbiBkZWNvZGUoc3RyKSB7XG5cdFx0XHRcdFx0dmFyIGRlY29kZWQgPSAwO1xuXG5cdFx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0ZGVjb2RlZCA9IGRlY29kZWQgKiBsZW5ndGggKyBtYXBbc3RyLmNoYXJBdChpKV07XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIGRlY29kZWQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBZZWFzdDogQSB0aW55IGdyb3dpbmcgaWQgZ2VuZXJhdG9yLlxuICAgICAqXG4gICAgICogQHJldHVybnMge1N0cmluZ30gQSB1bmlxdWUgaWQuXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblx0XHRcdFx0ZnVuY3Rpb24geWVhc3QoKSB7XG5cdFx0XHRcdFx0dmFyIG5vdyA9IGVuY29kZSgrbmV3IERhdGUoKSk7XG5cblx0XHRcdFx0XHRpZiAobm93ICE9PSBwcmV2KSByZXR1cm4gc2VlZCA9IDAsIHByZXYgPSBub3c7XG5cdFx0XHRcdFx0cmV0dXJuIG5vdyArICcuJyArIGVuY29kZShzZWVkKyspO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9cblx0XHRcdFx0Ly8gTWFwIGVhY2ggY2hhcmFjdGVyIHRvIGl0cyBpbmRleC5cblx0XHRcdFx0Ly9cblx0XHRcdFx0Zm9yICg7IGkgPCBsZW5ndGg7IGkrKykgbWFwW2FscGhhYmV0W2ldXSA9IGk7XG5cblx0XHRcdFx0Ly9cblx0XHRcdFx0Ly8gRXhwb3NlIHRoZSBgeWVhc3RgLCBgZW5jb2RlYCBhbmQgYGRlY29kZWAgZnVuY3Rpb25zLlxuXHRcdFx0XHQvL1xuXHRcdFx0XHR5ZWFzdC5lbmNvZGUgPSBlbmNvZGU7XG5cdFx0XHRcdHllYXN0LmRlY29kZSA9IGRlY29kZTtcblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSB5ZWFzdDtcblx0XHRcdH0sIHt9XSwgMzE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG4gICAgICogTW9kdWxlIGRlcGVuZGVuY2llcy5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgdXJsID0gX2RlcmVxXygnLi91cmwnKTtcblx0XHRcdFx0dmFyIHBhcnNlciA9IF9kZXJlcV8oJ3NvY2tldC5pby1wYXJzZXInKTtcblx0XHRcdFx0dmFyIE1hbmFnZXIgPSBfZGVyZXFfKCcuL21hbmFnZXInKTtcblx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnc29ja2V0LmlvLWNsaWVudCcpO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBleHBvcnRzLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0cyA9IGxvb2t1cDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBNYW5hZ2VycyBjYWNoZS5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgY2FjaGUgPSBleHBvcnRzLm1hbmFnZXJzID0ge307XG5cblx0XHRcdFx0LyoqXG4gICAgICogTG9va3MgdXAgYW4gZXhpc3RpbmcgYE1hbmFnZXJgIGZvciBtdWx0aXBsZXhpbmcuXG4gICAgICogSWYgdGhlIHVzZXIgc3VtbW9uczpcbiAgICAgKlxuICAgICAqICAgYGlvKCdodHRwOi8vbG9jYWxob3N0L2EnKTtgXG4gICAgICogICBgaW8oJ2h0dHA6Ly9sb2NhbGhvc3QvYicpO2BcbiAgICAgKlxuICAgICAqIFdlIHJldXNlIHRoZSBleGlzdGluZyBpbnN0YW5jZSBiYXNlZCBvbiBzYW1lIHNjaGVtZS9wb3J0L2hvc3QsXG4gICAgICogYW5kIHdlIGluaXRpYWxpemUgc29ja2V0cyBmb3IgZWFjaCBuYW1lc3BhY2UuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcblx0XHRcdFx0XHRpZiAodHlwZW9mIHVyaSA9PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdFx0b3B0cyA9IHVyaTtcblx0XHRcdFx0XHRcdHVyaSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblxuXHRcdFx0XHRcdHZhciBwYXJzZWQgPSB1cmwodXJpKTtcblx0XHRcdFx0XHR2YXIgc291cmNlID0gcGFyc2VkLnNvdXJjZTtcblx0XHRcdFx0XHR2YXIgaWQgPSBwYXJzZWQuaWQ7XG5cdFx0XHRcdFx0dmFyIHBhdGggPSBwYXJzZWQucGF0aDtcblx0XHRcdFx0XHR2YXIgc2FtZU5hbWVzcGFjZSA9IGNhY2hlW2lkXSAmJiBwYXRoIGluIGNhY2hlW2lkXS5uc3BzO1xuXHRcdFx0XHRcdHZhciBuZXdDb25uZWN0aW9uID0gb3B0cy5mb3JjZU5ldyB8fCBvcHRzWydmb3JjZSBuZXcgY29ubmVjdGlvbiddIHx8IGZhbHNlID09PSBvcHRzLm11bHRpcGxleCB8fCBzYW1lTmFtZXNwYWNlO1xuXG5cdFx0XHRcdFx0dmFyIGlvO1xuXG5cdFx0XHRcdFx0aWYgKG5ld0Nvbm5lY3Rpb24pIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdpZ25vcmluZyBzb2NrZXQgY2FjaGUgZm9yICVzJywgc291cmNlKTtcblx0XHRcdFx0XHRcdGlvID0gTWFuYWdlcihzb3VyY2UsIG9wdHMpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoIWNhY2hlW2lkXSkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygnbmV3IGlvIGluc3RhbmNlIGZvciAlcycsIHNvdXJjZSk7XG5cdFx0XHRcdFx0XHRcdGNhY2hlW2lkXSA9IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlvID0gY2FjaGVbaWRdO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBpby5zb2NrZXQocGFyc2VkLnBhdGgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogUHJvdG9jb2wgdmVyc2lvbi5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5wcm90b2NvbCA9IHBhcnNlci5wcm90b2NvbDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBgY29ubmVjdGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdXJpXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLmNvbm5lY3QgPSBsb29rdXA7XG5cblx0XHRcdFx0LyoqXG4gICAgICogRXhwb3NlIGNvbnN0cnVjdG9ycyBmb3Igc3RhbmRhbG9uZSBidWlsZC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5NYW5hZ2VyID0gX2RlcmVxXygnLi9tYW5hZ2VyJyk7XG5cdFx0XHRcdGV4cG9ydHMuU29ja2V0ID0gX2RlcmVxXygnLi9zb2NrZXQnKTtcblx0XHRcdH0sIHsgXCIuL21hbmFnZXJcIjogMzIsIFwiLi9zb2NrZXRcIjogMzQsIFwiLi91cmxcIjogMzUsIFwiZGVidWdcIjogMzksIFwic29ja2V0LmlvLXBhcnNlclwiOiA0NyB9XSwgMzI6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG4gICAgICogTW9kdWxlIGRlcGVuZGVuY2llcy5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgZWlvID0gX2RlcmVxXygnZW5naW5lLmlvLWNsaWVudCcpO1xuXHRcdFx0XHR2YXIgU29ja2V0ID0gX2RlcmVxXygnLi9zb2NrZXQnKTtcblx0XHRcdFx0dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKCdjb21wb25lbnQtZW1pdHRlcicpO1xuXHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnc29ja2V0LmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIgb24gPSBfZGVyZXFfKCcuL29uJyk7XG5cdFx0XHRcdHZhciBiaW5kID0gX2RlcmVxXygnY29tcG9uZW50LWJpbmQnKTtcblx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnc29ja2V0LmlvLWNsaWVudDptYW5hZ2VyJyk7XG5cdFx0XHRcdHZhciBpbmRleE9mID0gX2RlcmVxXygnaW5kZXhvZicpO1xuXHRcdFx0XHR2YXIgQmFja29mZiA9IF9kZXJlcV8oJ2JhY2tvMicpO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIElFNisgaGFzT3duUHJvcGVydHlcbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBNb2R1bGUgZXhwb3J0c1xuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gTWFuYWdlcjtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBgTWFuYWdlcmAgY29uc3RydWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZW5naW5lIGluc3RhbmNlIG9yIGVuZ2luZSB1cmkvb3B0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBNYW5hZ2VyKHVyaSwgb3B0cykge1xuXHRcdFx0XHRcdGlmICghKHRoaXMgaW5zdGFuY2VvZiBNYW5hZ2VyKSkgcmV0dXJuIG5ldyBNYW5hZ2VyKHVyaSwgb3B0cyk7XG5cdFx0XHRcdFx0aWYgKHVyaSAmJiAnb2JqZWN0JyA9PSB0eXBlb2YgdXJpKSB7XG5cdFx0XHRcdFx0XHRvcHRzID0gdXJpO1xuXHRcdFx0XHRcdFx0dXJpID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblxuXHRcdFx0XHRcdG9wdHMucGF0aCA9IG9wdHMucGF0aCB8fCAnL3NvY2tldC5pbyc7XG5cdFx0XHRcdFx0dGhpcy5uc3BzID0ge307XG5cdFx0XHRcdFx0dGhpcy5zdWJzID0gW107XG5cdFx0XHRcdFx0dGhpcy5vcHRzID0gb3B0cztcblx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdGlvbihvcHRzLnJlY29ubmVjdGlvbiAhPT0gZmFsc2UpO1xuXHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW9uQXR0ZW1wdHMob3B0cy5yZWNvbm5lY3Rpb25BdHRlbXB0cyB8fCBJbmZpbml0eSk7XG5cdFx0XHRcdFx0dGhpcy5yZWNvbm5lY3Rpb25EZWxheShvcHRzLnJlY29ubmVjdGlvbkRlbGF5IHx8IDEwMDApO1xuXHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW9uRGVsYXlNYXgob3B0cy5yZWNvbm5lY3Rpb25EZWxheU1heCB8fCA1MDAwKTtcblx0XHRcdFx0XHR0aGlzLnJhbmRvbWl6YXRpb25GYWN0b3Iob3B0cy5yYW5kb21pemF0aW9uRmFjdG9yIHx8IDAuNSk7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmID0gbmV3IEJhY2tvZmYoe1xuXHRcdFx0XHRcdFx0bWluOiB0aGlzLnJlY29ubmVjdGlvbkRlbGF5KCksXG5cdFx0XHRcdFx0XHRtYXg6IHRoaXMucmVjb25uZWN0aW9uRGVsYXlNYXgoKSxcblx0XHRcdFx0XHRcdGppdHRlcjogdGhpcy5yYW5kb21pemF0aW9uRmFjdG9yKClcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR0aGlzLnRpbWVvdXQobnVsbCA9PSBvcHRzLnRpbWVvdXQgPyAyMDAwMCA6IG9wdHMudGltZW91dCk7XG5cdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NlZCc7XG5cdFx0XHRcdFx0dGhpcy51cmkgPSB1cmk7XG5cdFx0XHRcdFx0dGhpcy5jb25uZWN0aW5nID0gW107XG5cdFx0XHRcdFx0dGhpcy5sYXN0UGluZyA9IG51bGw7XG5cdFx0XHRcdFx0dGhpcy5lbmNvZGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdHRoaXMucGFja2V0QnVmZmVyID0gW107XG5cdFx0XHRcdFx0dGhpcy5lbmNvZGVyID0gbmV3IHBhcnNlci5FbmNvZGVyKCk7XG5cdFx0XHRcdFx0dGhpcy5kZWNvZGVyID0gbmV3IHBhcnNlci5EZWNvZGVyKCk7XG5cdFx0XHRcdFx0dGhpcy5hdXRvQ29ubmVjdCA9IG9wdHMuYXV0b0Nvbm5lY3QgIT09IGZhbHNlO1xuXHRcdFx0XHRcdGlmICh0aGlzLmF1dG9Db25uZWN0KSB0aGlzLm9wZW4oKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuICAgICAqIFByb3BhZ2F0ZSBnaXZlbiBldmVudCB0byBzb2NrZXRzIGFuZCBlbWl0IG9uIGB0aGlzYFxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUuZW1pdEFsbCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLmVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRmb3IgKHZhciBuc3AgaW4gdGhpcy5uc3BzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzLmNhbGwodGhpcy5uc3BzLCBuc3ApKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMubnNwc1tuc3BdLmVtaXQuYXBwbHkodGhpcy5uc3BzW25zcF0sIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFVwZGF0ZSBgc29ja2V0LmlkYCBvZiBhbGwgc29ja2V0c1xuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUudXBkYXRlU29ja2V0SWRzID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGZvciAodmFyIG5zcCBpbiB0aGlzLm5zcHMpIHtcblx0XHRcdFx0XHRcdGlmIChoYXMuY2FsbCh0aGlzLm5zcHMsIG5zcCkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5uc3BzW25zcF0uaWQgPSB0aGlzLmVuZ2luZS5pZDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogTWl4IGluIGBFbWl0dGVyYC5cbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyKE1hbmFnZXIucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTZXRzIHRoZSBgcmVjb25uZWN0aW9uYCBjb25maWcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHRydWUvZmFsc2UgaWYgaXQgc2hvdWxkIGF1dG9tYXRpY2FsbHkgcmVjb25uZWN0XG4gICAgICogQHJldHVybiB7TWFuYWdlcn0gc2VsZiBvciB2YWx1ZVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uID0gZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb247XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uID0gISF2O1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFNldHMgdGhlIHJlY29ubmVjdGlvbiBhdHRlbXB0cyBjb25maWcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cyBiZWZvcmUgZ2l2aW5nIHVwXG4gICAgICogQHJldHVybiB7TWFuYWdlcn0gc2VsZiBvciB2YWx1ZVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uQXR0ZW1wdHMgPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzO1xuXHRcdFx0XHRcdHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzID0gdjtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTZXRzIHRoZSBkZWxheSBiZXR3ZWVuIHJlY29ubmVjdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcbiAgICAgKiBAcmV0dXJuIHtNYW5hZ2VyfSBzZWxmIG9yIHZhbHVlXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheSA9IGZ1bmN0aW9uICh2KSB7XG5cdFx0XHRcdFx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uRGVsYXkgPSB2O1xuXHRcdFx0XHRcdHRoaXMuYmFja29mZiAmJiB0aGlzLmJhY2tvZmYuc2V0TWluKHYpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnJhbmRvbWl6YXRpb25GYWN0b3IgPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JhbmRvbWl6YXRpb25GYWN0b3I7XG5cdFx0XHRcdFx0dGhpcy5fcmFuZG9taXphdGlvbkZhY3RvciA9IHY7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmICYmIHRoaXMuYmFja29mZi5zZXRKaXR0ZXIodik7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2V0cyB0aGUgbWF4aW11bSBkZWxheSBiZXR3ZWVuIHJlY29ubmVjdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcbiAgICAgKiBAcmV0dXJuIHtNYW5hZ2VyfSBzZWxmIG9yIHZhbHVlXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheU1heCA9IGZ1bmN0aW9uICh2KSB7XG5cdFx0XHRcdFx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg7XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXggPSB2O1xuXHRcdFx0XHRcdHRoaXMuYmFja29mZiAmJiB0aGlzLmJhY2tvZmYuc2V0TWF4KHYpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFNldHMgdGhlIGNvbm5lY3Rpb24gdGltZW91dC4gYGZhbHNlYCB0byBkaXNhYmxlXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtNYW5hZ2VyfSBzZWxmIG9yIHZhbHVlXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl90aW1lb3V0O1xuXHRcdFx0XHRcdHRoaXMuX3RpbWVvdXQgPSB2O1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFN0YXJ0cyB0cnlpbmcgdG8gcmVjb25uZWN0IGlmIHJlY29ubmVjdGlvbiBpcyBlbmFibGVkIGFuZCB3ZSBoYXZlIG5vdFxuICAgICAqIHN0YXJ0ZWQgcmVjb25uZWN0aW5nIHlldFxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUubWF5YmVSZWNvbm5lY3RPbk9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0Ly8gT25seSB0cnkgdG8gcmVjb25uZWN0IGlmIGl0J3MgdGhlIGZpcnN0IHRpbWUgd2UncmUgY29ubmVjdGluZ1xuXHRcdFx0XHRcdGlmICghdGhpcy5yZWNvbm5lY3RpbmcgJiYgdGhpcy5fcmVjb25uZWN0aW9uICYmIHRoaXMuYmFja29mZi5hdHRlbXB0cyA9PT0gMCkge1xuXHRcdFx0XHRcdFx0Ly8ga2VlcHMgcmVjb25uZWN0aW9uIGZyb20gZmlyaW5nIHR3aWNlIGZvciB0aGUgc2FtZSByZWNvbm5lY3Rpb24gbG9vcFxuXHRcdFx0XHRcdFx0dGhpcy5yZWNvbm5lY3QoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQgYHNvY2tldGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25hbCwgY2FsbGJhY2tcbiAgICAgKiBAcmV0dXJuIHtNYW5hZ2VyfSBzZWxmXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5vcGVuID0gTWFuYWdlci5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uIChmbikge1xuXHRcdFx0XHRcdGRlYnVnKCdyZWFkeVN0YXRlICVzJywgdGhpcy5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHRpZiAofnRoaXMucmVhZHlTdGF0ZS5pbmRleE9mKCdvcGVuJykpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0ZGVidWcoJ29wZW5pbmcgJXMnLCB0aGlzLnVyaSk7XG5cdFx0XHRcdFx0dGhpcy5lbmdpbmUgPSBlaW8odGhpcy51cmksIHRoaXMub3B0cyk7XG5cdFx0XHRcdFx0dmFyIHNvY2tldCA9IHRoaXMuZW5naW5lO1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3BlbmluZyc7XG5cdFx0XHRcdFx0dGhpcy5za2lwUmVjb25uZWN0ID0gZmFsc2U7XG5cblx0XHRcdFx0XHQvLyBlbWl0IGBvcGVuYFxuXHRcdFx0XHRcdHZhciBvcGVuU3ViID0gb24oc29ja2V0LCAnb3BlbicsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHNlbGYub25vcGVuKCk7XG5cdFx0XHRcdFx0XHRmbiAmJiBmbigpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gZW1pdCBgY29ubmVjdF9lcnJvcmBcblx0XHRcdFx0XHR2YXIgZXJyb3JTdWIgPSBvbihzb2NrZXQsICdlcnJvcicsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnY29ubmVjdF9lcnJvcicpO1xuXHRcdFx0XHRcdFx0c2VsZi5jbGVhbnVwKCk7XG5cdFx0XHRcdFx0XHRzZWxmLnJlYWR5U3RhdGUgPSAnY2xvc2VkJztcblx0XHRcdFx0XHRcdHNlbGYuZW1pdEFsbCgnY29ubmVjdF9lcnJvcicsIGRhdGEpO1xuXHRcdFx0XHRcdFx0aWYgKGZuKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0ZXJyLmRhdGEgPSBkYXRhO1xuXHRcdFx0XHRcdFx0XHRmbihlcnIpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gT25seSBkbyB0aGlzIGlmIHRoZXJlIGlzIG5vIGZuIHRvIGhhbmRsZSB0aGUgZXJyb3Jcblx0XHRcdFx0XHRcdFx0c2VsZi5tYXliZVJlY29ubmVjdE9uT3BlbigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0Ly8gZW1pdCBgY29ubmVjdF90aW1lb3V0YFxuXHRcdFx0XHRcdGlmIChmYWxzZSAhPT0gdGhpcy5fdGltZW91dCkge1xuXHRcdFx0XHRcdFx0dmFyIHRpbWVvdXQgPSB0aGlzLl90aW1lb3V0O1xuXHRcdFx0XHRcdFx0ZGVidWcoJ2Nvbm5lY3QgYXR0ZW1wdCB3aWxsIHRpbWVvdXQgYWZ0ZXIgJWQnLCB0aW1lb3V0KTtcblxuXHRcdFx0XHRcdFx0Ly8gc2V0IHRpbWVyXG5cdFx0XHRcdFx0XHR2YXIgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2Nvbm5lY3QgYXR0ZW1wdCB0aW1lZCBvdXQgYWZ0ZXIgJWQnLCB0aW1lb3V0KTtcblx0XHRcdFx0XHRcdFx0b3BlblN1Yi5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHRcdHNvY2tldC5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0XHRzb2NrZXQuZW1pdCgnZXJyb3InLCAndGltZW91dCcpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ2Nvbm5lY3RfdGltZW91dCcsIHRpbWVvdXQpO1xuXHRcdFx0XHRcdFx0fSwgdGltZW91dCk7XG5cblx0XHRcdFx0XHRcdHRoaXMuc3Vicy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0ZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcblx0XHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvcGVuU3ViKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7XG5cblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgb3Blbi5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1Zygnb3BlbicpO1xuXG5cdFx0XHRcdFx0Ly8gY2xlYXIgb2xkIHN1YnNcblx0XHRcdFx0XHR0aGlzLmNsZWFudXAoKTtcblxuXHRcdFx0XHRcdC8vIG1hcmsgYXMgb3BlblxuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdvcGVuJztcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ29wZW4nKTtcblxuXHRcdFx0XHRcdC8vIGFkZCBuZXcgc3Vic1xuXHRcdFx0XHRcdHZhciBzb2NrZXQgPSB0aGlzLmVuZ2luZTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdkYXRhJywgYmluZCh0aGlzLCAnb25kYXRhJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdwaW5nJywgYmluZCh0aGlzLCAnb25waW5nJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdwb25nJywgYmluZCh0aGlzLCAnb25wb25nJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdlcnJvcicsIGJpbmQodGhpcywgJ29uZXJyb3InKSkpO1xuXHRcdFx0XHRcdHRoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCwgJ2Nsb3NlJywgYmluZCh0aGlzLCAnb25jbG9zZScpKSk7XG5cdFx0XHRcdFx0dGhpcy5zdWJzLnB1c2gob24odGhpcy5kZWNvZGVyLCAnZGVjb2RlZCcsIGJpbmQodGhpcywgJ29uZGVjb2RlZCcpKSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ2FsbGVkIHVwb24gYSBwaW5nLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25waW5nID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMubGFzdFBpbmcgPSBuZXcgRGF0ZSgpO1xuXHRcdFx0XHRcdHRoaXMuZW1pdEFsbCgncGluZycpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25wb25nID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMuZW1pdEFsbCgncG9uZycsIG5ldyBEYXRlKCkgLSB0aGlzLmxhc3RQaW5nKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBkYXRhLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25kYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR0aGlzLmRlY29kZXIuYWRkKGRhdGEpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHBhcnNlciBmdWxseSBkZWNvZGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25kZWNvZGVkID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgncGFja2V0JywgcGFja2V0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzb2NrZXQgZXJyb3IuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdGRlYnVnKCdlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0dGhpcy5lbWl0QWxsKCdlcnJvcicsIGVycik7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBzb2NrZXQgZm9yIHRoZSBnaXZlbiBgbnNwYC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NvY2tldH1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnNvY2tldCA9IGZ1bmN0aW9uIChuc3ApIHtcblx0XHRcdFx0XHR2YXIgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG5cdFx0XHRcdFx0aWYgKCFzb2NrZXQpIHtcblx0XHRcdFx0XHRcdHNvY2tldCA9IG5ldyBTb2NrZXQodGhpcywgbnNwKTtcblx0XHRcdFx0XHRcdHRoaXMubnNwc1tuc3BdID0gc29ja2V0O1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0c29ja2V0Lm9uKCdjb25uZWN0aW5nJywgb25Db25uZWN0aW5nKTtcblx0XHRcdFx0XHRcdHNvY2tldC5vbignY29ubmVjdCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c29ja2V0LmlkID0gc2VsZi5lbmdpbmUuaWQ7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMuYXV0b0Nvbm5lY3QpIHtcblx0XHRcdFx0XHRcdFx0Ly8gbWFudWFsbHkgY2FsbCBoZXJlIHNpbmNlIGNvbm5lY3RpbmcgZXZuZXQgaXMgZmlyZWQgYmVmb3JlIGxpc3RlbmluZ1xuXHRcdFx0XHRcdFx0XHRvbkNvbm5lY3RpbmcoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRmdW5jdGlvbiBvbkNvbm5lY3RpbmcoKSB7XG5cdFx0XHRcdFx0XHRpZiAoISB+aW5kZXhPZihzZWxmLmNvbm5lY3RpbmcsIHNvY2tldCkpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5jb25uZWN0aW5nLnB1c2goc29ja2V0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gc29ja2V0O1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGEgc29ja2V0IGNsb3NlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTb2NrZXR9IHNvY2tldFxuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoc29ja2V0KSB7XG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gaW5kZXhPZih0aGlzLmNvbm5lY3RpbmcsIHNvY2tldCk7XG5cdFx0XHRcdFx0aWYgKH5pbmRleCkgdGhpcy5jb25uZWN0aW5nLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuY29ubmVjdGluZy5sZW5ndGgpIHJldHVybjtcblxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBXcml0ZXMgYSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdGRlYnVnKCd3cml0aW5nIHBhY2tldCAlaicsIHBhY2tldCk7XG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0aWYgKCFzZWxmLmVuY29kaW5nKSB7XG5cdFx0XHRcdFx0XHQvLyBlbmNvZGUsIHRoZW4gd3JpdGUgdG8gZW5naW5lIHdpdGggcmVzdWx0XG5cdFx0XHRcdFx0XHRzZWxmLmVuY29kaW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHRoaXMuZW5jb2Rlci5lbmNvZGUocGFja2V0LCBmdW5jdGlvbiAoZW5jb2RlZFBhY2tldHMpIHtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdHNlbGYuZW5naW5lLndyaXRlKGVuY29kZWRQYWNrZXRzW2ldLCBwYWNrZXQub3B0aW9ucyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0c2VsZi5lbmNvZGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnByb2Nlc3NQYWNrZXRRdWV1ZSgpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIGFkZCBwYWNrZXQgdG8gdGhlIHF1ZXVlXG5cdFx0XHRcdFx0XHRzZWxmLnBhY2tldEJ1ZmZlci5wdXNoKHBhY2tldCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIElmIHBhY2tldCBidWZmZXIgaXMgbm9uLWVtcHR5LCBiZWdpbnMgZW5jb2RpbmcgdGhlXG4gICAgICogbmV4dCBwYWNrZXQgaW4gbGluZS5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnByb2Nlc3NQYWNrZXRRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5wYWNrZXRCdWZmZXIubGVuZ3RoID4gMCAmJiAhdGhpcy5lbmNvZGluZykge1xuXHRcdFx0XHRcdFx0dmFyIHBhY2sgPSB0aGlzLnBhY2tldEJ1ZmZlci5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5wYWNrZXQocGFjayk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENsZWFuIHVwIHRyYW5zcG9ydCBzdWJzY3JpcHRpb25zIGFuZCBwYWNrZXQgYnVmZmVyLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUuY2xlYW51cCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1ZygnY2xlYW51cCcpO1xuXG5cdFx0XHRcdFx0dmFyIHN1Yjtcblx0XHRcdFx0XHR3aGlsZSAoc3ViID0gdGhpcy5zdWJzLnNoaWZ0KCkpIHN1Yi5kZXN0cm95KCk7XG5cblx0XHRcdFx0XHR0aGlzLnBhY2tldEJ1ZmZlciA9IFtdO1xuXHRcdFx0XHRcdHRoaXMuZW5jb2RpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHR0aGlzLmxhc3RQaW5nID0gbnVsbDtcblxuXHRcdFx0XHRcdHRoaXMuZGVjb2Rlci5kZXN0cm95KCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ2xvc2UgdGhlIGN1cnJlbnQgc29ja2V0LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUuY2xvc2UgPSBNYW5hZ2VyLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGRlYnVnKCdkaXNjb25uZWN0Jyk7XG5cdFx0XHRcdFx0dGhpcy5za2lwUmVjb25uZWN0ID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHQvLyBgb25jbG9zZWAgd2lsbCBub3QgZmlyZSBiZWNhdXNlXG5cdFx0XHRcdFx0XHQvLyBhbiBvcGVuIGV2ZW50IG5ldmVyIGhhcHBlbmVkXG5cdFx0XHRcdFx0XHR0aGlzLmNsZWFudXAoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmLnJlc2V0KCk7XG5cdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NlZCc7XG5cdFx0XHRcdFx0aWYgKHRoaXMuZW5naW5lKSB0aGlzLmVuZ2luZS5jbG9zZSgpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVuZ2luZSBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9uY2xvc2UgPSBmdW5jdGlvbiAocmVhc29uKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ29uY2xvc2UnKTtcblxuXHRcdFx0XHRcdHRoaXMuY2xlYW51cCgpO1xuXHRcdFx0XHRcdHRoaXMuYmFja29mZi5yZXNldCgpO1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdjbG9zZWQnO1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgnY2xvc2UnLCByZWFzb24pO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuX3JlY29ubmVjdGlvbiAmJiAhdGhpcy5za2lwUmVjb25uZWN0KSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBBdHRlbXB0IGEgcmVjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLnJlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuYmFja29mZi5hdHRlbXB0cyA+PSB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cykge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3JlY29ubmVjdCBmYWlsZWQnKTtcblx0XHRcdFx0XHRcdHRoaXMuYmFja29mZi5yZXNldCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0QWxsKCdyZWNvbm5lY3RfZmFpbGVkJyk7XG5cdFx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgZGVsYXkgPSB0aGlzLmJhY2tvZmYuZHVyYXRpb24oKTtcblx0XHRcdFx0XHRcdGRlYnVnKCd3aWxsIHdhaXQgJWRtcyBiZWZvcmUgcmVjb25uZWN0IGF0dGVtcHQnLCBkZWxheSk7XG5cblx0XHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHZhciB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5za2lwUmVjb25uZWN0KSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2F0dGVtcHRpbmcgcmVjb25uZWN0Jyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYuZW1pdEFsbCgncmVjb25uZWN0X2F0dGVtcHQnLCBzZWxmLmJhY2tvZmYuYXR0ZW1wdHMpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ3JlY29ubmVjdGluZycsIHNlbGYuYmFja29mZi5hdHRlbXB0cyk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY2hlY2sgYWdhaW4gZm9yIHRoZSBjYXNlIHNvY2tldCBjbG9zZWQgaW4gYWJvdmUgZXZlbnRzXG5cdFx0XHRcdFx0XHRcdGlmIChzZWxmLnNraXBSZWNvbm5lY3QpIHJldHVybjtcblxuXHRcdFx0XHRcdFx0XHRzZWxmLm9wZW4oZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRlYnVnKCdyZWNvbm5lY3QgYXR0ZW1wdCBlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ3JlY29ubmVjdF9lcnJvcicsIGVyci5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ3JlY29ubmVjdCBzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLm9ucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0sIGRlbGF5KTtcblxuXHRcdFx0XHRcdFx0dGhpcy5zdWJzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuXHRcdFx0XHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzdWNjZXNzZnVsIHJlY29ubmVjdC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9ucmVjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHZhciBhdHRlbXB0ID0gdGhpcy5iYWNrb2ZmLmF0dGVtcHRzO1xuXHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmLnJlc2V0KCk7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVTb2NrZXRJZHMoKTtcblx0XHRcdFx0XHR0aGlzLmVtaXRBbGwoJ3JlY29ubmVjdCcsIGF0dGVtcHQpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwgeyBcIi4vb25cIjogMzMsIFwiLi9zb2NrZXRcIjogMzQsIFwiYmFja28yXCI6IDM2LCBcImNvbXBvbmVudC1iaW5kXCI6IDM3LCBcImNvbXBvbmVudC1lbWl0dGVyXCI6IDM4LCBcImRlYnVnXCI6IDM5LCBcImVuZ2luZS5pby1jbGllbnRcIjogMSwgXCJpbmRleG9mXCI6IDQyLCBcInNvY2tldC5pby1wYXJzZXJcIjogNDcgfV0sIDMzOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBleHBvcnRzLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gb247XG5cblx0XHRcdFx0LyoqXG4gICAgICogSGVscGVyIGZvciBzdWJzY3JpcHRpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R8RXZlbnRFbWl0dGVyfSBvYmogd2l0aCBgRW1pdHRlcmAgbWl4aW4gb3IgYEV2ZW50RW1pdHRlcmBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgbmFtZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBvbihvYmosIGV2LCBmbikge1xuXHRcdFx0XHRcdG9iai5vbihldiwgZm4pO1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuXHRcdFx0XHRcdFx0XHRvYmoucmVtb3ZlTGlzdGVuZXIoZXYsIGZuKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9LCB7fV0sIDM0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG4gICAgICovXG5cblx0XHRcdFx0dmFyIHBhcnNlciA9IF9kZXJlcV8oJ3NvY2tldC5pby1wYXJzZXInKTtcblx0XHRcdFx0dmFyIEVtaXR0ZXIgPSBfZGVyZXFfKCdjb21wb25lbnQtZW1pdHRlcicpO1xuXHRcdFx0XHR2YXIgdG9BcnJheSA9IF9kZXJlcV8oJ3RvLWFycmF5Jyk7XG5cdFx0XHRcdHZhciBvbiA9IF9kZXJlcV8oJy4vb24nKTtcblx0XHRcdFx0dmFyIGJpbmQgPSBfZGVyZXFfKCdjb21wb25lbnQtYmluZCcpO1xuXHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdzb2NrZXQuaW8tY2xpZW50OnNvY2tldCcpO1xuXHRcdFx0XHR2YXIgaGFzQmluID0gX2RlcmVxXygnaGFzLWJpbmFyeScpO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBleHBvcnRzLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0cyA9IFNvY2tldDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBJbnRlcm5hbCBldmVudHMgKGJsYWNrbGlzdGVkKS5cbiAgICAgKiBUaGVzZSBldmVudHMgY2FuJ3QgYmUgZW1pdHRlZCBieSB0aGUgdXNlci5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdHZhciBldmVudHMgPSB7XG5cdFx0XHRcdFx0Y29ubmVjdDogMSxcblx0XHRcdFx0XHRjb25uZWN0X2Vycm9yOiAxLFxuXHRcdFx0XHRcdGNvbm5lY3RfdGltZW91dDogMSxcblx0XHRcdFx0XHRjb25uZWN0aW5nOiAxLFxuXHRcdFx0XHRcdGRpc2Nvbm5lY3Q6IDEsXG5cdFx0XHRcdFx0ZXJyb3I6IDEsXG5cdFx0XHRcdFx0cmVjb25uZWN0OiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdF9hdHRlbXB0OiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdF9mYWlsZWQ6IDEsXG5cdFx0XHRcdFx0cmVjb25uZWN0X2Vycm9yOiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdGluZzogMSxcblx0XHRcdFx0XHRwaW5nOiAxLFxuXHRcdFx0XHRcdHBvbmc6IDFcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTaG9ydGN1dCB0byBgRW1pdHRlciNlbWl0YC5cbiAgICAgKi9cblxuXHRcdFx0XHR2YXIgZW1pdCA9IEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ7XG5cblx0XHRcdFx0LyoqXG4gICAgICogYFNvY2tldGAgY29uc3RydWN0b3IuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIFNvY2tldChpbywgbnNwKSB7XG5cdFx0XHRcdFx0dGhpcy5pbyA9IGlvO1xuXHRcdFx0XHRcdHRoaXMubnNwID0gbnNwO1xuXHRcdFx0XHRcdHRoaXMuanNvbiA9IHRoaXM7IC8vIGNvbXBhdFxuXHRcdFx0XHRcdHRoaXMuaWRzID0gMDtcblx0XHRcdFx0XHR0aGlzLmFja3MgPSB7fTtcblx0XHRcdFx0XHR0aGlzLnJlY2VpdmVCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLnNlbmRCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdHRoaXMuZGlzY29ubmVjdGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRpZiAodGhpcy5pby5hdXRvQ29ubmVjdCkgdGhpcy5vcGVuKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBNaXggaW4gYEVtaXR0ZXJgLlxuICAgICAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIoU29ja2V0LnByb3RvdHlwZSk7XG5cblx0XHRcdFx0LyoqXG4gICAgICogU3Vic2NyaWJlIHRvIG9wZW4sIGNsb3NlIGFuZCBwYWNrZXQgZXZlbnRzXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnN1YkV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5zdWJzKSByZXR1cm47XG5cblx0XHRcdFx0XHR2YXIgaW8gPSB0aGlzLmlvO1xuXHRcdFx0XHRcdHRoaXMuc3VicyA9IFtvbihpbywgJ29wZW4nLCBiaW5kKHRoaXMsICdvbm9wZW4nKSksIG9uKGlvLCAncGFja2V0JywgYmluZCh0aGlzLCAnb25wYWNrZXQnKSksIG9uKGlvLCAnY2xvc2UnLCBiaW5kKHRoaXMsICdvbmNsb3NlJykpXTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBcIk9wZW5zXCIgdGhlIHNvY2tldC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vcGVuID0gU29ja2V0LnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkgcmV0dXJuIHRoaXM7XG5cblx0XHRcdFx0XHR0aGlzLnN1YkV2ZW50cygpO1xuXHRcdFx0XHRcdHRoaXMuaW8ub3BlbigpOyAvLyBlbnN1cmUgb3BlblxuXHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5pby5yZWFkeVN0YXRlKSB0aGlzLm9ub3BlbigpO1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgnY29ubmVjdGluZycpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFNlbmRzIGEgYG1lc3NhZ2VgIGV2ZW50LlxuICAgICAqXG4gICAgICogQHJldHVybiB7U29ja2V0fSBzZWxmXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0YXJncy51bnNoaWZ0KCdtZXNzYWdlJyk7XG5cdFx0XHRcdFx0dGhpcy5lbWl0LmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE92ZXJyaWRlIGBlbWl0YC5cbiAgICAgKiBJZiB0aGUgZXZlbnQgaXMgaW4gYGV2ZW50c2AsIGl0J3MgZW1pdHRlZCBub3JtYWxseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCBuYW1lXG4gICAgICogQHJldHVybiB7U29ja2V0fSBzZWxmXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAoZXYpIHtcblx0XHRcdFx0XHRpZiAoZXZlbnRzLmhhc093blByb3BlcnR5KGV2KSkge1xuXHRcdFx0XHRcdFx0ZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNlclR5cGUgPSBwYXJzZXIuRVZFTlQ7IC8vIGRlZmF1bHRcblx0XHRcdFx0XHRpZiAoaGFzQmluKGFyZ3MpKSB7XG5cdFx0XHRcdFx0XHRwYXJzZXJUeXBlID0gcGFyc2VyLkJJTkFSWV9FVkVOVDtcblx0XHRcdFx0XHR9IC8vIGJpbmFyeVxuXHRcdFx0XHRcdHZhciBwYWNrZXQgPSB7IHR5cGU6IHBhcnNlclR5cGUsIGRhdGE6IGFyZ3MgfTtcblxuXHRcdFx0XHRcdHBhY2tldC5vcHRpb25zID0ge307XG5cdFx0XHRcdFx0cGFja2V0Lm9wdGlvbnMuY29tcHJlc3MgPSAhdGhpcy5mbGFncyB8fCBmYWxzZSAhPT0gdGhpcy5mbGFncy5jb21wcmVzcztcblxuXHRcdFx0XHRcdC8vIGV2ZW50IGFjayBjYWxsYmFja1xuXHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09IHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0pIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdlbWl0dGluZyBwYWNrZXQgd2l0aCBhY2sgaWQgJWQnLCB0aGlzLmlkcyk7XG5cdFx0XHRcdFx0XHR0aGlzLmFja3NbdGhpcy5pZHNdID0gYXJncy5wb3AoKTtcblx0XHRcdFx0XHRcdHBhY2tldC5pZCA9IHRoaXMuaWRzKys7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRoaXMuY29ubmVjdGVkKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBhY2tldChwYWNrZXQpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnNlbmRCdWZmZXIucHVzaChwYWNrZXQpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLmZsYWdzO1xuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2VuZHMgYSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0cGFja2V0Lm5zcCA9IHRoaXMubnNwO1xuXHRcdFx0XHRcdHRoaXMuaW8ucGFja2V0KHBhY2tldCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogQ2FsbGVkIHVwb24gZW5naW5lIGBvcGVuYC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGRlYnVnKCd0cmFuc3BvcnQgaXMgb3BlbiAtIGNvbm5lY3RpbmcnKTtcblxuXHRcdFx0XHRcdC8vIHdyaXRlIGNvbm5lY3QgcGFja2V0IGlmIG5lY2Vzc2FyeVxuXHRcdFx0XHRcdGlmICgnLycgIT0gdGhpcy5uc3ApIHtcblx0XHRcdFx0XHRcdHRoaXMucGFja2V0KHsgdHlwZTogcGFyc2VyLkNPTk5FQ1QgfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVuZ2luZSBgY2xvc2VgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHJlYXNvblxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25jbG9zZSA9IGZ1bmN0aW9uIChyZWFzb24pIHtcblx0XHRcdFx0XHRkZWJ1ZygnY2xvc2UgKCVzKScsIHJlYXNvbik7XG5cdFx0XHRcdFx0dGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcblx0XHRcdFx0XHR0aGlzLmRpc2Nvbm5lY3RlZCA9IHRydWU7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuaWQ7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdkaXNjb25uZWN0JywgcmVhc29uKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBzb2NrZXQgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhY2tldFxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0aWYgKHBhY2tldC5uc3AgIT0gdGhpcy5uc3ApIHJldHVybjtcblxuXHRcdFx0XHRcdHN3aXRjaCAocGFja2V0LnR5cGUpIHtcblx0XHRcdFx0XHRcdGNhc2UgcGFyc2VyLkNPTk5FQ1Q6XG5cdFx0XHRcdFx0XHRcdHRoaXMub25jb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5FVkVOVDpcblx0XHRcdFx0XHRcdFx0dGhpcy5vbmV2ZW50KHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5CSU5BUllfRVZFTlQ6XG5cdFx0XHRcdFx0XHRcdHRoaXMub25ldmVudChwYWNrZXQpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBwYXJzZXIuQUNLOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uYWNrKHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5CSU5BUllfQUNLOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uYWNrKHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5ESVNDT05ORUNUOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uZGlzY29ubmVjdCgpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBwYXJzZXIuRVJST1I6XG5cdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uZXZlbnQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtcblx0XHRcdFx0XHRkZWJ1ZygnZW1pdHRpbmcgZXZlbnQgJWonLCBhcmdzKTtcblxuXHRcdFx0XHRcdGlmIChudWxsICE9IHBhY2tldC5pZCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ2F0dGFjaGluZyBhY2sgY2FsbGJhY2sgdG8gZXZlbnQnKTtcblx0XHRcdFx0XHRcdGFyZ3MucHVzaCh0aGlzLmFjayhwYWNrZXQuaWQpKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAodGhpcy5jb25uZWN0ZWQpIHtcblx0XHRcdFx0XHRcdGVtaXQuYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMucmVjZWl2ZUJ1ZmZlci5wdXNoKGFyZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5hY2sgPSBmdW5jdGlvbiAoaWQpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0dmFyIHNlbnQgPSBmYWxzZTtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXG5cdFx0XHRcdFx0XHRpZiAoc2VudCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0c2VudCA9IHRydWU7XG5cdFx0XHRcdFx0XHR2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcdGRlYnVnKCdzZW5kaW5nIGFjayAlaicsIGFyZ3MpO1xuXG5cdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGhhc0JpbihhcmdzKSA/IHBhcnNlci5CSU5BUllfQUNLIDogcGFyc2VyLkFDSztcblx0XHRcdFx0XHRcdHNlbGYucGFja2V0KHtcblx0XHRcdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRcdFx0aWQ6IGlkLFxuXHRcdFx0XHRcdFx0XHRkYXRhOiBhcmdzXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGEgc2VydmVyIGFja25vd2xlZ2VtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhY2tldFxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25hY2sgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0dmFyIGFjayA9IHRoaXMuYWNrc1twYWNrZXQuaWRdO1xuXHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09IHR5cGVvZiBhY2spIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdjYWxsaW5nIGFjayAlcyB3aXRoICVqJywgcGFja2V0LmlkLCBwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRhY2suYXBwbHkodGhpcywgcGFja2V0LmRhdGEpO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIHRoaXMuYWNrc1twYWNrZXQuaWRdO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnYmFkIGFjayAlcycsIHBhY2tldC5pZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHNlcnZlciBjb25uZWN0LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZGlzY29ubmVjdGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdjb25uZWN0Jyk7XG5cdFx0XHRcdFx0dGhpcy5lbWl0QnVmZmVyZWQoKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFbWl0IGJ1ZmZlcmVkIGV2ZW50cyAocmVjZWl2ZWQgYW5kIGVtaXR0ZWQpLlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5lbWl0QnVmZmVyZWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dmFyIGk7XG5cdFx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMucmVjZWl2ZUJ1ZmZlci5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0ZW1pdC5hcHBseSh0aGlzLCB0aGlzLnJlY2VpdmVCdWZmZXJbaV0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLnJlY2VpdmVCdWZmZXIgPSBbXTtcblxuXHRcdFx0XHRcdGZvciAoaSA9IDA7IGkgPCB0aGlzLnNlbmRCdWZmZXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdHRoaXMucGFja2V0KHRoaXMuc2VuZEJ1ZmZlcltpXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHRoaXMuc2VuZEJ1ZmZlciA9IFtdO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHNlcnZlciBkaXNjb25uZWN0LlxuICAgICAqXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ3NlcnZlciBkaXNjb25uZWN0ICglcyknLCB0aGlzLm5zcCk7XG5cdFx0XHRcdFx0dGhpcy5kZXN0cm95KCk7XG5cdFx0XHRcdFx0dGhpcy5vbmNsb3NlKCdpbyBzZXJ2ZXIgZGlzY29ubmVjdCcpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGZvcmNlZCBjbGllbnQvc2VydmVyIHNpZGUgZGlzY29ubmVjdGlvbnMsXG4gICAgICogdGhpcyBtZXRob2QgZW5zdXJlcyB0aGUgbWFuYWdlciBzdG9wcyB0cmFja2luZyB1cyBhbmRcbiAgICAgKiB0aGF0IHJlY29ubmVjdGlvbnMgZG9uJ3QgZ2V0IHRyaWdnZXJlZCBmb3IgdGhpcy5cbiAgICAgKlxuICAgICAqIEBhcGkgcHJpdmF0ZS5cbiAgICAgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc3Vicykge1xuXHRcdFx0XHRcdFx0Ly8gY2xlYW4gc3Vic2NyaXB0aW9ucyB0byBhdm9pZCByZWNvbm5lY3Rpb25zXG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc3Vicy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN1YnNbaV0uZGVzdHJveSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dGhpcy5zdWJzID0gbnVsbDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0aGlzLmlvLmRlc3Ryb3kodGhpcyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogRGlzY29ubmVjdHMgdGhlIHNvY2tldCBtYW51YWxseS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NvY2tldH0gc2VsZlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5jbG9zZSA9IFNvY2tldC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5jb25uZWN0ZWQpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdwZXJmb3JtaW5nIGRpc2Nvbm5lY3QgKCVzKScsIHRoaXMubnNwKTtcblx0XHRcdFx0XHRcdHRoaXMucGFja2V0KHsgdHlwZTogcGFyc2VyLkRJU0NPTk5FQ1QgfSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gcmVtb3ZlIHNvY2tldCBmcm9tIHBvb2xcblx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkge1xuXHRcdFx0XHRcdFx0Ly8gZmlyZSBldmVudHNcblx0XHRcdFx0XHRcdHRoaXMub25jbG9zZSgnaW8gY2xpZW50IGRpc2Nvbm5lY3QnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2V0cyB0aGUgY29tcHJlc3MgZmxhZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gaWYgYHRydWVgLCBjb21wcmVzc2VzIHRoZSBzZW5kaW5nIGRhdGFcbiAgICAgKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuY29tcHJlc3MgPSBmdW5jdGlvbiAoY29tcHJlc3MpIHtcblx0XHRcdFx0XHR0aGlzLmZsYWdzID0gdGhpcy5mbGFncyB8fCB7fTtcblx0XHRcdFx0XHR0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cdFx0XHR9LCB7IFwiLi9vblwiOiAzMywgXCJjb21wb25lbnQtYmluZFwiOiAzNywgXCJjb21wb25lbnQtZW1pdHRlclwiOiAzOCwgXCJkZWJ1Z1wiOiAzOSwgXCJoYXMtYmluYXJ5XCI6IDQxLCBcInNvY2tldC5pby1wYXJzZXJcIjogNDcsIFwidG8tYXJyYXlcIjogNTEgfV0sIDM1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0dmFyIHBhcnNldXJpID0gX2RlcmVxXygncGFyc2V1cmknKTtcblx0XHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdzb2NrZXQuaW8tY2xpZW50OnVybCcpO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1vZHVsZSBleHBvcnRzLlxuICAgICAgKi9cblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gdXJsO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFVSTCBwYXJzZXIuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmxcbiAgICAgICogQHBhcmFtIHtPYmplY3R9IEFuIG9iamVjdCBtZWFudCB0byBtaW1pYyB3aW5kb3cubG9jYXRpb24uXG4gICAgICAqICAgICAgICAgICAgICAgICBEZWZhdWx0cyB0byB3aW5kb3cubG9jYXRpb24uXG4gICAgICAqIEBhcGkgcHVibGljXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gdXJsKHVyaSwgbG9jKSB7XG5cdFx0XHRcdFx0XHR2YXIgb2JqID0gdXJpO1xuXG5cdFx0XHRcdFx0XHQvLyBkZWZhdWx0IHRvIHdpbmRvdy5sb2NhdGlvblxuXHRcdFx0XHRcdFx0dmFyIGxvYyA9IGxvYyB8fCBnbG9iYWwubG9jYXRpb247XG5cdFx0XHRcdFx0XHRpZiAobnVsbCA9PSB1cmkpIHVyaSA9IGxvYy5wcm90b2NvbCArICcvLycgKyBsb2MuaG9zdDtcblxuXHRcdFx0XHRcdFx0Ly8gcmVsYXRpdmUgcGF0aCBzdXBwb3J0XG5cdFx0XHRcdFx0XHRpZiAoJ3N0cmluZycgPT0gdHlwZW9mIHVyaSkge1xuXHRcdFx0XHRcdFx0XHRpZiAoJy8nID09IHVyaS5jaGFyQXQoMCkpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoJy8nID09IHVyaS5jaGFyQXQoMSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHVyaSA9IGxvYy5wcm90b2NvbCArIHVyaTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dXJpID0gbG9jLmhvc3QgKyB1cmk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKCEvXihodHRwcz98d3NzPyk6XFwvXFwvLy50ZXN0KHVyaSkpIHtcblx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJvdG9jb2wtbGVzcyB1cmwgJXMnLCB1cmkpO1xuXHRcdFx0XHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2YgbG9jKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR1cmkgPSBsb2MucHJvdG9jb2wgKyAnLy8nICsgdXJpO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR1cmkgPSAnaHR0cHM6Ly8nICsgdXJpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIHBhcnNlXG5cdFx0XHRcdFx0XHRcdGRlYnVnKCdwYXJzZSAlcycsIHVyaSk7XG5cdFx0XHRcdFx0XHRcdG9iaiA9IHBhcnNldXJpKHVyaSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIG1ha2Ugc3VyZSB3ZSB0cmVhdCBgbG9jYWxob3N0OjgwYCBhbmQgYGxvY2FsaG9zdGAgZXF1YWxseVxuXHRcdFx0XHRcdFx0aWYgKCFvYmoucG9ydCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoL14oaHR0cHx3cykkLy50ZXN0KG9iai5wcm90b2NvbCkpIHtcblx0XHRcdFx0XHRcdFx0XHRvYmoucG9ydCA9ICc4MCc7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoL14oaHR0cHx3cylzJC8udGVzdChvYmoucHJvdG9jb2wpKSB7XG5cdFx0XHRcdFx0XHRcdFx0b2JqLnBvcnQgPSAnNDQzJztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRvYmoucGF0aCA9IG9iai5wYXRoIHx8ICcvJztcblxuXHRcdFx0XHRcdFx0dmFyIGlwdjYgPSBvYmouaG9zdC5pbmRleE9mKCc6JykgIT09IC0xO1xuXHRcdFx0XHRcdFx0dmFyIGhvc3QgPSBpcHY2ID8gJ1snICsgb2JqLmhvc3QgKyAnXScgOiBvYmouaG9zdDtcblxuXHRcdFx0XHRcdFx0Ly8gZGVmaW5lIHVuaXF1ZSBpZFxuXHRcdFx0XHRcdFx0b2JqLmlkID0gb2JqLnByb3RvY29sICsgJzovLycgKyBob3N0ICsgJzonICsgb2JqLnBvcnQ7XG5cdFx0XHRcdFx0XHQvLyBkZWZpbmUgaHJlZlxuXHRcdFx0XHRcdFx0b2JqLmhyZWYgPSBvYmoucHJvdG9jb2wgKyAnOi8vJyArIGhvc3QgKyAobG9jICYmIGxvYy5wb3J0ID09IG9iai5wb3J0ID8gJycgOiAnOicgKyBvYmoucG9ydCk7XG5cblx0XHRcdFx0XHRcdHJldHVybiBvYmo7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwgeyBcImRlYnVnXCI6IDM5LCBcInBhcnNldXJpXCI6IDQ1IH1dLCAzNjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFeHBvc2UgYEJhY2tvZmZgLlxuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gQmFja29mZjtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBJbml0aWFsaXplIGJhY2tvZmYgdGltZXIgd2l0aCBgb3B0c2AuXG4gICAgICpcbiAgICAgKiAtIGBtaW5gIGluaXRpYWwgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgWzEwMF1cbiAgICAgKiAtIGBtYXhgIG1heCB0aW1lb3V0IFsxMDAwMF1cbiAgICAgKiAtIGBqaXR0ZXJgIFswXVxuICAgICAqIC0gYGZhY3RvcmAgWzJdXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gQmFja29mZihvcHRzKSB7XG5cdFx0XHRcdFx0b3B0cyA9IG9wdHMgfHwge307XG5cdFx0XHRcdFx0dGhpcy5tcyA9IG9wdHMubWluIHx8IDEwMDtcblx0XHRcdFx0XHR0aGlzLm1heCA9IG9wdHMubWF4IHx8IDEwMDAwO1xuXHRcdFx0XHRcdHRoaXMuZmFjdG9yID0gb3B0cy5mYWN0b3IgfHwgMjtcblx0XHRcdFx0XHR0aGlzLmppdHRlciA9IG9wdHMuaml0dGVyID4gMCAmJiBvcHRzLmppdHRlciA8PSAxID8gb3B0cy5qaXR0ZXIgOiAwO1xuXHRcdFx0XHRcdHRoaXMuYXR0ZW1wdHMgPSAwO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogUmV0dXJuIHRoZSBiYWNrb2ZmIGR1cmF0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybiB7TnVtYmVyfVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0QmFja29mZi5wcm90b3R5cGUuZHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dmFyIG1zID0gdGhpcy5tcyAqIE1hdGgucG93KHRoaXMuZmFjdG9yLCB0aGlzLmF0dGVtcHRzKyspO1xuXHRcdFx0XHRcdGlmICh0aGlzLmppdHRlcikge1xuXHRcdFx0XHRcdFx0dmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpO1xuXHRcdFx0XHRcdFx0dmFyIGRldmlhdGlvbiA9IE1hdGguZmxvb3IocmFuZCAqIHRoaXMuaml0dGVyICogbXMpO1xuXHRcdFx0XHRcdFx0bXMgPSAoTWF0aC5mbG9vcihyYW5kICogMTApICYgMSkgPT0gMCA/IG1zIC0gZGV2aWF0aW9uIDogbXMgKyBkZXZpYXRpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBNYXRoLm1pbihtcywgdGhpcy5tYXgpIHwgMDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBSZXNldCB0aGUgbnVtYmVyIG9mIGF0dGVtcHRzLlxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRCYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLmF0dGVtcHRzID0gMDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTZXQgdGhlIG1pbmltdW0gZHVyYXRpb25cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0QmFja29mZi5wcm90b3R5cGUuc2V0TWluID0gZnVuY3Rpb24gKG1pbikge1xuXHRcdFx0XHRcdHRoaXMubXMgPSBtaW47XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogU2V0IHRoZSBtYXhpbXVtIGR1cmF0aW9uXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdEJhY2tvZmYucHJvdG90eXBlLnNldE1heCA9IGZ1bmN0aW9uIChtYXgpIHtcblx0XHRcdFx0XHR0aGlzLm1heCA9IG1heDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBTZXQgdGhlIGppdHRlclxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRCYWNrb2ZmLnByb3RvdHlwZS5zZXRKaXR0ZXIgPSBmdW5jdGlvbiAoaml0dGVyKSB7XG5cdFx0XHRcdFx0dGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG5cdFx0XHRcdH07XG5cdFx0XHR9LCB7fV0sIDM3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQvKipcbiAgICAgKiBTbGljZSByZWZlcmVuY2UuXG4gICAgICovXG5cblx0XHRcdFx0dmFyIHNsaWNlID0gW10uc2xpY2U7XG5cblx0XHRcdFx0LyoqXG4gICAgICogQmluZCBgb2JqYCB0byBgZm5gLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9ialxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBmbiBvciBzdHJpbmdcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iaiwgZm4pIHtcblx0XHRcdFx0XHRpZiAoJ3N0cmluZycgPT0gdHlwZW9mIGZuKSBmbiA9IG9ialtmbl07XG5cdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgIT0gdHlwZW9mIGZuKSB0aHJvdyBuZXcgRXJyb3IoJ2JpbmQoKSByZXF1aXJlcyBhIGZ1bmN0aW9uJyk7XG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdFx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHJldHVybiBmbi5hcHBseShvYmosIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cdFx0XHR9LCB7fV0sIDM4OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEV4cG9zZSBgRW1pdHRlcmAuXG4gICAgICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBFbWl0dGVyO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEluaXRpYWxpemUgYSBuZXcgYEVtaXR0ZXJgLlxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBFbWl0dGVyKG9iaikge1xuXHRcdFx0XHRcdGlmIChvYmopIHJldHVybiBtaXhpbihvYmopO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1peGluIHRoZSBlbWl0dGVyIHByb3BlcnRpZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gICAgICogQHJldHVybiB7T2JqZWN0fVxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIG1peGluKG9iaikge1xuXHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBFbWl0dGVyLnByb3RvdHlwZSkge1xuXHRcdFx0XHRcdFx0b2JqW2tleV0gPSBFbWl0dGVyLnByb3RvdHlwZVtrZXldO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gb2JqO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogTGlzdGVuIG9uIHRoZSBnaXZlbiBgZXZlbnRgIHdpdGggYGZuYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHJldHVybiB7RW1pdHRlcn1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9uID0gRW1pdHRlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcblx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cdFx0XHRcdFx0KHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF0gPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdIHx8IFtdKS5wdXNoKGZuKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBBZGRzIGFuIGBldmVudGAgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGludm9rZWQgYSBzaW5nbGVcbiAgICAgKiB0aW1lIHRoZW4gYXV0b21hdGljYWxseSByZW1vdmVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICAgKiBAcmV0dXJuIHtFbWl0dGVyfVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcblx0XHRcdFx0XHRmdW5jdGlvbiBvbigpIHtcblx0XHRcdFx0XHRcdHRoaXMub2ZmKGV2ZW50LCBvbik7XG5cdFx0XHRcdFx0XHRmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG9uLmZuID0gZm47XG5cdFx0XHRcdFx0dGhpcy5vbihldmVudCwgb24pO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgZm9yIGBldmVudGAgb3IgYWxsXG4gICAgICogcmVnaXN0ZXJlZCBjYWxsYmFja3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPSBFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXG5cdFx0XHRcdFx0Ly8gYWxsXG5cdFx0XHRcdFx0aWYgKDAgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0ge307XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBzcGVjaWZpYyBldmVudFxuXHRcdFx0XHRcdHZhciBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuXHRcdFx0XHRcdGlmICghY2FsbGJhY2tzKSByZXR1cm4gdGhpcztcblxuXHRcdFx0XHRcdC8vIHJlbW92ZSBhbGwgaGFuZGxlcnNcblx0XHRcdFx0XHRpZiAoMSA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcblx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIHJlbW92ZSBzcGVjaWZpYyBoYW5kbGVyXG5cdFx0XHRcdFx0dmFyIGNiO1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRjYiA9IGNhbGxiYWNrc1tpXTtcblx0XHRcdFx0XHRcdGlmIChjYiA9PT0gZm4gfHwgY2IuZm4gPT09IGZuKSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBFbWl0IGBldmVudGAgd2l0aCB0aGUgZ2l2ZW4gYXJncy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICAgICAqIEBwYXJhbSB7TWl4ZWR9IC4uLlxuICAgICAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gICAgICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcblx0XHRcdFx0XHR2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSxcblx0XHRcdFx0XHQgICAgY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcblxuXHRcdFx0XHRcdGlmIChjYWxsYmFja3MpIHtcblx0XHRcdFx0XHRcdGNhbGxiYWNrcyA9IGNhbGxiYWNrcy5zbGljZSgwKTtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2tzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFJldHVybiBhcnJheSBvZiBjYWxsYmFja3MgZm9yIGBldmVudGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSB8fCBbXTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDaGVjayBpZiB0aGlzIGVtaXR0ZXIgaGFzIGBldmVudGAgaGFuZGxlcnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhdGhpcy5saXN0ZW5lcnMoZXZlbnQpLmxlbmd0aDtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSwgMzk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsxN11bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHsgXCIuL2RlYnVnXCI6IDQwLCBcImR1cFwiOiAxNyB9XSwgNDA6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsxOF1bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHsgXCJkdXBcIjogMTgsIFwibXNcIjogNDQgfV0sIDQxOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0LypcbiAgICAgICogTW9kdWxlIHJlcXVpcmVtZW50cy5cbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgaXNBcnJheSA9IF9kZXJlcV8oJ2lzYXJyYXknKTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBNb2R1bGUgZXhwb3J0cy5cbiAgICAgICovXG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGhhc0JpbmFyeTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBDaGVja3MgZm9yIGJpbmFyeSBkYXRhLlxuICAgICAgKlxuICAgICAgKiBSaWdodCBub3cgb25seSBCdWZmZXIgYW5kIEFycmF5QnVmZmVyIGFyZSBzdXBwb3J0ZWQuLlxuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge09iamVjdH0gYW55dGhpbmdcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBoYXNCaW5hcnkoZGF0YSkge1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuXHRcdFx0XHRcdFx0XHRpZiAoIW9iaikgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChnbG9iYWwuQnVmZmVyICYmIGdsb2JhbC5CdWZmZXIuaXNCdWZmZXIgJiYgZ2xvYmFsLkJ1ZmZlci5pc0J1ZmZlcihvYmopIHx8IGdsb2JhbC5BcnJheUJ1ZmZlciAmJiBvYmogaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciB8fCBnbG9iYWwuQmxvYiAmJiBvYmogaW5zdGFuY2VvZiBCbG9iIHx8IGdsb2JhbC5GaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmIChpc0FycmF5KG9iaikpIHtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKF9oYXNCaW5hcnkob2JqW2ldKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAob2JqICYmICdvYmplY3QnID09IHR5cGVvZiBvYmopIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBzZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9BdXRvbWF0dGljL2hhcy1iaW5hcnkvcHVsbC80XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9iai50b0pTT04gJiYgJ2Z1bmN0aW9uJyA9PSB0eXBlb2Ygb2JqLnRvSlNPTikge1xuXHRcdFx0XHRcdFx0XHRcdFx0b2JqID0gb2JqLnRvSlNPTigpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBvYmopIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpICYmIF9oYXNCaW5hcnkob2JqW2tleV0pKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIF9oYXNCaW5hcnkoZGF0YSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwgeyBcImlzYXJyYXlcIjogNDMgfV0sIDQyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMjNdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LCB7IFwiZHVwXCI6IDIzIH1dLCA0MzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0YXJndW1lbnRzWzRdWzI0XVswXS5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSwgeyBcImR1cFwiOiAyNCB9XSwgNDQ6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsyNV1bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHsgXCJkdXBcIjogMjUgfV0sIDQ1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMjhdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LCB7IFwiZHVwXCI6IDI4IH1dLCA0NjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcblx0XHRcdFx0XHQvKmdsb2JhbCBCbG9iLEZpbGUqL1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIE1vZHVsZSByZXF1aXJlbWVudHNcbiAgICAgICovXG5cblx0XHRcdFx0XHR2YXIgaXNBcnJheSA9IF9kZXJlcV8oJ2lzYXJyYXknKTtcblx0XHRcdFx0XHR2YXIgaXNCdWYgPSBfZGVyZXFfKCcuL2lzLWJ1ZmZlcicpO1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIFJlcGxhY2VzIGV2ZXJ5IEJ1ZmZlciB8IEFycmF5QnVmZmVyIGluIHBhY2tldCB3aXRoIGEgbnVtYmVyZWQgcGxhY2Vob2xkZXIuXG4gICAgICAqIEFueXRoaW5nIHdpdGggYmxvYnMgb3IgZmlsZXMgc2hvdWxkIGJlIGZlZCB0aHJvdWdoIHJlbW92ZUJsb2JzIGJlZm9yZSBjb21pbmdcbiAgICAgICogaGVyZS5cbiAgICAgICpcbiAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhY2tldCAtIHNvY2tldC5pbyBldmVudCBwYWNrZXRcbiAgICAgICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGRlY29uc3RydWN0ZWQgcGFja2V0IGFuZCBsaXN0IG9mIGJ1ZmZlcnNcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29uc3RydWN0UGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0dmFyIGJ1ZmZlcnMgPSBbXTtcblx0XHRcdFx0XHRcdHZhciBwYWNrZXREYXRhID0gcGFja2V0LmRhdGE7XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdGlmICghZGF0YSkgcmV0dXJuIGRhdGE7XG5cblx0XHRcdFx0XHRcdFx0aWYgKGlzQnVmKGRhdGEpKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHBsYWNlaG9sZGVyID0geyBfcGxhY2Vob2xkZXI6IHRydWUsIG51bTogYnVmZmVycy5sZW5ndGggfTtcblx0XHRcdFx0XHRcdFx0XHRidWZmZXJzLnB1c2goZGF0YSk7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHBsYWNlaG9sZGVyO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGlzQXJyYXkoZGF0YSkpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgbmV3RGF0YSA9IG5ldyBBcnJheShkYXRhLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXdEYXRhW2ldID0gX2RlY29uc3RydWN0UGFja2V0KGRhdGFbaV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gbmV3RGF0YTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICgnb2JqZWN0JyA9PSB0eXBlb2YgZGF0YSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBuZXdEYXRhID0ge307XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIga2V5IGluIGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdG5ld0RhdGFba2V5XSA9IF9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2tleV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gbmV3RGF0YTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHBhY2sgPSBwYWNrZXQ7XG5cdFx0XHRcdFx0XHRwYWNrLmRhdGEgPSBfZGVjb25zdHJ1Y3RQYWNrZXQocGFja2V0RGF0YSk7XG5cdFx0XHRcdFx0XHRwYWNrLmF0dGFjaG1lbnRzID0gYnVmZmVycy5sZW5ndGg7IC8vIG51bWJlciBvZiBiaW5hcnkgJ2F0dGFjaG1lbnRzJ1xuXHRcdFx0XHRcdFx0cmV0dXJuIHsgcGFja2V0OiBwYWNrLCBidWZmZXJzOiBidWZmZXJzIH07XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuICAgICAgKiBSZWNvbnN0cnVjdHMgYSBiaW5hcnkgcGFja2V0IGZyb20gaXRzIHBsYWNlaG9sZGVyIHBhY2tldCBhbmQgYnVmZmVyc1xuICAgICAgKlxuICAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gZXZlbnQgcGFja2V0IHdpdGggcGxhY2Vob2xkZXJzXG4gICAgICAqIEBwYXJhbSB7QXJyYXl9IGJ1ZmZlcnMgLSBiaW5hcnkgYnVmZmVycyB0byBwdXQgaW4gcGxhY2Vob2xkZXIgcG9zaXRpb25zXG4gICAgICAqIEByZXR1cm4ge09iamVjdH0gcmVjb25zdHJ1Y3RlZCBwYWNrZXRcbiAgICAgICogQGFwaSBwdWJsaWNcbiAgICAgICovXG5cblx0XHRcdFx0XHRleHBvcnRzLnJlY29uc3RydWN0UGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCwgYnVmZmVycykge1xuXHRcdFx0XHRcdFx0dmFyIGN1clBsYWNlSG9sZGVyID0gMDtcblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gX3JlY29uc3RydWN0UGFja2V0KGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGRhdGEgJiYgZGF0YS5fcGxhY2Vob2xkZXIpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYnVmID0gYnVmZmVyc1tkYXRhLm51bV07IC8vIGFwcHJvcHJpYXRlIGJ1ZmZlciAoc2hvdWxkIGJlIG5hdHVyYWwgb3JkZXIgYW55d2F5KVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBidWY7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoaXNBcnJheShkYXRhKSkge1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVtpXSA9IF9yZWNvbnN0cnVjdFBhY2tldChkYXRhW2ldKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGF0YSAmJiAnb2JqZWN0JyA9PSB0eXBlb2YgZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhW2tleV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtrZXldKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHBhY2tldC5kYXRhID0gX3JlY29uc3RydWN0UGFja2V0KHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdHBhY2tldC5hdHRhY2htZW50cyA9IHVuZGVmaW5lZDsgLy8gbm8gbG9uZ2VyIHVzZWZ1bFxuXHRcdFx0XHRcdFx0cmV0dXJuIHBhY2tldDtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG4gICAgICAqIEFzeW5jaHJvbm91c2x5IHJlbW92ZXMgQmxvYnMgb3IgRmlsZXMgZnJvbSBkYXRhIHZpYVxuICAgICAgKiBGaWxlUmVhZGVyJ3MgcmVhZEFzQXJyYXlCdWZmZXIgbWV0aG9kLiBVc2VkIGJlZm9yZSBlbmNvZGluZ1xuICAgICAgKiBkYXRhIGFzIG1zZ3BhY2suIENhbGxzIGNhbGxiYWNrIHdpdGggdGhlIGJsb2JsZXNzIGRhdGEuXG4gICAgICAqXG4gICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMucmVtb3ZlQmxvYnMgPSBmdW5jdGlvbiAoZGF0YSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIF9yZW1vdmVCbG9icyhvYmosIGN1cktleSwgY29udGFpbmluZ09iamVjdCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIW9iaikgcmV0dXJuIG9iajtcblxuXHRcdFx0XHRcdFx0XHQvLyBjb252ZXJ0IGFueSBibG9iXG5cdFx0XHRcdFx0XHRcdGlmIChnbG9iYWwuQmxvYiAmJiBvYmogaW5zdGFuY2VvZiBCbG9iIHx8IGdsb2JhbC5GaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpIHtcblx0XHRcdFx0XHRcdFx0XHRwZW5kaW5nQmxvYnMrKztcblxuXHRcdFx0XHRcdFx0XHRcdC8vIGFzeW5jIGZpbGVyZWFkZXJcblx0XHRcdFx0XHRcdFx0XHR2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZVJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyB0aGlzLnJlc3VsdCA9PSBhcnJheWJ1ZmZlclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNvbnRhaW5pbmdPYmplY3QpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGFpbmluZ09iamVjdFtjdXJLZXldID0gdGhpcy5yZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRibG9ibGVzc0RhdGEgPSB0aGlzLnJlc3VsdDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gaWYgbm90aGluZyBwZW5kaW5nIGl0cyBjYWxsYmFjayB0aW1lXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoISAtLXBlbmRpbmdCbG9icykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhibG9ibGVzc0RhdGEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdFx0XHRmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKG9iaik7IC8vIGJsb2IgLT4gYXJyYXlidWZmZXJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChpc0FycmF5KG9iaikpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGhhbmRsZSBhcnJheVxuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0X3JlbW92ZUJsb2JzKG9ialtpXSwgaSwgb2JqKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG9iaiAmJiAnb2JqZWN0JyA9PSB0eXBlb2Ygb2JqICYmICFpc0J1ZihvYmopKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBhbmQgb2JqZWN0XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdF9yZW1vdmVCbG9icyhvYmpba2V5XSwga2V5LCBvYmopO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHBlbmRpbmdCbG9icyA9IDA7XG5cdFx0XHRcdFx0XHR2YXIgYmxvYmxlc3NEYXRhID0gZGF0YTtcblx0XHRcdFx0XHRcdF9yZW1vdmVCbG9icyhibG9ibGVzc0RhdGEpO1xuXHRcdFx0XHRcdFx0aWYgKCFwZW5kaW5nQmxvYnMpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2soYmxvYmxlc3NEYXRhKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pO1xuXHRcdFx0fSwgeyBcIi4vaXMtYnVmZmVyXCI6IDQ4LCBcImlzYXJyYXlcIjogNDMgfV0sIDQ3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG4gICAgICovXG5cblx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnc29ja2V0LmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIganNvbiA9IF9kZXJlcV8oJ2pzb24zJyk7XG5cdFx0XHRcdHZhciBpc0FycmF5ID0gX2RlcmVxXygnaXNhcnJheScpO1xuXHRcdFx0XHR2YXIgRW1pdHRlciA9IF9kZXJlcV8oJ2NvbXBvbmVudC1lbWl0dGVyJyk7XG5cdFx0XHRcdHZhciBiaW5hcnkgPSBfZGVyZXFfKCcuL2JpbmFyeScpO1xuXHRcdFx0XHR2YXIgaXNCdWYgPSBfZGVyZXFfKCcuL2lzLWJ1ZmZlcicpO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFByb3RvY29sIHZlcnNpb24uXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMucHJvdG9jb2wgPSA0O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFBhY2tldCB0eXBlcy5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy50eXBlcyA9IFsnQ09OTkVDVCcsICdESVNDT05ORUNUJywgJ0VWRU5UJywgJ0JJTkFSWV9FVkVOVCcsICdBQ0snLCAnQklOQVJZX0FDSycsICdFUlJPUiddO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIFBhY2tldCB0eXBlIGBjb25uZWN0YC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5DT05ORUNUID0gMDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBQYWNrZXQgdHlwZSBgZGlzY29ubmVjdGAuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuRElTQ09OTkVDVCA9IDE7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGFja2V0IHR5cGUgYGV2ZW50YC5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5FVkVOVCA9IDI7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGFja2V0IHR5cGUgYGFja2AuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuQUNLID0gMztcblxuXHRcdFx0XHQvKipcbiAgICAgKiBQYWNrZXQgdHlwZSBgZXJyb3JgLlxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLkVSUk9SID0gNDtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBQYWNrZXQgdHlwZSAnYmluYXJ5IGV2ZW50J1xuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLkJJTkFSWV9FVkVOVCA9IDU7XG5cblx0XHRcdFx0LyoqXG4gICAgICogUGFja2V0IHR5cGUgYGJpbmFyeSBhY2tgLiBGb3IgYWNrcyB3aXRoIGJpbmFyeSBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAYXBpIHB1YmxpY1xuICAgICAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuQklOQVJZX0FDSyA9IDY7XG5cblx0XHRcdFx0LyoqXG4gICAgICogRW5jb2RlciBjb25zdHJ1Y3Rvci5cbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZXhwb3J0cy5FbmNvZGVyID0gRW5jb2RlcjtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBEZWNvZGVyIGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRleHBvcnRzLkRlY29kZXIgPSBEZWNvZGVyO1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEEgc29ja2V0LmlvIEVuY29kZXIgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gRW5jb2RlcigpIHt9XG5cblx0XHRcdFx0LyoqXG4gICAgICogRW5jb2RlIGEgcGFja2V0IGFzIGEgc2luZ2xlIHN0cmluZyBpZiBub24tYmluYXJ5LCBvciBhcyBhXG4gICAgICogYnVmZmVyIHNlcXVlbmNlLCBkZXBlbmRpbmcgb24gcGFja2V0IHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gcGFja2V0IG9iamVjdFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gZnVuY3Rpb24gdG8gaGFuZGxlIGVuY29kaW5ncyAobGlrZWx5IGVuZ2luZS53cml0ZSlcbiAgICAgKiBAcmV0dXJuIENhbGxzIGNhbGxiYWNrIHdpdGggQXJyYXkgb2YgZW5jb2RpbmdzXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRFbmNvZGVyLnByb3RvdHlwZS5lbmNvZGUgPSBmdW5jdGlvbiAob2JqLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdGRlYnVnKCdlbmNvZGluZyBwYWNrZXQgJWonLCBvYmopO1xuXG5cdFx0XHRcdFx0aWYgKGV4cG9ydHMuQklOQVJZX0VWRU5UID09IG9iai50eXBlIHx8IGV4cG9ydHMuQklOQVJZX0FDSyA9PSBvYmoudHlwZSkge1xuXHRcdFx0XHRcdFx0ZW5jb2RlQXNCaW5hcnkob2JqLCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhciBlbmNvZGluZyA9IGVuY29kZUFzU3RyaW5nKG9iaik7XG5cdFx0XHRcdFx0XHRjYWxsYmFjayhbZW5jb2RpbmddKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG4gICAgICogRW5jb2RlIHBhY2tldCBhcyBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XG4gICAgICogQHJldHVybiB7U3RyaW5nfSBlbmNvZGVkXG4gICAgICogQGFwaSBwcml2YXRlXG4gICAgICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlQXNTdHJpbmcob2JqKSB7XG5cdFx0XHRcdFx0dmFyIHN0ciA9ICcnO1xuXHRcdFx0XHRcdHZhciBuc3AgPSBmYWxzZTtcblxuXHRcdFx0XHRcdC8vIGZpcnN0IGlzIHR5cGVcblx0XHRcdFx0XHRzdHIgKz0gb2JqLnR5cGU7XG5cblx0XHRcdFx0XHQvLyBhdHRhY2htZW50cyBpZiB3ZSBoYXZlIHRoZW1cblx0XHRcdFx0XHRpZiAoZXhwb3J0cy5CSU5BUllfRVZFTlQgPT0gb2JqLnR5cGUgfHwgZXhwb3J0cy5CSU5BUllfQUNLID09IG9iai50eXBlKSB7XG5cdFx0XHRcdFx0XHRzdHIgKz0gb2JqLmF0dGFjaG1lbnRzO1xuXHRcdFx0XHRcdFx0c3RyICs9ICctJztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBpZiB3ZSBoYXZlIGEgbmFtZXNwYWNlIG90aGVyIHRoYW4gYC9gXG5cdFx0XHRcdFx0Ly8gd2UgYXBwZW5kIGl0IGZvbGxvd2VkIGJ5IGEgY29tbWEgYCxgXG5cdFx0XHRcdFx0aWYgKG9iai5uc3AgJiYgJy8nICE9IG9iai5uc3ApIHtcblx0XHRcdFx0XHRcdG5zcCA9IHRydWU7XG5cdFx0XHRcdFx0XHRzdHIgKz0gb2JqLm5zcDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSB0aGUgaWRcblx0XHRcdFx0XHRpZiAobnVsbCAhPSBvYmouaWQpIHtcblx0XHRcdFx0XHRcdGlmIChuc3ApIHtcblx0XHRcdFx0XHRcdFx0c3RyICs9ICcsJztcblx0XHRcdFx0XHRcdFx0bnNwID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRzdHIgKz0gb2JqLmlkO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGpzb24gZGF0YVxuXHRcdFx0XHRcdGlmIChudWxsICE9IG9iai5kYXRhKSB7XG5cdFx0XHRcdFx0XHRpZiAobnNwKSBzdHIgKz0gJywnO1xuXHRcdFx0XHRcdFx0c3RyICs9IGpzb24uc3RyaW5naWZ5KG9iai5kYXRhKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkZWJ1ZygnZW5jb2RlZCAlaiBhcyAlcycsIG9iaiwgc3RyKTtcblx0XHRcdFx0XHRyZXR1cm4gc3RyO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogRW5jb2RlIHBhY2tldCBhcyAnYnVmZmVyIHNlcXVlbmNlJyBieSByZW1vdmluZyBibG9icywgYW5kXG4gICAgICogZGVjb25zdHJ1Y3RpbmcgcGFja2V0IGludG8gb2JqZWN0IHdpdGggcGxhY2Vob2xkZXJzIGFuZFxuICAgICAqIGEgbGlzdCBvZiBidWZmZXJzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhY2tldFxuICAgICAqIEByZXR1cm4ge0J1ZmZlcn0gZW5jb2RlZFxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUFzQmluYXJ5KG9iaiwgY2FsbGJhY2spIHtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHdyaXRlRW5jb2RpbmcoYmxvYmxlc3NEYXRhKSB7XG5cdFx0XHRcdFx0XHR2YXIgZGVjb25zdHJ1Y3Rpb24gPSBiaW5hcnkuZGVjb25zdHJ1Y3RQYWNrZXQoYmxvYmxlc3NEYXRhKTtcblx0XHRcdFx0XHRcdHZhciBwYWNrID0gZW5jb2RlQXNTdHJpbmcoZGVjb25zdHJ1Y3Rpb24ucGFja2V0KTtcblx0XHRcdFx0XHRcdHZhciBidWZmZXJzID0gZGVjb25zdHJ1Y3Rpb24uYnVmZmVycztcblxuXHRcdFx0XHRcdFx0YnVmZmVycy51bnNoaWZ0KHBhY2spOyAvLyBhZGQgcGFja2V0IGluZm8gdG8gYmVnaW5uaW5nIG9mIGRhdGEgbGlzdFxuXHRcdFx0XHRcdFx0Y2FsbGJhY2soYnVmZmVycyk7IC8vIHdyaXRlIGFsbCB0aGUgYnVmZmVyc1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJpbmFyeS5yZW1vdmVCbG9icyhvYmosIHdyaXRlRW5jb2RpbmcpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG4gICAgICogQSBzb2NrZXQuaW8gRGVjb2RlciBpbnN0YW5jZVxuICAgICAqXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBkZWNvZGVyXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBEZWNvZGVyKCkge1xuXHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBNaXggaW4gYEVtaXR0ZXJgIHdpdGggRGVjb2Rlci5cbiAgICAgKi9cblxuXHRcdFx0XHRFbWl0dGVyKERlY29kZXIucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBEZWNvZGVzIGFuIGVjb2RlZCBwYWNrZXQgc3RyaW5nIGludG8gcGFja2V0IEpTT04uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2JqIC0gZW5jb2RlZCBwYWNrZXRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHBhY2tldFxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG5cblx0XHRcdFx0RGVjb2Rlci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG9iaikge1xuXHRcdFx0XHRcdHZhciBwYWNrZXQ7XG5cdFx0XHRcdFx0aWYgKCdzdHJpbmcnID09IHR5cGVvZiBvYmopIHtcblx0XHRcdFx0XHRcdHBhY2tldCA9IGRlY29kZVN0cmluZyhvYmopO1xuXHRcdFx0XHRcdFx0aWYgKGV4cG9ydHMuQklOQVJZX0VWRU5UID09IHBhY2tldC50eXBlIHx8IGV4cG9ydHMuQklOQVJZX0FDSyA9PSBwYWNrZXQudHlwZSkge1xuXHRcdFx0XHRcdFx0XHQvLyBiaW5hcnkgcGFja2V0J3MganNvblxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlY29uc3RydWN0b3IgPSBuZXcgQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIG5vIGF0dGFjaG1lbnRzLCBsYWJlbGVkIGJpbmFyeSBidXQgbm8gYmluYXJ5IGRhdGEgdG8gZm9sbG93XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLnJlY29uc3RydWN0b3IucmVjb25QYWNrLmF0dGFjaG1lbnRzID09PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdkZWNvZGVkJywgcGFja2V0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gbm9uLWJpbmFyeSBmdWxsIHBhY2tldFxuXHRcdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2RlY29kZWQnLCBwYWNrZXQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaXNCdWYob2JqKSB8fCBvYmouYmFzZTY0KSB7XG5cdFx0XHRcdFx0XHQvLyByYXcgYmluYXJ5IGRhdGFcblx0XHRcdFx0XHRcdGlmICghdGhpcy5yZWNvbnN0cnVjdG9yKSB7XG5cdFx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignZ290IGJpbmFyeSBkYXRhIHdoZW4gbm90IHJlY29uc3RydWN0aW5nIGEgcGFja2V0Jyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRwYWNrZXQgPSB0aGlzLnJlY29uc3RydWN0b3IudGFrZUJpbmFyeURhdGEob2JqKTtcblx0XHRcdFx0XHRcdFx0aWYgKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIHJlY2VpdmVkIGZpbmFsIGJ1ZmZlclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdkZWNvZGVkJywgcGFja2V0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gdHlwZTogJyArIG9iaik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIERlY29kZSBhIHBhY2tldCBTdHJpbmcgKEpTT04gZGF0YSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IHBhY2tldFxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGRlY29kZVN0cmluZyhzdHIpIHtcblx0XHRcdFx0XHR2YXIgcCA9IHt9O1xuXHRcdFx0XHRcdHZhciBpID0gMDtcblxuXHRcdFx0XHRcdC8vIGxvb2sgdXAgdHlwZVxuXHRcdFx0XHRcdHAudHlwZSA9IE51bWJlcihzdHIuY2hhckF0KDApKTtcblx0XHRcdFx0XHRpZiAobnVsbCA9PSBleHBvcnRzLnR5cGVzW3AudHlwZV0pIHJldHVybiBlcnJvcigpO1xuXG5cdFx0XHRcdFx0Ly8gbG9vayB1cCBhdHRhY2htZW50cyBpZiB0eXBlIGJpbmFyeVxuXHRcdFx0XHRcdGlmIChleHBvcnRzLkJJTkFSWV9FVkVOVCA9PSBwLnR5cGUgfHwgZXhwb3J0cy5CSU5BUllfQUNLID09IHAudHlwZSkge1xuXHRcdFx0XHRcdFx0dmFyIGJ1ZiA9ICcnO1xuXHRcdFx0XHRcdFx0d2hpbGUgKHN0ci5jaGFyQXQoKytpKSAhPSAnLScpIHtcblx0XHRcdFx0XHRcdFx0YnVmICs9IHN0ci5jaGFyQXQoaSk7XG5cdFx0XHRcdFx0XHRcdGlmIChpID09IHN0ci5sZW5ndGgpIGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKGJ1ZiAhPSBOdW1iZXIoYnVmKSB8fCBzdHIuY2hhckF0KGkpICE9ICctJykge1xuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0lsbGVnYWwgYXR0YWNobWVudHMnKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHAuYXR0YWNobWVudHMgPSBOdW1iZXIoYnVmKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBsb29rIHVwIG5hbWVzcGFjZSAoaWYgYW55KVxuXHRcdFx0XHRcdGlmICgnLycgPT0gc3RyLmNoYXJBdChpICsgMSkpIHtcblx0XHRcdFx0XHRcdHAubnNwID0gJyc7XG5cdFx0XHRcdFx0XHR3aGlsZSAoKytpKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBjID0gc3RyLmNoYXJBdChpKTtcblx0XHRcdFx0XHRcdFx0aWYgKCcsJyA9PSBjKSBicmVhaztcblx0XHRcdFx0XHRcdFx0cC5uc3AgKz0gYztcblx0XHRcdFx0XHRcdFx0aWYgKGkgPT0gc3RyLmxlbmd0aCkgYnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHAubnNwID0gJy8nO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGxvb2sgdXAgaWRcblx0XHRcdFx0XHR2YXIgbmV4dCA9IHN0ci5jaGFyQXQoaSArIDEpO1xuXHRcdFx0XHRcdGlmICgnJyAhPT0gbmV4dCAmJiBOdW1iZXIobmV4dCkgPT0gbmV4dCkge1xuXHRcdFx0XHRcdFx0cC5pZCA9ICcnO1xuXHRcdFx0XHRcdFx0d2hpbGUgKCsraSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgYyA9IHN0ci5jaGFyQXQoaSk7XG5cdFx0XHRcdFx0XHRcdGlmIChudWxsID09IGMgfHwgTnVtYmVyKGMpICE9IGMpIHtcblx0XHRcdFx0XHRcdFx0XHQtLWk7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cC5pZCArPSBzdHIuY2hhckF0KGkpO1xuXHRcdFx0XHRcdFx0XHRpZiAoaSA9PSBzdHIubGVuZ3RoKSBicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHAuaWQgPSBOdW1iZXIocC5pZCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gbG9vayB1cCBqc29uIGRhdGFcblx0XHRcdFx0XHRpZiAoc3RyLmNoYXJBdCgrK2kpKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRwLmRhdGEgPSBqc29uLnBhcnNlKHN0ci5zdWJzdHIoaSkpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyb3IoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkZWJ1ZygnZGVjb2RlZCAlcyBhcyAlaicsIHN0ciwgcCk7XG5cdFx0XHRcdFx0cmV0dXJuIHA7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBEZWFsbG9jYXRlcyBhIHBhcnNlcidzIHJlc291cmNlc1xuICAgICAqXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cblxuXHRcdFx0XHREZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLnJlY29uc3RydWN0b3IpIHtcblx0XHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3Rvci5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuICAgICAqIEEgbWFuYWdlciBvZiBhIGJpbmFyeSBldmVudCdzICdidWZmZXIgc2VxdWVuY2UnLiBTaG91bGRcbiAgICAgKiBiZSBjb25zdHJ1Y3RlZCB3aGVuZXZlciBhIHBhY2tldCBvZiB0eXBlIEJJTkFSWV9FVkVOVCBpc1xuICAgICAqIGRlY29kZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XG4gICAgICogQHJldHVybiB7QmluYXJ5UmVjb25zdHJ1Y3Rvcn0gaW5pdGlhbGl6ZWQgcmVjb25zdHJ1Y3RvclxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIEJpbmFyeVJlY29uc3RydWN0b3IocGFja2V0KSB7XG5cdFx0XHRcdFx0dGhpcy5yZWNvblBhY2sgPSBwYWNrZXQ7XG5cdFx0XHRcdFx0dGhpcy5idWZmZXJzID0gW107XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcbiAgICAgKiBNZXRob2QgdG8gYmUgY2FsbGVkIHdoZW4gYmluYXJ5IGRhdGEgcmVjZWl2ZWQgZnJvbSBjb25uZWN0aW9uXG4gICAgICogYWZ0ZXIgYSBCSU5BUllfRVZFTlQgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtCdWZmZXIgfCBBcnJheUJ1ZmZlcn0gYmluRGF0YSAtIHRoZSByYXcgYmluYXJ5IGRhdGEgcmVjZWl2ZWRcbiAgICAgKiBAcmV0dXJuIHtudWxsIHwgT2JqZWN0fSByZXR1cm5zIG51bGwgaWYgbW9yZSBiaW5hcnkgZGF0YSBpcyBleHBlY3RlZCBvclxuICAgICAqICAgYSByZWNvbnN0cnVjdGVkIHBhY2tldCBvYmplY3QgaWYgYWxsIGJ1ZmZlcnMgaGF2ZSBiZWVuIHJlY2VpdmVkLlxuICAgICAqIEBhcGkgcHJpdmF0ZVxuICAgICAqL1xuXG5cdFx0XHRcdEJpbmFyeVJlY29uc3RydWN0b3IucHJvdG90eXBlLnRha2VCaW5hcnlEYXRhID0gZnVuY3Rpb24gKGJpbkRhdGEpIHtcblx0XHRcdFx0XHR0aGlzLmJ1ZmZlcnMucHVzaChiaW5EYXRhKTtcblx0XHRcdFx0XHRpZiAodGhpcy5idWZmZXJzLmxlbmd0aCA9PSB0aGlzLnJlY29uUGFjay5hdHRhY2htZW50cykge1xuXHRcdFx0XHRcdFx0Ly8gZG9uZSB3aXRoIGJ1ZmZlciBsaXN0XG5cdFx0XHRcdFx0XHR2YXIgcGFja2V0ID0gYmluYXJ5LnJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLCB0aGlzLmJ1ZmZlcnMpO1xuXHRcdFx0XHRcdFx0dGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcGFja2V0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcbiAgICAgKiBDbGVhbnMgdXAgYmluYXJ5IHBhY2tldCByZWNvbnN0cnVjdGlvbiB2YXJpYWJsZXMuXG4gICAgICpcbiAgICAgKiBAYXBpIHByaXZhdGVcbiAgICAgKi9cblxuXHRcdFx0XHRCaW5hcnlSZWNvbnN0cnVjdG9yLnByb3RvdHlwZS5maW5pc2hlZFJlY29uc3RydWN0aW9uID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMucmVjb25QYWNrID0gbnVsbDtcblx0XHRcdFx0XHR0aGlzLmJ1ZmZlcnMgPSBbXTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRmdW5jdGlvbiBlcnJvcihkYXRhKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdHR5cGU6IGV4cG9ydHMuRVJST1IsXG5cdFx0XHRcdFx0XHRkYXRhOiAncGFyc2VyIGVycm9yJ1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH0sIHsgXCIuL2JpbmFyeVwiOiA0NiwgXCIuL2lzLWJ1ZmZlclwiOiA0OCwgXCJjb21wb25lbnQtZW1pdHRlclwiOiA0OSwgXCJkZWJ1Z1wiOiAzOSwgXCJpc2FycmF5XCI6IDQzLCBcImpzb24zXCI6IDUwIH1dLCA0ODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gaXNCdWY7XG5cblx0XHRcdFx0XHQvKipcbiAgICAgICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhIGJ1ZmZlciBvciBhbiBhcnJheWJ1ZmZlci5cbiAgICAgICpcbiAgICAgICogQGFwaSBwcml2YXRlXG4gICAgICAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gaXNCdWYob2JqKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZ2xvYmFsLkJ1ZmZlciAmJiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyKG9iaikgfHwgZ2xvYmFsLkFycmF5QnVmZmVyICYmIG9iaiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KTtcblx0XHRcdH0sIHt9XSwgNDk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsxNV1bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcblx0XHRcdH0sIHsgXCJkdXBcIjogMTUgfV0sIDUwOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qISBKU09OIHYzLjMuMiB8IGh0dHA6Ly9iZXN0aWVqcy5naXRodWIuaW8vanNvbjMgfCBDb3B5cmlnaHQgMjAxMi0yMDE0LCBLaXQgQ2FtYnJpZGdlIHwgaHR0cDovL2tpdC5taXQtbGljZW5zZS5vcmcgKi9cblx0XHRcdFx0XHQ7KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdC8vIERldGVjdCB0aGUgYGRlZmluZWAgZnVuY3Rpb24gZXhwb3NlZCBieSBhc3luY2hyb25vdXMgbW9kdWxlIGxvYWRlcnMuIFRoZVxuXHRcdFx0XHRcdFx0Ly8gc3RyaWN0IGBkZWZpbmVgIGNoZWNrIGlzIG5lY2Vzc2FyeSBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIGByLmpzYC5cblx0XHRcdFx0XHRcdHZhciBpc0xvYWRlciA9IHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kO1xuXG5cdFx0XHRcdFx0XHQvLyBBIHNldCBvZiB0eXBlcyB1c2VkIHRvIGRpc3Rpbmd1aXNoIG9iamVjdHMgZnJvbSBwcmltaXRpdmVzLlxuXHRcdFx0XHRcdFx0dmFyIG9iamVjdFR5cGVzID0ge1xuXHRcdFx0XHRcdFx0XHRcImZ1bmN0aW9uXCI6IHRydWUsXG5cdFx0XHRcdFx0XHRcdFwib2JqZWN0XCI6IHRydWVcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdC8vIERldGVjdCB0aGUgYGV4cG9ydHNgIG9iamVjdCBleHBvc2VkIGJ5IENvbW1vbkpTIGltcGxlbWVudGF0aW9ucy5cblx0XHRcdFx0XHRcdHZhciBmcmVlRXhwb3J0cyA9IG9iamVjdFR5cGVzW3R5cGVvZiBleHBvcnRzXSAmJiBleHBvcnRzICYmICFleHBvcnRzLm5vZGVUeXBlICYmIGV4cG9ydHM7XG5cblx0XHRcdFx0XHRcdC8vIFVzZSB0aGUgYGdsb2JhbGAgb2JqZWN0IGV4cG9zZWQgYnkgTm9kZSAoaW5jbHVkaW5nIEJyb3dzZXJpZnkgdmlhXG5cdFx0XHRcdFx0XHQvLyBgaW5zZXJ0LW1vZHVsZS1nbG9iYWxzYCksIE5hcndoYWwsIGFuZCBSaW5nbyBhcyB0aGUgZGVmYXVsdCBjb250ZXh0LFxuXHRcdFx0XHRcdFx0Ly8gYW5kIHRoZSBgd2luZG93YCBvYmplY3QgaW4gYnJvd3NlcnMuIFJoaW5vIGV4cG9ydHMgYSBgZ2xvYmFsYCBmdW5jdGlvblxuXHRcdFx0XHRcdFx0Ly8gaW5zdGVhZC5cblx0XHRcdFx0XHRcdHZhciByb290ID0gb2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93IHx8IHRoaXMsXG5cdFx0XHRcdFx0XHQgICAgZnJlZUdsb2JhbCA9IGZyZWVFeHBvcnRzICYmIG9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIHR5cGVvZiBnbG9iYWwgPT0gXCJvYmplY3RcIiAmJiBnbG9iYWw7XG5cblx0XHRcdFx0XHRcdGlmIChmcmVlR2xvYmFsICYmIChmcmVlR2xvYmFsW1wiZ2xvYmFsXCJdID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWxbXCJ3aW5kb3dcIl0gPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbFtcInNlbGZcIl0gPT09IGZyZWVHbG9iYWwpKSB7XG5cdFx0XHRcdFx0XHRcdHJvb3QgPSBmcmVlR2xvYmFsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBQdWJsaWM6IEluaXRpYWxpemVzIEpTT04gMyB1c2luZyB0aGUgZ2l2ZW4gYGNvbnRleHRgIG9iamVjdCwgYXR0YWNoaW5nIHRoZVxuXHRcdFx0XHRcdFx0Ly8gYHN0cmluZ2lmeWAgYW5kIGBwYXJzZWAgZnVuY3Rpb25zIHRvIHRoZSBzcGVjaWZpZWQgYGV4cG9ydHNgIG9iamVjdC5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHJ1bkluQ29udGV4dChjb250ZXh0LCBleHBvcnRzKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRleHQgfHwgKGNvbnRleHQgPSByb290W1wiT2JqZWN0XCJdKCkpO1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzIHx8IChleHBvcnRzID0gcm9vdFtcIk9iamVjdFwiXSgpKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBOYXRpdmUgY29uc3RydWN0b3IgYWxpYXNlcy5cblx0XHRcdFx0XHRcdFx0dmFyIE51bWJlciA9IGNvbnRleHRbXCJOdW1iZXJcIl0gfHwgcm9vdFtcIk51bWJlclwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIFN0cmluZyA9IGNvbnRleHRbXCJTdHJpbmdcIl0gfHwgcm9vdFtcIlN0cmluZ1wiXSxcblx0XHRcdFx0XHRcdFx0ICAgIE9iamVjdCA9IGNvbnRleHRbXCJPYmplY3RcIl0gfHwgcm9vdFtcIk9iamVjdFwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIERhdGUgPSBjb250ZXh0W1wiRGF0ZVwiXSB8fCByb290W1wiRGF0ZVwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIFN5bnRheEVycm9yID0gY29udGV4dFtcIlN5bnRheEVycm9yXCJdIHx8IHJvb3RbXCJTeW50YXhFcnJvclwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIFR5cGVFcnJvciA9IGNvbnRleHRbXCJUeXBlRXJyb3JcIl0gfHwgcm9vdFtcIlR5cGVFcnJvclwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIE1hdGggPSBjb250ZXh0W1wiTWF0aFwiXSB8fCByb290W1wiTWF0aFwiXSxcblx0XHRcdFx0XHRcdFx0ICAgIG5hdGl2ZUpTT04gPSBjb250ZXh0W1wiSlNPTlwiXSB8fCByb290W1wiSlNPTlwiXTtcblxuXHRcdFx0XHRcdFx0XHQvLyBEZWxlZ2F0ZSB0byB0aGUgbmF0aXZlIGBzdHJpbmdpZnlgIGFuZCBgcGFyc2VgIGltcGxlbWVudGF0aW9ucy5cblx0XHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBuYXRpdmVKU09OID09IFwib2JqZWN0XCIgJiYgbmF0aXZlSlNPTikge1xuXHRcdFx0XHRcdFx0XHRcdGV4cG9ydHMuc3RyaW5naWZ5ID0gbmF0aXZlSlNPTi5zdHJpbmdpZnk7XG5cdFx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5wYXJzZSA9IG5hdGl2ZUpTT04ucGFyc2U7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyBDb252ZW5pZW5jZSBhbGlhc2VzLlxuXHRcdFx0XHRcdFx0XHR2YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuXHRcdFx0XHRcdFx0XHQgICAgZ2V0Q2xhc3MgPSBvYmplY3RQcm90by50b1N0cmluZyxcblx0XHRcdFx0XHRcdFx0ICAgIGlzUHJvcGVydHksXG5cdFx0XHRcdFx0XHRcdCAgICBmb3JFYWNoLFxuXHRcdFx0XHRcdFx0XHQgICAgdW5kZWY7XG5cblx0XHRcdFx0XHRcdFx0Ly8gVGVzdCB0aGUgYERhdGUjZ2V0VVRDKmAgbWV0aG9kcy4gQmFzZWQgb24gd29yayBieSBAWWFmZmxlLlxuXHRcdFx0XHRcdFx0XHR2YXIgaXNFeHRlbmRlZCA9IG5ldyBEYXRlKC0zNTA5ODI3MzM0NTczMjkyKTtcblx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYGdldFVUQ0Z1bGxZZWFyYCwgYE1vbnRoYCwgYW5kIGBEYXRlYCBtZXRob2RzIHJldHVybiBub25zZW5zaWNhbFxuXHRcdFx0XHRcdFx0XHRcdC8vIHJlc3VsdHMgZm9yIGNlcnRhaW4gZGF0ZXMgaW4gT3BlcmEgPj0gMTAuNTMuXG5cdFx0XHRcdFx0XHRcdFx0aXNFeHRlbmRlZCA9IGlzRXh0ZW5kZWQuZ2V0VVRDRnVsbFllYXIoKSA9PSAtMTA5MjUyICYmIGlzRXh0ZW5kZWQuZ2V0VVRDTW9udGgoKSA9PT0gMCAmJiBpc0V4dGVuZGVkLmdldFVUQ0RhdGUoKSA9PT0gMSAmJlxuXHRcdFx0XHRcdFx0XHRcdC8vIFNhZmFyaSA8IDIuMC4yIHN0b3JlcyB0aGUgaW50ZXJuYWwgbWlsbGlzZWNvbmQgdGltZSB2YWx1ZSBjb3JyZWN0bHksXG5cdFx0XHRcdFx0XHRcdFx0Ly8gYnV0IGNsaXBzIHRoZSB2YWx1ZXMgcmV0dXJuZWQgYnkgdGhlIGRhdGUgbWV0aG9kcyB0byB0aGUgcmFuZ2Ugb2Zcblx0XHRcdFx0XHRcdFx0XHQvLyBzaWduZWQgMzItYml0IGludGVnZXJzIChbLTIgKiogMzEsIDIgKiogMzEgLSAxXSkuXG5cdFx0XHRcdFx0XHRcdFx0aXNFeHRlbmRlZC5nZXRVVENIb3VycygpID09IDEwICYmIGlzRXh0ZW5kZWQuZ2V0VVRDTWludXRlcygpID09IDM3ICYmIGlzRXh0ZW5kZWQuZ2V0VVRDU2Vjb25kcygpID09IDYgJiYgaXNFeHRlbmRlZC5nZXRVVENNaWxsaXNlY29uZHMoKSA9PSA3MDg7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblxuXHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBuYXRpdmUgYEpTT04uc3RyaW5naWZ5YCBhbmQgYHBhcnNlYFxuXHRcdFx0XHRcdFx0XHQvLyBpbXBsZW1lbnRhdGlvbnMgYXJlIHNwZWMtY29tcGxpYW50LiBCYXNlZCBvbiB3b3JrIGJ5IEtlbiBTbnlkZXIuXG5cdFx0XHRcdFx0XHRcdGZ1bmN0aW9uIGhhcyhuYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGhhc1tuYW1lXSAhPT0gdW5kZWYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFJldHVybiBjYWNoZWQgZmVhdHVyZSB0ZXN0IHJlc3VsdC5cblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBoYXNbbmFtZV07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHZhciBpc1N1cHBvcnRlZDtcblx0XHRcdFx0XHRcdFx0XHRpZiAobmFtZSA9PSBcImJ1Zy1zdHJpbmctY2hhci1pbmRleFwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJRSA8PSA3IGRvZXNuJ3Qgc3VwcG9ydCBhY2Nlc3Npbmcgc3RyaW5nIGNoYXJhY3RlcnMgdXNpbmcgc3F1YXJlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBicmFja2V0IG5vdGF0aW9uLiBJRSA4IG9ubHkgc3VwcG9ydHMgdGhpcyBmb3IgcHJpbWl0aXZlcy5cblx0XHRcdFx0XHRcdFx0XHRcdGlzU3VwcG9ydGVkID0gXCJhXCJbMF0gIT0gXCJhXCI7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChuYW1lID09IFwianNvblwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbmRpY2F0ZXMgd2hldGhlciBib3RoIGBKU09OLnN0cmluZ2lmeWAgYW5kIGBKU09OLnBhcnNlYCBhcmVcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHN1cHBvcnRlZC5cblx0XHRcdFx0XHRcdFx0XHRcdGlzU3VwcG9ydGVkID0gaGFzKFwianNvbi1zdHJpbmdpZnlcIikgJiYgaGFzKFwianNvbi1wYXJzZVwiKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlLFxuXHRcdFx0XHRcdFx0XHRcdFx0ICAgIHNlcmlhbGl6ZWQgPSBcIntcXFwiYVxcXCI6WzEsdHJ1ZSxmYWxzZSxudWxsLFxcXCJcXFxcdTAwMDBcXFxcYlxcXFxuXFxcXGZcXFxcclxcXFx0XFxcIl19XCI7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBUZXN0IGBKU09OLnN0cmluZ2lmeWAuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAobmFtZSA9PSBcImpzb24tc3RyaW5naWZ5XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHN0cmluZ2lmeSA9IGV4cG9ydHMuc3RyaW5naWZ5LFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQgICAgc3RyaW5naWZ5U3VwcG9ydGVkID0gdHlwZW9mIHN0cmluZ2lmeSA9PSBcImZ1bmN0aW9uXCIgJiYgaXNFeHRlbmRlZDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHN0cmluZ2lmeVN1cHBvcnRlZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgdGVzdCBmdW5jdGlvbiBvYmplY3Qgd2l0aCBhIGN1c3RvbSBgdG9KU09OYCBtZXRob2QuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0KHZhbHVlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSkudG9KU09OID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeVN1cHBvcnRlZCA9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGaXJlZm94IDMuMWIxIGFuZCBiMiBzZXJpYWxpemUgc3RyaW5nLCBudW1iZXIsIGFuZCBib29sZWFuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwcmltaXRpdmVzIGFzIG9iamVjdCBsaXRlcmFscy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeSgwKSA9PT0gXCIwXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxLCBiMiwgYW5kIEpTT04gMiBzZXJpYWxpemUgd3JhcHBlZCBwcmltaXRpdmVzIGFzIG9iamVjdFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IE51bWJlcigpKSA9PT0gXCIwXCIgJiYgc3RyaW5naWZ5KG5ldyBTdHJpbmcoKSkgPT0gJ1wiXCInICYmXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiAzLjFiMSwgMiB0aHJvdyBhbiBlcnJvciBpZiB0aGUgdmFsdWUgaXMgYG51bGxgLCBgdW5kZWZpbmVkYCwgb3Jcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRvZXMgbm90IGRlZmluZSBhIGNhbm9uaWNhbCBKU09OIHJlcHJlc2VudGF0aW9uICh0aGlzIGFwcGxpZXMgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIG9iamVjdHMgd2l0aCBgdG9KU09OYCBwcm9wZXJ0aWVzIGFzIHdlbGwsICp1bmxlc3MqIHRoZXkgYXJlIG5lc3RlZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gd2l0aGluIGFuIG9iamVjdCBvciBhcnJheSkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkoZ2V0Q2xhc3MpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSUUgOCBzZXJpYWxpemVzIGB1bmRlZmluZWRgIGFzIGBcInVuZGVmaW5lZFwiYC4gU2FmYXJpIDw9IDUuMS43IGFuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRkYgMy4xYjMgcGFzcyB0aGlzIHRlc3QuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkodW5kZWYpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2FmYXJpIDw9IDUuMS43IGFuZCBGRiAzLjFiMyB0aHJvdyBgRXJyb3JgcyBhbmQgYFR5cGVFcnJvcmBzLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gcmVzcGVjdGl2ZWx5LCBpZiB0aGUgdmFsdWUgaXMgb21pdHRlZCBlbnRpcmVseS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeSgpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRkYgMy4xYjEsIDIgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIG5vdCBhIG51bWJlcixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHN0cmluZywgYXJyYXksIG9iamVjdCwgQm9vbGVhbiwgb3IgYG51bGxgIGxpdGVyYWwuIFRoaXMgYXBwbGllcyB0b1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gb2JqZWN0cyB3aXRoIGN1c3RvbSBgdG9KU09OYCBtZXRob2RzIGFzIHdlbGwsIHVubGVzcyB0aGV5IGFyZSBuZXN0ZWRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGluc2lkZSBvYmplY3Qgb3IgYXJyYXkgbGl0ZXJhbHMuIFlVSSAzLjAuMGIxIGlnbm9yZXMgY3VzdG9tIGB0b0pTT05gXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBtZXRob2RzIGVudGlyZWx5LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KHZhbHVlKSA9PT0gXCIxXCIgJiYgc3RyaW5naWZ5KFt2YWx1ZV0pID09IFwiWzFdXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFByb3RvdHlwZSA8PSAxLjYuMSBzZXJpYWxpemVzIGBbdW5kZWZpbmVkXWAgYXMgYFwiW11cImAgaW5zdGVhZCBvZlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFwiW251bGxdXCJgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KFt1bmRlZl0pID09IFwiW251bGxdXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFlVSSAzLjAuMGIxIGZhaWxzIHRvIHNlcmlhbGl6ZSBgbnVsbGAgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobnVsbCkgPT0gXCJudWxsXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxLCAyIGhhbHRzIHNlcmlhbGl6YXRpb24gaWYgYW4gYXJyYXkgY29udGFpbnMgYSBmdW5jdGlvbjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBbMSwgdHJ1ZSwgZ2V0Q2xhc3MsIDFdYCBzZXJpYWxpemVzIGFzIFwiWzEsdHJ1ZSxdLFwiLiBGRiAzLjFiM1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZWxpZGVzIG5vbi1KU09OIHZhbHVlcyBmcm9tIG9iamVjdHMgYW5kIGFycmF5cywgdW5sZXNzIHRoZXlcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlZmluZSBjdXN0b20gYHRvSlNPTmAgbWV0aG9kcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShbdW5kZWYsIGdldENsYXNzLCBudWxsXSkgPT0gXCJbbnVsbCxudWxsLG51bGxdXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNpbXBsZSBzZXJpYWxpemF0aW9uIHRlc3QuIEZGIDMuMWIxIHVzZXMgVW5pY29kZSBlc2NhcGUgc2VxdWVuY2VzXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB3aGVyZSBjaGFyYWN0ZXIgZXNjYXBlIGNvZGVzIGFyZSBleHBlY3RlZCAoZS5nLiwgYFxcYmAgPT4gYFxcdTAwMDhgKS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeSh7IFwiYVwiOiBbdmFsdWUsIHRydWUsIGZhbHNlLCBudWxsLCBcIlxceDAwXFxiXFxuXFxmXFxyXFx0XCJdIH0pID09IHNlcmlhbGl6ZWQgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxIGFuZCBiMiBpZ25vcmUgdGhlIGBmaWx0ZXJgIGFuZCBgd2lkdGhgIGFyZ3VtZW50cy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShudWxsLCB2YWx1ZSkgPT09IFwiMVwiICYmIHN0cmluZ2lmeShbMSwgMl0sIG51bGwsIDEpID09IFwiW1xcbiAxLFxcbiAyXFxuXVwiICYmXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBKU09OIDIsIFByb3RvdHlwZSA8PSAxLjcsIGFuZCBvbGRlciBXZWJLaXQgYnVpbGRzIGluY29ycmVjdGx5XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzZXJpYWxpemUgZXh0ZW5kZWQgeWVhcnMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IERhdGUoLTguNjRlMTUpKSA9PSAnXCItMjcxODIxLTA0LTIwVDAwOjAwOjAwLjAwMFpcIicgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBtaWxsaXNlY29uZHMgYXJlIG9wdGlvbmFsIGluIEVTIDUsIGJ1dCByZXF1aXJlZCBpbiA1LjEuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IERhdGUoOC42NGUxNSkpID09ICdcIisyNzU3NjAtMDktMTNUMDA6MDA6MDAuMDAwWlwiJyAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRmlyZWZveCA8PSAxMS4wIGluY29ycmVjdGx5IHNlcmlhbGl6ZXMgeWVhcnMgcHJpb3IgdG8gMCBhcyBuZWdhdGl2ZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZm91ci1kaWdpdCB5ZWFycyBpbnN0ZWFkIG9mIHNpeC1kaWdpdCB5ZWFycy4gQ3JlZGl0czogQFlhZmZsZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShuZXcgRGF0ZSgtNjIxOTg3NTUyZTUpKSA9PSAnXCItMDAwMDAxLTAxLTAxVDAwOjAwOjAwLjAwMFpcIicgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNhZmFyaSA8PSA1LjEuNSBhbmQgT3BlcmEgPj0gMTAuNTMgaW5jb3JyZWN0bHkgc2VyaWFsaXplIG1pbGxpc2Vjb25kXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB2YWx1ZXMgbGVzcyB0aGFuIDEwMDAuIENyZWRpdHM6IEBZYWZmbGUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IERhdGUoLTEpKSA9PSAnXCIxOTY5LTEyLTMxVDIzOjU5OjU5Ljk5OVpcIic7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZXhjZXB0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnlTdXBwb3J0ZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aXNTdXBwb3J0ZWQgPSBzdHJpbmdpZnlTdXBwb3J0ZWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBUZXN0IGBKU09OLnBhcnNlYC5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChuYW1lID09IFwianNvbi1wYXJzZVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBwYXJzZSA9IGV4cG9ydHMucGFyc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgcGFyc2UgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxLCBiMiB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhIGJhcmUgbGl0ZXJhbCBpcyBwcm92aWRlZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENvbmZvcm1pbmcgaW1wbGVtZW50YXRpb25zIHNob3VsZCBhbHNvIGNvZXJjZSB0aGUgaW5pdGlhbCBhcmd1bWVudCB0b1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYSBzdHJpbmcgcHJpb3IgdG8gcGFyc2luZy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChwYXJzZShcIjBcIikgPT09IDAgJiYgIXBhcnNlKGZhbHNlKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTaW1wbGUgcGFyc2luZyB0ZXN0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IHBhcnNlKHNlcmlhbGl6ZWQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgcGFyc2VTdXBwb3J0ZWQgPSB2YWx1ZVtcImFcIl0ubGVuZ3RoID09IDUgJiYgdmFsdWVbXCJhXCJdWzBdID09PSAxO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocGFyc2VTdXBwb3J0ZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2FmYXJpIDw9IDUuMS4yIGFuZCBGRiAzLjFiMSBhbGxvdyB1bmVzY2FwZWQgdGFicyBpbiBzdHJpbmdzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cGFyc2VTdXBwb3J0ZWQgPSAhcGFyc2UoJ1wiXFx0XCInKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHt9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiA0LjAgYW5kIDQuMC4xIGFsbG93IGxlYWRpbmcgYCtgIHNpZ25zIGFuZCBsZWFkaW5nXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlY2ltYWwgcG9pbnRzLiBGRiA0LjAsIDQuMC4xLCBhbmQgSUUgOS0xMCBhbHNvIGFsbG93XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNlcnRhaW4gb2N0YWwgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gcGFyc2UoXCIwMVwiKSAhPT0gMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiA0LjAsIDQuMC4xLCBhbmQgUmhpbm8gMS43UjMtUjQgYWxsb3cgdHJhaWxpbmcgZGVjaW1hbFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwb2ludHMuIFRoZXNlIGVudmlyb25tZW50cywgYWxvbmcgd2l0aCBGRiAzLjFiMSBhbmQgMixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYWxzbyBhbGxvdyB0cmFpbGluZyBjb21tYXMgaW4gSlNPTiBvYmplY3RzIGFuZCBhcnJheXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gcGFyc2UoXCIxLlwiKSAhPT0gMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlzU3VwcG9ydGVkID0gcGFyc2VTdXBwb3J0ZWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBoYXNbbmFtZV0gPSAhIWlzU3VwcG9ydGVkO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKCFoYXMoXCJqc29uXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gQ29tbW9uIGBbW0NsYXNzXV1gIG5hbWUgYWxpYXNlcy5cblx0XHRcdFx0XHRcdFx0XHR2YXIgZnVuY3Rpb25DbGFzcyA9IFwiW29iamVjdCBGdW5jdGlvbl1cIixcblx0XHRcdFx0XHRcdFx0XHQgICAgZGF0ZUNsYXNzID0gXCJbb2JqZWN0IERhdGVdXCIsXG5cdFx0XHRcdFx0XHRcdFx0ICAgIG51bWJlckNsYXNzID0gXCJbb2JqZWN0IE51bWJlcl1cIixcblx0XHRcdFx0XHRcdFx0XHQgICAgc3RyaW5nQ2xhc3MgPSBcIltvYmplY3QgU3RyaW5nXVwiLFxuXHRcdFx0XHRcdFx0XHRcdCAgICBhcnJheUNsYXNzID0gXCJbb2JqZWN0IEFycmF5XVwiLFxuXHRcdFx0XHRcdFx0XHRcdCAgICBib29sZWFuQ2xhc3MgPSBcIltvYmplY3QgQm9vbGVhbl1cIjtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIERldGVjdCBpbmNvbXBsZXRlIHN1cHBvcnQgZm9yIGFjY2Vzc2luZyBzdHJpbmcgY2hhcmFjdGVycyBieSBpbmRleC5cblx0XHRcdFx0XHRcdFx0XHR2YXIgY2hhckluZGV4QnVnZ3kgPSBoYXMoXCJidWctc3RyaW5nLWNoYXItaW5kZXhcIik7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBEZWZpbmUgYWRkaXRpb25hbCB1dGlsaXR5IG1ldGhvZHMgaWYgdGhlIGBEYXRlYCBtZXRob2RzIGFyZSBidWdneS5cblx0XHRcdFx0XHRcdFx0XHRpZiAoIWlzRXh0ZW5kZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBmbG9vciA9IE1hdGguZmxvb3I7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBBIG1hcHBpbmcgYmV0d2VlbiB0aGUgbW9udGhzIG9mIHRoZSB5ZWFyIGFuZCB0aGUgbnVtYmVyIG9mIGRheXMgYmV0d2VlblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSmFudWFyeSAxc3QgYW5kIHRoZSBmaXJzdCBvZiB0aGUgcmVzcGVjdGl2ZSBtb250aC5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBNb250aHMgPSBbMCwgMzEsIDU5LCA5MCwgMTIwLCAxNTEsIDE4MSwgMjEyLCAyNDMsIDI3MywgMzA0LCAzMzRdO1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBkYXlzIGJldHdlZW4gdGhlIFVuaXggZXBvY2ggYW5kIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gZmlyc3QgZGF5IG9mIHRoZSBnaXZlbiBtb250aC5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBnZXREYXkgPSBmdW5jdGlvbiBnZXREYXkoeWVhciwgbW9udGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIE1vbnRoc1ttb250aF0gKyAzNjUgKiAoeWVhciAtIDE5NzApICsgZmxvb3IoKHllYXIgLSAxOTY5ICsgKG1vbnRoID0gKyhtb250aCA+IDEpKSkgLyA0KSAtIGZsb29yKCh5ZWFyIC0gMTkwMSArIG1vbnRoKSAvIDEwMCkgKyBmbG9vcigoeWVhciAtIDE2MDEgKyBtb250aCkgLyA0MDApO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogRGV0ZXJtaW5lcyBpZiBhIHByb3BlcnR5IGlzIGEgZGlyZWN0IHByb3BlcnR5IG9mIHRoZSBnaXZlblxuXHRcdFx0XHRcdFx0XHRcdC8vIG9iamVjdC4gRGVsZWdhdGVzIHRvIHRoZSBuYXRpdmUgYE9iamVjdCNoYXNPd25Qcm9wZXJ0eWAgbWV0aG9kLlxuXHRcdFx0XHRcdFx0XHRcdGlmICghKGlzUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlzUHJvcGVydHkgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIG1lbWJlcnMgPSB7fSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGNvbnN0cnVjdG9yO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoKG1lbWJlcnMuX19wcm90b19fID0gbnVsbCwgbWVtYmVycy5fX3Byb3RvX18gPSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlICpwcm90byogcHJvcGVydHkgY2Fubm90IGJlIHNldCBtdWx0aXBsZSB0aW1lcyBpbiByZWNlbnRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB2ZXJzaW9ucyBvZiBGaXJlZm94IGFuZCBTZWFNb25rZXkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XCJ0b1N0cmluZ1wiOiAxXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0sIG1lbWJlcnMpLnRvU3RyaW5nICE9IGdldENsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2FmYXJpIDw9IDIuMC4zIGRvZXNuJ3QgaW1wbGVtZW50IGBPYmplY3QjaGFzT3duUHJvcGVydHlgLCBidXRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzdXBwb3J0cyB0aGUgbXV0YWJsZSAqcHJvdG8qIHByb3BlcnR5LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlzUHJvcGVydHkgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENhcHR1cmUgYW5kIGJyZWFrIHRoZSBvYmplY3QncyBwcm90b3R5cGUgY2hhaW4gKHNlZSBzZWN0aW9uIDguNi4yXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBvZiB0aGUgRVMgNS4xIHNwZWMpLiBUaGUgcGFyZW50aGVzaXplZCBleHByZXNzaW9uIHByZXZlbnRzIGFuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB1bnNhZmUgdHJhbnNmb3JtYXRpb24gYnkgdGhlIENsb3N1cmUgQ29tcGlsZXIuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgb3JpZ2luYWwgPSB0aGlzLl9fcHJvdG9fXyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgICByZXN1bHQgPSAocHJvcGVydHkgaW4gKHRoaXMuX19wcm90b19fID0gbnVsbCwgdGhpcykpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgcHJvdG90eXBlIGNoYWluLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5fX3Byb3RvX18gPSBvcmlnaW5hbDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDYXB0dXJlIGEgcmVmZXJlbmNlIHRvIHRoZSB0b3AtbGV2ZWwgYE9iamVjdGAgY29uc3RydWN0b3IuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3RydWN0b3IgPSBtZW1iZXJzLmNvbnN0cnVjdG9yO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVzZSB0aGUgYGNvbnN0cnVjdG9yYCBwcm9wZXJ0eSB0byBzaW11bGF0ZSBgT2JqZWN0I2hhc093blByb3BlcnR5YCBpblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIG90aGVyIGVudmlyb25tZW50cy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpc1Byb3BlcnR5ID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgcGFyZW50ID0gKHRoaXMuY29uc3RydWN0b3IgfHwgY29uc3RydWN0b3IpLnByb3RvdHlwZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBwcm9wZXJ0eSBpbiB0aGlzICYmICEocHJvcGVydHkgaW4gcGFyZW50ICYmIHRoaXNbcHJvcGVydHldID09PSBwYXJlbnRbcHJvcGVydHldKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG1lbWJlcnMgPSBudWxsO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gaXNQcm9wZXJ0eS5jYWxsKHRoaXMsIHByb3BlcnR5KTtcblx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IE5vcm1hbGl6ZXMgdGhlIGBmb3IuLi5pbmAgaXRlcmF0aW9uIGFsZ29yaXRobSBhY3Jvc3Ncblx0XHRcdFx0XHRcdFx0XHQvLyBlbnZpcm9ubWVudHMuIEVhY2ggZW51bWVyYXRlZCBrZXkgaXMgeWllbGRlZCB0byBhIGBjYWxsYmFja2AgZnVuY3Rpb24uXG5cdFx0XHRcdFx0XHRcdFx0Zm9yRWFjaCA9IGZ1bmN0aW9uIChvYmplY3QsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgc2l6ZSA9IDAsXG5cdFx0XHRcdFx0XHRcdFx0XHQgICAgUHJvcGVydGllcyxcblx0XHRcdFx0XHRcdFx0XHRcdCAgICBtZW1iZXJzLFxuXHRcdFx0XHRcdFx0XHRcdFx0ICAgIHByb3BlcnR5O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBUZXN0cyBmb3IgYnVncyBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudCdzIGBmb3IuLi5pbmAgYWxnb3JpdGhtLiBUaGVcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGB2YWx1ZU9mYCBwcm9wZXJ0eSBpbmhlcml0cyB0aGUgbm9uLWVudW1lcmFibGUgZmxhZyBmcm9tXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBgT2JqZWN0LnByb3RvdHlwZWAgaW4gb2xkZXIgdmVyc2lvbnMgb2YgSUUsIE5ldHNjYXBlLCBhbmQgTW96aWxsYS5cblx0XHRcdFx0XHRcdFx0XHRcdChQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnZhbHVlT2YgPSAwO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSkucHJvdG90eXBlLnZhbHVlT2YgPSAwO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJdGVyYXRlIG92ZXIgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIGBQcm9wZXJ0aWVzYCBjbGFzcy5cblx0XHRcdFx0XHRcdFx0XHRcdG1lbWJlcnMgPSBuZXcgUHJvcGVydGllcygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChwcm9wZXJ0eSBpbiBtZW1iZXJzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElnbm9yZSBhbGwgcHJvcGVydGllcyBpbmhlcml0ZWQgZnJvbSBgT2JqZWN0LnByb3RvdHlwZWAuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChpc1Byb3BlcnR5LmNhbGwobWVtYmVycywgcHJvcGVydHkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2l6ZSsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRQcm9wZXJ0aWVzID0gbWVtYmVycyA9IG51bGw7XG5cblx0XHRcdFx0XHRcdFx0XHRcdC8vIE5vcm1hbGl6ZSB0aGUgaXRlcmF0aW9uIGFsZ29yaXRobS5cblx0XHRcdFx0XHRcdFx0XHRcdGlmICghc2l6ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIGxpc3Qgb2Ygbm9uLWVudW1lcmFibGUgcHJvcGVydGllcyBpbmhlcml0ZWQgZnJvbSBgT2JqZWN0LnByb3RvdHlwZWAuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG1lbWJlcnMgPSBbXCJ2YWx1ZU9mXCIsIFwidG9TdHJpbmdcIiwgXCJ0b0xvY2FsZVN0cmluZ1wiLCBcInByb3BlcnR5SXNFbnVtZXJhYmxlXCIsIFwiaXNQcm90b3R5cGVPZlwiLCBcImhhc093blByb3BlcnR5XCIsIFwiY29uc3RydWN0b3JcIl07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElFIDw9IDgsIE1vemlsbGEgMS4wLCBhbmQgTmV0c2NhcGUgNi4yIGlnbm9yZSBzaGFkb3dlZCBub24tZW51bWVyYWJsZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwcm9wZXJ0aWVzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmb3JFYWNoID0gZnVuY3Rpb24gKG9iamVjdCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgaXNGdW5jdGlvbiA9IGdldENsYXNzLmNhbGwob2JqZWN0KSA9PSBmdW5jdGlvbkNsYXNzLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgICBwcm9wZXJ0eSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICAgbGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBoYXNQcm9wZXJ0eSA9ICFpc0Z1bmN0aW9uICYmIHR5cGVvZiBvYmplY3QuY29uc3RydWN0b3IgIT0gXCJmdW5jdGlvblwiICYmIG9iamVjdFR5cGVzW3R5cGVvZiBvYmplY3QuaGFzT3duUHJvcGVydHldICYmIG9iamVjdC5oYXNPd25Qcm9wZXJ0eSB8fCBpc1Byb3BlcnR5O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAocHJvcGVydHkgaW4gb2JqZWN0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBHZWNrbyA8PSAxLjAgZW51bWVyYXRlcyB0aGUgYHByb3RvdHlwZWAgcHJvcGVydHkgb2YgZnVuY3Rpb25zIHVuZGVyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjZXJ0YWluIGNvbmRpdGlvbnM7IElFIGRvZXMgbm90LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCEoaXNGdW5jdGlvbiAmJiBwcm9wZXJ0eSA9PSBcInByb3RvdHlwZVwiKSAmJiBoYXNQcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhbGxiYWNrKHByb3BlcnR5KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTWFudWFsbHkgaW52b2tlIHRoZSBjYWxsYmFjayBmb3IgZWFjaCBub24tZW51bWVyYWJsZSBwcm9wZXJ0eS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGxlbmd0aCA9IG1lbWJlcnMubGVuZ3RoOyBwcm9wZXJ0eSA9IG1lbWJlcnNbLS1sZW5ndGhdOyBoYXNQcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpICYmIGNhbGxiYWNrKHByb3BlcnR5KSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHNpemUgPT0gMikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTYWZhcmkgPD0gMi4wLjQgZW51bWVyYXRlcyBzaGFkb3dlZCBwcm9wZXJ0aWVzIHR3aWNlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmb3JFYWNoID0gZnVuY3Rpb24gKG9iamVjdCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDcmVhdGUgYSBzZXQgb2YgaXRlcmF0ZWQgcHJvcGVydGllcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgbWVtYmVycyA9IHt9LFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgICBpc0Z1bmN0aW9uID0gZ2V0Q2xhc3MuY2FsbChvYmplY3QpID09IGZ1bmN0aW9uQ2xhc3MsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIHByb3BlcnR5O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAocHJvcGVydHkgaW4gb2JqZWN0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTdG9yZSBlYWNoIHByb3BlcnR5IG5hbWUgdG8gcHJldmVudCBkb3VibGUgZW51bWVyYXRpb24uIFRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYHByb3RvdHlwZWAgcHJvcGVydHkgb2YgZnVuY3Rpb25zIGlzIG5vdCBlbnVtZXJhdGVkIGR1ZSB0byBjcm9zcy1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVudmlyb25tZW50IGluY29uc2lzdGVuY2llcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICghKGlzRnVuY3Rpb24gJiYgcHJvcGVydHkgPT0gXCJwcm90b3R5cGVcIikgJiYgIWlzUHJvcGVydHkuY2FsbChtZW1iZXJzLCBwcm9wZXJ0eSkgJiYgKG1lbWJlcnNbcHJvcGVydHldID0gMSkgJiYgaXNQcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhbGxiYWNrKHByb3BlcnR5KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBObyBidWdzIGRldGVjdGVkOyB1c2UgdGhlIHN0YW5kYXJkIGBmb3IuLi5pbmAgYWxnb3JpdGhtLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmb3JFYWNoID0gZnVuY3Rpb24gKG9iamVjdCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgaXNGdW5jdGlvbiA9IGdldENsYXNzLmNhbGwob2JqZWN0KSA9PSBmdW5jdGlvbkNsYXNzLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgICBwcm9wZXJ0eSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICAgaXNDb25zdHJ1Y3Rvcjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHByb3BlcnR5IGluIG9iamVjdCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCEoaXNGdW5jdGlvbiAmJiBwcm9wZXJ0eSA9PSBcInByb3RvdHlwZVwiKSAmJiBpc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkgJiYgIShpc0NvbnN0cnVjdG9yID0gcHJvcGVydHkgPT09IFwiY29uc3RydWN0b3JcIikpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2socHJvcGVydHkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBNYW51YWxseSBpbnZva2UgdGhlIGNhbGxiYWNrIGZvciB0aGUgYGNvbnN0cnVjdG9yYCBwcm9wZXJ0eSBkdWUgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjcm9zcy1lbnZpcm9ubWVudCBpbmNvbnNpc3RlbmNpZXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlzQ29uc3RydWN0b3IgfHwgaXNQcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkgPSBcImNvbnN0cnVjdG9yXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhwcm9wZXJ0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZvckVhY2gob2JqZWN0LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIFB1YmxpYzogU2VyaWFsaXplcyBhIEphdmFTY3JpcHQgYHZhbHVlYCBhcyBhIEpTT04gc3RyaW5nLiBUaGUgb3B0aW9uYWxcblx0XHRcdFx0XHRcdFx0XHQvLyBgZmlsdGVyYCBhcmd1bWVudCBtYXkgc3BlY2lmeSBlaXRoZXIgYSBmdW5jdGlvbiB0aGF0IGFsdGVycyBob3cgb2JqZWN0IGFuZFxuXHRcdFx0XHRcdFx0XHRcdC8vIGFycmF5IG1lbWJlcnMgYXJlIHNlcmlhbGl6ZWQsIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MgYW5kIG51bWJlcnMgdGhhdFxuXHRcdFx0XHRcdFx0XHRcdC8vIGluZGljYXRlcyB3aGljaCBwcm9wZXJ0aWVzIHNob3VsZCBiZSBzZXJpYWxpemVkLiBUaGUgb3B0aW9uYWwgYHdpZHRoYFxuXHRcdFx0XHRcdFx0XHRcdC8vIGFyZ3VtZW50IG1heSBiZSBlaXRoZXIgYSBzdHJpbmcgb3IgbnVtYmVyIHRoYXQgc3BlY2lmaWVzIHRoZSBpbmRlbnRhdGlvblxuXHRcdFx0XHRcdFx0XHRcdC8vIGxldmVsIG9mIHRoZSBvdXRwdXQuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFoYXMoXCJqc29uLXN0cmluZ2lmeVwiKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IEEgbWFwIG9mIGNvbnRyb2wgY2hhcmFjdGVycyBhbmQgdGhlaXIgZXNjYXBlZCBlcXVpdmFsZW50cy5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBFc2NhcGVzID0ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQ5MjogXCJcXFxcXFxcXFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQzNDogJ1xcXFxcIicsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDg6IFwiXFxcXGJcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTI6IFwiXFxcXGZcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTA6IFwiXFxcXG5cIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTM6IFwiXFxcXHJcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0OTogXCJcXFxcdFwiXG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogQ29udmVydHMgYHZhbHVlYCBpbnRvIGEgemVyby1wYWRkZWQgc3RyaW5nIHN1Y2ggdGhhdCBpdHNcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGxlbmd0aCBpcyBhdCBsZWFzdCBlcXVhbCB0byBgd2lkdGhgLiBUaGUgYHdpZHRoYCBtdXN0IGJlIDw9IDYuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgbGVhZGluZ1plcm9lcyA9IFwiMDAwMDAwXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdG9QYWRkZWRTdHJpbmcgPSBmdW5jdGlvbiB0b1BhZGRlZFN0cmluZyh3aWR0aCwgdmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGB8fCAwYCBleHByZXNzaW9uIGlzIG5lY2Vzc2FyeSB0byB3b3JrIGFyb3VuZCBhIGJ1ZyBpblxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPcGVyYSA8PSA3LjU0dTIgd2hlcmUgYDAgPT0gLTBgLCBidXQgYFN0cmluZygtMCkgIT09IFwiMFwiYC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIChsZWFkaW5nWmVyb2VzICsgKHZhbHVlIHx8IDApKS5zbGljZSgtd2lkdGgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IERvdWJsZS1xdW90ZXMgYSBzdHJpbmcgYHZhbHVlYCwgcmVwbGFjaW5nIGFsbCBBU0NJSSBjb250cm9sXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBjaGFyYWN0ZXJzIChjaGFyYWN0ZXJzIHdpdGggY29kZSB1bml0IHZhbHVlcyBiZXR3ZWVuIDAgYW5kIDMxKSB3aXRoXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyB0aGVpciBlc2NhcGVkIGVxdWl2YWxlbnRzLiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFF1b3RlKHZhbHVlKWAgb3BlcmF0aW9uIGRlZmluZWQgaW4gRVMgNS4xIHNlY3Rpb24gMTUuMTIuMy5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciB1bmljb2RlUHJlZml4ID0gXCJcXFxcdTAwXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgcXVvdGUgPSBmdW5jdGlvbiBxdW90ZSh2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gJ1wiJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGluZGV4ID0gMCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGxlbmd0aCA9IHZhbHVlLmxlbmd0aCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIHVzZUNoYXJJbmRleCA9ICFjaGFySW5kZXhCdWdneSB8fCBsZW5ndGggPiAxMDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHN5bWJvbHMgPSB1c2VDaGFySW5kZXggJiYgKGNoYXJJbmRleEJ1Z2d5ID8gdmFsdWUuc3BsaXQoXCJcIikgOiB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBjaGFyQ29kZSA9IHZhbHVlLmNoYXJDb2RlQXQoaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElmIHRoZSBjaGFyYWN0ZXIgaXMgYSBjb250cm9sIGNoYXJhY3RlciwgYXBwZW5kIGl0cyBVbmljb2RlIG9yXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gc2hvcnRoYW5kIGVzY2FwZSBzZXF1ZW5jZTsgb3RoZXJ3aXNlLCBhcHBlbmQgdGhlIGNoYXJhY3RlciBhcy1pcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNoYXJDb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDg6Y2FzZSA5OmNhc2UgMTA6Y2FzZSAxMjpjYXNlIDEzOmNhc2UgMzQ6Y2FzZSA5Mjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ICs9IEVzY2FwZXNbY2hhckNvZGVdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA8IDMyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ICs9IHVuaWNvZGVQcmVmaXggKyB0b1BhZGRlZFN0cmluZygyLCBjaGFyQ29kZS50b1N0cmluZygxNikpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCArPSB1c2VDaGFySW5kZXggPyBzeW1ib2xzW2luZGV4XSA6IHZhbHVlLmNoYXJBdChpbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiByZXN1bHQgKyAnXCInO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlY3Vyc2l2ZWx5IHNlcmlhbGl6ZXMgYW4gb2JqZWN0LiBJbXBsZW1lbnRzIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFN0cihrZXksIGhvbGRlcilgLCBgSk8odmFsdWUpYCwgYW5kIGBKQSh2YWx1ZSlgIG9wZXJhdGlvbnMuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgc2VyaWFsaXplID0gZnVuY3Rpb24gc2VyaWFsaXplKHByb3BlcnR5LCBvYmplY3QsIGNhbGxiYWNrLCBwcm9wZXJ0aWVzLCB3aGl0ZXNwYWNlLCBpbmRlbnRhdGlvbiwgc3RhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlLCBjbGFzc05hbWUsIHllYXIsIG1vbnRoLCBkYXRlLCB0aW1lLCBob3VycywgbWludXRlcywgc2Vjb25kcywgbWlsbGlzZWNvbmRzLCByZXN1bHRzLCBlbGVtZW50LCBpbmRleCwgbGVuZ3RoLCBwcmVmaXgsIHJlc3VsdDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBOZWNlc3NhcnkgZm9yIGhvc3Qgb2JqZWN0IHN1cHBvcnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBvYmplY3RbcHJvcGVydHldO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHt9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIiAmJiB2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNsYXNzTmFtZSA9IGdldENsYXNzLmNhbGwodmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjbGFzc05hbWUgPT0gZGF0ZUNsYXNzICYmICFpc1Byb3BlcnR5LmNhbGwodmFsdWUsIFwidG9KU09OXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPiAtMSAvIDAgJiYgdmFsdWUgPCAxIC8gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBEYXRlcyBhcmUgc2VyaWFsaXplZCBhY2NvcmRpbmcgdG8gdGhlIGBEYXRlI3RvSlNPTmAgbWV0aG9kXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNwZWNpZmllZCBpbiBFUyA1LjEgc2VjdGlvbiAxNS45LjUuNDQuIFNlZSBzZWN0aW9uIDE1LjkuMS4xNVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBmb3IgdGhlIElTTyA4NjAxIGRhdGUgdGltZSBzdHJpbmcgZm9ybWF0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZ2V0RGF5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTWFudWFsbHkgY29tcHV0ZSB0aGUgeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNlY29uZHMsIGFuZCBtaWxsaXNlY29uZHMgaWYgdGhlIGBnZXRVVEMqYCBtZXRob2RzIGFyZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGJ1Z2d5LiBBZGFwdGVkIGZyb20gQFlhZmZsZSdzIGBkYXRlLXNoaW1gIHByb2plY3QuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGF0ZSA9IGZsb29yKHZhbHVlIC8gODY0ZTUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoeWVhciA9IGZsb29yKGRhdGUgLyAzNjUuMjQyNSkgKyAxOTcwIC0gMTsgZ2V0RGF5KHllYXIgKyAxLCAwKSA8PSBkYXRlOyB5ZWFyKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAobW9udGggPSBmbG9vcigoZGF0ZSAtIGdldERheSh5ZWFyLCAwKSkgLyAzMC40Mik7IGdldERheSh5ZWFyLCBtb250aCArIDEpIDw9IGRhdGU7IG1vbnRoKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGUgPSAxICsgZGF0ZSAtIGdldERheSh5ZWFyLCBtb250aCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGB0aW1lYCB2YWx1ZSBzcGVjaWZpZXMgdGhlIHRpbWUgd2l0aGluIHRoZSBkYXkgKHNlZSBFU1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIDUuMSBzZWN0aW9uIDE1LjkuMS4yKS4gVGhlIGZvcm11bGEgYChBICUgQiArIEIpICUgQmAgaXMgdXNlZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHRvIGNvbXB1dGUgYEEgbW9kdWxvIEJgLCBhcyB0aGUgYCVgIG9wZXJhdG9yIGRvZXMgbm90XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gY29ycmVzcG9uZCB0byB0aGUgYG1vZHVsb2Agb3BlcmF0aW9uIGZvciBuZWdhdGl2ZSBudW1iZXJzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRpbWUgPSAodmFsdWUgJSA4NjRlNSArIDg2NGU1KSAlIDg2NGU1O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBob3VycywgbWludXRlcywgc2Vjb25kcywgYW5kIG1pbGxpc2Vjb25kcyBhcmUgb2J0YWluZWQgYnlcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBkZWNvbXBvc2luZyB0aGUgdGltZSB3aXRoaW4gdGhlIGRheS4gU2VlIHNlY3Rpb24gMTUuOS4xLjEwLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGhvdXJzID0gZmxvb3IodGltZSAvIDM2ZTUpICUgMjQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWludXRlcyA9IGZsb29yKHRpbWUgLyA2ZTQpICUgNjA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2Vjb25kcyA9IGZsb29yKHRpbWUgLyAxZTMpICUgNjA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWlsbGlzZWNvbmRzID0gdGltZSAlIDFlMztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR5ZWFyID0gdmFsdWUuZ2V0VVRDRnVsbFllYXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRtb250aCA9IHZhbHVlLmdldFVUQ01vbnRoKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGF0ZSA9IHZhbHVlLmdldFVUQ0RhdGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRob3VycyA9IHZhbHVlLmdldFVUQ0hvdXJzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWludXRlcyA9IHZhbHVlLmdldFVUQ01pbnV0ZXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZWNvbmRzID0gdmFsdWUuZ2V0VVRDU2Vjb25kcygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdG1pbGxpc2Vjb25kcyA9IHZhbHVlLmdldFVUQ01pbGxpc2Vjb25kcygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNlcmlhbGl6ZSBleHRlbmRlZCB5ZWFycyBjb3JyZWN0bHkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gKHllYXIgPD0gMCB8fCB5ZWFyID49IDFlNCA/ICh5ZWFyIDwgMCA/IFwiLVwiIDogXCIrXCIpICsgdG9QYWRkZWRTdHJpbmcoNiwgeWVhciA8IDAgPyAteWVhciA6IHllYXIpIDogdG9QYWRkZWRTdHJpbmcoNCwgeWVhcikpICsgXCItXCIgKyB0b1BhZGRlZFN0cmluZygyLCBtb250aCArIDEpICsgXCItXCIgKyB0b1BhZGRlZFN0cmluZygyLCBkYXRlKSArXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE1vbnRocywgZGF0ZXMsIGhvdXJzLCBtaW51dGVzLCBhbmQgc2Vjb25kcyBzaG91bGQgaGF2ZSB0d29cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZGlnaXRzOyBtaWxsaXNlY29uZHMgc2hvdWxkIGhhdmUgdGhyZWUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFwiVFwiICsgdG9QYWRkZWRTdHJpbmcoMiwgaG91cnMpICsgXCI6XCIgKyB0b1BhZGRlZFN0cmluZygyLCBtaW51dGVzKSArIFwiOlwiICsgdG9QYWRkZWRTdHJpbmcoMiwgc2Vjb25kcykgK1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBNaWxsaXNlY29uZHMgYXJlIG9wdGlvbmFsIGluIEVTIDUuMCwgYnV0IHJlcXVpcmVkIGluIDUuMS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XCIuXCIgKyB0b1BhZGRlZFN0cmluZygzLCBtaWxsaXNlY29uZHMpICsgXCJaXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgdmFsdWUudG9KU09OID09IFwiZnVuY3Rpb25cIiAmJiAoY2xhc3NOYW1lICE9IG51bWJlckNsYXNzICYmIGNsYXNzTmFtZSAhPSBzdHJpbmdDbGFzcyAmJiBjbGFzc05hbWUgIT0gYXJyYXlDbGFzcyB8fCBpc1Byb3BlcnR5LmNhbGwodmFsdWUsIFwidG9KU09OXCIpKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUHJvdG90eXBlIDw9IDEuNi4xIGFkZHMgbm9uLXN0YW5kYXJkIGB0b0pTT05gIG1ldGhvZHMgdG8gdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgTnVtYmVyYCwgYFN0cmluZ2AsIGBEYXRlYCwgYW5kIGBBcnJheWAgcHJvdG90eXBlcy4gSlNPTiAzXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBpZ25vcmVzIGFsbCBgdG9KU09OYCBtZXRob2RzIG9uIHRoZXNlIG9iamVjdHMgdW5sZXNzIHRoZXkgYXJlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBkZWZpbmVkIGRpcmVjdGx5IG9uIGFuIGluc3RhbmNlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSB2YWx1ZS50b0pTT04ocHJvcGVydHkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBJZiBhIHJlcGxhY2VtZW50IGZ1bmN0aW9uIHdhcyBwcm92aWRlZCwgY2FsbCBpdCB0byBvYnRhaW4gdGhlIHZhbHVlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZm9yIHNlcmlhbGl6YXRpb24uXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjay5jYWxsKG9iamVjdCwgcHJvcGVydHksIHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gXCJudWxsXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2xhc3NOYW1lID0gZ2V0Q2xhc3MuY2FsbCh2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjbGFzc05hbWUgPT0gYm9vbGVhbkNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQm9vbGVhbnMgYXJlIHJlcHJlc2VudGVkIGxpdGVyYWxseS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gXCJcIiArIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNsYXNzTmFtZSA9PSBudW1iZXJDbGFzcykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEpTT04gbnVtYmVycyBtdXN0IGJlIGZpbml0ZS4gYEluZmluaXR5YCBhbmQgYE5hTmAgYXJlIHNlcmlhbGl6ZWQgYXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgXCJudWxsXCJgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZSA+IC0xIC8gMCAmJiB2YWx1ZSA8IDEgLyAwID8gXCJcIiArIHZhbHVlIDogXCJudWxsXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoY2xhc3NOYW1lID09IHN0cmluZ0NsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3RyaW5ncyBhcmUgZG91YmxlLXF1b3RlZCBhbmQgZXNjYXBlZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcXVvdGUoXCJcIiArIHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZWN1cnNpdmVseSBzZXJpYWxpemUgb2JqZWN0cyBhbmQgYXJyYXlzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDaGVjayBmb3IgY3ljbGljIHN0cnVjdHVyZXMuIFRoaXMgaXMgYSBsaW5lYXIgc2VhcmNoOyBwZXJmb3JtYW5jZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGlzIGludmVyc2VseSBwcm9wb3J0aW9uYWwgdG8gdGhlIG51bWJlciBvZiB1bmlxdWUgbmVzdGVkIG9iamVjdHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChsZW5ndGggPSBzdGFjay5sZW5ndGg7IGxlbmd0aC0tOykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHN0YWNrW2xlbmd0aF0gPT09IHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEN5Y2xpYyBzdHJ1Y3R1cmVzIGNhbm5vdCBiZSBzZXJpYWxpemVkIGJ5IGBKU09OLnN0cmluZ2lmeWAuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBZGQgdGhlIG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RhY2sucHVzaCh2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0cyA9IFtdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNhdmUgdGhlIGN1cnJlbnQgaW5kZW50YXRpb24gbGV2ZWwgYW5kIGluZGVudCBvbmUgYWRkaXRpb25hbCBsZXZlbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcmVmaXggPSBpbmRlbnRhdGlvbjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpbmRlbnRhdGlvbiArPSB3aGl0ZXNwYWNlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjbGFzc05hbWUgPT0gYXJyYXlDbGFzcykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmVjdXJzaXZlbHkgc2VyaWFsaXplIGFycmF5IGVsZW1lbnRzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChpbmRleCA9IDAsIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxlbWVudCA9IHNlcmlhbGl6ZShpbmRleCwgdmFsdWUsIGNhbGxiYWNrLCBwcm9wZXJ0aWVzLCB3aGl0ZXNwYWNlLCBpbmRlbnRhdGlvbiwgc3RhY2spO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2goZWxlbWVudCA9PT0gdW5kZWYgPyBcIm51bGxcIiA6IGVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ID0gcmVzdWx0cy5sZW5ndGggPyB3aGl0ZXNwYWNlID8gXCJbXFxuXCIgKyBpbmRlbnRhdGlvbiArIHJlc3VsdHMuam9pbihcIixcXG5cIiArIGluZGVudGF0aW9uKSArIFwiXFxuXCIgKyBwcmVmaXggKyBcIl1cIiA6IFwiW1wiICsgcmVzdWx0cy5qb2luKFwiLFwiKSArIFwiXVwiIDogXCJbXVwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZWN1cnNpdmVseSBzZXJpYWxpemUgb2JqZWN0IG1lbWJlcnMuIE1lbWJlcnMgYXJlIHNlbGVjdGVkIGZyb21cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVpdGhlciBhIHVzZXItc3BlY2lmaWVkIGxpc3Qgb2YgcHJvcGVydHkgbmFtZXMsIG9yIHRoZSBvYmplY3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGl0c2VsZi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvckVhY2gocHJvcGVydGllcyB8fCB2YWx1ZSwgZnVuY3Rpb24gKHByb3BlcnR5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBlbGVtZW50ID0gc2VyaWFsaXplKHByb3BlcnR5LCB2YWx1ZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIGluZGVudGF0aW9uLCBzdGFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChlbGVtZW50ICE9PSB1bmRlZikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFjY29yZGluZyB0byBFUyA1LjEgc2VjdGlvbiAxNS4xMi4zOiBcIklmIGBnYXBgIHt3aGl0ZXNwYWNlfVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGlzIG5vdCB0aGUgZW1wdHkgc3RyaW5nLCBsZXQgYG1lbWJlcmAge3F1b3RlKHByb3BlcnR5KSArIFwiOlwifVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGJlIHRoZSBjb25jYXRlbmF0aW9uIG9mIGBtZW1iZXJgIGFuZCB0aGUgYHNwYWNlYCBjaGFyYWN0ZXIuXCJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgXCJgc3BhY2VgIGNoYXJhY3RlclwiIHJlZmVycyB0byB0aGUgbGl0ZXJhbCBzcGFjZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNoYXJhY3Rlciwgbm90IHRoZSBgc3BhY2VgIHt3aWR0aH0gYXJndW1lbnQgcHJvdmlkZWQgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgSlNPTi5zdHJpbmdpZnlgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaChxdW90ZShwcm9wZXJ0eSkgKyBcIjpcIiArICh3aGl0ZXNwYWNlID8gXCIgXCIgOiBcIlwiKSArIGVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IHJlc3VsdHMubGVuZ3RoID8gd2hpdGVzcGFjZSA/IFwie1xcblwiICsgaW5kZW50YXRpb24gKyByZXN1bHRzLmpvaW4oXCIsXFxuXCIgKyBpbmRlbnRhdGlvbikgKyBcIlxcblwiICsgcHJlZml4ICsgXCJ9XCIgOiBcIntcIiArIHJlc3VsdHMuam9pbihcIixcIikgKyBcIn1cIiA6IFwie31cIjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBvYmplY3QgZnJvbSB0aGUgdHJhdmVyc2VkIG9iamVjdCBzdGFjay5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdGFjay5wb3AoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBQdWJsaWM6IGBKU09OLnN0cmluZ2lmeWAuIFNlZSBFUyA1LjEgc2VjdGlvbiAxNS4xMi4zLlxuXHRcdFx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5zdHJpbmdpZnkgPSBmdW5jdGlvbiAoc291cmNlLCBmaWx0ZXIsIHdpZHRoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciB3aGl0ZXNwYWNlLCBjYWxsYmFjaywgcHJvcGVydGllcywgY2xhc3NOYW1lO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAob2JqZWN0VHlwZXNbdHlwZW9mIGZpbHRlcl0gJiYgZmlsdGVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKChjbGFzc05hbWUgPSBnZXRDbGFzcy5jYWxsKGZpbHRlcikpID09IGZ1bmN0aW9uQ2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gZmlsdGVyO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoY2xhc3NOYW1lID09IGFycmF5Q2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENvbnZlcnQgdGhlIHByb3BlcnR5IG5hbWVzIGFycmF5IGludG8gYSBtYWtlc2hpZnQgc2V0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cHJvcGVydGllcyA9IHt9O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGggPSBmaWx0ZXIubGVuZ3RoLCB2YWx1ZTsgaW5kZXggPCBsZW5ndGg7IHZhbHVlID0gZmlsdGVyW2luZGV4KytdLCAoY2xhc3NOYW1lID0gZ2V0Q2xhc3MuY2FsbCh2YWx1ZSksIGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcyB8fCBjbGFzc05hbWUgPT0gbnVtYmVyQ2xhc3MpICYmIChwcm9wZXJ0aWVzW3ZhbHVlXSA9IDEpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHdpZHRoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKChjbGFzc05hbWUgPSBnZXRDbGFzcy5jYWxsKHdpZHRoKSkgPT0gbnVtYmVyQ2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENvbnZlcnQgdGhlIGB3aWR0aGAgdG8gYW4gaW50ZWdlciBhbmQgY3JlYXRlIGEgc3RyaW5nIGNvbnRhaW5pbmdcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGB3aWR0aGAgbnVtYmVyIG9mIHNwYWNlIGNoYXJhY3RlcnMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoKHdpZHRoIC09IHdpZHRoICUgMSkgPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAod2hpdGVzcGFjZSA9IFwiXCIsIHdpZHRoID4gMTAgJiYgKHdpZHRoID0gMTApOyB3aGl0ZXNwYWNlLmxlbmd0aCA8IHdpZHRoOyB3aGl0ZXNwYWNlICs9IFwiIFwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0d2hpdGVzcGFjZSA9IHdpZHRoLmxlbmd0aCA8PSAxMCA/IHdpZHRoIDogd2lkdGguc2xpY2UoMCwgMTApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPcGVyYSA8PSA3LjU0dTIgZGlzY2FyZHMgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggZW1wdHkgc3RyaW5nIGtleXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gKGBcIlwiYCkgb25seSBpZiB0aGV5IGFyZSB1c2VkIGRpcmVjdGx5IHdpdGhpbiBhbiBvYmplY3QgbWVtYmVyIGxpc3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gKGUuZy4sIGAhKFwiXCIgaW4geyBcIlwiOiAxfSlgKS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHNlcmlhbGl6ZShcIlwiLCAodmFsdWUgPSB7fSwgdmFsdWVbXCJcIl0gPSBzb3VyY2UsIHZhbHVlKSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIFwiXCIsIFtdKTtcblx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUHVibGljOiBQYXJzZXMgYSBKU09OIHNvdXJjZSBzdHJpbmcuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFoYXMoXCJqc29uLXBhcnNlXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IEEgbWFwIG9mIGVzY2FwZWQgY29udHJvbCBjaGFyYWN0ZXJzIGFuZCB0aGVpciB1bmVzY2FwZWRcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGVxdWl2YWxlbnRzLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIFVuZXNjYXBlcyA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0OTI6IFwiXFxcXFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQzNDogJ1wiJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0NDc6IFwiL1wiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ5ODogXCJcXGJcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTE2OiBcIlxcdFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQxMTA6IFwiXFxuXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDEwMjogXCJcXGZcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTE0OiBcIlxcclwiXG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogU3RvcmVzIHRoZSBwYXJzZXIgc3RhdGUuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgSW5kZXgsIFNvdXJjZTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlc2V0cyB0aGUgcGFyc2VyIHN0YXRlIGFuZCB0aHJvd3MgYSBgU3ludGF4RXJyb3JgLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGFib3J0ID0gZnVuY3Rpb24gYWJvcnQoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4ID0gU291cmNlID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgU3ludGF4RXJyb3IoKTtcblx0XHRcdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdFx0XHRcdC8vIEludGVybmFsOiBSZXR1cm5zIHRoZSBuZXh0IHRva2VuLCBvciBgXCIkXCJgIGlmIHRoZSBwYXJzZXIgaGFzIHJlYWNoZWRcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzdHJpbmcuIEEgdG9rZW4gbWF5IGJlIGEgc3RyaW5nLCBudW1iZXIsIGBudWxsYFxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gbGl0ZXJhbCwgb3IgQm9vbGVhbiBsaXRlcmFsLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGxleCA9IGZ1bmN0aW9uIGxleCgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHNvdXJjZSA9IFNvdXJjZSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGxlbmd0aCA9IHNvdXJjZS5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCAgICB2YWx1ZSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGJlZ2luLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQgICAgcG9zaXRpb24sXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCAgICBpc1NpZ25lZCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgIGNoYXJDb2RlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR3aGlsZSAoSW5kZXggPCBsZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNoYXJDb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDk6Y2FzZSAxMDpjYXNlIDEzOmNhc2UgMzI6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNraXAgd2hpdGVzcGFjZSB0b2tlbnMsIGluY2x1ZGluZyB0YWJzLCBjYXJyaWFnZSByZXR1cm5zLCBsaW5lXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGZlZWRzLCBhbmQgc3BhY2UgY2hhcmFjdGVycy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0SW5kZXgrKztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDEyMzpjYXNlIDEyNTpjYXNlIDkxOmNhc2UgOTM6Y2FzZSA1ODpjYXNlIDQ0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBhIHB1bmN0dWF0b3IgdG9rZW4gKGB7YCwgYH1gLCBgW2AsIGBdYCwgYDpgLCBvciBgLGApIGF0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGNoYXJJbmRleEJ1Z2d5ID8gc291cmNlLmNoYXJBdChJbmRleCkgOiBzb3VyY2VbSW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDM0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgXCJgIGRlbGltaXRzIGEgSlNPTiBzdHJpbmc7IGFkdmFuY2UgdG8gdGhlIG5leHQgY2hhcmFjdGVyIGFuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBiZWdpbiBwYXJzaW5nIHRoZSBzdHJpbmcuIFN0cmluZyB0b2tlbnMgYXJlIHByZWZpeGVkIHdpdGggdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNlbnRpbmVsIGBAYCBjaGFyYWN0ZXIgdG8gZGlzdGluZ3Vpc2ggdGhlbSBmcm9tIHB1bmN0dWF0b3JzIGFuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBlbmQtb2Ytc3RyaW5nIHRva2Vucy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YWx1ZSA9IFwiQFwiLCBJbmRleCsrOyBJbmRleCA8IGxlbmd0aDspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPCAzMikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5lc2NhcGVkIEFTQ0lJIGNvbnRyb2wgY2hhcmFjdGVycyAodGhvc2Ugd2l0aCBhIGNvZGUgdW5pdFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbGVzcyB0aGFuIHRoZSBzcGFjZSBjaGFyYWN0ZXIpIGFyZSBub3QgcGVybWl0dGVkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNoYXJDb2RlID09IDkyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIHJldmVyc2Ugc29saWR1cyAoYFxcYCkgbWFya3MgdGhlIGJlZ2lubmluZyBvZiBhbiBlc2NhcGVkXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjb250cm9sIGNoYXJhY3RlciAoaW5jbHVkaW5nIGBcImAsIGBcXGAsIGFuZCBgL2ApIG9yIFVuaWNvZGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVzY2FwZSBzZXF1ZW5jZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNoYXJDb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgOTI6Y2FzZSAzNDpjYXNlIDQ3OmNhc2UgOTg6Y2FzZSAxMTY6Y2FzZSAxMTA6Y2FzZSAxMDI6Y2FzZSAxMTQ6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmV2aXZlIGVzY2FwZWQgY29udHJvbCBjaGFyYWN0ZXJzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlICs9IFVuZXNjYXBlc1tjaGFyQ29kZV07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0SW5kZXgrKztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAxMTc6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFxcdWAgbWFya3MgdGhlIGJlZ2lubmluZyBvZiBhIFVuaWNvZGUgZXNjYXBlIHNlcXVlbmNlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFkdmFuY2UgdG8gdGhlIGZpcnN0IGNoYXJhY3RlciBhbmQgdmFsaWRhdGUgdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZm91ci1kaWdpdCBjb2RlIHBvaW50LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJlZ2luID0gKytJbmRleDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHBvc2l0aW9uID0gSW5kZXggKyA0OyBJbmRleCA8IHBvc2l0aW9uOyBJbmRleCsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgdmFsaWQgc2VxdWVuY2UgY29tcHJpc2VzIGZvdXIgaGV4ZGlnaXRzIChjYXNlLVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gaW5zZW5zaXRpdmUpIHRoYXQgZm9ybSBhIHNpbmdsZSBoZXhhZGVjaW1hbCB2YWx1ZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICghKGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3IHx8IGNoYXJDb2RlID49IDk3ICYmIGNoYXJDb2RlIDw9IDEwMiB8fCBjaGFyQ29kZSA+PSA2NSAmJiBjaGFyQ29kZSA8PSA3MCkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW52YWxpZCBVbmljb2RlIGVzY2FwZSBzZXF1ZW5jZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmV2aXZlIHRoZSBlc2NhcGVkIGNoYXJhY3Rlci5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSArPSBmcm9tQ2hhckNvZGUoXCIweFwiICsgc291cmNlLnNsaWNlKGJlZ2luLCBJbmRleCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEludmFsaWQgZXNjYXBlIHNlcXVlbmNlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA9PSAzNCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBbiB1bmVzY2FwZWQgZG91YmxlLXF1b3RlIGNoYXJhY3RlciBtYXJrcyB0aGUgZW5kIG9mIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzdHJpbmcuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRiZWdpbiA9IEluZGV4O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT3B0aW1pemUgZm9yIHRoZSBjb21tb24gY2FzZSB3aGVyZSBhIHN0cmluZyBpcyB2YWxpZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHdoaWxlIChjaGFyQ29kZSA+PSAzMiAmJiBjaGFyQ29kZSAhPSA5MiAmJiBjaGFyQ29kZSAhPSAzNCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KCsrSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQXBwZW5kIHRoZSBzdHJpbmcgYXMtaXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSArPSBzb3VyY2Uuc2xpY2UoYmVnaW4sIEluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSA9PSAzNCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFkdmFuY2UgdG8gdGhlIG5leHQgY2hhcmFjdGVyIGFuZCByZXR1cm4gdGhlIHJldml2ZWQgc3RyaW5nLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4Kys7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVudGVybWluYXRlZCBzdHJpbmcuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBudW1iZXJzIGFuZCBsaXRlcmFscy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YmVnaW4gPSBJbmRleDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQWR2YW5jZSBwYXN0IHRoZSBuZWdhdGl2ZSBzaWduLCBpZiBvbmUgaXMgc3BlY2lmaWVkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPT0gNDUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpc1NpZ25lZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdCgrK0luZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBhbiBpbnRlZ2VyIG9yIGZsb2F0aW5nLXBvaW50IHZhbHVlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPj0gNDggJiYgY2hhckNvZGUgPD0gNTcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBMZWFkaW5nIHplcm9lcyBhcmUgaW50ZXJwcmV0ZWQgYXMgb2N0YWwgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNoYXJDb2RlID09IDQ4ICYmIChjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4ICsgMSksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWxsZWdhbCBvY3RhbCBsaXRlcmFsLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aXNTaWduZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSB0aGUgaW50ZWdlciBjb21wb25lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICg7IEluZGV4IDwgbGVuZ3RoICYmIChjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSwgY2hhckNvZGUgPj0gNDggJiYgY2hhckNvZGUgPD0gNTcpOyBJbmRleCsrKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGbG9hdHMgY2Fubm90IGNvbnRhaW4gYSBsZWFkaW5nIGRlY2ltYWwgcG9pbnQ7IGhvd2V2ZXIsIHRoaXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjYXNlIGlzIGFscmVhZHkgYWNjb3VudGVkIGZvciBieSB0aGUgcGFyc2VyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChzb3VyY2UuY2hhckNvZGVBdChJbmRleCkgPT0gNDYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBvc2l0aW9uID0gKytJbmRleDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcnNlIHRoZSBkZWNpbWFsIGNvbXBvbmVudC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoOyBwb3NpdGlvbiA8IGxlbmd0aCAmJiAoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChwb3NpdGlvbiksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KTsgcG9zaXRpb24rKyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocG9zaXRpb24gPT0gSW5kZXgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWxsZWdhbCB0cmFpbGluZyBkZWNpbWFsLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0SW5kZXggPSBwb3NpdGlvbjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgZXhwb25lbnRzLiBUaGUgYGVgIGRlbm90aW5nIHRoZSBleHBvbmVudCBpc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNhc2UtaW5zZW5zaXRpdmUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNoYXJDb2RlID09IDEwMSB8fCBjaGFyQ29kZSA9PSA2OSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdCgrK0luZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNraXAgcGFzdCB0aGUgc2lnbiBmb2xsb3dpbmcgdGhlIGV4cG9uZW50LCBpZiBvbmUgaXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNwZWNpZmllZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA9PSA0MyB8fCBjaGFyQ29kZSA9PSA0NSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgdGhlIGV4cG9uZW50aWFsIGNvbXBvbmVudC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAocG9zaXRpb24gPSBJbmRleDsgcG9zaXRpb24gPCBsZW5ndGggJiYgKGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQocG9zaXRpb24pLCBjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nyk7IHBvc2l0aW9uKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBvc2l0aW9uID09IEluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElsbGVnYWwgZW1wdHkgZXhwb25lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCA9IHBvc2l0aW9uO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDb2VyY2UgdGhlIHBhcnNlZCB2YWx1ZSB0byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiArc291cmNlLnNsaWNlKGJlZ2luLCBJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSBuZWdhdGl2ZSBzaWduIG1heSBvbmx5IHByZWNlZGUgbnVtYmVycy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlzU2lnbmVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgdHJ1ZWAsIGBmYWxzZWAsIGFuZCBgbnVsbGAgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChzb3VyY2Uuc2xpY2UoSW5kZXgsIEluZGV4ICsgNCkgPT0gXCJ0cnVlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHNvdXJjZS5zbGljZShJbmRleCwgSW5kZXggKyA1KSA9PSBcImZhbHNlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA1O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChzb3VyY2Uuc2xpY2UoSW5kZXgsIEluZGV4ICsgNCkgPT0gXCJudWxsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVucmVjb2duaXplZCB0b2tlbi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmV0dXJuIHRoZSBzZW50aW5lbCBgJGAgY2hhcmFjdGVyIGlmIHRoZSBwYXJzZXIgaGFzIHJlYWNoZWQgdGhlIGVuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBvZiB0aGUgc291cmNlIHN0cmluZy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIFwiJFwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFBhcnNlcyBhIEpTT04gYHZhbHVlYCB0b2tlbi5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBnZXQgPSBmdW5jdGlvbiBnZXQodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHJlc3VsdHMsIGhhc01lbWJlcnM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIiRcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVuZXhwZWN0ZWQgZW5kIG9mIGlucHV0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKChjaGFySW5kZXhCdWdneSA/IHZhbHVlLmNoYXJBdCgwKSA6IHZhbHVlWzBdKSA9PSBcIkBcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBzZW50aW5lbCBgQGAgY2hhcmFjdGVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlLnNsaWNlKDEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBvYmplY3QgYW5kIGFycmF5IGxpdGVyYWxzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIltcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2VzIGEgSlNPTiBhcnJheSwgcmV0dXJuaW5nIGEgbmV3IEphdmFTY3JpcHQgYXJyYXkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHRzID0gW107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKDs7IGhhc01lbWJlcnMgfHwgKGhhc01lbWJlcnMgPSB0cnVlKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGxleCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIGNsb3Npbmcgc3F1YXJlIGJyYWNrZXQgbWFya3MgdGhlIGVuZCBvZiB0aGUgYXJyYXkgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwiXVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWYgdGhlIGFycmF5IGxpdGVyYWwgY29udGFpbnMgZWxlbWVudHMsIHRoZSBjdXJyZW50IHRva2VuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNob3VsZCBiZSBhIGNvbW1hIHNlcGFyYXRpbmcgdGhlIHByZXZpb3VzIGVsZW1lbnQgZnJvbSB0aGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbmV4dC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGhhc01lbWJlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCIsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCJdXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5leHBlY3RlZCB0cmFpbGluZyBgLGAgaW4gYXJyYXkgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSBgLGAgbXVzdCBzZXBhcmF0ZSBlYWNoIGFycmF5IGVsZW1lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBFbGlzaW9ucyBhbmQgbGVhZGluZyBjb21tYXMgYXJlIG5vdCBwZXJtaXR0ZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIixcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0cy5wdXNoKGdldCh2YWx1ZSkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICh2YWx1ZSA9PSBcIntcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2VzIGEgSlNPTiBvYmplY3QsIHJldHVybmluZyBhIG5ldyBKYXZhU2NyaXB0IG9iamVjdC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdHMgPSB7fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoOzsgaGFzTWVtYmVycyB8fCAoaGFzTWVtYmVycyA9IHRydWUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgY2xvc2luZyBjdXJseSBicmFjZSBtYXJrcyB0aGUgZW5kIG9mIHRoZSBvYmplY3QgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwifVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWYgdGhlIG9iamVjdCBsaXRlcmFsIGNvbnRhaW5zIG1lbWJlcnMsIHRoZSBjdXJyZW50IHRva2VuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNob3VsZCBiZSBhIGNvbW1hIHNlcGFyYXRvci5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGhhc01lbWJlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCIsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCJ9XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5leHBlY3RlZCB0cmFpbGluZyBgLGAgaW4gb2JqZWN0IGxpdGVyYWwuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgYCxgIG11c3Qgc2VwYXJhdGUgZWFjaCBvYmplY3QgbWVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTGVhZGluZyBjb21tYXMgYXJlIG5vdCBwZXJtaXR0ZWQsIG9iamVjdCBwcm9wZXJ0eSBuYW1lcyBtdXN0IGJlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRvdWJsZS1xdW90ZWQgc3RyaW5ncywgYW5kIGEgYDpgIG11c3Qgc2VwYXJhdGUgZWFjaCBwcm9wZXJ0eVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBuYW1lIGFuZCB2YWx1ZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwiLFwiIHx8IHR5cGVvZiB2YWx1ZSAhPSBcInN0cmluZ1wiIHx8IChjaGFySW5kZXhCdWdneSA/IHZhbHVlLmNoYXJBdCgwKSA6IHZhbHVlWzBdKSAhPSBcIkBcIiB8fCBsZXgoKSAhPSBcIjpcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0c1t2YWx1ZS5zbGljZSgxKV0gPSBnZXQobGV4KCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVuZXhwZWN0ZWQgdG9rZW4gZW5jb3VudGVyZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogVXBkYXRlcyBhIHRyYXZlcnNlZCBvYmplY3QgbWVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShzb3VyY2UsIHByb3BlcnR5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgZWxlbWVudCA9IHdhbGsoc291cmNlLCBwcm9wZXJ0eSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZWxlbWVudCA9PT0gdW5kZWYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgc291cmNlW3Byb3BlcnR5XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzb3VyY2VbcHJvcGVydHldID0gZWxlbWVudDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlY3Vyc2l2ZWx5IHRyYXZlcnNlcyBhIHBhcnNlZCBKU09OIG9iamVjdCwgaW52b2tpbmcgdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBgY2FsbGJhY2tgIGZ1bmN0aW9uIGZvciBlYWNoIHZhbHVlLiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFdhbGsoaG9sZGVyLCBuYW1lKWAgb3BlcmF0aW9uIGRlZmluZWQgaW4gRVMgNS4xIHNlY3Rpb24gMTUuMTIuMi5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciB3YWxrID0gZnVuY3Rpb24gd2Fsayhzb3VyY2UsIHByb3BlcnR5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgdmFsdWUgPSBzb3VyY2VbcHJvcGVydHldLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQgICAgbGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIgJiYgdmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgZm9yRWFjaGAgY2FuJ3QgYmUgdXNlZCB0byB0cmF2ZXJzZSBhbiBhcnJheSBpbiBPcGVyYSA8PSA4LjU0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYmVjYXVzZSBpdHMgYE9iamVjdCNoYXNPd25Qcm9wZXJ0eWAgaW1wbGVtZW50YXRpb24gcmV0dXJucyBgZmFsc2VgXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZm9yIGFycmF5IGluZGljZXMgKGUuZy4sIGAhWzEsIDIsIDNdLmhhc093blByb3BlcnR5KFwiMFwiKWApLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChnZXRDbGFzcy5jYWxsKHZhbHVlKSA9PSBhcnJheUNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgbGVuZ3RoLS07KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVwZGF0ZSh2YWx1ZSwgbGVuZ3RoLCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvckVhY2godmFsdWUsIGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR1cGRhdGUodmFsdWUsIHByb3BlcnR5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwoc291cmNlLCBwcm9wZXJ0eSwgdmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUHVibGljOiBgSlNPTi5wYXJzZWAuIFNlZSBFUyA1LjEgc2VjdGlvbiAxNS4xMi4yLlxuXHRcdFx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5wYXJzZSA9IGZ1bmN0aW9uIChzb3VyY2UsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciByZXN1bHQsIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFNvdXJjZSA9IFwiXCIgKyBzb3VyY2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IGdldChsZXgoKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElmIGEgSlNPTiBzdHJpbmcgY29udGFpbnMgbXVsdGlwbGUgdG9rZW5zLCBpdCBpcyBpbnZhbGlkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobGV4KCkgIT0gXCIkXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlc2V0IHRoZSBwYXJzZXIgc3RhdGUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4ID0gU291cmNlID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrICYmIGdldENsYXNzLmNhbGwoY2FsbGJhY2spID09IGZ1bmN0aW9uQ2xhc3MgPyB3YWxrKCh2YWx1ZSA9IHt9LCB2YWx1ZVtcIlwiXSA9IHJlc3VsdCwgdmFsdWUpLCBcIlwiLCBjYWxsYmFjaykgOiByZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGV4cG9ydHNbXCJydW5JbkNvbnRleHRcIl0gPSBydW5JbkNvbnRleHQ7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBleHBvcnRzO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoZnJlZUV4cG9ydHMgJiYgIWlzTG9hZGVyKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEV4cG9ydCBmb3IgQ29tbW9uSlMgZW52aXJvbm1lbnRzLlxuXHRcdFx0XHRcdFx0XHRydW5JbkNvbnRleHQocm9vdCwgZnJlZUV4cG9ydHMpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gRXhwb3J0IGZvciB3ZWIgYnJvd3NlcnMgYW5kIEphdmFTY3JpcHQgZW5naW5lcy5cblx0XHRcdFx0XHRcdFx0dmFyIG5hdGl2ZUpTT04gPSByb290LkpTT04sXG5cdFx0XHRcdFx0XHRcdCAgICBwcmV2aW91c0pTT04gPSByb290W1wiSlNPTjNcIl0sXG5cdFx0XHRcdFx0XHRcdCAgICBpc1Jlc3RvcmVkID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdFx0dmFyIEpTT04zID0gcnVuSW5Db250ZXh0KHJvb3QsIHJvb3RbXCJKU09OM1wiXSA9IHtcblx0XHRcdFx0XHRcdFx0XHQvLyBQdWJsaWM6IFJlc3RvcmVzIHRoZSBvcmlnaW5hbCB2YWx1ZSBvZiB0aGUgZ2xvYmFsIGBKU09OYCBvYmplY3QgYW5kXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYEpTT04zYCBvYmplY3QuXG5cdFx0XHRcdFx0XHRcdFx0XCJub0NvbmZsaWN0XCI6IGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIWlzUmVzdG9yZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aXNSZXN0b3JlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJvb3QuSlNPTiA9IG5hdGl2ZUpTT047XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJvb3RbXCJKU09OM1wiXSA9IHByZXZpb3VzSlNPTjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmF0aXZlSlNPTiA9IHByZXZpb3VzSlNPTiA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gSlNPTjM7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0XHRyb290LkpTT04gPSB7XG5cdFx0XHRcdFx0XHRcdFx0XCJwYXJzZVwiOiBKU09OMy5wYXJzZSxcblx0XHRcdFx0XHRcdFx0XHRcInN0cmluZ2lmeVwiOiBKU09OMy5zdHJpbmdpZnlcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gRXhwb3J0IGZvciBhc3luY2hyb25vdXMgbW9kdWxlIGxvYWRlcnMuXG5cdFx0XHRcdFx0XHRpZiAoaXNMb2FkZXIpIHtcblx0XHRcdFx0XHRcdFx0ZGVmaW5lKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gSlNPTjM7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pLmNhbGwodGhpcyk7XG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSk7XG5cdFx0XHR9LCB7fV0sIDUxOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IHRvQXJyYXk7XG5cblx0XHRcdFx0ZnVuY3Rpb24gdG9BcnJheShsaXN0LCBpbmRleCkge1xuXHRcdFx0XHRcdHZhciBhcnJheSA9IFtdO1xuXG5cdFx0XHRcdFx0aW5kZXggPSBpbmRleCB8fCAwO1xuXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IGluZGV4IHx8IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRhcnJheVtpIC0gaW5kZXhdID0gbGlzdFtpXTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gYXJyYXk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIHt9XSB9LCB7fSwgWzMxXSkoMzEpO1xuXHR9KTtcbn1cblxuY2MuX1JGcG9wKCk7Il19
