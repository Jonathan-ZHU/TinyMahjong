{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "tipLabel",
    "Label",
    "_stateStr",
    "_progress",
    "_splash",
    "_isLoading",
    "onLoad",
    "sys",
    "isNative",
    "isMobile",
    "cvs",
    "node",
    "getComponent",
    "Canvas",
    "fitHeight",
    "fitWidth",
    "initMgr",
    "string",
    "find",
    "active",
    "start",
    "self",
    "SHOW_TIME",
    "FADE_TIME",
    "os",
    "OS_IOS",
    "t",
    "Date",
    "now",
    "fn",
    "dt",
    "setTimeout",
    "op",
    "opacity",
    "checkVersion",
    "vv",
    "UserMgr",
    "require",
    "userMgr",
    "ReplayMgr",
    "replayMgr",
    "http",
    "global",
    "net",
    "GameNetMgr",
    "gameNetMgr",
    "initHandlers",
    "AnysdkMgr",
    "anysdkMgr",
    "init",
    "VoiceMgr",
    "voiceMgr",
    "AudioMgr",
    "audioMgr",
    "Utils",
    "utils",
    "args",
    "urlParse",
    "params",
    "window",
    "location",
    "name",
    "value",
    "str",
    "href",
    "num",
    "indexOf",
    "substr",
    "arr",
    "split",
    "i",
    "length",
    "substring",
    "onGetVersion",
    "ret",
    "version",
    "console",
    "log",
    "SI",
    "VERSION",
    "startPreloading",
    "xhr",
    "complete",
    "fnRequest",
    "sendRequest",
    "abort",
    "onBtnDownloadClicked",
    "openURL",
    "appweb",
    "loader",
    "onProgress",
    "completedCount",
    "totalCount",
    "item",
    "loadResAll",
    "err",
    "assets",
    "onLoadComplete",
    "director",
    "loadScene",
    "onComplete",
    "update",
    "Math",
    "floor"
  ],
  "mappings": ";;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAASL,GAAGM,KADJ;AAERC,mBAAU,EAFF;AAGRC,mBAAU,GAHF;AAIRC,iBAAQ,IAJA;AAKRC,oBAAW;AALH,KAHP;;AAWL;AACAC,YAAQ,kBAAY;AAChB,YAAG,CAACX,GAAGY,GAAH,CAAOC,QAAR,IAAoBb,GAAGY,GAAH,CAAOE,QAA9B,EAAuC;AACnC,gBAAIC,MAAM,KAAKC,IAAL,CAAUC,YAAV,CAAuBjB,GAAGkB,MAA1B,CAAV;AACAH,gBAAII,SAAJ,GAAgB,IAAhB;AACAJ,gBAAIK,QAAJ,GAAe,IAAf;AACH;AACD,aAAKC,OAAL;AACA,aAAKhB,QAAL,CAAciB,MAAd,GAAuB,KAAKf,SAA5B;;AAEA,aAAKE,OAAL,GAAeT,GAAGuB,IAAH,CAAQ,eAAR,CAAf;AACA,aAAKd,OAAL,CAAae,MAAb,GAAsB,IAAtB;AACH,KAvBI;;AAyBLC,WAAM,iBAAU;AACZ,YAAIC,OAAO,IAAX;AACA,YAAIC,YAAY,IAAhB;AACA,YAAIC,YAAY,GAAhB;AACA,YAAG5B,GAAGY,GAAH,CAAOiB,EAAP,IAAa7B,GAAGY,GAAH,CAAOkB,MAApB,IAA8B,CAAC9B,GAAGY,GAAH,CAAOC,QAAzC,EAAkD;AAC9Ca,iBAAKjB,OAAL,CAAae,MAAb,GAAsB,IAAtB;AACA,gBAAIO,IAAIC,KAAKC,GAAL,EAAR;AACA,gBAAIC,KAAK,SAALA,EAAK,GAAU;AACf,oBAAIC,KAAKH,KAAKC,GAAL,KAAaF,CAAtB;AACA,oBAAGI,KAAKR,SAAR,EAAkB;AACdS,+BAAWF,EAAX,EAAc,EAAd;AACH,iBAFD,MAGK;AACD,wBAAIG,KAAK,CAAC,IAAK,CAACF,KAAKR,SAAN,IAAmBC,SAAzB,IAAuC,GAAhD;AACA,wBAAGS,KAAK,CAAR,EAAU;AACNX,6BAAKjB,OAAL,CAAa6B,OAAb,GAAuB,CAAvB;AACAZ,6BAAKa,YAAL;AACH,qBAHD,MAII;AACAb,6BAAKjB,OAAL,CAAa6B,OAAb,GAAuBD,EAAvB;AACAD,mCAAWF,EAAX,EAAc,EAAd;AACH;AACJ;AACJ,aAhBD;AAiBAE,uBAAWF,EAAX,EAAc,EAAd;AACH,SArBD,MAsBI;AACA,iBAAKzB,OAAL,CAAae,MAAb,GAAsB,KAAtB;AACA,iBAAKe,YAAL;AACH;AACJ,KAvDI;;AAyDLlB,aAAQ,mBAAU;AACdrB,WAAGwC,EAAH,GAAQ,EAAR;AACA,YAAIC,UAAUC,QAAQ,SAAR,CAAd;AACA1C,WAAGwC,EAAH,CAAMG,OAAN,GAAgB,IAAIF,OAAJ,EAAhB;;AAEA,YAAIG,YAAYF,QAAQ,WAAR,CAAhB;AACA1C,WAAGwC,EAAH,CAAMK,SAAN,GAAkB,IAAID,SAAJ,EAAlB;;AAEA5C,WAAGwC,EAAH,CAAMM,IAAN,GAAaJ,QAAQ,MAAR,CAAb;AACA1C,WAAGwC,EAAH,CAAMO,MAAN,GAAeL,QAAQ,QAAR,CAAf;AACA1C,WAAGwC,EAAH,CAAMQ,GAAN,GAAYN,QAAQ,KAAR,CAAZ;;AAEA,YAAIO,aAAaP,QAAQ,YAAR,CAAjB;AACA1C,WAAGwC,EAAH,CAAMU,UAAN,GAAmB,IAAID,UAAJ,EAAnB;AACAjD,WAAGwC,EAAH,CAAMU,UAAN,CAAiBC,YAAjB;;AAEA,YAAIC,YAAYV,QAAQ,WAAR,CAAhB;AACA1C,WAAGwC,EAAH,CAAMa,SAAN,GAAkB,IAAID,SAAJ,EAAlB;AACApD,WAAGwC,EAAH,CAAMa,SAAN,CAAgBC,IAAhB;;AAEA,YAAIC,WAAWb,QAAQ,UAAR,CAAf;AACA1C,WAAGwC,EAAH,CAAMgB,QAAN,GAAiB,IAAID,QAAJ,EAAjB;AACAvD,WAAGwC,EAAH,CAAMgB,QAAN,CAAeF,IAAf;;AAEA,YAAIG,WAAWf,QAAQ,UAAR,CAAf;AACA1C,WAAGwC,EAAH,CAAMkB,QAAN,GAAiB,IAAID,QAAJ,EAAjB;AACAzD,WAAGwC,EAAH,CAAMkB,QAAN,CAAeJ,IAAf;;AAEA,YAAIK,QAAQjB,QAAQ,OAAR,CAAZ;AACA1C,WAAGwC,EAAH,CAAMoB,KAAN,GAAc,IAAID,KAAJ,EAAd;;AAEA3D,WAAG6D,IAAH,GAAU,KAAKC,QAAL,EAAV;AACH,KAzFI;;AA2FLA,cAAS,oBAAU;AACf,YAAIC,SAAS,EAAb;AACA,YAAGC,OAAOC,QAAP,IAAmB,IAAtB,EAA2B;AACvB,mBAAOF,MAAP;AACH;AACD,YAAIG,IAAJ,EAASC,KAAT;AACA,YAAIC,MAAIJ,OAAOC,QAAP,CAAgBI,IAAxB,CANe,CAMe;AAC9B,YAAIC,MAAIF,IAAIG,OAAJ,CAAY,GAAZ,CAAR;AACAH,cAAIA,IAAII,MAAJ,CAAWF,MAAI,CAAf,CAAJ,CARe,CAQQ;;AAEvB,YAAIG,MAAIL,IAAIM,KAAJ,CAAU,GAAV,CAAR,CAVe,CAUS;AACxB,aAAI,IAAIC,IAAE,CAAV,EAAYA,IAAIF,IAAIG,MAApB,EAA2BD,GAA3B,EAA+B;AAC3BL,kBAAIG,IAAIE,CAAJ,EAAOJ,OAAP,CAAe,GAAf,CAAJ;AACA,gBAAGD,MAAI,CAAP,EAAS;AACLJ,uBAAKO,IAAIE,CAAJ,EAAOE,SAAP,CAAiB,CAAjB,EAAmBP,GAAnB,CAAL;AACAH,wBAAMM,IAAIE,CAAJ,EAAOH,MAAP,CAAcF,MAAI,CAAlB,CAAN;AACAP,uBAAOG,IAAP,IAAaC,KAAb;AACH;AACJ;AACD,eAAOJ,MAAP;AACH,KA/GI;;AAiHLxB,kBAAa,wBAAU;AACnB,YAAIb,OAAO,IAAX;AACA,YAAIoD,eAAe,SAAfA,YAAe,CAASC,GAAT,EAAa;AAC5B,gBAAGA,IAAIC,OAAJ,IAAe,IAAlB,EAAuB;AACnBC,wBAAQC,GAAR,CAAY,QAAZ;AACH,aAFD,MAGI;AACAlF,mBAAGwC,EAAH,CAAM2C,EAAN,GAAWJ,GAAX;AACA,oBAAGA,IAAIC,OAAJ,IAAehF,GAAGoF,OAArB,EAA6B;AACzBpF,uBAAGuB,IAAH,CAAQ,cAAR,EAAwBC,MAAxB,GAAiC,IAAjC;AACH,iBAFD,MAGI;AACAE,yBAAK2D,eAAL;AACH;AACJ;AACJ,SAbD;;AAeA,YAAIC,MAAM,IAAV;AACA,YAAIC,WAAW,KAAf;AACA,YAAIC,YAAY,SAAZA,SAAY,GAAU;AACtB9D,iBAAKnB,SAAL,GAAiB,SAAjB;AACA+E,kBAAMtF,GAAGwC,EAAH,CAAMM,IAAN,CAAW2C,WAAX,CAAuB,iBAAvB,EAAyC,IAAzC,EAA8C,UAASV,GAAT,EAAa;AAC7DO,sBAAM,IAAN;AACAC,2BAAW,IAAX;AACAT,6BAAaC,GAAb;AACH,aAJK,CAAN;AAKA3C,uBAAWF,EAAX,EAAc,IAAd;AACH,SARD;;AAUA,YAAIA,KAAK,SAALA,EAAK,GAAU;AACf,gBAAG,CAACqD,QAAJ,EAAa;AACT,oBAAGD,GAAH,EAAO;AACHA,wBAAII,KAAJ;AACAhE,yBAAKnB,SAAL,GAAiB,WAAjB;AACA6B,+BAAW,YAAU;AACjBoD;AACH,qBAFD,EAEE,IAFF;AAGH,iBAND,MAOI;AACAA;AACH;AACJ;AACJ,SAbD;AAcAtD;AACH,KA7JI;;AA+JLyD,0BAAqB,gCAAU;AAC3B3F,WAAGY,GAAH,CAAOgF,OAAP,CAAe5F,GAAGwC,EAAH,CAAM2C,EAAN,CAASU,MAAxB;AACH,KAjKI;;AAmKLR,qBAAgB,2BAAU;AACtB,aAAK9E,SAAL,GAAiB,YAAjB;AACA,aAAKG,UAAL,GAAkB,IAAlB;AACA,YAAIgB,OAAO,IAAX;;AAEA1B,WAAG8F,MAAH,CAAUC,UAAV,GAAuB,UAAWC,cAAX,EAA2BC,UAA3B,EAAwCC,IAAxC,EAA8C;AACjE;AACA,gBAAGxE,KAAKhB,UAAR,EAAmB;AACfgB,qBAAKlB,SAAL,GAAiBwF,iBAAeC,UAAhC;AACH;AACJ,SALD;;AAOAjG,WAAG8F,MAAH,CAAUK,UAAV,CAAqB,UAArB,EAAiC,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACpD3E,iBAAK4E,cAAL;AACH,SAFD;AAGH,KAlLI;;AAoLLA,oBAAe,0BAAU;AACrB,aAAK5F,UAAL,GAAkB,KAAlB;AACA,aAAKH,SAAL,GAAiB,MAAjB;AACAP,WAAGuG,QAAH,CAAYC,SAAZ,CAAsB,OAAtB;AACAxG,WAAG8F,MAAH,CAAUW,UAAV,GAAuB,IAAvB;AACH,KAzLI;;AA2LL;AACAC,YAAQ,gBAAUvE,EAAV,EAAc;AAClB,YAAG,KAAK5B,SAAL,CAAeqE,MAAf,IAAyB,CAA5B,EAA8B;AAC1B;AACH;AACD,aAAKvE,QAAL,CAAciB,MAAd,GAAuB,KAAKf,SAAL,GAAiB,GAAxC;AACA,YAAG,KAAKG,UAAR,EAAmB;AACf,iBAAKL,QAAL,CAAciB,MAAd,IAAwBqF,KAAKC,KAAL,CAAW,KAAKpG,SAAL,GAAiB,GAA5B,IAAmC,GAA3D;AACH,SAFD,MAGI;AACA,gBAAIuB,IAAI4E,KAAKC,KAAL,CAAW5E,KAAKC,GAAL,KAAa,IAAxB,IAAgC,CAAxC;AACA,iBAAI,IAAI0C,IAAI,CAAZ,EAAeA,IAAI5C,CAAnB,EAAsB,EAAG4C,CAAzB,EAA2B;AACvB,qBAAKtE,QAAL,CAAciB,MAAd,IAAwB,GAAxB;AACH;AACJ;AACJ;AA1MI,CAAT",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        tipLabel:cc.Label,\r\n        _stateStr:'',\r\n        _progress:0.0,\r\n        _splash:null,\r\n        _isLoading:false,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        if(!cc.sys.isNative && cc.sys.isMobile){\r\n            var cvs = this.node.getComponent(cc.Canvas);\r\n            cvs.fitHeight = true;\r\n            cvs.fitWidth = true;\r\n        }\r\n        this.initMgr();\r\n        this.tipLabel.string = this._stateStr;\r\n        \r\n        this._splash = cc.find(\"Canvas/splash\");\r\n        this._splash.active = true;\r\n    },\r\n    \r\n    start:function(){        \r\n        var self = this;\r\n        var SHOW_TIME = 3000;\r\n        var FADE_TIME = 500;\r\n        if(cc.sys.os != cc.sys.OS_IOS || !cc.sys.isNative){\r\n            self._splash.active = true;\r\n            var t = Date.now();\r\n            var fn = function(){\r\n                var dt = Date.now() - t;\r\n                if(dt < SHOW_TIME){\r\n                    setTimeout(fn,33);\r\n                }\r\n                else {\r\n                    var op = (1 - ((dt - SHOW_TIME) / FADE_TIME)) * 255;\r\n                    if(op < 0){\r\n                        self._splash.opacity = 0;\r\n                        self.checkVersion();    \r\n                    }\r\n                    else{\r\n                        self._splash.opacity = op;\r\n                        setTimeout(fn,33);   \r\n                    }\r\n                }\r\n            };\r\n            setTimeout(fn,33);\r\n        }\r\n        else{\r\n            this._splash.active = false;\r\n            this.checkVersion();\r\n        }\r\n    },\r\n    \r\n    initMgr:function(){\r\n        cc.vv = {};\r\n        var UserMgr = require(\"UserMgr\");\r\n        cc.vv.userMgr = new UserMgr();\r\n        \r\n        var ReplayMgr = require(\"ReplayMgr\");\r\n        cc.vv.replayMgr = new ReplayMgr();\r\n        \r\n        cc.vv.http = require(\"HTTP\");\r\n        cc.vv.global = require(\"Global\");\r\n        cc.vv.net = require(\"Net\");\r\n        \r\n        var GameNetMgr = require(\"GameNetMgr\");\r\n        cc.vv.gameNetMgr = new GameNetMgr();\r\n        cc.vv.gameNetMgr.initHandlers();\r\n        \r\n        var AnysdkMgr = require(\"AnysdkMgr\");\r\n        cc.vv.anysdkMgr = new AnysdkMgr();\r\n        cc.vv.anysdkMgr.init();\r\n        \r\n        var VoiceMgr = require(\"VoiceMgr\");\r\n        cc.vv.voiceMgr = new VoiceMgr();\r\n        cc.vv.voiceMgr.init();\r\n        \r\n        var AudioMgr = require(\"AudioMgr\");\r\n        cc.vv.audioMgr = new AudioMgr();\r\n        cc.vv.audioMgr.init();\r\n        \r\n        var Utils = require(\"Utils\");\r\n        cc.vv.utils = new Utils();\r\n        \r\n        cc.args = this.urlParse();\r\n    },\r\n    \r\n    urlParse:function(){\r\n        var params = {};\r\n        if(window.location == null){\r\n            return params;\r\n        }\r\n        var name,value; \r\n        var str=window.location.href; //取得整个地址栏\r\n        var num=str.indexOf(\"?\") \r\n        str=str.substr(num+1); //取得所有参数   stringvar.substr(start [, length ]\r\n        \r\n        var arr=str.split(\"&\"); //各个参数放到数组里\r\n        for(var i=0;i < arr.length;i++){ \r\n            num=arr[i].indexOf(\"=\"); \r\n            if(num>0){ \r\n                name=arr[i].substring(0,num);\r\n                value=arr[i].substr(num+1);\r\n                params[name]=value;\r\n            } \r\n        }\r\n        return params;\r\n    },\r\n    \r\n    checkVersion:function(){\r\n        var self = this;\r\n        var onGetVersion = function(ret){\r\n            if(ret.version == null){\r\n                console.log(\"error.\");\r\n            }\r\n            else{\r\n                cc.vv.SI = ret;\r\n                if(ret.version != cc.VERSION){\r\n                    cc.find(\"Canvas/alert\").active = true;\r\n                }\r\n                else{\r\n                    self.startPreloading();\r\n                }\r\n            }\r\n        };\r\n        \r\n        var xhr = null;\r\n        var complete = false;\r\n        var fnRequest = function(){\r\n            self._stateStr = \"正在连接服务器\";\r\n            xhr = cc.vv.http.sendRequest(\"/get_serverinfo\",null,function(ret){\r\n                xhr = null;\r\n                complete = true;\r\n                onGetVersion(ret);\r\n            });\r\n            setTimeout(fn,5000);            \r\n        }\r\n        \r\n        var fn = function(){\r\n            if(!complete){\r\n                if(xhr){\r\n                    xhr.abort();\r\n                    self._stateStr = \"连接失败，即将重试\";\r\n                    setTimeout(function(){\r\n                        fnRequest();\r\n                    },5000);\r\n                }\r\n                else{\r\n                    fnRequest();\r\n                }\r\n            }\r\n        };\r\n        fn();\r\n    },\r\n    \r\n    onBtnDownloadClicked:function(){\r\n        cc.sys.openURL(cc.vv.SI.appweb);\r\n    },\r\n    \r\n    startPreloading:function(){\r\n        this._stateStr = \"正在加载资源，请稍候\";\r\n        this._isLoading = true;\r\n        var self = this;\r\n        \r\n        cc.loader.onProgress = function ( completedCount, totalCount,  item ){\r\n            //console.log(\"completedCount:\" + completedCount + \",totalCount:\" + totalCount );\r\n            if(self._isLoading){\r\n                self._progress = completedCount/totalCount;\r\n            }\r\n        };\r\n        \r\n        cc.loader.loadResAll(\"textures\", function (err, assets) {\r\n            self.onLoadComplete();\r\n        });      \r\n    },\r\n    \r\n    onLoadComplete:function(){\r\n        this._isLoading = false;\r\n        this._stateStr = \"准备登陆\";\r\n        cc.director.loadScene(\"login\");\r\n        cc.loader.onComplete = null;\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        if(this._stateStr.length == 0){\r\n            return;\r\n        }\r\n        this.tipLabel.string = this._stateStr + ' ';\r\n        if(this._isLoading){\r\n            this.tipLabel.string += Math.floor(this._progress * 100) + \"%\";   \r\n        }\r\n        else{\r\n            var t = Math.floor(Date.now() / 1000) % 4;\r\n            for(var i = 0; i < t; ++ i){\r\n                this.tipLabel.string += '.';\r\n            }            \r\n        }\r\n    }\r\n});"
  ]
}