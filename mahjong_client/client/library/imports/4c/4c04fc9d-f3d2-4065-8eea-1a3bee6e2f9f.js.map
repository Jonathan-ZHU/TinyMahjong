{"version":3,"sources":["assets/scripts/components/Settings.js"],"names":["cc","Class","extends","Component","properties","_btnYXOpen","_btnYXClose","_btnYYOpen","_btnYYClose","onLoad","vv","node","getChildByName","initButtonHandler","slider","utils","addSlideEvent","refreshVolume","onSlided","parent","name","audioMgr","setSFXVolume","progress","setBGMVolume","btn","addClickEvent","active","sfxVolume","yx","width","getComponent","Slider","bgmVolume","yy","onBtnClicked","event","target","sys","localStorage","removeItem","director","loadScene"],"mappings":"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","file":"unknown","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,      // The default value will be used only when the component attaching\n        //                           to a node for the first time\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        _btnYXOpen:null,\n        _btnYXClose:null,\n        _btnYYOpen:null,\n        _btnYYClose:null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        if(cc.vv == null){\n            return;\n        }\n                \n        this._btnYXOpen = this.node.getChildByName(\"yinxiao\").getChildByName(\"btn_yx_open\");\n        this._btnYXClose = this.node.getChildByName(\"yinxiao\").getChildByName(\"btn_yx_close\");\n        \n        this._btnYYOpen = this.node.getChildByName(\"yinyue\").getChildByName(\"btn_yy_open\");\n        this._btnYYClose = this.node.getChildByName(\"yinyue\").getChildByName(\"btn_yy_close\");\n        \n        this.initButtonHandler(this.node.getChildByName(\"btn_close\"));\n        this.initButtonHandler(this.node.getChildByName(\"btn_exit\"));\n        \n        \n        this.initButtonHandler(this._btnYXOpen);\n        this.initButtonHandler(this._btnYXClose);\n        this.initButtonHandler(this._btnYYOpen);\n        this.initButtonHandler(this._btnYYClose);\n        \n\n        var slider = this.node.getChildByName(\"yinxiao\").getChildByName(\"progress\");\n        cc.vv.utils.addSlideEvent(slider,this.node,\"Settings\",\"onSlided\");\n        \n        var slider = this.node.getChildByName(\"yinyue\").getChildByName(\"progress\");\n        cc.vv.utils.addSlideEvent(slider,this.node,\"Settings\",\"onSlided\");\n        \n        this.refreshVolume();\n    },\n    \n    onSlided:function(slider){\n        if(slider.node.parent.name == \"yinxiao\"){\n            cc.vv.audioMgr.setSFXVolume(slider.progress);\n        }\n        else if(slider.node.parent.name == \"yinyue\"){\n            cc.vv.audioMgr.setBGMVolume(slider.progress);\n        }\n        this.refreshVolume();\n    },\n    \n    initButtonHandler:function(btn){\n        cc.vv.utils.addClickEvent(btn,this.node,\"Settings\",\"onBtnClicked\");    \n    },\n    \n    refreshVolume:function(){\n        \n        this._btnYXClose.active = cc.vv.audioMgr.sfxVolume > 0;\n        this._btnYXOpen.active = !this._btnYXClose.active;\n        \n        var yx = this.node.getChildByName(\"yinxiao\");\n        var width = 368 * cc.vv.audioMgr.sfxVolume;\n        var progress = yx.getChildByName(\"progress\")\n        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.sfxVolume;\n        progress.getChildByName(\"progress\").width = width;  \n        //yx.getChildByName(\"btn_progress\").x = progress.x + width;\n        \n        \n        this._btnYYClose.active = cc.vv.audioMgr.bgmVolume > 0;\n        this._btnYYOpen.active = !this._btnYYClose.active;\n        var yy = this.node.getChildByName(\"yinyue\");\n        var width = 368 * cc.vv.audioMgr.bgmVolume;\n        var progress = yy.getChildByName(\"progress\");\n        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.bgmVolume; \n        \n        progress.getChildByName(\"progress\").width = width;\n        //yy.getChildByName(\"btn_progress\").x = progress.x + width;\n    },\n    \n    onBtnClicked:function(event){\n        if(event.target.name == \"btn_close\"){\n            this.node.active = false;\n        }\n        else if(event.target.name == \"btn_exit\"){\n            cc.sys.localStorage.removeItem(\"wx_account\");\n            cc.sys.localStorage.removeItem(\"wx_sign\");\n            cc.director.loadScene(\"login\");\n        }\n        else if(event.target.name == \"btn_yx_open\"){\n            cc.vv.audioMgr.setSFXVolume(1.0);\n            this.refreshVolume(); \n        }\n        else if(event.target.name == \"btn_yx_close\"){\n            cc.vv.audioMgr.setSFXVolume(0);\n            this.refreshVolume();\n        }\n        else if(event.target.name == \"btn_yy_open\"){\n            cc.vv.audioMgr.setBGMVolume(1);\n            this.refreshVolume();\n        }\n        else if(event.target.name == \"btn_yy_close\"){\n            cc.vv.audioMgr.setBGMVolume(0);\n            this.refreshVolume();\n        }\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}