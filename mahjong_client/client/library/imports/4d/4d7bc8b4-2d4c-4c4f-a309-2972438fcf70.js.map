{"version":3,"sources":["assets/scripts/components/History.js"],"names":["cc","Class","extends","Component","properties","HistoryItemPrefab","default","type","Prefab","_history","_viewlist","_content","_viewitemTemp","_historyData","_curRoomInfo","_emptyTip","onLoad","node","getChildByName","active","find","children","removeChild","addClickEvent","target","component","handler","eventHandler","EventHandler","clickEvents","getComponent","Button","push","onBtnBackClicked","initRoomHistoryList","onBtnHistoryClicked","self","vv","userMgr","getHistoryList","data","sort","a","b","time","i","length","j","s","seats","name","Buffer","toString","dateFormat","date","Date","datetime","year","getFullYear","month","getMonth","day","getDate","h","getHours","m","getMinutes","getSeconds","format","console","log","getViewItem","idx","titleId","Label","string","id","btnOp","info","score","shrinkContent","initGameHistoryList","roomInfo","create_time","result","JSON","parse","index","content","childrenCount","instantiate","addChild","num","lastOne","getGameListOfRoom","getGamesOfRoom","uuid","getDetailOfGame","roomUUID","base_info","action_records","gameNetMgr","prepareReplay","replayMgr","init","director","loadScene","onViewItemClicked","event","onBtnOpClicked","parent"],"mappings":"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","file":"unknown","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        HistoryItemPrefab:{\n            default:null,\n            type:cc.Prefab,\n        },\n        // foo: {\n        //    default: null,\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n        _history:null,\n        _viewlist:null,\n        _content:null,\n        _viewitemTemp:null,\n        _historyData:null,\n        _curRoomInfo:null,\n        _emptyTip:null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this._history = this.node.getChildByName(\"history\");\n        this._history.active = false;\n        \n        this._emptyTip = this._history.getChildByName(\"emptyTip\");\n        this._emptyTip.active = true;\n        \n        this._viewlist = this._history.getChildByName(\"viewlist\");\n        this._content = cc.find(\"view/content\",this._viewlist);\n        \n        this._viewitemTemp = this._content.children[0];\n        this._content.removeChild(this._viewitemTemp);\n\n        var node = cc.find(\"Canvas/right_bottom/btn_zhanji\");        \n        this.addClickEvent(node,this.node,\"History\",\"onBtnHistoryClicked\");\n        \n        var node = cc.find(\"Canvas/history/btn_back\");  \n        this.addClickEvent(node,this.node,\"History\",\"onBtnBackClicked\");\n    },\n    \n    addClickEvent:function(node,target,component,handler){\n        var eventHandler = new cc.Component.EventHandler();\n        eventHandler.target = target;\n        eventHandler.component = component;\n        eventHandler.handler = handler;\n\n        var clickEvents = node.getComponent(cc.Button).clickEvents;\n        clickEvents.push(eventHandler);\n    },\n    \n    onBtnBackClicked:function(){\n        if(this._curRoomInfo == null){\n            this._historyData = null;\n            this._history.active = false;            \n        }\n        else{\n            this.initRoomHistoryList(this._historyData);   \n        }\n    },\n    \n    onBtnHistoryClicked:function(){\n        this._history.active = true;\n        var self = this;\n        cc.vv.userMgr.getHistoryList(function(data){\n            data.sort(function(a,b){\n                return a.time < b.time; \n            });\n            self._historyData = data;\n            for(var i = 0; i < data.length; ++i){\n                for(var j = 0; j < 4; ++j){\n                    var s = data[i].seats[j];\n                    s.name = new Buffer(s.name,'base64').toString();\n                }\n            }\n            self.initRoomHistoryList(data);\n            \n        });\n    },\n    \n    dateFormat:function(time){\n        var date = new Date(time);\n        var datetime = \"{0}-{1}-{2} {3}:{4}:{5}\";\n        var year = date.getFullYear();\n        var month = date.getMonth() + 1;\n        month = month >= 10? month : (\"0\"+month);\n        var day = date.getDate();\n        day = day >= 10? day : (\"0\"+day);\n        var h = date.getHours();\n        h = h >= 10? h : (\"0\"+h);\n        var m = date.getMinutes();\n        m = m >= 10? m : (\"0\"+m);\n        var s = date.getSeconds();\n        s = s >= 10? s : (\"0\"+s);\n        datetime = datetime.format(year,month,day,h,m,s);\n        return datetime;\n    },\n    \n    initRoomHistoryList:function(data){\n        console.log(\"initRoomHistoryList\");\n        for(var i = 0; i < data.length; ++i){\n            var node = this.getViewItem(i);\n            node.idx = i;\n            var titleId = \"\" + (i + 1);\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + data[i].id;\n            var datetime = this.dateFormat(data[i].time * 1000);\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\n            \n            console.log(1);\n            \n            var btnOp = node.getChildByName(\"btnOp\");\n            btnOp.idx = i;\n            //btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"详情\";\n            \n            console.log(2);\n            \n            for(var j = 0; j < 4; ++j){\n                var s = data[i].seats[j];\n                var info = s.name + \":\" +  s.score;\n                //console.log(info);\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\n            }\n            \n            console.log(3);\n        }\n        this._emptyTip.active = data.length == 0;\n        console.log(this._emptyTip.active);\n        this.shrinkContent(data.length);\n        this._curRoomInfo = null;\n    },\n    \n    initGameHistoryList:function(roomInfo,data){\n        console.log(\"initGameHistoryList\");\n        data.sort(function(a,b){\n           return a.create_time < b.create_time; \n        });\n        for(var i = 0; i < data.length; ++i){\n            var node = this.getViewItem(i);\n            var idx = data.length - i - 1;\n            node.idx = idx;\n            var titleId = \"\" + (idx + 1);\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + roomInfo.id;\n            var datetime = this.dateFormat(data[i].create_time * 1000);\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\n            \n            var btnOp = node.getChildByName(\"btnOp\");\n            btnOp.idx = idx; \n            //btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"回放\";\n            \n            var result = JSON.parse(data[i].result);\n            for(var j = 0; j < 4; ++j){\n                var s = roomInfo.seats[j];\n                var info = s.name + \":\" + result[j];\n                //console.log(info);\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\n            }\n        }\n        this.shrinkContent(data.length);\n        this._curRoomInfo = roomInfo;\n    },\n    \n    getViewItem:function(index){\n        var content = this._content;\n        if(content.childrenCount > index){\n            return content.children[index];\n        }\n        var node = cc.instantiate(this._viewitemTemp);\n        content.addChild(node);\n        return node;\n    },\n    shrinkContent:function(num){\n        while(this._content.childrenCount > num){\n            var lastOne = this._content.children[this._content.childrenCount -1];\n            this._content.removeChild(lastOne,true);\n        }\n    },\n    \n    getGameListOfRoom:function(idx){\n        var self = this;\n        var roomInfo = this._historyData[idx];        \n        cc.vv.userMgr.getGamesOfRoom(roomInfo.uuid,function(data){\n            if(data != null && data.length > 0){\n                self.initGameHistoryList(roomInfo,data);\n            }\n        });\n    },\n    \n    getDetailOfGame:function(idx){\n        var self = this;\n        var roomUUID = this._curRoomInfo.uuid;\n        cc.vv.userMgr.getDetailOfGame(roomUUID,idx,function(data){\n            data.base_info = JSON.parse(data.base_info);\n            data.action_records = JSON.parse(data.action_records);\n            cc.vv.gameNetMgr.prepareReplay(self._curRoomInfo,data);\n            cc.vv.replayMgr.init(data);\n            cc.director.loadScene(\"mjgame\"); \n        });\n    },\n    \n    onViewItemClicked:function(event){\n        var idx = event.target.idx;\n        console.log(idx);\n        if(this._curRoomInfo == null){\n            this.getGameListOfRoom(idx);\n        }\n        else{\n            this.getDetailOfGame(idx+1);      \n        }\n    },\n    \n    onBtnOpClicked:function(event){\n        var idx = event.target.parent.idx;\n        console.log(idx);\n        if(this._curRoomInfo == null){\n            this.getGameListOfRoom(idx);\n        }\n        else{\n            this.getDetailOfGame(idx+1);      \n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}