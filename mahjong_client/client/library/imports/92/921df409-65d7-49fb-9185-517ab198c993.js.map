{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "lblRoomNo",
    "default",
    "type",
    "Label",
    "_seats",
    "_seats2",
    "_timeLabel",
    "_voiceMsgQueue",
    "_lastPlayingSeat",
    "_playingSeat",
    "_lastPlayTime",
    "onLoad",
    "vv",
    "initView",
    "initSeats",
    "initEventHandlers",
    "prepare",
    "node",
    "getChildByName",
    "seats",
    "i",
    "children",
    "length",
    "push",
    "getComponent",
    "refreshBtns",
    "find",
    "string",
    "gameNetMgr",
    "getWanfa",
    "roomId",
    "gameChild",
    "sides",
    "sideNode",
    "seat",
    "btnWechat",
    "utils",
    "addClickEvent",
    "titles",
    "active",
    "conf",
    "btnExit",
    "btnDispress",
    "btnWeichat",
    "btnBack",
    "isIdle",
    "numOfGames",
    "console",
    "log",
    "isOwner",
    "self",
    "on",
    "data",
    "initSingleSeat",
    "detail",
    "refreshXuanPaiState",
    "idx",
    "seatindex",
    "localIdx",
    "getLocalIndex",
    "playVoice",
    "getSeatIndexByID",
    "sender",
    "chat",
    "content",
    "index",
    "info",
    "getQuickChatInfo",
    "audioMgr",
    "playSFX",
    "sound",
    "emoji",
    "isOffline",
    "online",
    "isZhuang",
    "button",
    "setInfo",
    "name",
    "score",
    "setReady",
    "ready",
    "setOffline",
    "setID",
    "userid",
    "voiceMsg",
    "setZhuang",
    "onBtnSettingsClicked",
    "popupMgr",
    "showSettings",
    "onBtnBackClicked",
    "alert",
    "show",
    "director",
    "loadScene",
    "onBtnChatClicked",
    "onBtnWeichatClicked",
    "title",
    "anysdkMgr",
    "share",
    "onBtnDissolveClicked",
    "net",
    "send",
    "onBtnExit",
    "shift",
    "localIndex",
    "msgInfo",
    "JSON",
    "parse",
    "msgfile",
    "msg",
    "voiceMgr",
    "writeVoice",
    "play",
    "Date",
    "now",
    "time",
    "update",
    "dt",
    "minutes",
    "Math",
    "floor",
    "_lastMinute",
    "date",
    "h",
    "getHours",
    "m",
    "getMinutes",
    "onPlayerOver",
    "resumeAll",
    "onDestroy",
    "stop"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        lblRoomNo:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        _seats:[],\r\n        _seats2:[],\r\n        _timeLabel:null,\r\n        _voiceMsgQueue:[],\r\n        _lastPlayingSeat:null,\r\n        _playingSeat:null,\r\n        _lastPlayTime:null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        if(cc.vv == null){\r\n            return;\r\n        }\r\n        \r\n        this.initView();\r\n        this.initSeats();\r\n        this.initEventHandlers();\r\n    },\r\n    \r\n    initView:function(){\r\n        var prepare = this.node.getChildByName(\"prepare\");\r\n        var seats = prepare.getChildByName(\"seats\");\r\n        for(var i = 0; i < seats.children.length; ++i){\r\n            this._seats.push(seats.children[i].getComponent(\"Seat\"));\r\n        }\r\n        \r\n        this.refreshBtns();\r\n        \r\n        this.lblRoomNo = cc.find(\"Canvas/infobar/shijian/Z_room_txt/New Label\").getComponent(cc.Label);\r\n        this._timeLabel = cc.find(\"Canvas/infobar/shijian/time\").getComponent(cc.Label);\r\n        \r\n        //显示玩法\r\n        cc.find(\"Canvas/infobar/wanfa\").getComponent(cc.Label).string =  cc.vv.gameNetMgr.getWanfa();\r\n        \r\n        \r\n        this.lblRoomNo.string = cc.vv.gameNetMgr.roomId;\r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        var sides = [\"myself\",\"right\",\"up\",\"left\"];\r\n        for(var i = 0; i < sides.length; ++i){\r\n            var sideNode = gameChild.getChildByName(sides[i]);\r\n            var seat = sideNode.getChildByName(\"seat\");\r\n            this._seats2.push(seat.getComponent(\"Seat\"));\r\n        }\r\n        \r\n        var btnWechat = cc.find(\"Canvas/prepare/btnWeichat\");\r\n        if(btnWechat){\r\n            cc.vv.utils.addClickEvent(btnWechat,this.node,\"MJRoom\",\"onBtnWeichatClicked\");\r\n        }\r\n        \r\n        \r\n        var titles = cc.find(\"Canvas/typeTitle\");\r\n        for(var i = 0; i < titles.children.length; ++i){\r\n            titles.children[i].active = false;\r\n        }\r\n        \r\n        if(cc.vv.gameNetMgr.conf){\r\n            //TODO:换成相应字样\r\n            // var type = cc.vv.gameNetMgr.conf.type;\r\n            // if(type == null || type == \"\"){\r\n            //     type = \"xzdd\";\r\n            // }\r\n            // titles.getChildByName(type).active = true;   \r\n        }\r\n    },\r\n    \r\n    refreshBtns:function(){\r\n        var prepare = this.node.getChildByName(\"prepare\");\r\n        var btnExit = prepare.getChildByName(\"btnExit\");\r\n        var btnDispress = prepare.getChildByName(\"btnDissolve\");\r\n        var btnWeichat = prepare.getChildByName(\"btnWeichat\");\r\n        var btnBack = prepare.getChildByName(\"btnBack\");\r\n        var isIdle = cc.vv.gameNetMgr.numOfGames == 0;\r\n        console.log('isIdle'+isIdle);\r\n        console.log(cc.vv.gameNetMgr.numOfGames);\r\n        btnExit.active = !cc.vv.gameNetMgr.isOwner() && isIdle;\r\n        btnDispress.active = cc.vv.gameNetMgr.isOwner() && isIdle;\r\n        \r\n        btnWeichat.active = isIdle;\r\n        btnBack.active = isIdle;\r\n    },\r\n    \r\n    initEventHandlers:function(){\r\n        var self = this;\r\n        this.node.on('new_user',function(data){\r\n            self.initSingleSeat(data.detail);\r\n        });\r\n        \r\n        this.node.on('user_state_changed',function(data){\r\n            self.initSingleSeat(data.detail);\r\n        });\r\n        \r\n        this.node.on('game_begin',function(data){\r\n            self.refreshBtns();\r\n            self.initSeats();\r\n        });\r\n        \r\n        this.node.on('game_num',function(data){\r\n            self.refreshBtns();\r\n        });\r\n\r\n        this.node.on('game_huanpai',function(data){\r\n            for(var i in self._seats2){\r\n                self._seats2[i].refreshXuanPaiState();    \r\n            }\r\n        });\r\n                \r\n        this.node.on('huanpai_notify',function(data){\r\n            var idx = data.detail.seatindex;\r\n            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);\r\n            self._seats2[localIdx].refreshXuanPaiState();\r\n        });\r\n        \r\n        this.node.on('game_huanpai_over',function(data){\r\n            for(var i in self._seats2){\r\n                self._seats2[i].refreshXuanPaiState();    \r\n            }\r\n        });\r\n        \r\n        this.node.on('voice_msg',function(data){\r\n            var data = data.detail;\r\n            self._voiceMsgQueue.push(data);\r\n            self.playVoice();\r\n        });\r\n        \r\n        this.node.on('chat_push',function(data){\r\n            var data = data.detail;\r\n            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);\r\n            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);\r\n            self._seats[localIdx].chat(data.content);\r\n            self._seats2[localIdx].chat(data.content);\r\n        });\r\n        \r\n        this.node.on('quick_chat_push',function(data){\r\n            var data = data.detail;\r\n            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);\r\n            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);\r\n            \r\n            var index = data.content;\r\n            var info = cc.vv.chat.getQuickChatInfo(index);\r\n            self._seats[localIdx].chat(info.content);\r\n            self._seats2[localIdx].chat(info.content);\r\n            \r\n            cc.vv.audioMgr.playSFX(info.sound);\r\n        });\r\n        \r\n        this.node.on('emoji_push',function(data){\r\n            var data = data.detail;\r\n            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);\r\n            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);\r\n            console.log(data);\r\n            self._seats[localIdx].emoji(data.content);\r\n            self._seats2[localIdx].emoji(data.content);\r\n        });\r\n    },\r\n    \r\n    initSeats:function(){\r\n        var seats = cc.vv.gameNetMgr.seats;\r\n        for(var i = 0; i < seats.length; ++i){\r\n            this.initSingleSeat(seats[i]);\r\n        }\r\n    },\r\n    \r\n    initSingleSeat:function(seat){\r\n        var index = cc.vv.gameNetMgr.getLocalIndex(seat.seatindex);\r\n        var isOffline = !seat.online;\r\n        var isZhuang = seat.seatindex == cc.vv.gameNetMgr.button;\r\n        \r\n        console.log(\"isOffline:\" + isOffline);\r\n        \r\n        this._seats[index].setInfo(seat.name,seat.score);\r\n        this._seats[index].setReady(seat.ready);\r\n        this._seats[index].setOffline(isOffline);\r\n        this._seats[index].setID(seat.userid);\r\n        this._seats[index].voiceMsg(false);\r\n        \r\n        this._seats2[index].setInfo(seat.name,seat.score);\r\n        this._seats2[index].setZhuang(isZhuang);\r\n        this._seats2[index].setOffline(isOffline);\r\n        this._seats2[index].setID(seat.userid);\r\n        this._seats2[index].voiceMsg(false);\r\n        this._seats2[index].refreshXuanPaiState();\r\n    },\r\n    \r\n    onBtnSettingsClicked:function(){\r\n        cc.vv.popupMgr.showSettings();   \r\n    },\r\n\r\n    onBtnBackClicked:function(){\r\n        cc.vv.alert.show(\"返回大厅\",\"返回大厅房间仍会保留，快去邀请大伙来玩吧！\",function(){\r\n            cc.director.loadScene(\"hall\");    \r\n        },true);\r\n    },\r\n    \r\n    onBtnChatClicked:function(){\r\n        \r\n    },\r\n    \r\n    onBtnWeichatClicked:function(){\r\n        if(cc.vv.gameNetMgr.conf.type == \"sjmmj\"){\r\n            var title = \"<沈家门麻将>\";\r\n        }\r\n        else if(cc.vv.gameNetMgr.conf.type == \"dhmj\"){\r\n            var title = \"<定海麻将>\";\r\n        }\r\n        else if(cc.vv.gameNetMgr.conf.type == \"tdh\"){\r\n            var title = \"<推倒胡>\";\r\n        }\r\n        //cc.vv.anysdkMgr.share(\"奇奇舟山麻将\" + title,\"房号:\" + cc.vv.gameNetMgr.roomId + \" 玩法:\" + cc.vv.gameNetMgr.getWanfa());\r\n        cc.vv.anysdkMgr.share(\"奇奇舟山麻将\" + title + \" 房号:【\" + cc.vv.gameNetMgr.roomId+\"】\", \"玩法:\" + cc.vv.gameNetMgr.getWanfa());\r\n    },\r\n    \r\n    onBtnDissolveClicked:function(){\r\n        cc.vv.alert.show(\"解散房间\",\"解散房间不扣房卡，是否确定解散？\",function(){\r\n            cc.vv.net.send(\"dispress\");    \r\n        },true);\r\n    },\r\n    \r\n    onBtnExit:function(){\r\n        cc.vv.net.send(\"exit\");\r\n    },\r\n    \r\n    playVoice:function(){\r\n        if(this._playingSeat == null && this._voiceMsgQueue.length){\r\n            console.log(\"playVoice2\");\r\n            var data = this._voiceMsgQueue.shift();\r\n            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);\r\n            var localIndex = cc.vv.gameNetMgr.getLocalIndex(idx);\r\n            this._playingSeat = localIndex;\r\n            this._seats[localIndex].voiceMsg(true);\r\n            this._seats2[localIndex].voiceMsg(true);\r\n            \r\n            var msgInfo = JSON.parse(data.content);\r\n            \r\n            var msgfile = \"voicemsg.amr\";\r\n            console.log(msgInfo.msg.length);\r\n            cc.vv.voiceMgr.writeVoice(msgfile,msgInfo.msg);\r\n            cc.vv.voiceMgr.play(msgfile);\r\n            this._lastPlayTime = Date.now() + msgInfo.time;\r\n        }\r\n    },\r\n    \r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        var minutes = Math.floor(Date.now()/1000/60);\r\n        if(this._lastMinute != minutes){\r\n            this._lastMinute = minutes;\r\n            var date = new Date();\r\n            var h = date.getHours();\r\n            h = h < 10? \"0\"+h:h;\r\n            \r\n            var m = date.getMinutes();\r\n            m = m < 10? \"0\"+m:m;\r\n            this._timeLabel.string = \"\" + h + \":\" + m;             \r\n        }\r\n        \r\n        \r\n        if(this._lastPlayTime != null){\r\n            if(Date.now() > this._lastPlayTime + 200){\r\n                this.onPlayerOver();\r\n                this._lastPlayTime = null;    \r\n            }\r\n        }\r\n        else{\r\n            this.playVoice();\r\n        }\r\n    },\r\n    \r\n        \r\n    onPlayerOver:function(){\r\n        cc.vv.audioMgr.resumeAll();\r\n        console.log(\"onPlayCallback:\" + this._playingSeat);\r\n        var localIndex = this._playingSeat;\r\n        this._playingSeat = null;\r\n        this._seats[localIndex].voiceMsg(false);\r\n        this._seats2[localIndex].voiceMsg(false);\r\n    },\r\n    \r\n    onDestroy:function(){\r\n        cc.vv.voiceMgr.stop();\r\n//        cc.vv.voiceMgr.onPlayCallback = null;\r\n    }\r\n});\r\n"
  ]
}