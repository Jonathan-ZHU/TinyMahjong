{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    // 页面名称，显示层级，是否显示回退，回退名称，\r\n    // 点击回退则删除当前层级的最后一个子对象。\r\n    // 层级 ：回退名称\r\n    properties: {\r\n        layers:{\r\n            default:[],\r\n            type:cc.Node,\r\n        },\r\n        back:cc.Button,\r\n        backName:cc.Label,\r\n       _backInfo:[],\r\n       _curInfoIdx:0, \r\n       _loading:false,   \r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        cc.http = require(\"HTTP\");\r\n\r\n        cc.page = {\r\n            SHOW_PAGE:\"show_page\",\r\n            BACK_PAGE:\"back_page\",\r\n            REMOVE_PAGE:\"remove_page\",\r\n            CLEAN_ALL_LAYERS:\"clean_all_layers\"\r\n        };\r\n\r\n        this.initEventListener();\r\n    },\r\n\r\n    start: function () {\r\n        cc.log(\"框架初始完毕。。。\");\r\n    },\r\n\r\n    initEventListener:function () {\r\n        this.node.on(cc.page.SHOW_PAGE,this.onShowPage.bind(this));\r\n        this.node.on(cc.page.BACK_PAGE,this.onBackPage.bind(this));\r\n        this.node.on(cc.page.REMOVE_PAGE,this.onRemovePage.bind(this));\r\n        this.node.on(cc.page.CLEAN_ALL_LAYERS,this.cleanAllLayers.bind(this));\r\n    },\r\n\r\n    /** path, layerIndex,showBack,backName,single,store*/\r\n    onShowPage: function (info) {\r\n        if( !info || !info.detail || this._loading)\r\n            return ;       \r\n        info = info.detail;\r\n\r\n        var pageidx = info.layerIndex;\r\n        if( pageidx < 0 || pageidx >= this.layers.length )\r\n            return ;\r\n        \r\n        this._backInfo.push(info);\r\n        this._curInfoIdx = this._backInfo.length - 1;\r\n        this._curPath = info.path;\r\n        //加载prefab\r\n        cc.loader.loadRes(info.path, function (err, prefab) {\r\n                if(prefab)\r\n                {\r\n                    this._prefabLoaded( prefab );\r\n                }\r\n                if(err)\r\n                {\r\n                     this._loading = false;\r\n                    cc.log(err);\r\n                }            \r\n            }.bind(this)); \r\n        this._loading = true;\r\n\r\n    },\r\n\r\n    _prefabLoaded: function (prefab){        \r\n        if( prefab )\r\n        {   \r\n            this._loading = false;\r\n            var curInfo = this._backInfo[this._curInfoIdx];\r\n\r\n            var newNode = cc.instantiate(prefab);\r\n            newNode.name = \"page\"+ this._backInfo.length;\r\n\r\n            var parent = this.layers[curInfo.layerIndex];\r\n            if( curInfo.single )\r\n            {\r\n                parent.removeAllChildren();\r\n            }\r\n            parent.addChild( newNode );\r\n\r\n            this.back.node.active = false;\r\n            if( curInfo.showBack )\r\n            {\r\n                this.back.node.active = true;\r\n                this.backName.string = curInfo.backName;\r\n            }\r\n\r\n            if( curInfo.scriptName && curInfo.scriptName != \"\" )\r\n            {\r\n                newNode.getComponent(curInfo.scriptName).init( curInfo.detail );\r\n            }\r\n        }\r\n    },\r\n\r\n    onBackPage: function (event) {\r\n        var last = this._backInfo.pop();        \r\n\r\n        var parent = this.layers[last.layerIndex];\r\n        parent.removeChild( parent.getChildByName( \"page\"+ (this._backInfo.length + 1) ) ,true );\r\n\r\n        //config pre \r\n        this.back.node.active = false;\r\n        last = this._backInfo[ this._backInfo.length - 1 ];\r\n        if( last )\r\n        {            \r\n            if( last.showBack )\r\n            {\r\n                this.back.node.active = true;\r\n                this.backName.string = last.backName;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**删除某一层 的 N 个界面 */\r\n    onRemovePage: function (event)\r\n    {\r\n        var info = event.detail;\r\n        if( !info && info.layerIndex > this.layers.length)\r\n        {\r\n            return ;\r\n        }\r\n\r\n        var cont = this.layers[info.layerIndex];\r\n        if( info.removeNum < 1)\r\n        {            \r\n            cont.removeAllChildren();\r\n            return ;\r\n        }\r\n\r\n        while ( info.removeNum >=1 ) {\r\n            cont.removeChild( cont.children[ cont.children.length -1 ] );\r\n            info.removeNum -= 1;\r\n        }\r\n    },\r\n\r\n\r\n    cleanAllLayers: function () {\r\n       this._curInfoIdx = 0;\r\n       this._backInfo = [];\r\n       this._loading = false;\r\n       this.layers.forEach(function(element) {\r\n            element.removeAllChildren();\r\n       }, this);\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    // onCleanAlert: function (info) {\r\n\r\n    // },\r\n\r\n    // onRestart: function (info) {\r\n        \r\n    // },\r\n\r\n\r\n\r\n});\r\n"
  ]
}